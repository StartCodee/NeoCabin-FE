/*! For license information please see main.598b3401.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var a=n(853),r=n(43),s=n(950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(i(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var p=Object.assign,h=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),C=Symbol.for("react.lazy");Symbol.for("react.scope");var T=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var E=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var _=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=_&&e[_]||e["@@iterator"])?e:null}var R=Symbol.for("react.client.reference");function F(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===R?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case S:return"Suspense";case N:return"SuspenseList";case T:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case w:return(e.displayName||"Context")+".Provider";case x:return(e._context.displayName||"Context")+".Consumer";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:F(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return F(e(t))}catch(n){}}return null}var D=Array.isArray,M=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P={pending:!1,data:null,method:null,action:null},L=[],z=-1;function j(e){return{current:e}}function B(e){0>z||(e.current=L[z],L[z]=null,z--)}function W(e,t){z++,L[z]=e.current,e.current=t}var V=j(null),U=j(null),H=j(null),G=j(null);function q(e,t){switch(W(H,t),W(U,e),W(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?rd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=sd(t=rd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(V),W(V,e)}function K(){B(V),B(U),B(H)}function X(e){null!==e.memoizedState&&W(G,e);var t=V.current,n=sd(t,e.type);t!==n&&(W(U,e),W(V,n))}function Y(e){U.current===e&&(B(V),B(U)),G.current===e&&(B(G),Xd._currentValue=P)}var Q=Object.prototype.hasOwnProperty,J=a.unstable_scheduleCallback,Z=a.unstable_cancelCallback,$=a.unstable_shouldYield,ee=a.unstable_requestPaint,te=a.unstable_now,ne=a.unstable_getCurrentPriorityLevel,ae=a.unstable_ImmediatePriority,re=a.unstable_UserBlockingPriority,se=a.unstable_NormalPriority,ie=a.unstable_LowPriority,oe=a.unstable_IdlePriority,le=a.log,ce=a.unstable_setDisableYieldValue,ue=null,de=null;function pe(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(t){}}var he=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(fe(e)/me|0)|0},fe=Math.log,me=Math.LN2;var ge=256,ye=4194304;function be(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ve(e,t,n){var a=e.pendingLanes;if(0===a)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&a;return 0!==o?0!==(a=o&~s)?r=be(a):0!==(i&=o)?r=be(i):n||0!==(n=o&~e)&&(r=be(n)):0!==(o=a&~s)?r=be(o):0!==i?r=be(i):n||0!==(n=a&~e)&&(r=be(n)),0===r?0:0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:r}function xe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ke(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Se(){var e=ye;return 0===(62914560&(ye<<=1))&&(ye=4194304),e}function Ne(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ie(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ce(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-he(t);e.entangledLanes|=t,e.entanglements[a]=1073741824|e.entanglements[a]|4194090&n}function Te(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-he(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}function Ee(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function _e(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ae(){var e=O.p;return 0!==e?e:void 0===(e=window.event)?32:cp(e.type)}var Re=Math.random().toString(36).slice(2),Fe="__reactFiber$"+Re,De="__reactProps$"+Re,Me="__reactContainer$"+Re,Oe="__reactEvents$"+Re,Pe="__reactListeners$"+Re,Le="__reactHandles$"+Re,ze="__reactResources$"+Re,je="__reactMarker$"+Re;function Be(e){delete e[Fe],delete e[De],delete e[Oe],delete e[Pe],delete e[Le]}function We(e){var t=e[Fe];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Me]||n[Fe]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=vd(e);null!==e;){if(n=e[Fe])return n;e=vd(e)}return t}n=(e=n).parentNode}return null}function Ve(e){if(e=e[Fe]||e[Me]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ue(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function He(e){var t=e[ze];return t||(t=e[ze]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ge(e){e[je]=!0}var qe=new Set,Ke={};function Xe(e,t){Ye(e,t),Ye(e+"Capture",t)}function Ye(e,t){for(Ke[e]=t,e=0;e<t.length;e++)qe.add(t[e])}var Qe,Je,Ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$e={},et={};function tt(e,t,n){if(r=t,Q.call(et,r)||!Q.call($e,r)&&(Ze.test(r)?et[r]=!0:($e[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var a=t.toLowerCase().slice(0,5);if("data-"!==a&&"aria-"!==a)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function at(e,t,n,a){if(null===a)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+a)}}function rt(e){if(void 0===Qe)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Qe=t&&t[1]||"",Je=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Qe+e+Je}var st=!1;function it(e,t){if(!e||st)return"";st=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var a=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){a=s}e.call(n.prototype)}}else{try{throw Error()}catch(i){a=i}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&a&&"string"===typeof o.stack)return[o.stack,a.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=a.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(r=a=0;a<l.length&&!l[a].includes("DetermineComponentFrameRoot");)a++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(a===l.length||r===c.length)for(a=l.length-1,r=c.length-1;1<=a&&0<=r&&l[a]!==c[r];)r--;for(;1<=a&&0<=r;a--,r--)if(l[a]!==c[r]){if(1!==a||1!==r)do{if(a--,0>--r||l[a]!==c[r]){var u="\n"+l[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=a&&0<=r);break}}}finally{st=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?rt(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return rt(e.type);case 16:return rt("Lazy");case 13:return rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return it(e.type,!1);case 11:return it(e.type.render,!1);case 1:return it(e.type,!0);case 31:return rt("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){a=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=ut(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function ht(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var ft=/[\n"\\]/g;function mt(e){return e.replace(ft,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,n,a,r,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?bt(e,i,ct(t)):null!=n?bt(e,i,ct(n)):null!=a&&e.removeAttribute("value"),null==r&&null!=s&&(e.defaultChecked=!!s),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function yt(e,t,n,a,r,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}a="function"!==typeof(a=null!=a?a:r)&&"symbol"!==typeof a&&!!a,e.checked=o?e.checked:!!a,e.defaultChecked=!!a,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i)}function bt(e,t,n){"number"===t&&ht(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function vt(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function xt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,a){if(null==t){if(null!=a){if(null!=n)throw Error(i(92));if(D(a)){if(1<a.length)throw Error(i(93));a=a[0]}n=a}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(a=e.textContent)===n&&""!==a&&null!==a&&(e.value=a)}function kt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nt(e,t,n){var a=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?a?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":a?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function It(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=n){for(var a in n)!n.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var r in t)a=t[r],t.hasOwnProperty(r)&&n[r]!==a&&Nt(e,r,a)}else for(var s in t)t.hasOwnProperty(s)&&Nt(e,s,t[s])}function Ct(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Et=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _t(e){return Et.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var At=null;function Rt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ft=null,Dt=null;function Mt(e){var t=Ve(e);if(t&&(e=t.stateNode)){var n=e[De]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=a[De]||null;if(!r)throw Error(i(90));gt(a,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(a=n[t]).form===e.form&&pt(a)}break e;case"textarea":xt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&vt(e,!!n.multiple,t,!1)}}}var Ot=!1;function Pt(e,t,n){if(Ot)return e(t,n);Ot=!0;try{return e(t)}finally{if(Ot=!1,(null!==Ft||null!==Dt)&&(Wc(),Ft&&(t=Ft,e=Dt,Dt=Ft=null,Mt(t),e)))for(t=0;t<e.length;t++)Mt(e[t])}}function Lt(e,t){var n=e.stateNode;if(null===n)return null;var a=n[De]||null;if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),jt=!1;if(zt)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){jt=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch(Dp){jt=!1}var Wt=null,Vt=null,Ut=null;function Ht(){if(Ut)return Ut;var e,t,n=Vt,a=n.length,r="value"in Wt?Wt.value:Wt.textContent,s=r.length;for(e=0;e<a&&n[e]===r[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===r[s-t];t++);return Ut=r.slice(e,1<t?1-t:void 0)}function Gt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function qt(){return!0}function Kt(){return!1}function Xt(e){function t(t,n,a,r,s){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?qt:Kt,this.isPropagationStopped=Kt,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=qt)},persist:function(){},isPersistent:qt}),t}var Yt,Qt,Jt,Zt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$t=Xt(Zt),en=p({},Zt,{view:0,detail:0}),tn=Xt(en),nn=p({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jt&&(Jt&&"mousemove"===e.type?(Yt=e.screenX-Jt.screenX,Qt=e.screenY-Jt.screenY):Qt=Yt=0,Jt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:Qt}}),an=Xt(nn),rn=Xt(p({},nn,{dataTransfer:0})),sn=Xt(p({},en,{relatedTarget:0})),on=Xt(p({},Zt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Xt(p({},Zt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Xt(p({},Zt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=pn[e])&&!!t[e]}function fn(){return hn}var mn=Xt(p({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fn,charCode:function(e){return"keypress"===e.type?Gt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Xt(p({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),yn=Xt(p({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fn})),bn=Xt(p({},Zt,{propertyName:0,elapsedTime:0,pseudoElement:0})),vn=Xt(p({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),xn=Xt(p({},Zt,{newState:0,oldState:0})),wn=[9,13,27,32],kn=zt&&"CompositionEvent"in window,Sn=null;zt&&"documentMode"in document&&(Sn=document.documentMode);var Nn=zt&&"TextEvent"in window&&!Sn,In=zt&&(!kn||Sn&&8<Sn&&11>=Sn),Cn=String.fromCharCode(32),Tn=!1;function En(e,t){switch(e){case"keyup":return-1!==wn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _n(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var An=!1;var Rn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Rn[e.type]:"textarea"===t}function Dn(e,t,n,a){Ft?Dt?Dt.push(a):Dt=[a]:Ft=a,0<(t=Hu(t,"onChange")).length&&(n=new $t("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Mn=null,On=null;function Pn(e){Pu(e,0)}function Ln(e){if(pt(Ue(e)))return e}function zn(e,t){if("change"===e)return t}var jn=!1;if(zt){var Bn;if(zt){var Wn="oninput"in document;if(!Wn){var Vn=document.createElement("div");Vn.setAttribute("oninput","return;"),Wn="function"===typeof Vn.oninput}Bn=Wn}else Bn=!1;jn=Bn&&(!document.documentMode||9<document.documentMode)}function Un(){Mn&&(Mn.detachEvent("onpropertychange",Hn),On=Mn=null)}function Hn(e){if("value"===e.propertyName&&Ln(On)){var t=[];Dn(t,On,e,Rt(e)),Pt(Pn,t)}}function Gn(e,t,n){"focusin"===e?(Un(),On=n,(Mn=t).attachEvent("onpropertychange",Hn)):"focusout"===e&&Un()}function qn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ln(On)}function Kn(e,t){if("click"===e)return Ln(t)}function Xn(e,t){if("input"===e||"change"===e)return Ln(t)}var Yn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qn(e,t){if(Yn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!Q.call(t,r)||!Yn(e[r],t[r]))return!1}return!0}function Jn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zn(e,t){var n,a=Jn(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Jn(a)}}function $n(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?$n(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ea(e){for(var t=ht((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=ht((e=t.contentWindow).document)}return t}function ta(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var na=zt&&"documentMode"in document&&11>=document.documentMode,aa=null,ra=null,sa=null,ia=!1;function oa(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ia||null==aa||aa!==ht(a)||("selectionStart"in(a=aa)&&ta(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},sa&&Qn(sa,a)||(sa=a,0<(a=Hu(ra,"onSelect")).length&&(t=new $t("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=aa)))}function la(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ca={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionrun:la("Transition","TransitionRun"),transitionstart:la("Transition","TransitionStart"),transitioncancel:la("Transition","TransitionCancel"),transitionend:la("Transition","TransitionEnd")},ua={},da={};function pa(e){if(ua[e])return ua[e];if(!ca[e])return e;var t,n=ca[e];for(t in n)if(n.hasOwnProperty(t)&&t in da)return ua[e]=n[t];return e}zt&&(da=document.createElement("div").style,"AnimationEvent"in window||(delete ca.animationend.animation,delete ca.animationiteration.animation,delete ca.animationstart.animation),"TransitionEvent"in window||delete ca.transitionend.transition);var ha=pa("animationend"),fa=pa("animationiteration"),ma=pa("animationstart"),ga=pa("transitionrun"),ya=pa("transitionstart"),ba=pa("transitioncancel"),va=pa("transitionend"),xa=new Map,wa="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ka(e,t){xa.set(e,t),Xe(t,[e])}wa.push("scrollEnd");var Sa=new WeakMap;function Na(e,t){if("object"===typeof e&&null!==e){var n=Sa.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Sa.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Ia=[],Ca=0,Ta=0;function Ea(){for(var e=Ca,t=Ta=Ca=0;t<e;){var n=Ia[t];Ia[t++]=null;var a=Ia[t];Ia[t++]=null;var r=Ia[t];Ia[t++]=null;var s=Ia[t];if(Ia[t++]=null,null!==a&&null!==r){var i=a.pending;null===i?r.next=r:(r.next=i.next,i.next=r),a.pending=r}0!==s&&Fa(n,r,s)}}function _a(e,t,n,a){Ia[Ca++]=e,Ia[Ca++]=t,Ia[Ca++]=n,Ia[Ca++]=a,Ta|=a,e.lanes|=a,null!==(e=e.alternate)&&(e.lanes|=a)}function Aa(e,t,n,a){return _a(e,t,n,a),Da(e)}function Ra(e,t){return _a(e,null,null,t),Da(e)}function Fa(e,t,n){e.lanes|=n;var a=e.alternate;null!==a&&(a.lanes|=n);for(var r=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(a=s.alternate)&&(a.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(r=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,r&&null!==t&&(r=31-he(n),null===(a=(e=s.hiddenUpdates)[r])?e[r]=[t]:a.push(t),t.lane=536870912|n),s):null}function Da(e){if(50<Fc)throw Fc=0,Dc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ma={};function Oa(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pa(e,t,n,a){return new Oa(e,t,n,a)}function La(e){return!(!(e=e.prototype)||!e.isReactComponent)}function za(e,t){var n=e.alternate;return null===n?((n=Pa(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function ja(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ba(e,t,n,a,r,s){var o=0;if(a=e,"function"===typeof e)La(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case T:return(e=Pa(31,n,t,r)).elementType=T,e.lanes=s,e;case g:return Wa(n.children,r,s,t);case y:o=8,r|=24;break;case b:return(e=Pa(12,n,t,2|r)).elementType=b,e.lanes=s,e;case S:return(e=Pa(13,n,t,r)).elementType=S,e.lanes=s,e;case N:return(e=Pa(19,n,t,r)).elementType=N,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case v:case w:o=10;break e;case x:o=9;break e;case k:o=11;break e;case I:o=14;break e;case C:o=16,a=null;break e}o=29,n=Error(i(130,null===e?"null":typeof e,"")),a=null}return(t=Pa(o,n,t,r)).elementType=e,t.type=a,t.lanes=s,t}function Wa(e,t,n,a){return(e=Pa(7,e,a,t)).lanes=n,e}function Va(e,t,n){return(e=Pa(6,e,null,t)).lanes=n,e}function Ua(e,t,n){return(t=Pa(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ha=[],Ga=0,qa=null,Ka=0,Xa=[],Ya=0,Qa=null,Ja=1,Za="";function $a(e,t){Ha[Ga++]=Ka,Ha[Ga++]=qa,qa=e,Ka=t}function er(e,t,n){Xa[Ya++]=Ja,Xa[Ya++]=Za,Xa[Ya++]=Qa,Qa=e;var a=Ja;e=Za;var r=32-he(a)-1;a&=~(1<<r),n+=1;var s=32-he(t)+r;if(30<s){var i=r-r%5;s=(a&(1<<i)-1).toString(32),a>>=i,r-=i,Ja=1<<32-he(t)+r|n<<r|a,Za=s+e}else Ja=1<<s|n<<r|a,Za=e}function tr(e){null!==e.return&&($a(e,1),er(e,1,0))}function nr(e){for(;e===qa;)qa=Ha[--Ga],Ha[Ga]=null,Ka=Ha[--Ga],Ha[Ga]=null;for(;e===Qa;)Qa=Xa[--Ya],Xa[Ya]=null,Za=Xa[--Ya],Xa[Ya]=null,Ja=Xa[--Ya],Xa[Ya]=null}var ar=null,rr=null,sr=!1,ir=null,or=!1,lr=Error(i(519));function cr(e){throw mr(Na(Error(i(418,"")),e)),lr}function ur(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[Fe]=e,t[De]=a,n){case"dialog":Lu("cancel",t),Lu("close",t);break;case"iframe":case"object":case"embed":Lu("load",t);break;case"video":case"audio":for(n=0;n<Mu.length;n++)Lu(Mu[n],t);break;case"source":Lu("error",t);break;case"img":case"image":case"link":Lu("error",t),Lu("load",t);break;case"details":Lu("toggle",t);break;case"input":Lu("invalid",t),yt(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),dt(t);break;case"select":Lu("invalid",t);break;case"textarea":Lu("invalid",t),wt(t,a.value,a.defaultValue,a.children),dt(t)}"string"!==typeof(n=a.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===a.suppressHydrationWarning||Qu(t.textContent,n)?(null!=a.popover&&(Lu("beforetoggle",t),Lu("toggle",t)),null!=a.onScroll&&Lu("scroll",t),null!=a.onScrollEnd&&Lu("scrollend",t),null!=a.onClick&&(t.onclick=Ju),t=!0):t=!1,t||cr(e)}function dr(e){for(ar=e.return;ar;)switch(ar.tag){case 5:case 13:return void(or=!1);case 27:case 3:return void(or=!0);default:ar=ar.return}}function pr(e){if(e!==ar)return!1;if(!sr)return dr(e),sr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||id(e.type,e.memoizedProps)),t=!t),t&&rr&&cr(e),dr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){rr=yd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}rr=null}}else 27===n?(n=rr,hd(e.type)?(e=bd,bd=null,rr=e):rr=n):rr=ar?yd(e.stateNode.nextSibling):null;return!0}function hr(){rr=ar=null,sr=!1}function fr(){var e=ir;return null!==e&&(null===vc?vc=e:vc.push.apply(vc,e),ir=null),e}function mr(e){null===ir?ir=[e]:ir.push(e)}var gr=j(null),yr=null,br=null;function vr(e,t,n){W(gr,t._currentValue),t._currentValue=n}function xr(e){e._currentValue=gr.current,B(gr)}function wr(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function kr(e,t,n,a){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var s=r.dependencies;if(null!==s){var o=r.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=r;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),wr(s.return,n,e),a||(o=null);break e}s=l.next}}else if(18===r.tag){if(null===(o=r.return))throw Error(i(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),wr(o,n,e),o=null}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===e){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}}function Sr(e,t,n,a){e=null;for(var r=t,s=!1;null!==r;){if(!s)if(0!==(524288&r.flags))s=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var o=r.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=r.type;Yn(r.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(r===G.current){if(null===(o=r.alternate))throw Error(i(387));o.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(Xd):e=[Xd])}r=r.return}null!==e&&kr(t,e,n,a),t.flags|=262144}function Nr(e){for(e=e.firstContext;null!==e;){if(!Yn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ir(e){yr=e,br=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Cr(e){return Er(yr,e)}function Tr(e,t){return null===yr&&Ir(e),Er(e,t)}function Er(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===br){if(null===e)throw Error(i(308));br=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else br=br.next=t;return n}var _r="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ar=a.unstable_scheduleCallback,Rr=a.unstable_NormalPriority,Fr={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Dr(){return{controller:new _r,data:new Map,refCount:0}}function Mr(e){e.refCount--,0===e.refCount&&Ar(Rr,function(){e.controller.abort()})}var Or=null,Pr=0,Lr=0,zr=null;function jr(){if(0===--Pr&&null!==Or){null!==zr&&(zr.status="fulfilled");var e=Or;Or=null,Lr=0,zr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Br=M.S;M.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Or){var n=Or=[];Pr=0,Lr=_u(),zr={status:"pending",value:void 0,then:function(e){n.push(e)}}}Pr++,t.then(jr,jr)}(0,t),null!==Br&&Br(e,t)};var Wr=j(null);function Vr(){var e=Wr.current;return null!==e?e:ac.pooledCache}function Ur(e,t){W(Wr,null===t?Wr.current:t.pool)}function Hr(){var e=Vr();return null===e?null:{parent:Fr._currentValue,pool:e}}var Gr=Error(i(460)),qr=Error(i(474)),Kr=Error(i(542)),Xr={then:function(){}};function Yr(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Qr(){}function Jr(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Qr,Qr),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e;default:if("string"===typeof t.status)t.then(Qr,Qr);else{if(null!==(e=ac)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e}throw Zr=t,Gr}}var Zr=null;function $r(){if(null===Zr)throw Error(i(459));var e=Zr;return Zr=null,e}function es(e){if(e===Gr||e===Kr)throw Error(i(483))}var ts=!1;function ns(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function as(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function rs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ss(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&nc)){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,t=Da(e),Fa(e,null,n),t}return _a(e,a,t,n),Da(e)}function is(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Te(e,n)}}function os(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var i={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?r=s=i:s=s.next=i,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:a.shared,callbacks:a.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ls=!1;function cs(){if(ls){if(null!==zr)throw zr}}function us(e,t,n,a){ls=!1;var r=e.updateQueue;ts=!1;var s=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=r.baseState;for(i=0,u=c=l=null,o=s;;){var h=-536870913&o.lane,f=h!==o.lane;if(f?(sc&h)===h:(a&h)===h){0!==h&&h===Lr&&(ls=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;h=t;var y=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(y,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=g.payload)?m.call(y,d,h):m)||void 0===h)break e;d=p({},d,h);break e;case 2:ts=!0}}null!==(h=o.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[h]:f.push(h))}else f={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,i|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(f=o).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null===s&&(r.shared.lanes=0),hc|=i,e.lanes=i,e.memoizedState=d}}function ds(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function ps(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ds(n[e],t)}var hs=j(null),fs=j(0);function ms(e,t){W(fs,e=dc),W(hs,t),dc=e|t.baseLanes}function gs(){W(fs,dc),W(hs,hs.current)}function ys(){dc=fs.current,B(hs),B(fs)}var bs=0,vs=null,xs=null,ws=null,ks=!1,Ss=!1,Ns=!1,Is=0,Cs=0,Ts=null,Es=0;function _s(){throw Error(i(321))}function As(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yn(e[n],t[n]))return!1;return!0}function Rs(e,t,n,a,r,s){return bs=s,vs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=null===e||null===e.memoizedState?Gi:qi,Ns=!1,s=n(a,r),Ns=!1,Ss&&(s=Ds(t,n,a,r)),Fs(e),s}function Fs(e){M.H=Hi;var t=null!==xs&&null!==xs.next;if(bs=0,ws=xs=vs=null,ks=!1,Cs=0,Ts=null,t)throw Error(i(300));null===e||To||null!==(e=e.dependencies)&&Nr(e)&&(To=!0)}function Ds(e,t,n,a){vs=e;var r=0;do{if(Ss&&(Ts=null),Cs=0,Ss=!1,25<=r)throw Error(i(301));if(r+=1,ws=xs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}M.H=Ki,s=t(n,a)}while(Ss);return s}function Ms(){var e=M.H,t=e.useState()[0];return t="function"===typeof t.then?Bs(t):t,e=e.useState()[0],(null!==xs?xs.memoizedState:null)!==e&&(vs.flags|=1024),t}function Os(){var e=0!==Is;return Is=0,e}function Ps(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Ls(e){if(ks){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ks=!1}bs=0,ws=xs=vs=null,Ss=!1,Cs=Is=0,Ts=null}function zs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ws?vs.memoizedState=ws=e:ws=ws.next=e,ws}function js(){if(null===xs){var e=vs.alternate;e=null!==e?e.memoizedState:null}else e=xs.next;var t=null===ws?vs.memoizedState:ws.next;if(null!==t)ws=t,xs=e;else{if(null===e){if(null===vs.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(xs=e).memoizedState,baseState:xs.baseState,baseQueue:xs.baseQueue,queue:xs.queue,next:null},null===ws?vs.memoizedState=ws=e:ws=ws.next=e}return ws}function Bs(e){var t=Cs;return Cs+=1,null===Ts&&(Ts=[]),e=Jr(Ts,e,t),t=vs,null===(null===ws?t.memoizedState:ws.next)&&(t=t.alternate,M.H=null===t||null===t.memoizedState?Gi:qi),e}function Ws(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Bs(e);if(e.$$typeof===w)return Cr(e)}throw Error(i(438,String(e)))}function Vs(e){var t=null,n=vs.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var a=vs.alternate;null!==a&&(null!==(a=a.updateQueue)&&(null!=(a=a.memoCache)&&(t={data:a.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},vs.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=E;return t.index++,n}function Us(e,t){return"function"===typeof t?t(e):t}function Hs(e){return Gs(js(),xs,e)}function Gs(e,t,n){var a=e.queue;if(null===a)throw Error(i(311));a.lastRenderedReducer=n;var r=e.baseQueue,s=a.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}t.baseQueue=r=s,a.pending=null}if(s=e.baseState,null===r)e.memoizedState=s;else{var l=o=null,c=null,u=t=r.next,d=!1;do{var p=-536870913&u.lane;if(p!==u.lane?(sc&p)===p:(bs&p)===p){var h=u.revertLane;if(0===h)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),p===Lr&&(d=!0);else{if((bs&h)===h){u=u.next,h===Lr&&(d=!0);continue}p={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,o=s):c=c.next=p,vs.lanes|=h,hc|=h}p=u.action,Ns&&n(s,p),s=u.hasEagerState?u.eagerState:n(s,p)}else h={lane:p,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,vs.lanes|=p,hc|=p;u=u.next}while(null!==u&&u!==t);if(null===c?o=s:c.next=l,!Yn(s,e.memoizedState)&&(To=!0,d&&null!==(n=zr)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,a.lastRenderedState=s}return null===r&&(a.lanes=0),[e.memoizedState,a.dispatch]}function qs(e){var t=js(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);Yn(s,t.memoizedState)||(To=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,a]}function Ks(e,t,n){var a=vs,r=js(),s=sr;if(s){if(void 0===n)throw Error(i(407));n=n()}else n=t();var o=!Yn((xs||r).memoizedState,n);if(o&&(r.memoizedState=n,To=!0),r=r.queue,gi(2048,8,Qs.bind(null,a,r,e),[e]),r.getSnapshot!==t||o||null!==ws&&1&ws.memoizedState.tag){if(a.flags|=2048,hi(9,{destroy:void 0,resource:void 0},Ys.bind(null,a,r,n,t),null),null===ac)throw Error(i(349));s||0!==(124&bs)||Xs(a,t,n)}return n}function Xs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},vs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ys(e,t,n,a){t.value=n,t.getSnapshot=a,Js(t)&&Zs(e)}function Qs(e,t,n){return n(function(){Js(t)&&Zs(e)})}function Js(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yn(e,n)}catch(a){return!0}}function Zs(e){var t=Ra(e,2);null!==t&&Pc(t,e,2)}function $s(e){var t=zs();if("function"===typeof e){var n=e;if(e=n(),Ns){pe(!0);try{n()}finally{pe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:e},t}function ei(e,t,n,a){return e.baseState=n,Gs(e,xs,"function"===typeof a?a:Us)}function ti(e,t,n,a,r){if(Wi(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==M.T?n(!0):s.isTransition=!1,a(s),null===(n=t.pending)?(s.next=t.pending=s,ni(t,s)):(s.next=n.next,t.pending=n.next=s)}}function ni(e,t){var n=t.action,a=t.payload,r=e.state;if(t.isTransition){var s=M.T,i={};M.T=i;try{var o=n(r,a),l=M.S;null!==l&&l(i,o),ai(e,t,o)}catch(c){si(e,t,c)}finally{M.T=s}}else try{ai(e,t,s=n(r,a))}catch(u){si(e,t,u)}}function ai(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){ri(e,t,n)},function(n){return si(e,t,n)}):ri(e,t,n)}function ri(e,t,n){t.status="fulfilled",t.value=n,ii(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ni(e,n)))}function si(e,t,n){var a=e.pending;if(e.pending=null,null!==a){a=a.next;do{t.status="rejected",t.reason=n,ii(t),t=t.next}while(t!==a)}e.action=null}function ii(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function oi(e,t){return t}function li(e,t){if(sr){var n=ac.formState;if(null!==n){e:{var a=vs;if(sr){if(rr){t:{for(var r=rr,s=or;8!==r.nodeType;){if(!s){r=null;break t}if(null===(r=yd(r.nextSibling))){r=null;break t}}r="F!"===(s=r.data)||"F"===s?r:null}if(r){rr=yd(r.nextSibling),a="F!"===r.data;break e}}cr(a)}a=!1}a&&(t=n[0])}}return(n=zs()).memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:t},n.queue=a,n=zi.bind(null,vs,a),a.dispatch=n,a=$s(!1),s=Bi.bind(null,vs,!1,a.queue),r={state:t,dispatch:null,action:e,pending:null},(a=zs()).queue=r,n=ti.bind(null,vs,r,s,n),r.dispatch=n,a.memoizedState=e,[t,n,!1]}function ci(e){return ui(js(),xs,e)}function ui(e,t,n){if(t=Gs(e,t,oi)[0],e=Hs(Us)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var a=Bs(t)}catch(i){if(i===Gr)throw Kr;throw i}else a=t;var r=(t=js()).queue,s=r.dispatch;return n!==t.memoizedState&&(vs.flags|=2048,hi(9,{destroy:void 0,resource:void 0},di.bind(null,r,n),null)),[a,s,e]}function di(e,t){e.action=t}function pi(e){var t=js(),n=xs;if(null!==n)return ui(t,n,e);js(),t=t.memoizedState;var a=(n=js()).queue.dispatch;return n.memoizedState=e,[t,a,!1]}function hi(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},null===(t=vs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},vs.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function fi(){return js().memoizedState}function mi(e,t,n,a){var r=zs();a=void 0===a?null:a,vs.flags|=e,r.memoizedState=hi(1|t,{destroy:void 0,resource:void 0},n,a)}function gi(e,t,n,a){var r=js();a=void 0===a?null:a;var s=r.memoizedState.inst;null!==xs&&null!==a&&As(a,xs.memoizedState.deps)?r.memoizedState=hi(t,s,n,a):(vs.flags|=e,r.memoizedState=hi(1|t,s,n,a))}function yi(e,t){mi(8390656,8,e,t)}function bi(e,t){gi(2048,8,e,t)}function vi(e,t){return gi(4,2,e,t)}function xi(e,t){return gi(4,4,e,t)}function wi(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function ki(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,gi(4,4,wi.bind(null,t,e),n)}function Si(){}function Ni(e,t){var n=js();t=void 0===t?null:t;var a=n.memoizedState;return null!==t&&As(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Ii(e,t){var n=js();t=void 0===t?null:t;var a=n.memoizedState;if(null!==t&&As(t,a[1]))return a[0];if(a=e(),Ns){pe(!0);try{e()}finally{pe(!1)}}return n.memoizedState=[a,t],a}function Ci(e,t,n){return void 0===n||0!==(1073741824&bs)?e.memoizedState=t:(e.memoizedState=n,e=Oc(),vs.lanes|=e,hc|=e,n)}function Ti(e,t,n,a){return Yn(n,t)?n:null!==hs.current?(e=Ci(e,n,a),Yn(e,t)||(To=!0),e):0===(42&bs)?(To=!0,e.memoizedState=n):(e=Oc(),vs.lanes|=e,hc|=e,t)}function Ei(e,t,n,a,r){var s=O.p;O.p=0!==s&&8>s?s:8;var i=M.T,o={};M.T=o,Bi(e,!1,t,n);try{var l=r(),c=M.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)ji(e,t,function(e,t){var n=[],a={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(a.status="rejected",a.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),a}(l,a),Mc());else ji(e,t,a,Mc())}catch(u){ji(e,t,{then:function(){},status:"rejected",reason:u},Mc())}finally{O.p=s,M.T=i}}function _i(){}function Ai(e,t,n,a){if(5!==e.tag)throw Error(i(476));var r=Ri(e).queue;Ei(e,r,t,P,null===n?_i:function(){return Fi(e),n(a)})}function Ri(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:P,baseState:P,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:P},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Fi(e){ji(e,Ri(e).next.queue,{},Mc())}function Di(){return Cr(Xd)}function Mi(){return js().memoizedState}function Oi(){return js().memoizedState}function Pi(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Mc(),a=ss(t,e=rs(n),n);return null!==a&&(Pc(a,t,n),is(a,t,n)),t={cache:Dr()},void(e.payload=t)}t=t.return}}function Li(e,t,n){var a=Mc();n={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Wi(e)?Vi(t,n):null!==(n=Aa(e,t,n,a))&&(Pc(n,e,a),Ui(n,t,a))}function zi(e,t,n){ji(e,t,n,Mc())}function ji(e,t,n,a){var r={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wi(e))Vi(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,n);if(r.hasEagerState=!0,r.eagerState=o,Yn(o,i))return _a(e,t,r,0),null===ac&&Ea(),!1}catch(l){}if(null!==(n=Aa(e,t,r,a)))return Pc(n,e,a),Ui(n,t,a),!0}return!1}function Bi(e,t,n,a){if(a={lane:2,revertLane:_u(),action:a,hasEagerState:!1,eagerState:null,next:null},Wi(e)){if(t)throw Error(i(479))}else null!==(t=Aa(e,n,a,2))&&Pc(t,e,2)}function Wi(e){var t=e.alternate;return e===vs||null!==t&&t===vs}function Vi(e,t){Ss=ks=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ui(e,t,n){if(0!==(4194048&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Te(e,n)}}var Hi={readContext:Cr,use:Ws,useCallback:_s,useContext:_s,useEffect:_s,useImperativeHandle:_s,useLayoutEffect:_s,useInsertionEffect:_s,useMemo:_s,useReducer:_s,useRef:_s,useState:_s,useDebugValue:_s,useDeferredValue:_s,useTransition:_s,useSyncExternalStore:_s,useId:_s,useHostTransitionStatus:_s,useFormState:_s,useActionState:_s,useOptimistic:_s,useMemoCache:_s,useCacheRefresh:_s},Gi={readContext:Cr,use:Ws,useCallback:function(e,t){return zs().memoizedState=[e,void 0===t?null:t],e},useContext:Cr,useEffect:yi,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,mi(4194308,4,wi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return mi(4194308,4,e,t)},useInsertionEffect:function(e,t){mi(4,2,e,t)},useMemo:function(e,t){var n=zs();t=void 0===t?null:t;var a=e();if(Ns){pe(!0);try{e()}finally{pe(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=zs();if(void 0!==n){var r=n(t);if(Ns){pe(!0);try{n(t)}finally{pe(!1)}}}else r=t;return a.memoizedState=a.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},a.queue=e,e=e.dispatch=Li.bind(null,vs,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},zs().memoizedState=e},useState:function(e){var t=(e=$s(e)).queue,n=zi.bind(null,vs,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Si,useDeferredValue:function(e,t){return Ci(zs(),e,t)},useTransition:function(){var e=$s(!1);return e=Ei.bind(null,vs,e.queue,!0,!1),zs().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=vs,r=zs();if(sr){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===ac)throw Error(i(349));0!==(124&sc)||Xs(a,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,yi(Qs.bind(null,a,s,e),[e]),a.flags|=2048,hi(9,{destroy:void 0,resource:void 0},Ys.bind(null,a,s,n,t),null),n},useId:function(){var e=zs(),t=ac.identifierPrefix;if(sr){var n=Za;t="\xab"+t+"R"+(n=(Ja&~(1<<32-he(Ja)-1)).toString(32)+n),0<(n=Is++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Es++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Di,useFormState:li,useActionState:li,useOptimistic:function(e){var t=zs();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Bi.bind(null,vs,!0,n),n.dispatch=t,[e,t]},useMemoCache:Vs,useCacheRefresh:function(){return zs().memoizedState=Pi.bind(null,vs)}},qi={readContext:Cr,use:Ws,useCallback:Ni,useContext:Cr,useEffect:bi,useImperativeHandle:ki,useInsertionEffect:vi,useLayoutEffect:xi,useMemo:Ii,useReducer:Hs,useRef:fi,useState:function(){return Hs(Us)},useDebugValue:Si,useDeferredValue:function(e,t){return Ti(js(),xs.memoizedState,e,t)},useTransition:function(){var e=Hs(Us)[0],t=js().memoizedState;return["boolean"===typeof e?e:Bs(e),t]},useSyncExternalStore:Ks,useId:Mi,useHostTransitionStatus:Di,useFormState:ci,useActionState:ci,useOptimistic:function(e,t){return ei(js(),0,e,t)},useMemoCache:Vs,useCacheRefresh:Oi},Ki={readContext:Cr,use:Ws,useCallback:Ni,useContext:Cr,useEffect:bi,useImperativeHandle:ki,useInsertionEffect:vi,useLayoutEffect:xi,useMemo:Ii,useReducer:qs,useRef:fi,useState:function(){return qs(Us)},useDebugValue:Si,useDeferredValue:function(e,t){var n=js();return null===xs?Ci(n,e,t):Ti(n,xs.memoizedState,e,t)},useTransition:function(){var e=qs(Us)[0],t=js().memoizedState;return["boolean"===typeof e?e:Bs(e),t]},useSyncExternalStore:Ks,useId:Mi,useHostTransitionStatus:Di,useFormState:pi,useActionState:pi,useOptimistic:function(e,t){var n=js();return null!==xs?ei(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Vs,useCacheRefresh:Oi},Xi=null,Yi=0;function Qi(e){var t=Yi;return Yi+=1,null===Xi&&(Xi=[]),Jr(Xi,e,t)}function Ji(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zi(e,t){if(t.$$typeof===h)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $i(e){return(0,e._init)(e._payload)}function eo(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=za(e,t)).index=0,e.sibling=null,e}function s(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=67108866,n):a:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=Va(n,e.mode,a)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,a){var s=n.type;return s===g?d(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===C&&$i(s)===t.type)?(Ji(t=r(t,n.props),n),t.return=e,t):(Ji(t=Ba(n.type,n.key,n.props,null,e.mode,a),n),t.return=e,t)}function u(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ua(n,e.mode,a)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,a,s){return null===t||7!==t.tag?((t=Wa(n,e.mode,a,s)).return=e,t):((t=r(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Va(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return Ji(n=Ba(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Ua(t,e.mode,n)).return=e,t;case C:return p(e,t=(0,t._init)(t._payload),n)}if(D(t)||A(t))return(t=Wa(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return p(e,Qi(t),n);if(t.$$typeof===w)return p(e,Tr(e,t),n);Zi(e,t)}return null}function h(e,t,n,a){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:l(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return n.key===r?c(e,t,n,a):null;case m:return n.key===r?u(e,t,n,a):null;case C:return h(e,t,n=(r=n._init)(n._payload),a)}if(D(n)||A(n))return null!==r?null:d(e,t,n,a,null);if("function"===typeof n.then)return h(e,t,Qi(n),a);if(n.$$typeof===w)return h(e,t,Tr(e,n),a);Zi(e,n)}return null}function y(e,t,n,a,r){if("string"===typeof a&&""!==a||"number"===typeof a||"bigint"===typeof a)return l(t,e=e.get(n)||null,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case f:return c(t,e=e.get(null===a.key?n:a.key)||null,a,r);case m:return u(t,e=e.get(null===a.key?n:a.key)||null,a,r);case C:return y(e,t,n,a=(0,a._init)(a._payload),r)}if(D(a)||A(a))return d(t,e=e.get(n)||null,a,r,null);if("function"===typeof a.then)return y(e,t,n,Qi(a),r);if(a.$$typeof===w)return y(e,t,n,Tr(t,a),r);Zi(t,a)}return null}function b(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case f:e:{for(var v=u.key;null!==c;){if(c.key===v){if((v=u.type)===g){if(7===c.tag){n(l,c.sibling),(d=r(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===C&&$i(v)===c.type){n(l,c.sibling),Ji(d=r(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((d=Wa(u.props.children,l.mode,d,u.key)).return=l,l=d):(Ji(d=Ba(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return o(l);case m:e:{for(v=u.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=r(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Ua(u,l.mode,d)).return=l,l=d}return o(l);case C:return b(l,c,u=(v=u._init)(u._payload),d)}if(D(u))return function(r,i,o,l){for(var c=null,u=null,d=i,f=i=0,m=null;null!==d&&f<o.length;f++){d.index>f?(m=d,d=null):m=d.sibling;var g=h(r,d,o[f],l);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(r,d),i=s(g,i,f),null===u?c=g:u.sibling=g,u=g,d=m}if(f===o.length)return n(r,d),sr&&$a(r,f),c;if(null===d){for(;f<o.length;f++)null!==(d=p(r,o[f],l))&&(i=s(d,i,f),null===u?c=d:u.sibling=d,u=d);return sr&&$a(r,f),c}for(d=a(d);f<o.length;f++)null!==(m=y(d,r,f,o[f],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?f:m.key),i=s(m,i,f),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(r,e)}),sr&&$a(r,f),c}(l,c,u,d);if(A(u)){if("function"!==typeof(v=A(u)))throw Error(i(150));return function(r,o,l,c){if(null==l)throw Error(i(151));for(var u=null,d=null,f=o,m=o=0,g=null,b=l.next();null!==f&&!b.done;m++,b=l.next()){f.index>m?(g=f,f=null):g=f.sibling;var v=h(r,f,b.value,c);if(null===v){null===f&&(f=g);break}e&&f&&null===v.alternate&&t(r,f),o=s(v,o,m),null===d?u=v:d.sibling=v,d=v,f=g}if(b.done)return n(r,f),sr&&$a(r,m),u;if(null===f){for(;!b.done;m++,b=l.next())null!==(b=p(r,b.value,c))&&(o=s(b,o,m),null===d?u=b:d.sibling=b,d=b);return sr&&$a(r,m),u}for(f=a(f);!b.done;m++,b=l.next())null!==(b=y(f,r,m,b.value,c))&&(e&&null!==b.alternate&&f.delete(null===b.key?m:b.key),o=s(b,o,m),null===d?u=b:d.sibling=b,d=b);return e&&f.forEach(function(e){return t(r,e)}),sr&&$a(r,m),u}(l,c,u=v.call(u),d)}if("function"===typeof u.then)return b(l,c,Qi(u),d);if(u.$$typeof===w)return b(l,c,Tr(l,u),d);Zi(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=r(c,u)).return=l,l=d):(n(l,c),(d=Va(u,l.mode,d)).return=l,l=d),o(l)):n(l,c)}return function(e,t,n,a){try{Yi=0;var r=b(e,t,n,a);return Xi=null,r}catch(i){if(i===Gr||i===Kr)throw i;var s=Pa(29,i,null,e.mode);return s.lanes=a,s.return=e,s}}}var to=eo(!0),no=eo(!1),ao=j(null),ro=null;function so(e){var t=e.alternate;W(co,1&co.current),W(ao,e),null===ro&&(null===t||null!==hs.current||null!==t.memoizedState)&&(ro=e)}function io(e){if(22===e.tag){if(W(co,co.current),W(ao,e),null===ro){var t=e.alternate;null!==t&&null!==t.memoizedState&&(ro=e)}}else oo()}function oo(){W(co,co.current),W(ao,ao.current)}function lo(e){B(ao),ro===e&&(ro=null),B(co)}var co=j(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gd(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function po(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ho={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Mc(),r=rs(a);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ss(e,r,a))&&(Pc(t,e,a),is(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Mc(),r=rs(a);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ss(e,r,a))&&(Pc(t,e,a),is(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Mc(),a=rs(n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=ss(e,a,n))&&(Pc(t,e,n),is(t,e,n))}};function fo(e,t,n,a,r,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Qn(n,a)||!Qn(r,s))}function mo(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&ho.enqueueReplaceState(t,t.state,null)}function go(e,t){var n=t;if("ref"in t)for(var a in n={},t)"ref"!==a&&(n[a]=t[a]);if(e=e.defaultProps)for(var r in n===t&&(n=p({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}var yo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function bo(e){yo(e)}function vo(e){console.error(e)}function xo(e){yo(e)}function wo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function ko(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function So(e,t,n){return(n=rs(n)).tag=3,n.payload={element:null},n.callback=function(){wo(e,t)},n}function No(e){return(e=rs(e)).tag=3,e}function Io(e,t,n,a){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var s=a.value;e.payload=function(){return r(s)},e.callback=function(){ko(t,n,a)}}var i=n.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){ko(t,n,a),"function"!==typeof r&&(null===Nc?Nc=new Set([this]):Nc.add(this));var e=a.stack;this.componentDidCatch(a.value,{componentStack:null!==e?e:""})})}var Co=Error(i(461)),To=!1;function Eo(e,t,n,a){t.child=null===e?no(t,null,n,a):to(t,e.child,n,a)}function _o(e,t,n,a,r){n=n.render;var s=t.ref;if("ref"in a){var i={};for(var o in a)"ref"!==o&&(i[o]=a[o])}else i=a;return Ir(t),a=Rs(e,t,n,i,s,r),o=Os(),null===e||To?(sr&&o&&tr(t),t.flags|=1,Eo(e,t,a,r),t.child):(Ps(e,t,r),Yo(e,t,r))}function Ao(e,t,n,a,r){if(null===e){var s=n.type;return"function"!==typeof s||La(s)||void 0!==s.defaultProps||null!==n.compare?((e=Ba(n.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ro(e,t,s,a,r))}if(s=e.child,!Qo(e,r)){var i=s.memoizedProps;if((n=null!==(n=n.compare)?n:Qn)(i,a)&&e.ref===t.ref)return Yo(e,t,r)}return t.flags|=1,(e=za(s,a)).ref=t.ref,e.return=t,t.child=e}function Ro(e,t,n,a,r){if(null!==e){var s=e.memoizedProps;if(Qn(s,a)&&e.ref===t.ref){if(To=!1,t.pendingProps=a=s,!Qo(e,r))return t.lanes=e.lanes,Yo(e,t,r);0!==(131072&e.flags)&&(To=!0)}}return Oo(e,t,n,a,r)}function Fo(e,t,n){var a=t.pendingProps,r=a.children,s=null!==e?e.memoizedState:null;if("hidden"===a.mode){if(0!==(128&t.flags)){if(a=null!==s?s.baseLanes|n:n,null!==e){for(r=t.child=e.child,s=0;null!==r;)s=s|r.lanes|r.childLanes,r=r.sibling;t.childLanes=s&~a}else t.childLanes=0,t.child=null;return Do(e,t,a,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Do(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ur(0,null!==s?s.cachePool:null),null!==s?ms(t,s):gs(),io(t)}else null!==s?(Ur(0,s.cachePool),ms(t,s),oo(),t.memoizedState=null):(null!==e&&Ur(0,null),gs(),oo());return Eo(e,t,r,n),t.child}function Do(e,t,n,a){var r=Vr();return r=null===r?null:{parent:Fr._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},null!==e&&Ur(0,null),gs(),io(t),null!==e&&Sr(e,t,a,!0),null}function Mo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(i(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Oo(e,t,n,a,r){return Ir(t),n=Rs(e,t,n,a,void 0,r),a=Os(),null===e||To?(sr&&a&&tr(t),t.flags|=1,Eo(e,t,n,r),t.child):(Ps(e,t,r),Yo(e,t,r))}function Po(e,t,n,a,r,s){return Ir(t),t.updateQueue=null,n=Ds(t,a,n,r),Fs(e),a=Os(),null===e||To?(sr&&a&&tr(t),t.flags|=1,Eo(e,t,n,s),t.child):(Ps(e,t,s),Yo(e,t,s))}function Lo(e,t,n,a,r){if(Ir(t),null===t.stateNode){var s=Ma,i=n.contextType;"object"===typeof i&&null!==i&&(s=Cr(i)),s=new n(a,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=ho,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=a,s.state=t.memoizedState,s.refs={},ns(t),i=n.contextType,s.context="object"===typeof i&&null!==i?Cr(i):Ma,s.state=t.memoizedState,"function"===typeof(i=n.getDerivedStateFromProps)&&(po(t,n,i,a),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&ho.enqueueReplaceState(s,s.state,null),us(t,a,s,r),cs(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),a=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=go(n,o);s.props=l;var c=s.context,u=n.contextType;i=Ma,"object"===typeof u&&null!==u&&(i=Cr(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&mo(t,s,a,i),ts=!1;var p=t.memoizedState;s.state=p,us(t,a,s,r),cs(),c=t.memoizedState,o||p!==c||ts?("function"===typeof d&&(po(t,n,d,a),c=t.memoizedState),(l=ts||fo(t,n,l,a,p,c,i))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),s.props=a,s.state=c,s.context=i,a=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),a=!1)}else{s=t.stateNode,as(e,t),u=go(n,i=t.memoizedProps),s.props=u,d=t.pendingProps,p=s.context,c=n.contextType,l=Ma,"object"===typeof c&&null!==c&&(l=Cr(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==d||p!==l)&&mo(t,s,a,l),ts=!1,p=t.memoizedState,s.state=p,us(t,a,s,r),cs();var h=t.memoizedState;i!==d||p!==h||ts||null!==e&&null!==e.dependencies&&Nr(e.dependencies)?("function"===typeof o&&(po(t,n,o,a),h=t.memoizedState),(u=ts||fo(t,n,u,a,p,h,l)||null!==e&&null!==e.dependencies&&Nr(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(a,h,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(a,h,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=h),s.props=a,s.state=h,s.context=l,a=u):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),a=!1)}return s=a,Mo(e,t),a=0!==(128&t.flags),s||a?(s=t.stateNode,n=a&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&a?(t.child=to(t,e.child,null,r),t.child=to(t,null,n,r)):Eo(e,t,n,r),t.memoizedState=s.state,e=t.child):e=Yo(e,t,r),e}function zo(e,t,n,a){return hr(),t.flags|=256,Eo(e,t,n,a),t.child}var jo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bo(e){return{baseLanes:e,cachePool:Hr()}}function Wo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=gc),e}function Vo(e,t,n){var a,r=t.pendingProps,s=!1,o=0!==(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&0!==(2&co.current)),a&&(s=!0,t.flags&=-129),a=0!==(32&t.flags),t.flags&=-33,null===e){if(sr){if(s?so(t):oo(),sr){var l,c=rr;if(l=c){e:{for(l=c,c=or;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=yd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Qa?{id:Ja,overflow:Za}:null,retryLane:536870912,hydrationErrors:null},(l=Pa(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ar=t,rr=null,l=!0):l=!1}l||cr(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gd(c)?t.lanes=32:t.lanes=536870912,null;lo(t)}return c=r.children,r=r.fallback,s?(oo(),c=Ho({mode:"hidden",children:c},s=t.mode),r=Wa(r,s,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(s=t.child).memoizedState=Bo(n),s.childLanes=Wo(e,a,n),t.memoizedState=jo,r):(so(t),Uo(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(so(t),t.flags&=-257,t=Go(e,t,n)):null!==t.memoizedState?(oo(),t.child=e.child,t.flags|=128,t=null):(oo(),s=r.fallback,c=t.mode,r=Ho({mode:"visible",children:r.children},c),(s=Wa(s,c,n,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,to(t,e.child,null,n),(r=t.child).memoizedState=Bo(n),r.childLanes=Wo(e,a,n),t.memoizedState=jo,t=s);else if(so(t),gd(c)){if(a=c.nextSibling&&c.nextSibling.dataset)var u=a.dgst;a=u,(r=Error(i(419))).stack="",r.digest=a,mr({value:r,source:null,stack:null}),t=Go(e,t,n)}else if(To||Sr(e,t,n,!1),a=0!==(n&e.childLanes),To||a){if(null!==(a=ac)&&(0!==(r=0!==((r=0!==(42&(r=n&-n))?1:Ee(r))&(a.suspendedLanes|n))?0:r)&&r!==l.retryLane))throw l.retryLane=r,Ra(e,r),Pc(a,e,r),Co;"$?"===c.data||Kc(),t=Go(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,rr=yd(c.nextSibling),ar=t,sr=!0,ir=null,or=!1,null!==e&&(Xa[Ya++]=Ja,Xa[Ya++]=Za,Xa[Ya++]=Qa,Ja=e.id,Za=e.overflow,Qa=t),(t=Uo(t,r.children)).flags|=4096);return t}return s?(oo(),s=r.fallback,c=t.mode,u=(l=e.child).sibling,(r=za(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?s=za(u,s):(s=Wa(s,c,n,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,null===(c=e.child.memoizedState)?c=Bo(n):(null!==(l=c.cachePool)?(u=Fr._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Hr(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=Wo(e,a,n),t.memoizedState=jo,r):(so(t),e=(n=e.child).sibling,(n=za(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=n,t.memoizedState=null,n)}function Uo(e,t){return(t=Ho({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ho(e,t){return(e=Pa(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Go(e,t,n){return to(t,e.child,null,n),(e=Uo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qo(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),wr(e.return,t,n)}function Ko(e,t,n,a,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=n,s.tailMode=r)}function Xo(e,t,n){var a=t.pendingProps,r=a.revealOrder,s=a.tail;if(Eo(e,t,a.children,n),0!==(2&(a=co.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qo(e,n,t);else if(19===e.tag)qo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(W(co,a),r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ko(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===uo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ko(t,!0,n,null,s);break;case"together":Ko(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),hc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Sr(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=za(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=za(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Qo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Nr(e))}function Jo(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)To=!0;else{if(!Qo(e,n)&&0===(128&t.flags))return To=!1,function(e,t,n){switch(t.tag){case 3:q(t,t.stateNode.containerInfo),vr(0,Fr,e.memoizedState.cache),hr();break;case 27:case 5:X(t);break;case 4:q(t,t.stateNode.containerInfo);break;case 10:vr(0,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(null!==a)return null!==a.dehydrated?(so(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Vo(e,t,n):(so(t),null!==(e=Yo(e,t,n))?e.sibling:null);so(t);break;case 19:var r=0!==(128&e.flags);if((a=0!==(n&t.childLanes))||(Sr(e,t,n,!1),a=0!==(n&t.childLanes)),r){if(a)return Xo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),W(co,co.current),a)break;return null;case 22:case 23:return t.lanes=0,Fo(e,t,n);case 24:vr(0,Fr,e.memoizedState.cache)}return Yo(e,t,n)}(e,t,n);To=0!==(131072&e.flags)}else To=!1,sr&&0!==(1048576&t.flags)&&er(t,Ka,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,r=a._init;if(a=r(a._payload),t.type=a,"function"!==typeof a){if(void 0!==a&&null!==a){if((r=a.$$typeof)===k){t.tag=11,t=_o(null,t,a,e,n);break e}if(r===I){t.tag=14,t=Ao(null,t,a,e,n);break e}}throw t=F(a)||a,Error(i(306,t,""))}La(a)?(e=go(a,e),t.tag=1,t=Lo(null,t,a,e,n)):(t.tag=0,t=Oo(null,t,a,e,n))}return t;case 0:return Oo(e,t,t.type,t.pendingProps,n);case 1:return Lo(e,t,a=t.type,r=go(a,t.pendingProps),n);case 3:e:{if(q(t,t.stateNode.containerInfo),null===e)throw Error(i(387));a=t.pendingProps;var s=t.memoizedState;r=s.element,as(e,t),us(t,a,null,n);var o=t.memoizedState;if(a=o.cache,vr(0,Fr,a),a!==s.cache&&kr(t,[Fr],n,!0),cs(),a=o.element,s.isDehydrated){if(s={element:a,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=zo(e,t,a,n);break e}if(a!==r){mr(r=Na(Error(i(424)),t)),t=zo(e,t,a,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(rr=yd(e.firstChild),ar=t,sr=!0,ir=null,or=!0,n=no(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hr(),a===r){t=Yo(e,t,n);break e}Eo(e,t,a,n)}t=t.child}return t;case 26:return Mo(e,t),null===e?(n=Ed(t.type,null,t.pendingProps,null))?t.memoizedState=n:sr||(n=t.type,e=t.pendingProps,(a=ad(H.current).createElement(n))[Fe]=t,a[De]=e,ed(a,n,e),Ge(a),t.stateNode=a):t.memoizedState=Ed(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return X(t),null===e&&sr&&(a=t.stateNode=xd(t.type,t.pendingProps,H.current),ar=t,or=!0,r=rr,hd(t.type)?(bd=r,rr=yd(a.firstChild)):rr=r),Eo(e,t,t.pendingProps.children,n),Mo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&sr&&((r=a=rr)&&(null!==(a=function(e,t,n,a){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(a){if(!e[je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===s)return e}if(null===(e=yd(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,or))?(t.stateNode=a,ar=t,rr=yd(a.firstChild),or=!1,r=!0):r=!1),r||cr(t)),X(t),r=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,a=s.children,id(r,s)?a=null:null!==o&&id(r,o)&&(t.flags|=32),null!==t.memoizedState&&(r=Rs(e,t,Ms,null,null,n),Xd._currentValue=r),Mo(e,t),Eo(e,t,a,n),t.child;case 6:return null===e&&sr&&((e=n=rr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=yd(e.nextSibling)))return null}return e}(n,t.pendingProps,or))?(t.stateNode=n,ar=t,rr=null,e=!0):e=!1),e||cr(t)),null;case 13:return Vo(e,t,n);case 4:return q(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=to(t,null,a,n):Eo(e,t,a,n),t.child;case 11:return _o(e,t,t.type,t.pendingProps,n);case 7:return Eo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Eo(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,vr(0,t.type,a.value),Eo(e,t,a.children,n),t.child;case 9:return r=t.type._context,a=t.pendingProps.children,Ir(t),a=a(r=Cr(r)),t.flags|=1,Eo(e,t,a,n),t.child;case 14:return Ao(e,t,t.type,t.pendingProps,n);case 15:return Ro(e,t,t.type,t.pendingProps,n);case 19:return Xo(e,t,n);case 31:return a=t.pendingProps,n=t.mode,a={mode:a.mode,children:a.children},null===e?((n=Ho(a,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=za(e.child,a)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Fo(e,t,n);case 24:return Ir(t),a=Cr(Fr),null===e?(null===(r=Vr())&&(r=ac,s=Dr(),r.pooledCache=s,s.refCount++,null!==s&&(r.pooledCacheLanes|=n),r=s),t.memoizedState={parent:a,cache:r},ns(t),vr(0,Fr,r)):(0!==(e.lanes&n)&&(as(e,t),us(t,null,null,n),cs()),r=e.memoizedState,s=t.memoizedState,r.parent!==a?(r={parent:a,cache:a},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),vr(0,Fr,a)):(a=s.cache,vr(0,Fr,a),a!==r.cache&&kr(t,[Fr],n,!0))),Eo(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Zo(e){e.flags|=4}function $o(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Wd(t)){if(null!==(t=ao.current)&&((4194048&sc)===sc?null!==ro:(62914560&sc)!==sc&&0===(536870912&sc)||t!==ro))throw Zr=Xr,qr;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Se():536870912,e.lanes|=t,yc|=t)}function tl(e,t){if(!sr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=65011712&r.subtreeFlags,a|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function al(e,t,n){var a=t.pendingProps;switch(nr(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),xr(Fr),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(pr(t)?Zo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,fr())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Zo(t),null!==n?(nl(t),$o(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Zo(t),nl(t),$o(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==a&&Zo(t),nl(t),t.flags&=-16777217),null;case 27:Y(t),n=H.current;var r=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==a&&Zo(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return nl(t),null}e=V.current,pr(t)?ur(t):(e=xd(r,a,n),t.stateNode=e,Zo(t))}return nl(t),null;case 5:if(Y(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&Zo(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return nl(t),null}if(e=V.current,pr(t))ur(t);else{switch(r=ad(H.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof a.is?r.createElement("select",{is:a.is}):r.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e="string"===typeof a.is?r.createElement(n,{is:a.is}):r.createElement(n)}}e[Fe]=t,e[De]=a;e:for(r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&27!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;null===r.sibling;){if(null===r.return||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(ed(e,n,a),n){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Zo(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&Zo(t);else{if("string"!==typeof a&&null===t.stateNode)throw Error(i(166));if(e=H.current,pr(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,null!==(r=ar))switch(r.tag){case 27:case 5:a=r.memoizedProps}e[Fe]=t,(e=!!(e.nodeValue===n||null!==a&&!0===a.suppressHydrationWarning||Qu(e.nodeValue,n)))||cr(t)}else(e=ad(e).createTextNode(a))[Fe]=t,t.stateNode=e}return nl(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=pr(t),null!==a&&null!==a.dehydrated){if(null===e){if(!r)throw Error(i(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(i(317));r[Fe]=t}else hr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),r=!1}else r=fr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(lo(t),t):(lo(t),null)}if(lo(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==a,e=null!==e&&null!==e.memoizedState,n){r=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(r=a.alternate.memoizedState.cachePool.pool);var s=null;null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(s=a.memoizedState.cachePool.pool),s!==r&&(a.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return K(),null===e&&Bu(t.stateNode.containerInfo),nl(t),null;case 10:return xr(t.type),nl(t),null;case 19:if(B(co),null===(r=t.memoizedState))return nl(t),null;if(a=0!==(128&t.flags),null===(s=r.rendering))if(a)tl(r,!1);else{if(0!==pc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=uo(e))){for(t.flags|=128,tl(r,!1),e=s.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)ja(n,e),n=n.sibling;return W(co,1&co.current|2),t.child}e=e.sibling}null!==r.tail&&te()>kc&&(t.flags|=128,a=!0,tl(r,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=uo(s))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!sr)return nl(t),null}else 2*te()-r.renderingStartTime>kc&&536870912!==n&&(t.flags|=128,a=!0,tl(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=te(),t.sibling=null,e=co.current,W(co,a?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return lo(t),ys(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),null!==e&&B(Wr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),xr(Fr),nl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function rl(e,t){switch(nr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return xr(Fr),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 13:if(lo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(co),null;case 4:return K(),null;case 10:return xr(t.type),null;case 22:case 23:return lo(t),ys(),null!==e&&B(Wr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return xr(Fr),null;default:return null}}function sl(e,t){switch(nr(t),t.tag){case 3:xr(Fr),K();break;case 26:case 27:case 5:Y(t);break;case 4:K();break;case 13:lo(t);break;case 19:B(co);break;case 10:xr(t.type);break;case 22:case 23:lo(t),ys(),null!==e&&B(Wr);break;case 24:xr(Fr)}}function il(e,t){try{var n=t.updateQueue,a=null!==n?n.lastEffect:null;if(null!==a){var r=a.next;n=r;do{if((n.tag&e)===e){a=void 0;var s=n.create,i=n.inst;a=s(),i.destroy=a}n=n.next}while(n!==r)}}catch(o){uu(t,t.return,o)}}function ol(e,t,n){try{var a=t.updateQueue,r=null!==a?a.lastEffect:null;if(null!==r){var s=r.next;a=s;do{if((a.tag&e)===e){var i=a.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,r=t;var l=n,c=o;try{c()}catch(u){uu(r,l,u)}}}a=a.next}while(a!==s)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ps(t,n)}catch(a){uu(e,e.return,a)}}}function cl(e,t,n){n.props=go(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){uu(e,t,a)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;default:a=e.stateNode}"function"===typeof n?e.refCleanup=n(a):n.current=a}}catch(r){uu(e,t,r)}}function dl(e,t){var n=e.ref,a=e.refCleanup;if(null!==n)if("function"===typeof a)try{a()}catch(r){uu(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){uu(e,t,s)}else n.current=null}function pl(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(r){uu(e,e.return,r)}}function hl(e,t,n){try{var a=e.stateNode;!function(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,o=null,l=null,c=null,u=null,d=null;for(f in n){var p=n[f];if(n.hasOwnProperty(f)&&null!=p)switch(f){case"checked":case"value":break;case"defaultValue":c=p;default:a.hasOwnProperty(f)||Zu(e,t,f,null,a,p)}}for(var h in a){var f=a[h];if(p=n[h],a.hasOwnProperty(h)&&(null!=f||null!=p))switch(h){case"type":s=f;break;case"name":r=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":o=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(i(137,t));break;default:f!==p&&Zu(e,t,h,f,a,p)}}return void gt(e,o,l,c,u,d,s,r);case"select":for(s in f=o=l=h=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":f=c;default:a.hasOwnProperty(s)||Zu(e,t,s,null,a,c)}for(r in a)if(s=a[r],c=n[r],a.hasOwnProperty(r)&&(null!=s||null!=c))switch(r){case"value":h=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&Zu(e,t,r,s,a,c)}return t=l,n=o,a=f,void(null!=h?vt(e,!!n,h,!1):!!a!==!!n&&(null!=t?vt(e,!!n,t,!0):vt(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=h=null,n)if(r=n[l],n.hasOwnProperty(l)&&null!=r&&!a.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Zu(e,t,l,null,a,r)}for(o in a)if(r=a[o],s=n[o],a.hasOwnProperty(o)&&(null!=r||null!=s))switch(o){case"value":h=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(i(91));break;default:r!==s&&Zu(e,t,o,r,a,s)}return void xt(e,h,f);case"option":for(var m in n)if(h=n[m],n.hasOwnProperty(m)&&null!=h&&!a.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Zu(e,t,m,null,a,h);for(c in a)if(h=a[c],f=n[c],a.hasOwnProperty(c)&&h!==f&&(null!=h||null!=f))if("selected"===c)e.selected=h&&"function"!==typeof h&&"symbol"!==typeof h;else Zu(e,t,c,h,a,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)h=n[g],n.hasOwnProperty(g)&&null!=h&&!a.hasOwnProperty(g)&&Zu(e,t,g,null,a,h);for(u in a)if(h=a[u],f=n[u],a.hasOwnProperty(u)&&h!==f&&(null!=h||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(i(137,t));break;default:Zu(e,t,u,h,a,f)}return;default:if(Ct(t)){for(var y in n)h=n[y],n.hasOwnProperty(y)&&void 0!==h&&!a.hasOwnProperty(y)&&$u(e,t,y,void 0,a,h);for(d in a)h=a[d],f=n[d],!a.hasOwnProperty(d)||h===f||void 0===h&&void 0===f||$u(e,t,d,h,a,f);return}}for(var b in n)h=n[b],n.hasOwnProperty(b)&&null!=h&&!a.hasOwnProperty(b)&&Zu(e,t,b,null,a,h);for(p in a)h=a[p],f=n[p],!a.hasOwnProperty(p)||h===f||null==h&&null==f||Zu(e,t,p,h,a,f)}(a,e.type,n,t),a[De]=t}catch(r){uu(e,e.return,r)}}function fl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&hd(e.type)||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||fl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&hd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ju));else if(4!==a&&(27===a&&hd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function yl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&(27===a&&hd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}function bl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);ed(t,a,n),t[Fe]=e,t[De]=n}catch(s){uu(e,e.return,s)}}var vl=!1,xl=!1,wl=!1,kl="function"===typeof WeakSet?WeakSet:Set,Sl=null;function Nl(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:Ll(e,n),4&a&&il(5,n);break;case 1:if(Ll(e,n),4&a)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(i){uu(n,n.return,i)}else{var r=go(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){uu(n,n.return,o)}}64&a&&ll(n),512&a&&ul(n,n.return);break;case 3:if(Ll(e,n),64&a&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{ps(e,t)}catch(i){uu(n,n.return,i)}}break;case 27:null===t&&4&a&&bl(n);case 26:case 5:Ll(e,n),null===t&&4&a&&pl(n),512&a&&ul(n,n.return);break;case 12:Ll(e,n);break;case 13:Ll(e,n),4&a&&Al(e,n),64&a&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}(e,n=fu.bind(null,n))));break;case 22:if(!(a=null!==n.memoizedState||vl)){t=null!==t&&null!==t.memoizedState||xl,r=vl;var s=xl;vl=a,(xl=t)&&!s?jl(e,n,0!==(8772&n.subtreeFlags)):Ll(e,n),vl=r,xl=s}break;case 30:break;default:Ll(e,n)}}function Il(e){var t=e.alternate;null!==t&&(e.alternate=null,Il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Cl=null,Tl=!1;function El(e,t,n){for(n=n.child;null!==n;)_l(e,t,n),n=n.sibling}function _l(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,n)}catch(s){}switch(n.tag){case 26:xl||dl(n,t),El(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:xl||dl(n,t);var a=Cl,r=Tl;hd(n.type)&&(Cl=n.stateNode,Tl=!1),El(e,t,n),wd(n.stateNode),Cl=a,Tl=r;break;case 5:xl||dl(n,t);case 6:if(a=Cl,r=Tl,Cl=null,El(e,t,n),Tl=r,null!==(Cl=a))if(Tl)try{(9===Cl.nodeType?Cl.body:"HTML"===Cl.nodeName?Cl.ownerDocument.body:Cl).removeChild(n.stateNode)}catch(i){uu(n,t,i)}else try{Cl.removeChild(n.stateNode)}catch(i){uu(n,t,i)}break;case 18:null!==Cl&&(Tl?(fd(9===(e=Cl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Tp(e)):fd(Cl,n.stateNode));break;case 4:a=Cl,r=Tl,Cl=n.stateNode.containerInfo,Tl=!0,El(e,t,n),Cl=a,Tl=r;break;case 0:case 11:case 14:case 15:xl||ol(2,n,t),xl||ol(4,n,t),El(e,t,n);break;case 1:xl||(dl(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount&&cl(n,t,a)),El(e,t,n);break;case 21:El(e,t,n);break;case 22:xl=(a=xl)||null!==n.memoizedState,El(e,t,n),xl=a;break;default:El(e,t,n)}}function Al(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Tp(e)}catch(n){uu(t,t.return,n)}}function Rl(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new kl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new kl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){var a=mu.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))})}function Fl(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var r=n[a],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(hd(l.type)){Cl=l.stateNode,Tl=!1;break e}break;case 5:Cl=l.stateNode,Tl=!1;break e;case 3:case 4:Cl=l.stateNode.containerInfo,Tl=!0;break e}l=l.return}if(null===Cl)throw Error(i(160));_l(s,o,r),Cl=null,Tl=!1,null!==(s=r.alternate)&&(s.return=null),r.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ml(t,e),t=t.sibling}var Dl=null;function Ml(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Fl(t,e),Ol(e),4&a&&(ol(3,e,e.return),il(3,e),ol(5,e,e.return));break;case 1:Fl(t,e),Ol(e),512&a&&(xl||null===n||dl(n,n.return)),64&a&&vl&&(null!==(e=e.updateQueue)&&(null!==(a=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?a:n.concat(a))));break;case 26:var r=Dl;if(Fl(t,e),Ol(e),512&a&&(xl||null===n||dl(n,n.return)),4&a){var s=null!==n?n.memoizedState:null;if(a=e.memoizedState,null===n)if(null===a)if(null===e.stateNode){e:{a=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(a){case"title":(!(s=r.getElementsByTagName("title")[0])||s[je]||s[Fe]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=r.createElement(a),r.head.insertBefore(s,r.querySelector("head > title"))),ed(s,a,n),s[Fe]=e,Ge(s),a=s;break e;case"link":var o=jd("link","href",r).get(a+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}ed(s=r.createElement(a),a,n),r.head.appendChild(s);break;case"meta":if(o=jd("meta","content",r).get(a+(n.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}ed(s=r.createElement(a),a,n),r.head.appendChild(s);break;default:throw Error(i(468,a))}s[Fe]=e,Ge(s),a=s}e.stateNode=a}else Bd(r,e.type,e.stateNode);else e.stateNode=Md(r,a,e.memoizedProps);else s!==a?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===a?Bd(r,e.type,e.stateNode):Md(r,a,e.memoizedProps)):null===a&&null!==e.stateNode&&hl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Fl(t,e),Ol(e),512&a&&(xl||null===n||dl(n,n.return)),null!==n&&4&a&&hl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Fl(t,e),Ol(e),512&a&&(xl||null===n||dl(n,n.return)),32&e.flags){r=e.stateNode;try{kt(r,"")}catch(f){uu(e,e.return,f)}}4&a&&null!=e.stateNode&&hl(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&a&&(wl=!0);break;case 6:if(Fl(t,e),Ol(e),4&a){if(null===e.stateNode)throw Error(i(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(f){uu(e,e.return,f)}}break;case 3:if(zd=null,r=Dl,Dl=Nd(t.containerInfo),Fl(t,e),Dl=r,Ol(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Tp(t.containerInfo)}catch(f){uu(e,e.return,f)}wl&&(wl=!1,Pl(e));break;case 4:a=Dl,Dl=Nd(e.stateNode.containerInfo),Fl(t,e),Ol(e),Dl=a;break;case 12:default:Fl(t,e),Ol(e);break;case 13:Fl(t,e),Ol(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(wc=te()),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Rl(e,a)));break;case 22:r=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=vl,d=xl;if(vl=u||r,xl=d||c,Fl(t,e),xl=d,vl=u,Ol(e),8192&a)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||c||vl||xl||zl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,r)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var p=c.memoizedProps.style,h=void 0!==p&&null!==p&&p.hasOwnProperty("display")?p.display:null;l.style.display=null==h||"boolean"===typeof h?"":(""+h).trim()}}catch(f){uu(c,c.return,f)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){uu(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&a&&(null!==(a=e.updateQueue)&&(null!==(n=a.retryQueue)&&(a.retryQueue=null,Rl(e,n))));break;case 19:Fl(t,e),Ol(e),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Rl(e,a)));case 30:case 21:}}function Ol(e){var t=e.flags;if(2&t){try{for(var n,a=e.return;null!==a;){if(fl(a)){n=a;break}a=a.return}if(null==n)throw Error(i(160));switch(n.tag){case 27:var r=n.stateNode;yl(e,ml(e),r);break;case 5:var s=n.stateNode;32&n.flags&&(kt(s,""),n.flags&=-33),yl(e,ml(e),s);break;case 3:case 4:var o=n.stateNode.containerInfo;gl(e,ml(e),o);break;default:throw Error(i(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Pl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Pl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Ll(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Nl(e,t.alternate,t),t=t.sibling}function zl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ol(4,t,t.return),zl(t);break;case 1:dl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),zl(t);break;case 27:wd(t.stateNode);case 26:case 5:dl(t,t.return),zl(t);break;case 22:null===t.memoizedState&&zl(t);break;default:zl(t)}e=e.sibling}}function jl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var a=t.alternate,r=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:jl(r,s,n),il(4,s);break;case 1:if(jl(r,s,n),"function"===typeof(r=(a=s).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){uu(a,a.return,c)}if(null!==(r=(a=s).updateQueue)){var o=a.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)ds(l[r],o)}catch(c){uu(a,a.return,c)}}n&&64&i&&ll(s),ul(s,s.return);break;case 27:bl(s);case 26:case 5:jl(r,s,n),n&&null===a&&4&i&&pl(s),ul(s,s.return);break;case 12:jl(r,s,n);break;case 13:jl(r,s,n),n&&4&i&&Al(r,s);break;case 22:null===s.memoizedState&&jl(r,s,n),ul(s,s.return);break;case 30:break;default:jl(r,s,n)}t=t.sibling}}function Bl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Mr(n))}function Wl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Mr(e))}function Vl(e,t,n,a){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Ul(e,t,n,a),t=t.sibling}function Ul(e,t,n,a){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Vl(e,t,n,a),2048&r&&il(9,t);break;case 1:case 13:default:Vl(e,t,n,a);break;case 3:Vl(e,t,n,a),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Mr(e)));break;case 12:if(2048&r){Vl(e,t,n,a),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else Vl(e,t,n,a);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Vl(e,t,n,a):Gl(e,t):2&s._visibility?Vl(e,t,n,a):(s._visibility|=2,Hl(e,t,n,a,0!==(10256&t.subtreeFlags))),2048&r&&Bl(i,t);break;case 24:Vl(e,t,n,a),2048&r&&Wl(t.alternate,t)}}function Hl(e,t,n,a,r){for(r=r&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,i=t,o=n,l=a,c=i.flags;switch(i.tag){case 0:case 11:case 15:Hl(s,i,o,l,r),il(8,i);break;case 23:break;case 22:var u=i.stateNode;null!==i.memoizedState?2&u._visibility?Hl(s,i,o,l,r):Gl(s,i):(u._visibility|=2,Hl(s,i,o,l,r)),r&&2048&c&&Bl(i.alternate,i);break;case 24:Hl(s,i,o,l,r),r&&2048&c&&Wl(i.alternate,i);break;default:Hl(s,i,o,l,r)}t=t.sibling}}function Gl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,a=t,r=a.flags;switch(a.tag){case 22:Gl(n,a),2048&r&&Bl(a.alternate,a);break;case 24:Gl(n,a),2048&r&&Wl(a.alternate,a);break;default:Gl(n,a)}t=t.sibling}}var ql=8192;function Kl(e){if(e.subtreeFlags&ql)for(e=e.child;null!==e;)Xl(e),e=e.sibling}function Xl(e){switch(e.tag){case 26:Kl(e),e.flags&ql&&null!==e.memoizedState&&function(e,t,n){if(null===Vd)throw Error(i(475));var a=Vd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var r=_d(n.href),s=e.querySelector(Ad(r));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(a.count++,a=Hd.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=s,void Ge(s);s=e.ownerDocument||e,n=Rd(n),(r=kd.get(r))&&Pd(n,r),Ge(s=s.createElement("link"));var o=s;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),ed(s,"link",n),t.instance=s}null===a.stylesheets&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(a.count++,t=Hd.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}(Dl,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Dl;Dl=Nd(e.stateNode.containerInfo),Kl(e),Dl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=ql,ql=16777216,Kl(e),ql=t):Kl(e))}}function Yl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Ql(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];Sl=a,$l(a,e)}Yl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Jl(e),e=e.sibling}function Jl(e){switch(e.tag){case 0:case 11:case 15:Ql(e),2048&e.flags&&ol(9,e,e.return);break;case 3:case 12:default:Ql(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zl(e)):Ql(e)}}function Zl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];Sl=a,$l(a,e)}Yl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ol(8,t,t.return),Zl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Zl(t));break;default:Zl(t)}e=e.sibling}}function $l(e,t){for(;null!==Sl;){var n=Sl;switch(n.tag){case 0:case 11:case 15:ol(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var a=n.memoizedState.cachePool.pool;null!=a&&a.refCount++}break;case 24:Mr(n.memoizedState.cache)}if(null!==(a=n.child))a.return=n,Sl=a;else e:for(n=e;null!==Sl;){var r=(a=Sl).sibling,s=a.return;if(Il(a),a===n){Sl=null;break e}if(null!==r){r.return=s,Sl=r;break e}Sl=s}}}var ec={getCacheForType:function(e){var t=Cr(Fr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,ac=null,rc=null,sc=0,ic=0,oc=null,lc=!1,cc=!1,uc=!1,dc=0,pc=0,hc=0,fc=0,mc=0,gc=0,yc=0,bc=null,vc=null,xc=!1,wc=0,kc=1/0,Sc=null,Nc=null,Ic=0,Cc=null,Tc=null,Ec=0,_c=0,Ac=null,Rc=null,Fc=0,Dc=null;function Mc(){if(0!==(2&nc)&&0!==sc)return sc&-sc;if(null!==M.T){return 0!==Lr?Lr:_u()}return Ae()}function Oc(){0===gc&&(gc=0===(536870912&sc)||sr?ke():536870912);var e=ao.current;return null!==e&&(e.flags|=32),gc}function Pc(e,t,n){(e!==ac||2!==ic&&9!==ic)&&null===e.cancelPendingCommit||(Uc(e,0),Bc(e,sc,gc,!1)),Ie(e,n),0!==(2&nc)&&e===ac||(e===ac&&(0===(2&nc)&&(fc|=n),4===pc&&Bc(e,sc,gc,!1)),ku(e))}function Lc(e,t,n){if(0!==(6&nc))throw Error(i(327));for(var a=!n&&0===(124&t)&&0===(t&e.expiredLanes)||xe(e,t),r=a?function(e,t){var n=nc;nc|=2;var a=Gc(),r=qc();ac!==e||sc!==t?(Sc=null,kc=te()+500,Uc(e,t)):cc=xe(e,t);e:for(;;)try{if(0!==ic&&null!==rc){t=rc;var s=oc;t:switch(ic){case 1:ic=0,oc=null,$c(e,t,s,1);break;case 2:case 9:if(Yr(s)){ic=0,oc=null,Zc(t);break}t=function(){2!==ic&&9!==ic||ac!==e||(ic=7),ku(e)},s.then(t,t);break e;case 3:ic=7;break e;case 4:ic=5;break e;case 7:Yr(s)?(ic=0,oc=null,Zc(t)):(ic=0,oc=null,$c(e,t,s,7));break;case 5:var o=null;switch(rc.tag){case 26:o=rc.memoizedState;case 5:case 27:var l=rc;if(!o||Wd(o)){ic=0,oc=null;var c=l.sibling;if(null!==c)rc=c;else{var u=l.return;null!==u?(rc=u,eu(u)):rc=null}break t}}ic=0,oc=null,$c(e,t,s,5);break;case 6:ic=0,oc=null,$c(e,t,s,6);break;case 8:Vc(),pc=6;break e;default:throw Error(i(462))}}Qc();break}catch(d){Hc(e,d)}return br=yr=null,M.H=a,M.A=r,nc=n,null!==rc?0:(ac=null,sc=0,Ea(),pc)}(e,t):Xc(e,t,!0),s=a;;){if(0===r){cc&&!a&&Bc(e,t,0,!1);break}if(n=e.current.alternate,!s||jc(n)){if(2===r){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;r=bc;var c=l.current.memoizedState.isDehydrated;if(c&&(Uc(l,o).flags|=256),2!==(o=Xc(l,o,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=s,fc|=s,r=4;break e}s=vc,vc=r,null!==s&&(null===vc?vc=s:vc.push.apply(vc,s))}r=o}if(s=!1,2!==r)continue}}if(1===r){Uc(e,0),Bc(e,t,0,!0);break}e:{switch(a=e,s=r){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Bc(a,t,gc,!lc);break e;case 2:vc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(r=wc+300-te())){if(Bc(a,t,gc,!lc),0!==ve(a,0,!0))break e;a.timeoutHandle=ld(zc.bind(null,a,n,vc,Sc,xc,t,gc,fc,yc,lc,s,2,-0,0),r)}else zc(a,n,vc,Sc,xc,t,gc,fc,yc,lc,s,0,-0,0)}break}r=Xc(e,t,!1),s=!1}ku(e)}function zc(e,t,n,a,r,s,o,l,c,u,d,p,h,f){if(e.timeoutHandle=-1,(8192&(p=t.subtreeFlags)||16785408===(16785408&p))&&(Vd={stylesheets:null,count:0,unsuspend:Ud},Xl(t),null!==(p=function(){if(null===Vd)throw Error(i(475));var e=Vd;return e.stylesheets&&0===e.count&&qd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&qd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=p(nu.bind(null,e,t,s,n,a,r,o,l,c,d,1,h,f)),void Bc(e,s,o,!u);nu(e,t,s,n,a,r,o,l,c)}function jc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var a=0;a<n.length;a++){var r=n[a],s=r.getSnapshot;r=r.value;try{if(!Yn(s(),r))return!1}catch(i){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,n,a){t&=~mc,t&=~fc,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var r=t;0<r;){var s=31-he(r),i=1<<s;a[s]=-1,r&=~i}0!==n&&Ce(e,n,t)}function Wc(){return 0!==(6&nc)||(Su(0,!1),!1)}function Vc(){if(null!==rc){if(0===ic)var e=rc.return;else br=yr=null,Ls(e=rc),Xi=null,Yi=0,e=rc;for(;null!==e;)sl(e.alternate,e),e=e.return;rc=null}}function Uc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Vc(),ac=e,rc=n=za(e.current,null),sc=t,ic=0,oc=null,lc=!1,cc=xe(e,t),uc=!1,yc=gc=mc=fc=hc=pc=0,vc=bc=null,xc=!1,0!==(8&t)&&(t|=32&t);var a=e.entangledLanes;if(0!==a)for(e=e.entanglements,a&=t;0<a;){var r=31-he(a),s=1<<r;t|=e[r],a&=~s}return dc=t,Ea(),n}function Hc(e,t){vs=null,M.H=Hi,t===Gr||t===Kr?(t=$r(),ic=3):t===qr?(t=$r(),ic=4):ic=t===Co?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,oc=t,null===rc&&(pc=1,wo(e,Na(t,e.current)))}function Gc(){var e=M.H;return M.H=Hi,null===e?Hi:e}function qc(){var e=M.A;return M.A=ec,e}function Kc(){pc=4,lc||(4194048&sc)!==sc&&null!==ao.current||(cc=!0),0===(134217727&hc)&&0===(134217727&fc)||null===ac||Bc(ac,sc,gc,!1)}function Xc(e,t,n){var a=nc;nc|=2;var r=Gc(),s=qc();ac===e&&sc===t||(Sc=null,Uc(e,t)),t=!1;var i=pc;e:for(;;)try{if(0!==ic&&null!==rc){var o=rc,l=oc;switch(ic){case 8:Vc(),i=6;break e;case 3:case 2:case 9:case 6:null===ao.current&&(t=!0);var c=ic;if(ic=0,oc=null,$c(e,o,l,c),n&&cc){i=0;break e}break;default:c=ic,ic=0,oc=null,$c(e,o,l,c)}}Yc(),i=pc;break}catch(u){Hc(e,u)}return t&&e.shellSuspendCounter++,br=yr=null,nc=a,M.H=r,M.A=s,null===rc&&(ac=null,sc=0,Ea()),i}function Yc(){for(;null!==rc;)Jc(rc)}function Qc(){for(;null!==rc&&!$();)Jc(rc)}function Jc(e){var t=Jo(e.alternate,e,dc);e.memoizedProps=e.pendingProps,null===t?eu(e):rc=t}function Zc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Po(n,t,t.pendingProps,t.type,void 0,sc);break;case 11:t=Po(n,t,t.pendingProps,t.type.render,t.ref,sc);break;case 5:Ls(t);default:sl(n,t),t=Jo(n,t=rc=ja(t,dc),dc)}e.memoizedProps=e.pendingProps,null===t?eu(e):rc=t}function $c(e,t,n,a){br=yr=null,Ls(t),Xi=null,Yi=0;var r=t.return;try{if(function(e,t,n,a,r){if(n.flags|=32768,null!==a&&"object"===typeof a&&"function"===typeof a.then){if(null!==(t=n.alternate)&&Sr(t,n,r,!0),null!==(n=ao.current)){switch(n.tag){case 13:return null===ro?Kc():null===n.alternate&&0===pc&&(pc=3),n.flags&=-257,n.flags|=65536,n.lanes=r,a===Xr?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([a]):t.add(a),du(e,a,r)),!1;case 22:return n.flags|=65536,a===Xr?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([a]):n.add(a),du(e,a,r)),!1}throw Error(i(435,n.tag))}return du(e,a,r),Kc(),!1}if(sr)return null!==(t=ao.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,a!==lr&&mr(Na(e=Error(i(422),{cause:a}),n))):(a!==lr&&mr(Na(t=Error(i(423),{cause:a}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,a=Na(a,n),os(e,r=So(e.stateNode,a,r)),4!==pc&&(pc=2)),!1;var s=Error(i(520),{cause:a});if(s=Na(s,n),null===bc?bc=[s]:bc.push(s),4!==pc&&(pc=2),null===t)return!0;a=Na(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,os(n,e=So(n.stateNode,a,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Nc||!Nc.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,Io(r=No(r),e,n,a),os(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,sc))return pc=1,wo(e,Na(n,e.current)),void(rc=null)}catch(s){if(null!==r)throw rc=r,s;return pc=1,wo(e,Na(n,e.current)),void(rc=null)}32768&t.flags?(sr||1===a?e=!0:cc||0!==(536870912&sc)?e=!1:(lc=e=!0,(2===a||9===a||3===a||6===a)&&(null!==(a=ao.current)&&13===a.tag&&(a.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=al(t.alternate,t,dc);if(null!==n)return void(rc=n);if(null!==(t=t.sibling))return void(rc=t);rc=t=e}while(null!==t);0===pc&&(pc=5)}function tu(e,t){do{var n=rl(e.alternate,e);if(null!==n)return n.flags&=32767,void(rc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(rc=e);rc=e=n}while(null!==e);pc=6,rc=null}function nu(e,t,n,a,r,s,o,l,c){e.cancelPendingCommit=null;do{ou()}while(0!==Ic);if(0!==(6&nc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,n,a,r,s){var i=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=i&~n;0<n;){var u=31-he(n),d=1<<u;o[u]=0,l[u]=-1;var p=c[u];if(null!==p)for(c[u]=null,u=0;u<p.length;u++){var h=p[u];null!==h&&(h.lane&=-536870913)}n&=~d}0!==a&&Ce(e,a,0),0!==s&&0===r&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,n,s|=Ta,o,l,c),e===ac&&(rc=ac=null,sc=0),Tc=t,Cc=e,Ec=n,_c=s,Ac=r,Rc=a,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,J(se,function(){return lu(),null})):(e.callbackNode=null,e.callbackPriority=0),a=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||a){a=M.T,M.T=null,r=O.p,O.p=2,o=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,td=np,ta(e=ea(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var r=a.anchorOffset,s=a.focusNode;a=a.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||0!==r&&3!==p.nodeType||(l=o+r),p!==s||0!==a&&3!==p.nodeType||(c=o+a),3===p.nodeType&&(o+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===r&&(l=o),h===s&&++d===a&&(c=o),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},np=!1,Sl=t;null!==Sl;)if(e=(t=Sl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,Sl=e;else for(;null!==Sl;){switch(s=(t=Sl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,r=s.memoizedProps,s=s.memoizedState,a=n.stateNode;try{var m=go(n.type,r,(n.elementType,n.type));e=a.getSnapshotBeforeUpdate(m,s),a.__reactInternalSnapshotBeforeUpdate=e}catch(y){uu(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))md(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":md(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Sl=e;break}Sl=t.return}}(e,t)}finally{nc=o,O.p=r,M.T=a}}Ic=1,au(),ru(),su()}}function au(){if(1===Ic){Ic=0;var e=Cc,t=Tc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=M.T,M.T=null;var a=O.p;O.p=2;var r=nc;nc|=4;try{Ml(t,e);var s=nd,i=ea(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&$n(o.ownerDocument.documentElement,o)){if(null!==l&&ta(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var d=o.ownerDocument||document,p=d&&d.defaultView||window;if(p.getSelection){var h=p.getSelection(),f=o.textContent.length,m=Math.min(l.start,f),g=void 0===l.end?m:Math.min(l.end,f);!h.extend&&m>g&&(i=g,g=m,m=i);var y=Zn(o,m),b=Zn(o,g);if(y&&b&&(1!==h.rangeCount||h.anchorNode!==y.node||h.anchorOffset!==y.offset||h.focusNode!==b.node||h.focusOffset!==b.offset)){var v=d.createRange();v.setStart(y.node,y.offset),h.removeAllRanges(),m>g?(h.addRange(v),h.extend(b.node,b.offset)):(v.setEnd(b.node,b.offset),h.addRange(v))}}}}for(d=[],h=o;h=h.parentNode;)1===h.nodeType&&d.push({element:h,left:h.scrollLeft,top:h.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<d.length;o++){var x=d[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}np=!!td,nd=td=null}finally{nc=r,O.p=a,M.T=n}}e.current=t,Ic=2}}function ru(){if(2===Ic){Ic=0;var e=Cc,t=Tc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=M.T,M.T=null;var a=O.p;O.p=2;var r=nc;nc|=4;try{Nl(e,t.alternate,t)}finally{nc=r,O.p=a,M.T=n}}Ic=3}}function su(){if(4===Ic||3===Ic){Ic=0,ee();var e=Cc,t=Tc,n=Ec,a=Rc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ic=5:(Ic=0,Tc=Cc=null,iu(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Nc=null),_e(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==a){t=M.T,r=O.p,O.p=2,M.T=null;try{for(var s=e.onRecoverableError,i=0;i<a.length;i++){var o=a[i];s(o.value,{componentStack:o.stack})}}finally{M.T=t,O.p=r}}0!==(3&Ec)&&ou(),ku(e),r=e.pendingLanes,0!==(4194090&n)&&0!==(42&r)?e===Dc?Fc++:(Fc=0,Dc=e):Fc=0,Su(0,!1)}}function iu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Mr(t)))}function ou(e){return au(),ru(),su(),lu()}function lu(){if(5!==Ic)return!1;var e=Cc,t=_c;_c=0;var n=_e(Ec),a=M.T,r=O.p;try{O.p=32>n?32:n,M.T=null,n=Ac,Ac=null;var s=Cc,o=Ec;if(Ic=0,Tc=Cc=null,Ec=0,0!==(6&nc))throw Error(i(331));var l=nc;if(nc|=4,Jl(s.current),Ul(s,s.current,o,n),nc=l,Su(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,s)}catch(c){}return!0}finally{O.p=r,M.T=a,iu(e,t)}}function cu(e,t,n){t=Na(n,t),null!==(e=ss(e,t=So(e.stateNode,t,2),2))&&(Ie(e,2),ku(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Nc||!Nc.has(a))){e=Na(n,e),null!==(a=ss(t,n=No(2),2))&&(Io(n,a,t,e),Ie(a,2),ku(a));break}}t=t.return}}function du(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new tc;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(n)||(uc=!0,r.add(n),e=pu.bind(null,e,t,n),t.then(e,e))}function pu(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ac===e&&(sc&n)===n&&(4===pc||3===pc&&(62914560&sc)===sc&&300>te()-wc?0===(2&nc)&&Uc(e,0):mc|=n,yc===sc&&(yc=0)),ku(e)}function hu(e,t){0===t&&(t=Se()),null!==(e=Ra(e,t))&&(Ie(e,t),ku(e))}function fu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),hu(e,n)}function mu(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==a&&a.delete(t),hu(e,n)}var gu=null,yu=null,bu=!1,vu=!1,xu=!1,wu=0;function ku(e){e!==yu&&null===e.next&&(null===yu?gu=yu=e:yu=yu.next=e),vu=!0,bu||(bu=!0,dd(function(){0!==(6&nc)?J(ae,Nu):Iu()}))}function Su(e,t){if(!xu&&vu){xu=!0;do{for(var n=!1,a=gu;null!==a;){if(!t)if(0!==e){var r=a.pendingLanes;if(0===r)var s=0;else{var i=a.suspendedLanes,o=a.pingedLanes;s=(1<<31-he(42|e)+1)-1,s=201326741&(s&=r&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,Eu(a,s))}else s=sc,0===(3&(s=ve(a,a===ac?s:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||xe(a,s)||(n=!0,Eu(a,s));a=a.next}}while(n);xu=!1}}function Nu(){Iu()}function Iu(){vu=bu=!1;var e=0;0!==wu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==od&&(od=e,!0);return od=null,!1}()&&(e=wu),wu=0);for(var t=te(),n=null,a=gu;null!==a;){var r=a.next,s=Cu(a,t);0===s?(a.next=null,null===n?gu=r:n.next=r,null===r&&(yu=n)):(n=a,(0!==e||0!==(3&s))&&(vu=!0)),a=r}Su(e,!1)}function Cu(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-he(s),o=1<<i,l=r[i];-1===l?0!==(o&n)&&0===(o&a)||(r[i]=we(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(n=sc,n=ve(e,e===(t=ac)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),a=e.callbackNode,0===n||e===t&&(2===ic||9===ic)||null!==e.cancelPendingCommit)return null!==a&&null!==a&&Z(a),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||xe(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==a&&Z(a),_e(n)){case 2:case 8:n=re;break;case 32:default:n=se;break;case 268435456:n=oe}return a=Tu.bind(null,e),n=J(n,a),e.callbackPriority=t,e.callbackNode=n,t}return null!==a&&null!==a&&Z(a),e.callbackPriority=2,e.callbackNode=null,2}function Tu(e,t){if(0!==Ic&&5!==Ic)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(ou()&&e.callbackNode!==n)return null;var a=sc;return 0===(a=ve(e,e===ac?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Lc(e,a,t),Cu(e,te()),null!=e.callbackNode&&e.callbackNode===n?Tu.bind(null,e):null)}function Eu(e,t){if(ou())return null;Lc(e,t,!0)}function _u(){return 0===wu&&(wu=ke()),wu}function Au(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:_t(""+e)}function Ru(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Fu=0;Fu<wa.length;Fu++){var Du=wa[Fu];ka(Du.toLowerCase(),"on"+(Du[0].toUpperCase()+Du.slice(1)))}ka(ha,"onAnimationEnd"),ka(fa,"onAnimationIteration"),ka(ma,"onAnimationStart"),ka("dblclick","onDoubleClick"),ka("focusin","onFocus"),ka("focusout","onBlur"),ka(ga,"onTransitionRun"),ka(ya,"onTransitionStart"),ka(ba,"onTransitionCancel"),ka(va,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),Xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ou=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mu));function Pu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=c;try{s(r)}catch(u){yo(u)}r.currentTarget=null,s=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=c;try{s(r)}catch(u){yo(u)}r.currentTarget=null,s=l}}}}function Lu(e,t){var n=t[Oe];void 0===n&&(n=t[Oe]=new Set);var a=e+"__bubble";n.has(a)||(Wu(t,e,2,!1),n.add(a))}function zu(e,t,n){var a=0;t&&(a|=4),Wu(n,e,a,t)}var ju="_reactListening"+Math.random().toString(36).slice(2);function Bu(e){if(!e[ju]){e[ju]=!0,qe.forEach(function(t){"selectionchange"!==t&&(Ou.has(t)||zu(t,!1,e),zu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ju]||(t[ju]=!0,zu("selectionchange",!1,t))}}function Wu(e,t,n,a){switch(cp(t)){case 2:var r=ap;break;case 8:r=rp;break;default:r=sp}n=r.bind(null,t,n,e),r=void 0,!jt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Vu(e,t,n,a,r){var s=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===r)break;if(4===i)for(i=a.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===r)return;i=i.return}for(;null!==o;){if(null===(i=We(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){a=s=i;continue e}o=o.parentNode}}a=a.return}Pt(function(){var a=s,r=Rt(n),i=[];e:{var o=xa.get(e);if(void 0!==o){var c=$t,u=e;switch(e){case"keypress":if(0===Gt(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=an;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=rn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=yn;break;case ha:case fa:case ma:c=on;break;case va:c=bn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=vn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=xn}var d=0!==(4&t),p=!d&&("scroll"===e||"scrollend"===e),h=d?null!==o?o+"Capture":null:o;d=[];for(var f,m=a;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===h||null!=(g=Lt(m,h))&&d.push(Uu(m,g,f)),p)break;m=m.return}0<d.length&&(o=new c(o,u,null,n,r),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===At||!(u=n.relatedTarget||n.fromElement)||!We(u)&&!u[Me])&&(c||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=a,null!==(u=(u=n.relatedTarget||n.toElement)?We(u):null)&&(p=l(u),d=u.tag,u!==p||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=a),c!==u)){if(d=an,g="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=gn,g="onPointerLeave",h="onPointerEnter",m="pointer"),p=null==c?o:Ue(c),f=null==u?o:Ue(u),(o=new d(g,m+"leave",c,n,r)).target=p,o.relatedTarget=f,g=null,We(r)===a&&((d=new d(h,m+"enter",u,n,r)).target=f,d.relatedTarget=p,g=d),p=g,c&&u)e:{for(h=u,m=0,f=d=c;f;f=Gu(f))m++;for(f=0,g=h;g;g=Gu(g))f++;for(;0<m-f;)d=Gu(d),m--;for(;0<f-m;)h=Gu(h),f--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Gu(d),h=Gu(h)}d=null}else d=null;null!==c&&qu(i,o,c,d,!1),null!==u&&null!==p&&qu(i,p,u,d,!0)}if("select"===(c=(o=a?Ue(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var y=zn;else if(Fn(o))if(jn)y=Xn;else{y=qn;var b=Gn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?a&&Ct(a.elementType)&&(y=zn):y=Kn;switch(y&&(y=y(e,a))?Dn(i,y,n,r):(b&&b(e,o,a),"focusout"===e&&a&&"number"===o.type&&null!=a.memoizedProps.value&&bt(o,"number",o.value)),b=a?Ue(a):window,e){case"focusin":(Fn(b)||"true"===b.contentEditable)&&(aa=b,ra=a,sa=null);break;case"focusout":sa=ra=aa=null;break;case"mousedown":ia=!0;break;case"contextmenu":case"mouseup":case"dragend":ia=!1,oa(i,n,r);break;case"selectionchange":if(na)break;case"keydown":case"keyup":oa(i,n,r)}var v;if(kn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else An?En(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(In&&"ko"!==n.locale&&(An||"onCompositionStart"!==x?"onCompositionEnd"===x&&An&&(v=Ht()):(Vt="value"in(Wt=r)?Wt.value:Wt.textContent,An=!0)),0<(b=Hu(a,x)).length&&(x=new cn(x,e,null,n,r),i.push({event:x,listeners:b}),v?x.data=v:null!==(v=_n(n))&&(x.data=v))),(v=Nn?function(e,t){switch(e){case"compositionend":return _n(t);case"keypress":return 32!==t.which?null:(Tn=!0,Cn);case"textInput":return(e=t.data)===Cn&&Tn?null:e;default:return null}}(e,n):function(e,t){if(An)return"compositionend"===e||!kn&&En(e,t)?(e=Ht(),Ut=Vt=Wt=null,An=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return In&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(x=Hu(a,"onBeforeInput")).length&&(b=new cn("onBeforeInput","beforeinput",null,n,r),i.push({event:b,listeners:x}),b.data=v)),function(e,t,n,a,r){if("submit"===t&&n&&n.stateNode===r){var s=Au((r[De]||null).action),i=a.submitter;i&&null!==(t=(t=i[De]||null)?Au(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new $t("action","action",null,a,r);e.push({event:o,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(0!==wu){var e=i?Ru(r,i):new FormData(r);Ai(n,{pending:!0,data:e,method:r.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?Ru(r,i):new FormData(r),Ai(n,{pending:!0,data:e,method:r.method,action:s},s,e))},currentTarget:r}]})}}(i,e,a,n,r)}Pu(i,t)})}function Uu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hu(e,t){for(var n=t+"Capture",a=[];null!==e;){var r=e,s=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===s||(null!=(r=Lt(e,n))&&a.unshift(Uu(e,r,s)),null!=(r=Lt(e,t))&&a.push(Uu(e,r,s))),3===e.tag)return a;e=e.return}return[]}function Gu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function qu(e,t,n,a,r){for(var s=t._reactName,i=[];null!==n&&n!==a;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===a)break;5!==o&&26!==o&&27!==o||null===c||(l=c,r?null!=(c=Lt(n,s))&&i.unshift(Uu(n,c,l)):r||null!=(c=Lt(n,s))&&i.push(Uu(n,c,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Ku=/\r\n?/g,Xu=/\u0000|\uFFFD/g;function Yu(e){return("string"===typeof e?e:""+e).replace(Ku,"\n").replace(Xu,"")}function Qu(e,t){return t=Yu(t),Yu(e)===t}function Ju(){}function Zu(e,t,n,a,r,s){switch(n){case"children":"string"===typeof a?"body"===t||"textarea"===t&&""===a||kt(e,a):("number"===typeof a||"bigint"===typeof a)&&"body"!==t&&kt(e,""+a);break;case"className":nt(e,"class",a);break;case"tabIndex":nt(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,a);break;case"style":It(e,a,s);break;case"data":if("object"!==t){nt(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==a||"function"===typeof a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(n);break}a=_t(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if("function"===typeof a){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&Zu(e,t,"name",r.name,r,null),Zu(e,t,"formEncType",r.formEncType,r,null),Zu(e,t,"formMethod",r.formMethod,r,null),Zu(e,t,"formTarget",r.formTarget,r,null)):(Zu(e,t,"encType",r.encType,r,null),Zu(e,t,"method",r.method,r,null),Zu(e,t,"target",r.target,r,null))),null==a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(n);break}a=_t(""+a),e.setAttribute(n,a);break;case"onClick":null!=a&&(e.onclick=Ju);break;case"onScroll":null!=a&&Lu("scroll",e);break;case"onScrollEnd":null!=a&&Lu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(n=a.__html)){if(null!=r.children)throw Error(i(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"muted":e.muted=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"===typeof a||"boolean"===typeof a||"symbol"===typeof a){e.removeAttribute("xlink:href");break}n=_t(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===a?e.setAttribute(n,""):!1!==a&&null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":null==a||"function"===typeof a||"symbol"===typeof a||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Lu("beforetoggle",e),Lu("toggle",e),tt(e,"popover",a);break;case"xlinkActuate":at(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":at(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":at(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":at(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":at(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":at(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":at(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":at(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":at(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":tt(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Tt.get(n)||n,a)}}function $u(e,t,n,a,r,s){switch(n){case"style":It(e,a,s);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(n=a.__html)){if(null!=r.children)throw Error(i(60));e.innerHTML=n}}break;case"children":"string"===typeof a?kt(e,a):("number"===typeof a||"bigint"===typeof a)&&kt(e,""+a);break;case"onScroll":null!=a&&Lu("scroll",e);break;case"onScrollEnd":null!=a&&Lu("scrollend",e);break;case"onClick":null!=a&&(e.onclick=Ju);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"===typeof(s=null!=(s=e[De]||null)?s[n]:null)&&e.removeEventListener(t,s,r),"function"!==typeof a)?n in e?e[n]=a:!0===a?e.setAttribute(n,""):tt(e,n,a):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,r)))}}function ed(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lu("error",e),Lu("load",e);var a,r=!1,s=!1;for(a in n)if(n.hasOwnProperty(a)){var o=n[a];if(null!=o)switch(a){case"src":r=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Zu(e,t,a,o,n,null)}}return s&&Zu(e,t,"srcSet",n.srcSet,n,null),void(r&&Zu(e,t,"src",n.src,n,null));case"input":Lu("invalid",e);var l=a=o=s=null,c=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(null!=d)switch(r){case"name":s=d;break;case"type":o=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":a=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(i(137,t));break;default:Zu(e,t,r,d,n,null)}}return yt(e,a,l,c,u,o,s,!1),void dt(e);case"select":for(s in Lu("invalid",e),r=o=a=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":a=l;break;case"defaultValue":o=l;break;case"multiple":r=l;default:Zu(e,t,s,l,n,null)}return t=a,n=o,e.multiple=!!r,void(null!=t?vt(e,!!r,t,!1):null!=n&&vt(e,!!r,n,!0));case"textarea":for(o in Lu("invalid",e),a=s=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":s=l;break;case"children":a=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:Zu(e,t,o,l,n,null)}return wt(e,r,s,a),void dt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(r=n[c]))if("selected"===c)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else Zu(e,t,c,r,n,null);return;case"dialog":Lu("beforetoggle",e),Lu("toggle",e),Lu("cancel",e),Lu("close",e);break;case"iframe":case"object":Lu("load",e);break;case"video":case"audio":for(r=0;r<Mu.length;r++)Lu(Mu[r],e);break;case"image":Lu("error",e),Lu("load",e);break;case"details":Lu("toggle",e);break;case"embed":case"source":case"link":Lu("error",e),Lu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Zu(e,t,u,r,n,null)}return;default:if(Ct(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(r=n[d])&&$u(e,t,d,r,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(r=n[l])&&Zu(e,t,l,r,n,null))}var td=null,nd=null;function ad(e){return 9===e.nodeType?e:e.ownerDocument}function rd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function id(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var od=null;var ld="function"===typeof setTimeout?setTimeout:void 0,cd="function"===typeof clearTimeout?clearTimeout:void 0,ud="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ud?function(e){return ud.resolve(null).then(e).catch(pd)}:ld;function pd(e){setTimeout(function(){throw e})}function hd(e){return"head"===e}function fd(e,t){var n=t,a=0,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0<a&&8>a){n=a;var i=e.ownerDocument;if(1&n&&wd(i.documentElement),2&n&&wd(i.body),4&n)for(wd(n=i.head),i=n.firstChild;i;){var o=i.nextSibling,l=i.nodeName;i[je]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=o}}if(0===r)return e.removeChild(s),void Tp(t);r--}else"$"===n||"$?"===n||"$!"===n?r++:a=n.charCodeAt(0)-48;else a=0;n=s}while(n);Tp(t)}function md(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":md(n),Be(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function gd(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function yd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var bd=null;function vd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function xd(e,t,n){switch(t=ad(n),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function wd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Be(e)}var kd=new Map,Sd=new Set;function Nd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Id=O.d;O.d={f:function(){var e=Id.f(),t=Wc();return e||t},r:function(e){var t=Ve(e);null!==t&&5===t.tag&&"form"===t.type?Fi(t):Id.r(e)},D:function(e){Id.D(e),Td("dns-prefetch",e,null)},C:function(e,t){Id.C(e,t),Td("preconnect",e,t)},L:function(e,t,n){Id.L(e,t,n);var a=Cd;if(a&&e&&t){var r='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+mt(n.imageSizes)+'"]')):r+='[href="'+mt(e)+'"]';var s=r;switch(t){case"style":s=_d(e);break;case"script":s=Fd(e)}kd.has(s)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),kd.set(s,e),null!==a.querySelector(r)||"style"===t&&a.querySelector(Ad(s))||"script"===t&&a.querySelector(Dd(s))||(ed(t=a.createElement("link"),"link",e),Ge(t),a.head.appendChild(t)))}},m:function(e,t){Id.m(e,t);var n=Cd;if(n&&e){var a=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+mt(a)+'"][href="'+mt(e)+'"]',s=r;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Fd(e)}if(!kd.has(s)&&(e=p({rel:"modulepreload",href:e},t),kd.set(s,e),null===n.querySelector(r))){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Dd(s)))return}ed(a=n.createElement("link"),"link",e),Ge(a),n.head.appendChild(a)}}},X:function(e,t){Id.X(e,t);var n=Cd;if(n&&e){var a=He(n).hoistableScripts,r=Fd(e),s=a.get(r);s||((s=n.querySelector(Dd(r)))||(e=p({src:e,async:!0},t),(t=kd.get(r))&&Ld(e,t),Ge(s=n.createElement("script")),ed(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},a.set(r,s))}},S:function(e,t,n){Id.S(e,t,n);var a=Cd;if(a&&e){var r=He(a).hoistableStyles,s=_d(e);t=t||"default";var i=r.get(s);if(!i){var o={loading:0,preload:null};if(i=a.querySelector(Ad(s)))o.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=kd.get(s))&&Pd(e,n);var l=i=a.createElement("link");Ge(l),ed(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Od(i,t,a)}i={type:"stylesheet",instance:i,count:1,state:o},r.set(s,i)}}},M:function(e,t){Id.M(e,t);var n=Cd;if(n&&e){var a=He(n).hoistableScripts,r=Fd(e),s=a.get(r);s||((s=n.querySelector(Dd(r)))||(e=p({src:e,async:!0,type:"module"},t),(t=kd.get(r))&&Ld(e,t),Ge(s=n.createElement("script")),ed(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},a.set(r,s))}}};var Cd="undefined"===typeof document?null:document;function Td(e,t,n){var a=Cd;if(a&&"string"===typeof t&&t){var r=mt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),Sd.has(r)||(Sd.add(r),e={rel:e,crossOrigin:n,href:t},null===a.querySelector(r)&&(ed(t=a.createElement("link"),"link",e),Ge(t),a.head.appendChild(t)))}}function Ed(e,t,n,a){var r,s,o,l,c=(c=H.current)?Nd(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=_d(n.href),(a=(n=He(c).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=_d(n.href);var u=He(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Ad(e)))&&!u._p&&(d.instance=u,d.state.loading=5),kd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},kd.set(e,n),u||(r=c,s=e,o=n,l=d.state,r.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=r.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),ed(s,"link",o),Ge(s),r.head.appendChild(s))))),t&&null===a)throw Error(i(528,""));return d}if(t&&null!==a)throw Error(i(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Fd(n),(a=(n=He(c).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function _d(e){return'href="'+mt(e)+'"'}function Ad(e){return'link[rel="stylesheet"]['+e+"]"}function Rd(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Fd(e){return'[src="'+mt(e)+'"]'}function Dd(e){return"script[async]"+e}function Md(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(a)return t.instance=a,Ge(a),a;var r=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ge(a=(e.ownerDocument||e).createElement("style")),ed(a,"style",r),Od(a,n.precedence,e),t.instance=a;case"stylesheet":r=_d(n.href);var s=e.querySelector(Ad(r));if(s)return t.state.loading|=4,t.instance=s,Ge(s),s;a=Rd(n),(r=kd.get(r))&&Pd(a,r),Ge(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),ed(s,"link",a),t.state.loading|=4,Od(s,n.precedence,e),t.instance=s;case"script":return s=Fd(n.src),(r=e.querySelector(Dd(s)))?(t.instance=r,Ge(r),r):(a=n,(r=kd.get(s))&&Ld(a=p({},n),r),Ge(r=(e=e.ownerDocument||e).createElement("script")),ed(r,"link",a),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,Od(a,n.precedence,e));return t.instance}function Od(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=a.length?a[a.length-1]:null,s=r,i=0;i<a.length;i++){var o=a[i];if(o.dataset.precedence===t)s=o;else if(s!==r)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Pd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Ld(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var zd=null;function jd(e,t,n){if(null===zd){var a=new Map,r=zd=new Map;r.set(n,a)}else(a=(r=zd).get(n))||(a=new Map,r.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var s=n[r];if(!(s[je]||s[Fe]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=a.get(i);o?o.push(s):a.set(i,[s])}}return a}function Bd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Wd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Vd=null;function Ud(){}function Hd(){if(this.count--,0===this.count)if(this.stylesheets)qd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Gd=null;function qd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Gd=new Map,t.forEach(Kd,e),Gd=null,Hd.call(e))}function Kd(e,t){if(!(4&t.state.loading)){var n=Gd.get(e);if(n)var a=n.get(null);else{n=new Map,Gd.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var i=r[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(n.set(i.dataset.precedence,i),a=i)}a&&n.set(null,a)}i=(r=t.instance).getAttribute("data-precedence"),(s=n.get(i)||a)===a&&n.set(null,r),n.set(i,r),this.count++,a=Hd.bind(this),r.addEventListener("load",a),r.addEventListener("error",a),s?s.parentNode.insertBefore(r,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var Xd={$$typeof:w,Provider:null,Consumer:null,_currentValue:P,_currentValue2:P,_threadCount:0};function Yd(e,t,n,a,r,s,i,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ne(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ne(0),this.hiddenUpdates=Ne(null),this.identifierPrefix=a,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Qd(e,t,n,a,r,s,i,o,l,c,u,d){return e=new Yd(e,t,n,i,o,l,c,d),t=1,!0===s&&(t|=24),s=Pa(3,null,null,t),e.current=s,s.stateNode=e,(t=Dr()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:a,isDehydrated:n,cache:t},ns(s),e}function Jd(e){return e?e=Ma:Ma}function Zd(e,t,n,a,r,s){r=Jd(r),null===a.context?a.context=r:a.pendingContext=r,(a=rs(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(a.callback=s),null!==(n=ss(e,a,t))&&(Pc(n,0,t),is(n,e,t))}function $d(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ep(e,t){$d(e,t),(e=e.alternate)&&$d(e,t)}function tp(e){if(13===e.tag){var t=Ra(e,67108864);null!==t&&Pc(t,0,67108864),ep(e,67108864)}}var np=!0;function ap(e,t,n,a){var r=M.T;M.T=null;var s=O.p;try{O.p=2,sp(e,t,n,a)}finally{O.p=s,M.T=r}}function rp(e,t,n,a){var r=M.T;M.T=null;var s=O.p;try{O.p=8,sp(e,t,n,a)}finally{O.p=s,M.T=r}}function sp(e,t,n,a){if(np){var r=ip(a);if(null===r)Vu(e,t,a,op,n),bp(e,a);else if(function(e,t,n,a,r){switch(t){case"focusin":return dp=vp(dp,e,t,n,a,r),!0;case"dragenter":return pp=vp(pp,e,t,n,a,r),!0;case"mouseover":return hp=vp(hp,e,t,n,a,r),!0;case"pointerover":var s=r.pointerId;return fp.set(s,vp(fp.get(s)||null,e,t,n,a,r)),!0;case"gotpointercapture":return s=r.pointerId,mp.set(s,vp(mp.get(s)||null,e,t,n,a,r)),!0}return!1}(r,e,t,n,a))a.stopPropagation();else if(bp(e,a),4&t&&-1<yp.indexOf(e)){for(;null!==r;){var s=Ve(r);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=be(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-he(i);o.entanglements[1]|=l,i&=~l}ku(s),0===(6&nc)&&(kc=te()+500,Su(0,!1))}}break;case 13:null!==(o=Ra(s,2))&&Pc(o,0,2),Wc(),ep(s,2)}if(null===(s=ip(a))&&Vu(e,t,a,op,n),s===r)break;r=s}null!==r&&a.stopPropagation()}else Vu(e,t,a,null,n)}}function ip(e){return lp(e=Rt(e))}var op=null;function lp(e){if(op=null,null!==(e=We(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return op=e,null}function cp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case ae:return 2;case re:return 8;case se:case ie:return 32;case oe:return 268435456;default:return 32}default:return 32}}var up=!1,dp=null,pp=null,hp=null,fp=new Map,mp=new Map,gp=[],yp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bp(e,t){switch(e){case"focusin":case"focusout":dp=null;break;case"dragenter":case"dragleave":pp=null;break;case"mouseover":case"mouseout":hp=null;break;case"pointerover":case"pointerout":fp.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mp.delete(t.pointerId)}}function vp(e,t,n,a,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=Ve(t))&&tp(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function xp(e){var t=We(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=O.p;try{return O.p=e,t()}finally{O.p=n}}(e.priority,function(){if(13===n.tag){var e=Mc();e=Ee(e);var t=Ra(n,e);null!==t&&Pc(t,0,e),ep(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function wp(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=ip(e.nativeEvent);if(null!==n)return null!==(t=Ve(n))&&tp(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);At=a,n.target.dispatchEvent(a),At=null,t.shift()}return!0}function kp(e,t,n){wp(e)&&n.delete(t)}function Sp(){up=!1,null!==dp&&wp(dp)&&(dp=null),null!==pp&&wp(pp)&&(pp=null),null!==hp&&wp(hp)&&(hp=null),fp.forEach(kp),mp.forEach(kp)}function Np(e,t){e.blockedOn===t&&(e.blockedOn=null,up||(up=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Sp)))}var Ip=null;function Cp(e){Ip!==e&&(Ip=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Ip===e&&(Ip=null);for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1],r=e[t+2];if("function"!==typeof a){if(null===lp(a||n))continue;break}var s=Ve(n);null!==s&&(e.splice(t,3),t-=3,Ai(s,{pending:!0,data:r,method:n.method,action:a},a,r))}}))}function Tp(e){function t(t){return Np(t,e)}null!==dp&&Np(dp,e),null!==pp&&Np(pp,e),null!==hp&&Np(hp,e),fp.forEach(t),mp.forEach(t);for(var n=0;n<gp.length;n++){var a=gp[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<gp.length&&null===(n=gp[0]).blockedOn;)xp(n),null===n.blockedOn&&gp.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(a=0;a<n.length;a+=3){var r=n[a],s=n[a+1],i=r[De]||null;if("function"===typeof s)i||Cp(n);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(r=s,i=s[De]||null)o=i.formAction;else if(null!==lp(r))continue}else o=i.action;"function"===typeof o?n[a+1]=o:(n.splice(a,3),a-=3),Cp(n)}}}function Ep(e){this._internalRoot=e}function _p(e){this._internalRoot=e}_p.prototype.render=Ep.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Zd(t.current,Mc(),e,t,null,null)},_p.prototype.unmount=Ep.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Zd(e.current,2,null,e,null,null),Wc(),t[Me]=null}},_p.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ae();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gp.length&&0!==t&&t<gp[n].priority;n++);gp.splice(n,0,e),0===n&&xp(e)}};var Ap=r.version;if("19.1.1"!==Ap)throw Error(i(527,Ap,"19.1.1"));O.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(a=r.return)){n=a;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return u(r),e;if(s===a)return u(r),t;s=s.sibling}throw Error(i(188))}if(n.return!==a.return)n=r,a=s;else{for(var o=!1,c=r.child;c;){if(c===n){o=!0,n=r,a=s;break}if(c===a){o=!0,a=r,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,a=r;break}if(c===a){o=!0,a=s,n=r;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==a)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Rp={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Fp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fp.isDisabled&&Fp.supportsFiber)try{ue=Fp.inject(Rp),de=Fp}catch(Mp){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var n=!1,a="",r=bo,s=vo,l=xo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Qd(e,1,!1,null,0,n,a,r,s,l,0,null),e[Me]=t.current,Bu(e),new Ep(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(i(299));var a=!1,r="",s=bo,l=vo,c=xo,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Qd(e,1,!0,t,0,a,r,s,l,c,0,u)).context=Jd(null),n=t.current,(r=rs(a=Ee(a=Mc()))).callback=null,ss(n,r,a),n=a,t.current.lanes=n,Ie(t,n),ku(t),e[Me]=t.current,Bu(e),new _p(t)},t.version="19.1.1"},43:(e,t,n)=>{"use strict";e.exports=n(288)},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function b(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var x=v.prototype=new b;x.constructor=v,m(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},S=Object.prototype.hasOwnProperty;function N(e,t,a,r,s,i){return a=i.ref,{$$typeof:n,type:e,key:t,ref:void 0!==a?a:null,props:i}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function E(){}function _(e,t,r,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case a:u=!0;break;case p:return _((u=e._init)(e._payload),t,r,s,i)}}if(u)return i=i(e),u=""===s?"."+T(e,0):s,w(i)?(r="",null!=u&&(r=u.replace(C,"$&/")+"/"),_(i,t,r,"",function(e){return e})):null!=i&&(I(i)&&(l=i,c=r+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+u,i=N(l.type,c,void 0,0,0,l.props)),t.push(i)),1;u=0;var d,f=""===s?".":s+":";if(w(e))for(var m=0;m<e.length;m++)u+=_(s=e[m],t,r,o=f+T(s,m),i);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=h&&d[h]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(s=e.next()).done;)u+=_(s=s.value,t,r,o=f+T(s,m++),i);else if("object"===o){if("function"===typeof e.then)return _(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(E,E):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function A(e,t,n){if(null==e)return e;var a=[],r=0;return _(e,a,"","",function(e){return t.call(n,e,r++)}),a}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var F="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function D(){}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=i,t.PureComponent=v,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return k.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var a=m({},e.props),r=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(r=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(a[s]=t[s]);var s=arguments.length-2;if(1===s)a.children=n;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];a.children=i}return N(e.type,r,void 0,0,0,a)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var a,r={},s=null;if(null!=t)for(a in void 0!==t.key&&(s=""+t.key),t)S.call(t,a)&&"key"!==a&&"__self"!==a&&"__source"!==a&&(r[a]=t[a]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];r.children=o}if(e&&e.defaultProps)for(a in i=e.defaultProps)void 0===r[a]&&(r[a]=i[a]);return N(e,s,void 0,0,0,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=k.T,n={};k.T=n;try{var a=e(),r=k.S;null!==r&&r(n,a),"object"===typeof a&&null!==a&&"function"===typeof a.then&&a.then(D,F)}catch(s){F(s)}finally{k.T=t}},t.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},t.use=function(e){return k.H.use(e)},t.useActionState=function(e,t,n){return k.H.useActionState(e,t,n)},t.useCallback=function(e,t){return k.H.useCallback(e,t)},t.useContext=function(e){return k.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return k.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var a=k.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return a.useEffect(e,t)},t.useId=function(){return k.H.useId()},t.useImperativeHandle=function(e,t,n){return k.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return k.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return k.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return k.H.useMemo(e,t)},t.useOptimistic=function(e,t){return k.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return k.H.useReducer(e,t,n)},t.useRef=function(e){return k.H.useRef(e)},t.useState=function(e){return k.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return k.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return k.H.useTransition()},t.version="19.1.1"},291:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=291,e.exports=t},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{"use strict";e.exports=n(799)},672:(e,t,n)=>{"use strict";var a=n(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(r(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=n,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,a=c(n,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:a,integrity:r,fetchPriority:s}):"script"===n&&i.d.X(e,{crossOrigin:a,integrity:r,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,a=c(n,t.crossOrigin);i.d.L(e,n,{crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function r(e,t,a){var r=null;if(void 0!==a&&(r=""+a),void 0!==t.key&&(r=""+t.key),"key"in t)for(var s in a={},t)"key"!==s&&(a[s]=t[s]);else a=t;return t=a.ref,{$$typeof:n,type:e,key:r,ref:void 0!==t?t:null,props:a}}t.Fragment=a,t.jsx=r,t.jsxs=r},853:(e,t,n)=>{"use strict";e.exports=n(896)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,r=e[a];if(!(0<s(r,t)))break e;e[a]=t,e[n]=r,n=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,r=e.length,i=r>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[a]=u,e[c]=n,a=c):(e[a]=l,e[o]=n,a=o);else{if(!(c<r&&0>s(u,n)))break e;e[a]=u,e[c]=n,a=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,p=null,h=3,f=!1,m=!1,g=!1,y=!1,b="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=a(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=a(u)}}function k(e){if(g=!1,w(e),!m)if(null!==a(c))m=!0,N||(N=!0,S());else{var t=a(u);null!==t&&F(k,t.startTime-e)}}var S,N=!1,I=-1,C=5,T=-1;function E(){return!!y||!(t.unstable_now()-T<C)}function _(){if(y=!1,N){var e=t.unstable_now();T=e;var n=!0;try{e:{m=!1,g&&(g=!1,v(I),I=-1),f=!0;var s=h;try{t:{for(w(e),p=a(c);null!==p&&!(p.expirationTime>e&&E());){var i=p.callback;if("function"===typeof i){p.callback=null,h=p.priorityLevel;var o=i(p.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){p.callback=o,w(e),n=!0;break t}p===a(c)&&r(c),w(e)}else r(c);p=a(c)}if(null!==p)n=!0;else{var l=a(u);null!==l&&F(k,l.startTime-e),n=!1}}break e}finally{p=null,h=s,f=!1}n=void 0}}finally{n?S():N=!1}}}if("function"===typeof x)S=function(){x(_)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,R=A.port2;A.port1.onmessage=_,S=function(){R.postMessage(null)}}else S=function(){b(_,0)};function F(e,n){I=b(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,r,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,n(u,e),null===a(c)&&e===a(u)&&(g?(v(I),I=-1):g=!0,F(k,s-i))):(e.sortIndex=o,n(c,e),m||f||(m=!0,N||(N=!0,S()))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.m=e,n.amdO={},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(a,r){if(1&r&&(a=this(a)),8&r)return a;if("object"===typeof a&&a){if(4&r&&a.__esModule)return a;if(16&r&&"function"===typeof a.then)return a}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&a;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>i[e]=()=>a[e]);return i.default=()=>a,n.d(s,i),s}})(),n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,a)=>(n.f[a](e,t),t),[])),n.u=e=>"static/js/"+e+".670e15c7.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="frontend:";n.l=(a,r,s,i)=>{if(e[a])e[a].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+s){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=a),e[a]=[r];var p=(t,n)=>{o.onerror=o.onload=null,clearTimeout(h);var r=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach(e=>e(n)),t)return t(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,a)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var s=new Promise((n,a)=>r=e[t]=[n,a]);a.push(r[2]=s);var i=n.p+n.u(t),o=new Error;n.l(i,a=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,r[1](o)}},"chunk-"+t,t)}};var t=(t,a)=>{var r,s,i=a[0],o=a[1],l=a[2],c=0;if(i.some(t=>0!==e[t])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(a);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},a=self.webpackChunkfrontend=self.webpackChunkfrontend||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),n.nc=void 0,(()=>{"use strict";var e=n(43),t=n.t(e,2),a=n(391);function r(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function i(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function o(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const u=["sri"],d=["page"],p=["page","matches"],h=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],f=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],m=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var g="popstate";function y(){return N(function(e,t){let{pathname:n,search:a,hash:r}=e.location;return w("",{pathname:n,search:a,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:k(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function b(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function v(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(tv){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function w(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return c(c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?S(t):t),{},{state:n,key:t&&t.key||a||Math.random().toString(36).substring(2,10)})}function k(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function S(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function N(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:s=!1}=a,i=r.history,o="POP",l=null,u=d();function d(){return(i.state||{idx:null}).idx}function p(){o="POP";let e=d(),t=null==e?null:e-u;u=e,l&&l({action:o,location:f.location,delta:t})}function h(e){return I(e)}null==u&&(u=0,i.replaceState(c(c({},i.state),{},{idx:u}),""));let f={get action(){return o},get location(){return e(r,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(g,p),l=e,()=>{r.removeEventListener(g,p),l=null}},createHref:e=>t(r,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let a=w(f.location,e,t);n&&n(a,e),u=d()+1;let c=x(a,u),p=f.createHref(a);try{i.pushState(c,"",p)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;r.location.assign(p)}s&&l&&l({action:o,location:f.location,delta:1})},replace:function(e,t){o="REPLACE";let a=w(f.location,e,t);n&&n(a,e),u=d();let r=x(a,u),c=f.createHref(a);i.replaceState(r,"",c),s&&l&&l({action:o,location:f.location,delta:0})},go:e=>i.go(e)};return f}function I(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),b(n,"No window.location.(origin|href) available to create URL");let a="string"===typeof e?e:k(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=n+a),new URL(a,n)}new WeakMap;function C(e,t){return T(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function T(e,t,n,a){let r=V(("string"===typeof t?S(t):t).pathname||"/",n);if(null==r)return null;let s=E(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=W(r);i=z(s[o],e,a)}return i}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(a)&&i)return;b(l.relativePath.startsWith(a),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(a,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(a.length)}let c=K([a,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(b(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),E(e.children,t,u,c,i)),(null!=e.path||e.index)&&t.push({path:c,score:L(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let a of _(e.path))s(e,t,!0,a);else s(e,t)}),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===a.length)return r?[s,""]:[s];let i=_(a.join("/")),o=[];return o.push(...i.map(e=>""===e?s:[s,e].join("/"))),r&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var A=/^:[\w-]+$/,R=3,F=2,D=1,M=10,O=-2,P=e=>"*"===e;function L(e,t){let n=e.split("/"),a=n.length;return n.some(P)&&(a+=O),t&&(a+=F),n.filter(e=>!P(e)).reduce((e,t)=>e+(A.test(t)?R:""===t?D:M),a)}function z(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:a}=e,r={},s="/",i=[];for(let o=0;o<a.length;++o){let e=a[o],l=o===a.length-1,c="/"===s?t:t.slice(s.length)||"/",u=j({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!a[a.length-1].route.index&&(u=j({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),i.push({params:r,pathname:K([s,u.pathname]),pathnameBase:X(K([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=K([s,u.pathnameBase]))}return i}function j(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=B(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],i=s.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=a.reduce((e,t,n)=>{let{paramName:a,isOptional:r}=t;if("*"===a){let e=o[n]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[a]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:s,pathnameBase:i,pattern:e}}function B(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];v("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function W(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return v(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function V(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}function U(e,t,n,a){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(a),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function H(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function G(e){let t=H(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function q(e,t,n){let a,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?a=S(e):(a=c({},e),b(!a.pathname||!a.pathname.includes("?"),U("?","pathname","search",a)),b(!a.pathname||!a.pathname.includes("#"),U("#","pathname","hash",a)),b(!a.search||!a.search.includes("#"),U("#","search","hash",a)));let s,i=""===e||""===a.pathname,o=i?"/":a.pathname;if(null==o)s=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:a="",hash:r=""}="string"===typeof e?S(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:Y(a),hash:Q(r)}}(a,s),u=o&&"/"!==o&&o.endsWith("/"),d=(i||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!d||(l.pathname+="/"),l}var K=e=>e.join("/").replace(/\/\/+/g,"/"),X=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Y=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function J(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Z=["POST","PUT","PATCH","DELETE"],$=(new Set(Z),["GET",...Z]);new Set($),Symbol("ResetLoaderData");var ee=e.createContext(null);ee.displayName="DataRouter";var te=e.createContext(null);te.displayName="DataRouterState";var ne=e.createContext(!1);var ae=e.createContext({isTransitioning:!1});ae.displayName="ViewTransition";var re=e.createContext(new Map);re.displayName="Fetchers";var se=e.createContext(null);se.displayName="Await";var ie=e.createContext(null);ie.displayName="Navigation";var oe=e.createContext(null);oe.displayName="Location";var le=e.createContext({outlet:null,matches:[],isDataRoute:!1});le.displayName="Route";var ce=e.createContext(null);ce.displayName="RouteError";function ue(){return null!=e.useContext(oe)}function de(){return b(ue(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(oe).location}var pe="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function he(t){e.useContext(ie).static||e.useLayoutEffect(t)}function fe(){let{isDataRoute:t}=e.useContext(le);return t?function(){let{router:t}=Ne("useNavigate"),n=Ce("useNavigate"),a=e.useRef(!1);he(()=>{a.current=!0});let r=e.useCallback(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(a.current,pe),a.current&&("number"===typeof e?t.navigate(e):await t.navigate(e,c({fromRouteId:n},r)))},[t,n]);return r}():function(){b(ue(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(ee),{basename:n,navigator:a}=e.useContext(ie),{matches:r}=e.useContext(le),{pathname:s}=de(),i=JSON.stringify(G(r)),o=e.useRef(!1);he(()=>{o.current=!0});let l=e.useCallback(function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(v(o.current,pe),!o.current)return;if("number"===typeof e)return void a.go(e);let l=q(e,JSON.parse(i),s,"path"===r.relative);null==t&&"/"!==n&&(l.pathname="/"===l.pathname?n:K([n,l.pathname])),(r.replace?a.replace:a.push)(l,r.state,r)},[n,a,i,s,t]);return l}()}e.createContext(null);function me(){let{matches:t}=e.useContext(le),n=t[t.length-1];return n?n.params:{}}function ge(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:a}=e.useContext(le),{pathname:r}=de(),s=JSON.stringify(G(a));return e.useMemo(()=>q(t,JSON.parse(s),r,"path"===n),[t,s,r,n])}function ye(t,n,a,r,s){b(ue(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=e.useContext(ie),{matches:o}=e.useContext(le),l=o[o.length-1],u=l?l.params:{},d=l?l.pathname:"/",p=l?l.pathnameBase:"/",h=l&&l.route;{let e=h&&h.path||"";_e(d,!h||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=de();if(n){var g;let e="string"===typeof n?S(n):n;b("/"===p||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(p)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(p,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let y=f.pathname||"/",x=y;if("/"!==p){let e=p.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=C(t,{pathname:x});v(h||null!=w,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),v(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let k=ke(w&&w.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:K([p,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?p:K([p,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,a,r,s);return n&&k?e.createElement(oe.Provider,{value:{location:c({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},k):k}function be(){let t=Te(),n=J(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=e.createElement(e.Fragment,null,e.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:i},"ErrorBoundary")," or"," ",e.createElement("code",{style:i},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),a?e.createElement("pre",{style:s},a):null,o)}var ve=e.createElement(be,null),xe=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?e.createElement(le.Provider,{value:this.props.routeContext},e.createElement(ce.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function we(t){let{routeContext:n,match:a,children:r}=t,s=e.useContext(ee);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),e.createElement(le.Provider,{value:n},r)}function ke(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==t){if(!a)return null;if(a.errors)t=a.matches;else{if(0!==n.length||a.initialized||!(a.matches.length>0))return null;t=a.matches}}let s=t,i=null===a||void 0===a?void 0:a.errors;if(null!=i){let e=s.findIndex(e=>e.route.id&&void 0!==(null===i||void 0===i?void 0:i[e.route.id]));b(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(i).join(","))),s=s.slice(0,Math.min(s.length,e+1))}let o=!1,l=-1;if(a)for(let e=0;e<s.length;e++){let t=s[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=e),t.route.id){let{loaderData:e,errors:n}=a,r=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||r){o=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}return s.reduceRight((t,c,u)=>{let d,p=!1,h=null,f=null;a&&(d=i&&c.route.id?i[c.route.id]:void 0,h=c.route.errorElement||ve,o&&(l<0&&0===u?(_e("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,f=null):l===u&&(p=!0,f=c.route.hydrateFallbackElement||null)));let m=n.concat(s.slice(0,u+1)),g=()=>{let n;return n=d?h:p?f:c.route.Component?e.createElement(c.route.Component,null):c.route.element?c.route.element:t,e.createElement(we,{match:c,routeContext:{outlet:t,matches:m,isDataRoute:null!=a},children:n})};return a&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?e.createElement(xe,{location:a.location,revalidation:a.revalidation,component:h,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):g()},null)}function Se(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ne(t){let n=e.useContext(ee);return b(n,Se(t)),n}function Ie(t){let n=e.useContext(te);return b(n,Se(t)),n}function Ce(t){let n=function(t){let n=e.useContext(le);return b(n,Se(t)),n}(t),a=n.matches[n.matches.length-1];return b(a.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),a.route.id}function Te(){var t;let n=e.useContext(ce),a=Ie("useRouteError"),r=Ce("useRouteError");return void 0!==n?n:null===(t=a.errors)||void 0===t?void 0:t[r]}var Ee={};function _e(e,t,n){t||Ee[e]||(Ee[e]=!0,v(!1,n))}var Ae={};function Re(e,t){e||Ae[t]||(Ae[t]=!0,console.warn(t))}e.memo(function(e){let{routes:t,future:n,state:a,unstable_onError:r}=e;return ye(t,void 0,a,r,n)});function Fe(t){let{to:n,replace:a,state:r,relative:s}=t;b(ue(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=e.useContext(ie);v(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=e.useContext(le),{pathname:l}=de(),c=fe(),u=q(n,G(o),l,"path"===s),d=JSON.stringify(u);return e.useEffect(()=>{c(JSON.parse(d),{replace:a,state:r,relative:s})},[c,d,s,a,r]),null}function De(e){b(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Me(t){let{basename:n="/",children:a=null,location:r,navigationType:s="POP",navigator:i,static:o=!1}=t;b(!ue(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),c=e.useMemo(()=>({basename:l,navigator:i,static:o,future:{}}),[l,i,o]);"string"===typeof r&&(r=S(r));let{pathname:u="/",search:d="",hash:p="",state:h=null,key:f="default"}=r,m=e.useMemo(()=>{let e=V(u,l);return null==e?null:{location:{pathname:e,search:d,hash:p,state:h,key:f},navigationType:s}},[l,u,d,p,h,f,s]);return v(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(d).concat(p,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:e.createElement(ie.Provider,{value:c},e.createElement(oe.Provider,{children:a,value:m}))}function Oe(e){let{children:t,location:n}=e;return ye(Pe(t),n)}e.Component;function Pe(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[];return e.Children.forEach(t,(t,r)=>{if(!e.isValidElement(t))return;let s=[...n,r];if(t.type===e.Fragment)return void a.push.apply(a,Pe(t.props.children,s));b(t.type===De,"[".concat("string"===typeof t.type?t.type:t.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),b(!t.props.index||!t.props.children,"An index route cannot have child routes.");let i={id:t.props.id||s.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(i.children=Pe(t.props.children,s)),a.push(i)}),a}var Le="get",ze="application/x-www-form-urlencoded";function je(e){return null!=e&&"string"===typeof e.tagName}var Be=null;var We=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ve(e){return null==e||We.has(e)?e:(v(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(ze,'"')),null)}function Ue(e,t){let n,a,r,s,i;if(je(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");a=i?V(i,t):null,n=e.getAttribute("method")||Le,r=Ve(e.getAttribute("enctype"))||ze,s=new FormData(e)}else if(function(e){return je(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return je(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(a=o?V(o,t):null,n=e.getAttribute("formmethod")||i.getAttribute("method")||Le,r=Ve(e.getAttribute("formenctype"))||Ve(i.getAttribute("enctype"))||ze,s=new FormData(i,e),!function(){if(null===Be)try{new FormData(document.createElement("form"),0),Be=!1}catch(tv){Be=!0}return Be}()){let{name:t,type:n,value:a}=e;if("image"===n){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,a)}}else{if(je(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Le,a=null,r=ze,i=e}var o;return s&&"text/plain"===r&&(i=s,s=void 0),{action:a,method:n.toLowerCase(),encType:r,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function He(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ge(e,t,n){let a="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===a.pathname?a.pathname="_root.".concat(n):t&&"/"===V(a.pathname,t)?a.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):a.pathname="".concat(a.pathname.replace(/\/$/,""),".").concat(n),a}async function qe(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ke(e){return null!=e&&"string"===typeof e.page}function Xe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ye(e,t,n,a,r,s){let i=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var a;return n[t].pathname!==e.pathname||(null===(a=n[t].route.path)||void 0===a?void 0:a.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>i(e,t)||o(e,t)):"data"===s?t.filter((t,s)=>{let l=a.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var c;let a=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof a)return a}return!0}):[]}function Qe(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a=e.map(e=>{let a=t.routes[e.route.id];if(!a)return[];let r=[a.module];return a.clientActionModule&&(r=r.concat(a.clientActionModule)),a.clientLoaderModule&&(r=r.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(r=r.concat(a.hydrateFallbackModule)),a.imports&&(r=r.concat(a.imports)),r}).flat(1),[...new Set(a)];var a}function Je(e,t){let n=new Set,a=new Set(t);return e.reduce((e,r)=>{if(t&&!Ke(r)&&"script"===r.as&&r.href&&a.has(r.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}(r));return n.has(s)||(n.add(s),e.push({key:s,link:r})),e},[])}function Ze(e,t){return"lazy"===e.mode&&!0===t}function $e(){let t=e.useContext(ee);return He(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function et(){let t=e.useContext(te);return He(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var tt=e.createContext(void 0);function nt(){let t=e.useContext(tt);return He(t,"You must render this element inside a <HydratedRouter> element"),t}function at(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function rt(e,t,n){if(n&&!lt)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}tt.displayName="FrameworkContext";function st(t){let{page:n}=t,a=r(t,d),{router:s}=$e(),i=e.useMemo(()=>C(s.routes,n,s.basename),[s.routes,n,s.basename]);return i?e.createElement(ot,c({page:n,matches:i},a)):null}function it(t){let{manifest:n,routeModules:a}=nt(),[r,s]=e.useState([]);return e.useEffect(()=>{let e=!1;return async function(e,t,n){return Je((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await qe(a,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Xe).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?c(c({},e),{},{rel:"prefetch",as:"style"}):c(c({},e),{},{rel:"prefetch"})))}(t,n,a).then(t=>{e||s(t)}),()=>{e=!0}},[t,n,a]),r}function ot(t){let{page:n,matches:a}=t,s=r(t,p),i=de(),{manifest:o,routeModules:l}=nt(),{basename:u}=$e(),{loaderData:d,matches:h}=et(),f=e.useMemo(()=>Ye(n,a,h,o,i,"data"),[n,a,h,o,i]),m=e.useMemo(()=>Ye(n,a,h,o,i,"assets"),[n,a,h,o,i]),g=e.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let e=new Set,t=!1;if(a.forEach(n=>{var a;let r=o.routes[n.route.id];r&&r.hasLoader&&(!f.some(e=>e.route.id===n.route.id)&&n.route.id in d&&null!==(a=l[n.route.id])&&void 0!==a&&a.shouldRevalidate||r.hasClientLoader?t=!0:e.add(n.route.id))}),0===e.size)return[];let r=Ge(n,u,"data");return t&&e.size>0&&r.searchParams.set("_routes",a.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[r.pathname+r.search]},[u,d,i,o,f,a,n,l]),y=e.useMemo(()=>Qe(m,o),[m,o]),b=it(m);return e.createElement(e.Fragment,null,g.map(t=>e.createElement("link",c({key:t,rel:"prefetch",as:"fetch",href:t},s))),y.map(t=>e.createElement("link",c({key:t,rel:"modulepreload",href:t},s))),b.map(t=>{let{key:n,link:a}=t;return e.createElement("link",c({key:n,nonce:s.nonce},a))}))}var lt=!1;function ct(t){let{manifest:n,serverHandoffString:a,isSpaMode:s,renderMeta:i,routeDiscovery:o,ssr:l}=nt(),{router:d,static:p,staticContext:h}=$e(),{matches:f}=et(),m=e.useContext(ne),g=Ze(o,l);i&&(i.didRenderScripts=!0);let y=rt(f,null,s);e.useEffect(()=>{0},[]);let b=e.useMemo(()=>{var s;if(m)return null;let i=h?"window.__reactRouterContext = ".concat(a,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=p?"".concat(null!==n.hmr&&void 0!==s&&s.runtime?"import ".concat(JSON.stringify(n.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(n.url)),";\n").concat(y.map((e,t)=>{let a="route".concat(t),r=n.routes[e.route.id];He(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:i,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=r,u=[...s?[{module:s,varName:"".concat(a,"_clientAction")}]:[],...i?[{module:i,varName:"".concat(a,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(a,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(a,"_HydrateFallback")}]:[],{module:c,varName:"".concat(a,"_main")}];return 1===u.length?"import * as ".concat(a," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(a," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,a=r(e,u),s=new Set(t.state.matches.map(e=>e.route.id)),i=t.state.location.pathname.split("/").filter(Boolean),o=["/"];for(i.pop();i.length>0;)o.push("/".concat(i.join("/"))),i.pop();o.forEach(e=>{let n=C(t.routes,e,t.basename);n&&n.forEach(e=>s.add(e.route.id))});let l=[...s].reduce((e,t)=>Object.assign(e,{[t]:a.routes[t]}),{});return c(c({},a),{},{routes:l,sri:!!n||void 0})}(n,d),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(y.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(n.entry.module),");"):" ";return e.createElement(e.Fragment,null,e.createElement("script",c(c({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:i},type:void 0})),e.createElement("script",c(c({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),v=lt||m?[]:(n.entry.imports.concat(Qe(y,n,{includeHydrateFallback:!0})),[...new Set(x)]);var x;let w="object"===typeof n.sri?n.sri:{};return Re(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),lt||m?null:e.createElement(e.Fragment,null,"object"===typeof n.sri?e.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}}):null,g?null:e.createElement("link",{rel:"modulepreload",href:n.url,crossOrigin:t.crossOrigin,integrity:w[n.url],suppressHydrationWarning:!0}),e.createElement("link",{rel:"modulepreload",href:n.entry.module,crossOrigin:t.crossOrigin,integrity:w[n.entry.module],suppressHydrationWarning:!0}),v.map(n=>e.createElement("link",{key:n,rel:"modulepreload",href:n,crossOrigin:t.crossOrigin,integrity:w[n],suppressHydrationWarning:!0})),b)}function ut(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}e.Component;function dt(t){let{error:n,isOutsideRemixApp:a}=t;console.error(n);let r,s=e.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(J(n))return e.createElement(pt,{title:"Unhandled Thrown Response!"},e.createElement("h1",{style:{fontSize:"24px"}},n.status," ",n.statusText),s);if(n instanceof Error)0;else{let e=null==n?"Unknown Error":"object"===typeof n&&"toString"in n?n.toString():JSON.stringify(n);new Error(e)}return e.createElement(pt,{title:"Application Error!",isOutsideRemixApp:a},e.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),e.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),s)}function pt(t){var n;let{title:a,renderScripts:r,isOutsideRemixApp:s,children:i}=t,{routeModules:o}=nt();return null!==o.root&&void 0!==n&&n.Layout&&!s?i:e.createElement("html",{lang:"en"},e.createElement("head",null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),e.createElement("title",null,a)),e.createElement("body",null,e.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},i,r?e.createElement(ct,null):null)))}var ht="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ht&&(window.__reactRouterVersion="7.9.1")}catch(tv){}function ft(t){let{basename:n,children:a,window:r}=t,s=e.useRef();null==s.current&&(s.current=y({window:r,v5Compat:!0}));let i=s.current,[o,l]=e.useState({action:i.action,location:i.location}),c=e.useCallback(t=>{e.startTransition(()=>l(t))},[l]);return e.useLayoutEffect(()=>i.listen(c),[i,c]),e.createElement(Me,{basename:n,children:a,location:o.location,navigationType:o.action,navigator:i})}var mt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gt=e.forwardRef(function(t,n){let a,{onClick:s,discover:i="render",prefetch:o="none",relative:l,reloadDocument:u,replace:d,state:p,target:f,to:m,preventScrollReset:g,viewTransition:y}=t,x=r(t,h),{basename:w}=e.useContext(ie),S="string"===typeof m&&mt.test(m),N=!1;if("string"===typeof m&&S&&(a=m,ht))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=V(t.pathname,w);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:N=!0}catch(tv){v(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let I=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(ue(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:r}=e.useContext(ie),{hash:s,pathname:i,search:o}=ge(t,{relative:n}),l=i;return"/"!==a&&(l="/"===i?a:K([a,i])),r.createHref({pathname:l,search:o,hash:s})}(m,{relative:l}),[C,T,E]=function(t,n){let a=e.useContext(tt),[r,s]=e.useState(!1),[i,o]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:p}=n,h=e.useRef(null);e.useEffect(()=>{if("render"===t&&o(!0),"viewport"===t){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}},[t]),e.useEffect(()=>{if(r){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[r]);let f=()=>{s(!0)},m=()=>{s(!1),o(!1)};return a?"intent"!==t?[i,h,{}]:[i,h,{onFocus:at(l,f),onBlur:at(c,m),onMouseEnter:at(u,f),onMouseLeave:at(d,m),onTouchStart:at(p,f)}]:[!1,h,{}]}(o,x),_=function(t){let{target:n,replace:a,state:r,preventScrollReset:s,relative:i,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=fe(),c=de(),u=ge(t,{relative:i});return e.useCallback(e=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,n)){e.preventDefault();let n=void 0!==a?a:k(c)===k(u);l(t,{replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,u,a,r,n,t,s,i,o])}(m,{replace:d,state:p,target:f,preventScrollReset:g,relative:l,viewTransition:y});let A=e.createElement("a",c(c(c({},x),E),{},{href:a||I,onClick:N||u?s:function(e){s&&s(e),e.defaultPrevented||_(e)},ref:ut(n,T),target:f,"data-discover":S||"render"!==i?void 0:"true"}));return C&&!S?e.createElement(e.Fragment,null,A,e.createElement(st,{page:I})):A});gt.displayName="Link";var yt=e.forwardRef(function(t,n){let{"aria-current":a="page",caseSensitive:s=!1,className:i="",end:o=!1,style:l,to:u,viewTransition:d,children:p}=t,h=r(t,f),m=ge(u,{relative:h.relative}),g=de(),y=e.useContext(te),{navigator:v,basename:x}=e.useContext(ie),w=null!=y&&function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.useContext(ae);b(null!=a,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=xt("useViewTransitionState"),s=ge(t,{relative:n});if(!a.isTransitioning)return!1;let i=V(a.currentLocation.pathname,r)||a.currentLocation.pathname,o=V(a.nextLocation.pathname,r)||a.nextLocation.pathname;return null!=j(s.pathname,o)||null!=j(s.pathname,i)}(m)&&!0===d,k=v.encodeLocation?v.encodeLocation(m).pathname:m.pathname,S=g.pathname,N=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;s||(S=S.toLowerCase(),N=N?N.toLowerCase():null,k=k.toLowerCase()),N&&x&&(N=V(N,x)||N);const I="/"!==k&&k.endsWith("/")?k.length-1:k.length;let C,T=S===k||!o&&S.startsWith(k)&&"/"===S.charAt(I),E=null!=N&&(N===k||!o&&N.startsWith(k)&&"/"===N.charAt(k.length)),_={isActive:T,isPending:E,isTransitioning:w},A=T?a:void 0;C="function"===typeof i?i(_):[i,T?"active":null,E?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let R="function"===typeof l?l(_):l;return e.createElement(gt,c(c({},h),{},{"aria-current":A,className:C,ref:n,style:R,to:u,viewTransition:d}),"function"===typeof p?p(_):p)});yt.displayName="NavLink";var bt=e.forwardRef((t,n)=>{let{discover:a="render",fetcherKey:s,navigate:i,reloadDocument:o,replace:l,state:u,method:d=Le,action:p,onSubmit:h,relative:f,preventScrollReset:g,viewTransition:y}=t,v=r(t,m),x=St(),w=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:a}=e.useContext(ie),r=e.useContext(le);b(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i=c({},ge(t||".",{relative:n})),o=de();if(null==t){i.search=o.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();i.search=n?"?".concat(n):""}}t&&"."!==t||!s.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==a&&(i.pathname="/"===i.pathname?a:K([a,i.pathname]));return k(i)}(p,{relative:f}),S="get"===d.toLowerCase()?"get":"post",N="string"===typeof p&&mt.test(p);return e.createElement("form",c(c({ref:n,method:S,action:w,onSubmit:o?h:e=>{if(h&&h(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;x(t||e.currentTarget,{fetcherKey:s,method:n,navigate:i,replace:l,state:u,relative:f,preventScrollReset:g,viewTransition:y})}},v),{},{"data-discover":N||"render"!==a?void 0:"true"}))});function vt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function xt(t){let n=e.useContext(ee);return b(n,vt(t)),n}bt.displayName="Form";var wt=0,kt=()=>"__".concat(String(++wt),"__");function St(){let{router:t}=xt("useSubmit"),{basename:n}=e.useContext(ie),a=Ce("useRouteId");return e.useCallback(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:i,encType:o,formData:l,body:c}=Ue(e,n);if(!1===r.navigate){let e=r.fetcherKey||kt();await t.fetch(e,a,r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,flushSync:r.flushSync})}else await t.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:a,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,n,a])}const Nt=[{id:1,username:"archivist1",password:"password",role:"Archivist",name:"John Smith"},{id:2,username:"admin1",password:"admin123",role:"Admin",name:"Sarah Johnson"},{id:3,username:"archivist2",password:"password",role:"Archivist",name:"Mike Wilson"}],It=[{id:1,title:"Annual Financial Report 2023",year:2023,physicalLocation:"Rack A - Drawer 3",softFile:"financial_report_2023.pdf",ownership:"Finance Department",accessRights:["Finance Team","Management","Auditors"],status:"Available",registrationDate:"2023-12-15",lastAccessed:"2024-01-10",borrowedBy:null,borrowDate:null,returnDate:null},{id:2,title:"Employee Handbook v2.1",year:2024,physicalLocation:"Rack B - Drawer 1",softFile:"employee_handbook_v2.1.pdf",ownership:"HR Department",accessRights:["HR Team","Management","All Employees"],status:"Borrowed",registrationDate:"2024-01-05",lastAccessed:"2024-02-20",borrowedBy:"Mike Wilson",borrowDate:"2024-02-20",returnDate:"2024-03-05"},{id:3,title:"Project Alpha Specifications",year:2024,physicalLocation:"Rack C - Drawer 2",softFile:"project_alpha_specs.pdf",ownership:"Engineering Department",accessRights:["Engineering Team","Project Managers"],status:"Available",registrationDate:"2024-02-01",lastAccessed:"2024-02-15",borrowedBy:null,borrowDate:null,returnDate:null},{id:4,title:"Legal Contract Template",year:2023,physicalLocation:"Rack A - Drawer 1",softFile:"legal_contract_template.pdf",ownership:"Legal Department",accessRights:["Legal Team","Management"],status:"Overdue",registrationDate:"2023-11-10",lastAccessed:"2024-01-25",borrowedBy:"John Smith",borrowDate:"2024-01-25",returnDate:"2024-02-10"}],Ct=["Rack A - Drawer 1","Rack A - Drawer 2","Rack A - Drawer 3","Rack B - Drawer 1","Rack B - Drawer 2","Rack B - Drawer 3","Rack C - Drawer 1","Rack C - Drawer 2","Rack C - Drawer 3"],Tt=["Finance Department","HR Department","Engineering Department","Legal Department","Marketing Department","Operations Department"],Et=["Finance Team","HR Team","Engineering Team","Legal Team","Marketing Team","Operations Team","Management","Auditors","All Employees","Project Managers"],_t=[{id:1,timestamp:"2024-02-25 10:30:00",action:"Document Retrieved",document:"Annual Financial Report 2023",user:"John Smith",location:"Rack A - Drawer 3",status:"Success"},{id:2,timestamp:"2024-02-25 09:15:00",action:"Document Returned",document:"Employee Handbook v2.1",user:"Mike Wilson",location:"Rack B - Drawer 1",status:"Success"},{id:3,timestamp:"2024-02-24 16:45:00",action:"Unauthorized Access Attempt",document:"Legal Contract Template",user:"Unknown",location:"Rack A - Drawer 1",status:"Denied"},{id:4,timestamp:"2024-02-24 14:20:00",action:"Document Borrowed",document:"Project Alpha Specifications",user:"Sarah Johnson",location:"Rack C - Drawer 2",status:"Success"}],At=[{id:1,type:"warning",title:"Overdue Document",message:"Legal Contract Template is 15 days overdue",timestamp:"2024-02-25 08:00:00",read:!1},{id:2,type:"alert",title:"Security Alert",message:"Unauthorized access attempt detected at Rack A - Drawer 1",timestamp:"2024-02-24 16:45:00",read:!1},{id:3,type:"info",title:"Document Returned",message:"Employee Handbook v2.1 has been returned successfully",timestamp:"2024-02-25 09:15:00",read:!0}],Rt=156,Ft=134,Dt=19,Mt=3,Ot=45,Pt=28,Lt=2,zt=98;var jt=n(579);const Bt=(0,e.createContext)(),Wt=()=>{const t=(0,e.useContext)(Bt);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Vt=t=>{let{children:n}=t;const[a,r]=(0,e.useState)(null),[s,i]=(0,e.useState)(!1),o={user:a,login:async(e,t)=>{i(!0),await new Promise(e=>setTimeout(e,1e3));const n=Nt.find(n=>n.username===e&&n.password===t);return n?(r(n),i(!1),{success:!0}):(i(!1),{success:!1,error:"Invalid credentials"})},logout:()=>{r(null)},isLoading:s};return(0,jt.jsx)(Bt.Provider,{value:o,children:n})};function Ut(e,t){if("function"===typeof e)return e(t);null!==e&&void 0!==e&&(e.current=t)}function Ht(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{let n=!1;const a=t.map(t=>{const a=Ut(t,e);return n||"function"!=typeof a||(n=!0),a});if(n)return()=>{for(let e=0;e<a.length;e++){const n=a[e];"function"==typeof n?n():Ut(t[e],null)}}}}function Gt(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e.useCallback(Ht(...n),n)}const qt=["children"],Kt=["children"];function Xt(t){const n=Qt(t),a=e.forwardRef((t,a)=>{const{children:s}=t,i=r(t,qt),o=e.Children.toArray(s),l=o.find(Zt);if(l){const t=l.props.children,r=o.map(n=>n===l?e.Children.count(t)>1?e.Children.only(null):e.isValidElement(t)?t.props.children:null:n);return(0,jt.jsx)(n,c(c({},i),{},{ref:a,children:e.isValidElement(t)?e.cloneElement(t,void 0,r):null}))}return(0,jt.jsx)(n,c(c({},i),{},{ref:a,children:s}))});return a.displayName="".concat(t,".Slot"),a}var Yt=Xt("Slot");function Qt(t){const n=e.forwardRef((t,n)=>{const{children:a}=t,s=r(t,Kt);if(e.isValidElement(a)){const t=function(e){var t,n;let a=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,r=a&&"isReactWarning"in a&&a.isReactWarning;if(r)return e.ref;if(a=null===(n=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===n?void 0:n.get,r=a&&"isReactWarning"in a&&a.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(a),r=function(e,t){const n=c({},t);for(const a in t){const r=e[a],s=t[a];/^on[A-Z]/.test(a)?r&&s?n[a]=function(){const e=s(...arguments);return r(...arguments),e}:r&&(n[a]=r):"style"===a?n[a]=c(c({},r),s):"className"===a&&(n[a]=[r,s].filter(Boolean).join(" "))}return c(c({},e),n)}(s,a.props);return a.type!==e.Fragment&&(r.ref=n?Ht(n,t):t),e.cloneElement(a,r)}return e.Children.count(a)>1?e.Children.only(null):null});return n.displayName="".concat(t,".SlotClone"),n}var Jt=Symbol("radix.slottable");function Zt(t){return e.isValidElement(t)&&"function"===typeof t.type&&"__radixId"in t.type&&t.type.__radixId===Jt}function $t(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=$t(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function en(){for(var e,t,n=0,a="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=$t(e))&&(a&&(a+=" "),a+=t);return a}const tn=["class","className"],nn=e=>"boolean"===typeof e?"".concat(e):0===e?"0":e,an=en,rn=(e,t)=>n=>{var a;if(null==(null===t||void 0===t?void 0:t.variants))return an(e,null===n||void 0===n?void 0:n.class,null===n||void 0===n?void 0:n.className);const{variants:s,defaultVariants:i}=t,o=Object.keys(s).map(e=>{const t=null===n||void 0===n?void 0:n[e],a=null===i||void 0===i?void 0:i[e];if(null===t)return null;const r=nn(t)||nn(a);return s[e][r]}),l=n&&Object.entries(n).reduce((e,t)=>{let[n,a]=t;return void 0===a||(e[n]=a),e},{}),u=null===t||void 0===t||null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:n,className:a}=t,s=r(t,tn);return Object.entries(s).every(e=>{let[t,n]=e;return Array.isArray(n)?n.includes(c(c({},i),l)[t]):c(c({},i),l)[t]===n})?[...e,n,a]:e},[]);return an(e,o,u,null===n||void 0===n?void 0:n.class,null===n||void 0===n?void 0:n.className)},sn=(e,t)=>{var n;if(0===e.length)return t.classGroupId;const a=e[0],r=t.nextPart.get(a),s=r?sn(e.slice(1),r):void 0;if(s)return s;if(0===t.validators.length)return;const i=e.join("-");return null===(n=t.validators.find(e=>{let{validator:t}=e;return t(i)}))||void 0===n?void 0:n.classGroupId},on=/^\[(.+)\]$/,ln=e=>{if(on.test(e)){const t=on.exec(e)[1],n=null===t||void 0===t?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},cn=e=>{const{theme:t,classGroups:n}=e,a={nextPart:new Map,validators:[]};for(const r in n)un(n[r],a,r,t);return a},un=(e,t,n,a)=>{e.forEach(e=>{if("string"===typeof e){return void((""===e?t:dn(t,e)).classGroupId=n)}if("function"===typeof e)return pn(e)?void un(e(a),t,n,a):void t.validators.push({validator:e,classGroupId:n});Object.entries(e).forEach(e=>{let[r,s]=e;un(s,dn(t,r),n,a)})})},dn=(e,t)=>{let n=e;return t.split("-").forEach(e=>{n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)}),n},pn=e=>e.isThemeGetter,hn=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,a=new Map;const r=(r,s)=>{n.set(r,s),t++,t>e&&(t=0,a=n,n=new Map)};return{get(e){let t=n.get(e);return void 0!==t?t:void 0!==(t=a.get(e))?(r(e,t),t):void 0},set(e,t){n.has(e)?n.set(e,t):r(e,t)}}},fn=e=>{const{prefix:t,experimentalParseClassName:n}=e;let a=e=>{const t=[];let n,a=0,r=0,s=0;for(let l=0;l<e.length;l++){let i=e[l];if(0===a&&0===r){if(":"===i){t.push(e.slice(s,l)),s=l+1;continue}if("/"===i){n=l;continue}}"["===i?a++:"]"===i?a--:"("===i?r++:")"===i&&r--}const i=0===t.length?e:e.substring(s),o=mn(i);return{modifiers:t,hasImportantModifier:o!==i,baseClassName:o,maybePostfixModifierPosition:n&&n>s?n-s:void 0}};if(t){const e=t+":",n=a;a=t=>t.startsWith(e)?n(t.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:t,maybePostfixModifierPosition:void 0}}if(n){const e=a;a=t=>n({className:t,parseClassName:e})}return a},mn=e=>e.endsWith("!")?e.substring(0,e.length-1):e.startsWith("!")?e.substring(1):e,gn=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(e=>[e,!0]));return e=>{if(e.length<=1)return e;const n=[];let a=[];return e.forEach(e=>{"["===e[0]||t[e]?(n.push(...a.sort(),e),a=[]):a.push(e)}),n.push(...a.sort()),n}},yn=e=>c({cache:hn(e.cacheSize),parseClassName:fn(e),sortModifiers:gn(e)},(e=>{const t=cn(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:e=>{const n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),sn(n,t)||ln(e)},getConflictingClassGroupIds:(e,t)=>{const r=n[e]||[];return t&&a[e]?[...r,...a[e]]:r}}})(e)),bn=/\s+/;function vn(){let e,t,n=0,a="";for(;n<arguments.length;)(e=arguments[n++])&&(t=xn(e))&&(a&&(a+=" "),a+=t);return a}const xn=e=>{if("string"===typeof e)return e;let t,n="";for(let a=0;a<e.length;a++)e[a]&&(t=xn(e[a]))&&(n&&(n+=" "),n+=t);return n};function wn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];let r,s,i,o=function(t){const a=n.reduce((e,t)=>t(e),e());return r=yn(a),s=r.cache.get,i=r.cache.set,o=l,l(t)};function l(e){const t=s(e);if(t)return t;const n=((e,t)=>{const{parseClassName:n,getClassGroupId:a,getConflictingClassGroupIds:r,sortModifiers:s}=t,i=[],o=e.trim().split(bn);let l="";for(let c=o.length-1;c>=0;c-=1){const e=o[c],{isExternal:t,modifiers:u,hasImportantModifier:d,baseClassName:p,maybePostfixModifierPosition:h}=n(e);if(t){l=e+(l.length>0?" "+l:l);continue}let f=!!h,m=a(f?p.substring(0,h):p);if(!m){if(!f){l=e+(l.length>0?" "+l:l);continue}if(m=a(p),!m){l=e+(l.length>0?" "+l:l);continue}f=!1}const g=s(u).join(":"),y=d?g+"!":g,b=y+m;if(i.includes(b))continue;i.push(b);const v=r(m,f);for(let n=0;n<v.length;++n){const e=v[n];i.push(y+e)}l=e+(l.length>0?" "+l:l)}return l})(e,r);return i(e,n),n}return function(){return o(vn.apply(null,arguments))}}const kn=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},Sn=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Nn=/^\((?:(\w[\w-]*):)?(.+)\)$/i,In=/^\d+\/\d+$/,Cn=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Tn=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,En=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,_n=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,An=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Rn=e=>In.test(e),Fn=e=>!!e&&!Number.isNaN(Number(e)),Dn=e=>!!e&&Number.isInteger(Number(e)),Mn=e=>e.endsWith("%")&&Fn(e.slice(0,-1)),On=e=>Cn.test(e),Pn=()=>!0,Ln=e=>Tn.test(e)&&!En.test(e),zn=()=>!1,jn=e=>_n.test(e),Bn=e=>An.test(e),Wn=e=>!Un(e)&&!Yn(e),Vn=e=>na(e,ia,zn),Un=e=>Sn.test(e),Hn=e=>na(e,oa,Ln),Gn=e=>na(e,la,Fn),qn=e=>na(e,ra,zn),Kn=e=>na(e,sa,Bn),Xn=e=>na(e,ua,jn),Yn=e=>Nn.test(e),Qn=e=>aa(e,oa),Jn=e=>aa(e,ca),Zn=e=>aa(e,ra),$n=e=>aa(e,ia),ea=e=>aa(e,sa),ta=e=>aa(e,ua,!0),na=(e,t,n)=>{const a=Sn.exec(e);return!!a&&(a[1]?t(a[1]):n(a[2]))},aa=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=Nn.exec(e);return!!a&&(a[1]?t(a[1]):n)},ra=e=>"position"===e||"percentage"===e,sa=e=>"image"===e||"url"===e,ia=e=>"length"===e||"size"===e||"bg-size"===e,oa=e=>"length"===e,la=e=>"number"===e,ca=e=>"family-name"===e,ua=e=>"shadow"===e,da=(Symbol.toStringTag,()=>{const e=kn("color"),t=kn("font"),n=kn("text"),a=kn("font-weight"),r=kn("tracking"),s=kn("leading"),i=kn("breakpoint"),o=kn("container"),l=kn("spacing"),c=kn("radius"),u=kn("shadow"),d=kn("inset-shadow"),p=kn("text-shadow"),h=kn("drop-shadow"),f=kn("blur"),m=kn("perspective"),g=kn("aspect"),y=kn("ease"),b=kn("animate"),v=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",Yn,Un],x=()=>[Yn,Un,l],w=()=>[Rn,"full","auto",...x()],k=()=>[Dn,"none","subgrid",Yn,Un],S=()=>["auto",{span:["full",Dn,Yn,Un]},Dn,Yn,Un],N=()=>[Dn,"auto",Yn,Un],I=()=>["auto","min","max","fr",Yn,Un],C=()=>["auto",...x()],T=()=>[Rn,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...x()],E=()=>[e,Yn,Un],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",Zn,qn,{position:[Yn,Un]}],A=()=>["auto","cover","contain",$n,Vn,{size:[Yn,Un]}],R=()=>[Mn,Qn,Hn],F=()=>["","none","full",c,Yn,Un],D=()=>["",Fn,Qn,Hn],M=()=>[Fn,Mn,Zn,qn],O=()=>["","none",f,Yn,Un],P=()=>["none",Fn,Yn,Un],L=()=>["none",Fn,Yn,Un],z=()=>[Fn,Yn,Un],j=()=>[Rn,"full",...x()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[On],breakpoint:[On],color:[Pn],container:[On],"drop-shadow":[On],ease:["in","out","in-out"],font:[Wn],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[On],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[On],shadow:[On],spacing:["px",Fn],text:[On],"text-shadow":[On],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Rn,Un,Yn,g]}],container:["container"],columns:[{columns:[Fn,Un,Yn,o]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:v()}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:w()}],"inset-x":[{"inset-x":w()}],"inset-y":[{"inset-y":w()}],start:[{start:w()}],end:[{end:w()}],top:[{top:w()}],right:[{right:w()}],bottom:[{bottom:w()}],left:[{left:w()}],visibility:["visible","invisible","collapse"],z:[{z:[Dn,"auto",Yn,Un]}],basis:[{basis:[Rn,"full","auto",o,...x()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Fn,Rn,"auto","initial","none",Un]}],grow:[{grow:["",Fn,Yn,Un]}],shrink:[{shrink:["",Fn,Yn,Un]}],order:[{order:[Dn,"first","last","none",Yn,Un]}],"grid-cols":[{"grid-cols":k()}],"col-start-end":[{col:S()}],"col-start":[{"col-start":N()}],"col-end":[{"col-end":N()}],"grid-rows":[{"grid-rows":k()}],"row-start-end":[{row:S()}],"row-start":[{"row-start":N()}],"row-end":[{"row-end":N()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":I()}],"auto-rows":[{"auto-rows":I()}],gap:[{gap:x()}],"gap-x":[{"gap-x":x()}],"gap-y":[{"gap-y":x()}],"justify-content":[{justify:["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe","normal"]}],"justify-items":[{"justify-items":["start","end","center","stretch","center-safe","end-safe","normal"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"align-items":[{items:["start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"align-self":[{self:["auto","start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"place-items":[{"place-items":["start","end","center","stretch","center-safe","end-safe","baseline"]}],"place-self":[{"place-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],p:[{p:x()}],px:[{px:x()}],py:[{py:x()}],ps:[{ps:x()}],pe:[{pe:x()}],pt:[{pt:x()}],pr:[{pr:x()}],pb:[{pb:x()}],pl:[{pl:x()}],m:[{m:C()}],mx:[{mx:C()}],my:[{my:C()}],ms:[{ms:C()}],me:[{me:C()}],mt:[{mt:C()}],mr:[{mr:C()}],mb:[{mb:C()}],ml:[{ml:C()}],"space-x":[{"space-x":x()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":x()}],"space-y-reverse":["space-y-reverse"],size:[{size:T()}],w:[{w:[o,"screen",...T()]}],"min-w":[{"min-w":[o,"screen","none",...T()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[i]},...T()]}],h:[{h:["screen","lh",...T()]}],"min-h":[{"min-h":["screen","lh","none",...T()]}],"max-h":[{"max-h":["screen","lh",...T()]}],"font-size":[{text:["base",n,Qn,Hn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[a,Yn,Gn]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Mn,Un]}],"font-family":[{font:[Jn,Un,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,Yn,Un]}],"line-clamp":[{"line-clamp":[Fn,"none",Yn,Gn]}],leading:[{leading:[s,...x()]}],"list-image":[{"list-image":["none",Yn,Un]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Yn,Un]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:E()}],"text-color":[{text:E()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","wavy"]}],"text-decoration-thickness":[{decoration:[Fn,"from-font","auto",Yn,Hn]}],"text-decoration-color":[{decoration:E()}],"underline-offset":[{"underline-offset":[Fn,"auto",Yn,Un]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:x()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Yn,Un]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Yn,Un]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:_()}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:A()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Dn,Yn,Un],radial:["",Yn,Un],conic:[Dn,Yn,Un]},ea,Kn]}],"bg-color":[{bg:E()}],"gradient-from-pos":[{from:R()}],"gradient-via-pos":[{via:R()}],"gradient-to-pos":[{to:R()}],"gradient-from":[{from:E()}],"gradient-via":[{via:E()}],"gradient-to":[{to:E()}],rounded:[{rounded:F()}],"rounded-s":[{"rounded-s":F()}],"rounded-e":[{"rounded-e":F()}],"rounded-t":[{"rounded-t":F()}],"rounded-r":[{"rounded-r":F()}],"rounded-b":[{"rounded-b":F()}],"rounded-l":[{"rounded-l":F()}],"rounded-ss":[{"rounded-ss":F()}],"rounded-se":[{"rounded-se":F()}],"rounded-ee":[{"rounded-ee":F()}],"rounded-es":[{"rounded-es":F()}],"rounded-tl":[{"rounded-tl":F()}],"rounded-tr":[{"rounded-tr":F()}],"rounded-br":[{"rounded-br":F()}],"rounded-bl":[{"rounded-bl":F()}],"border-w":[{border:D()}],"border-w-x":[{"border-x":D()}],"border-w-y":[{"border-y":D()}],"border-w-s":[{"border-s":D()}],"border-w-e":[{"border-e":D()}],"border-w-t":[{"border-t":D()}],"border-w-r":[{"border-r":D()}],"border-w-b":[{"border-b":D()}],"border-w-l":[{"border-l":D()}],"divide-x":[{"divide-x":D()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":D()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:["solid","dashed","dotted","double","hidden","none"]}],"divide-style":[{divide:["solid","dashed","dotted","double","hidden","none"]}],"border-color":[{border:E()}],"border-color-x":[{"border-x":E()}],"border-color-y":[{"border-y":E()}],"border-color-s":[{"border-s":E()}],"border-color-e":[{"border-e":E()}],"border-color-t":[{"border-t":E()}],"border-color-r":[{"border-r":E()}],"border-color-b":[{"border-b":E()}],"border-color-l":[{"border-l":E()}],"divide-color":[{divide:E()}],"outline-style":[{outline:["solid","dashed","dotted","double","none","hidden"]}],"outline-offset":[{"outline-offset":[Fn,Yn,Un]}],"outline-w":[{outline:["",Fn,Qn,Hn]}],"outline-color":[{outline:E()}],shadow:[{shadow:["","none",u,ta,Xn]}],"shadow-color":[{shadow:E()}],"inset-shadow":[{"inset-shadow":["none",d,ta,Xn]}],"inset-shadow-color":[{"inset-shadow":E()}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:E()}],"ring-offset-w":[{"ring-offset":[Fn,Hn]}],"ring-offset-color":[{"ring-offset":E()}],"inset-ring-w":[{"inset-ring":D()}],"inset-ring-color":[{"inset-ring":E()}],"text-shadow":[{"text-shadow":["none",p,ta,Xn]}],"text-shadow-color":[{"text-shadow":E()}],opacity:[{opacity:[Fn,Yn,Un]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Fn]}],"mask-image-linear-from-pos":[{"mask-linear-from":M()}],"mask-image-linear-to-pos":[{"mask-linear-to":M()}],"mask-image-linear-from-color":[{"mask-linear-from":E()}],"mask-image-linear-to-color":[{"mask-linear-to":E()}],"mask-image-t-from-pos":[{"mask-t-from":M()}],"mask-image-t-to-pos":[{"mask-t-to":M()}],"mask-image-t-from-color":[{"mask-t-from":E()}],"mask-image-t-to-color":[{"mask-t-to":E()}],"mask-image-r-from-pos":[{"mask-r-from":M()}],"mask-image-r-to-pos":[{"mask-r-to":M()}],"mask-image-r-from-color":[{"mask-r-from":E()}],"mask-image-r-to-color":[{"mask-r-to":E()}],"mask-image-b-from-pos":[{"mask-b-from":M()}],"mask-image-b-to-pos":[{"mask-b-to":M()}],"mask-image-b-from-color":[{"mask-b-from":E()}],"mask-image-b-to-color":[{"mask-b-to":E()}],"mask-image-l-from-pos":[{"mask-l-from":M()}],"mask-image-l-to-pos":[{"mask-l-to":M()}],"mask-image-l-from-color":[{"mask-l-from":E()}],"mask-image-l-to-color":[{"mask-l-to":E()}],"mask-image-x-from-pos":[{"mask-x-from":M()}],"mask-image-x-to-pos":[{"mask-x-to":M()}],"mask-image-x-from-color":[{"mask-x-from":E()}],"mask-image-x-to-color":[{"mask-x-to":E()}],"mask-image-y-from-pos":[{"mask-y-from":M()}],"mask-image-y-to-pos":[{"mask-y-to":M()}],"mask-image-y-from-color":[{"mask-y-from":E()}],"mask-image-y-to-color":[{"mask-y-to":E()}],"mask-image-radial":[{"mask-radial":[Yn,Un]}],"mask-image-radial-from-pos":[{"mask-radial-from":M()}],"mask-image-radial-to-pos":[{"mask-radial-to":M()}],"mask-image-radial-from-color":[{"mask-radial-from":E()}],"mask-image-radial-to-color":[{"mask-radial-to":E()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]}],"mask-image-conic-pos":[{"mask-conic":[Fn]}],"mask-image-conic-from-pos":[{"mask-conic-from":M()}],"mask-image-conic-to-pos":[{"mask-conic-to":M()}],"mask-image-conic-from-color":[{"mask-conic-from":E()}],"mask-image-conic-to-color":[{"mask-conic-to":E()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:_()}],"mask-repeat":[{mask:["no-repeat",{repeat:["","x","y","space","round"]}]}],"mask-size":[{mask:A()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Yn,Un]}],filter:[{filter:["","none",Yn,Un]}],blur:[{blur:O()}],brightness:[{brightness:[Fn,Yn,Un]}],contrast:[{contrast:[Fn,Yn,Un]}],"drop-shadow":[{"drop-shadow":["","none",h,ta,Xn]}],"drop-shadow-color":[{"drop-shadow":E()}],grayscale:[{grayscale:["",Fn,Yn,Un]}],"hue-rotate":[{"hue-rotate":[Fn,Yn,Un]}],invert:[{invert:["",Fn,Yn,Un]}],saturate:[{saturate:[Fn,Yn,Un]}],sepia:[{sepia:["",Fn,Yn,Un]}],"backdrop-filter":[{"backdrop-filter":["","none",Yn,Un]}],"backdrop-blur":[{"backdrop-blur":O()}],"backdrop-brightness":[{"backdrop-brightness":[Fn,Yn,Un]}],"backdrop-contrast":[{"backdrop-contrast":[Fn,Yn,Un]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Fn,Yn,Un]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Fn,Yn,Un]}],"backdrop-invert":[{"backdrop-invert":["",Fn,Yn,Un]}],"backdrop-opacity":[{"backdrop-opacity":[Fn,Yn,Un]}],"backdrop-saturate":[{"backdrop-saturate":[Fn,Yn,Un]}],"backdrop-sepia":[{"backdrop-sepia":["",Fn,Yn,Un]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":x()}],"border-spacing-x":[{"border-spacing-x":x()}],"border-spacing-y":[{"border-spacing-y":x()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Yn,Un]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Fn,"initial",Yn,Un]}],ease:[{ease:["linear","initial",y,Yn,Un]}],delay:[{delay:[Fn,Yn,Un]}],animate:[{animate:["none",b,Yn,Un]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,Yn,Un]}],"perspective-origin":[{"perspective-origin":v()}],rotate:[{rotate:P()}],"rotate-x":[{"rotate-x":P()}],"rotate-y":[{"rotate-y":P()}],"rotate-z":[{"rotate-z":P()}],scale:[{scale:L()}],"scale-x":[{"scale-x":L()}],"scale-y":[{"scale-y":L()}],"scale-z":[{"scale-z":L()}],"scale-3d":["scale-3d"],skew:[{skew:z()}],"skew-x":[{"skew-x":z()}],"skew-y":[{"skew-y":z()}],transform:[{transform:[Yn,Un,"","none","gpu","cpu"]}],"transform-origin":[{origin:v()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:j()}],"translate-x":[{"translate-x":j()}],"translate-y":[{"translate-y":j()}],"translate-z":[{"translate-z":j()}],"translate-none":["translate-none"],accent:[{accent:E()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:E()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Yn,Un]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":x()}],"scroll-mx":[{"scroll-mx":x()}],"scroll-my":[{"scroll-my":x()}],"scroll-ms":[{"scroll-ms":x()}],"scroll-me":[{"scroll-me":x()}],"scroll-mt":[{"scroll-mt":x()}],"scroll-mr":[{"scroll-mr":x()}],"scroll-mb":[{"scroll-mb":x()}],"scroll-ml":[{"scroll-ml":x()}],"scroll-p":[{"scroll-p":x()}],"scroll-px":[{"scroll-px":x()}],"scroll-py":[{"scroll-py":x()}],"scroll-ps":[{"scroll-ps":x()}],"scroll-pe":[{"scroll-pe":x()}],"scroll-pt":[{"scroll-pt":x()}],"scroll-pr":[{"scroll-pr":x()}],"scroll-pb":[{"scroll-pb":x()}],"scroll-pl":[{"scroll-pl":x()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Yn,Un]}],fill:[{fill:["none",...E()]}],"stroke-w":[{stroke:[Fn,Qn,Hn,Gn]}],stroke:[{stroke:["none",...E()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}}),pa=wn(da);function ha(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return pa(en(t))}const fa=["className","variant","size","asChild"],ma=rn("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ga=e.forwardRef((e,t)=>{let{className:n,variant:a,size:s,asChild:i=!1}=e,o=r(e,fa);const l=i?Yt:"button";return(0,jt.jsx)(l,c({className:ha(ma({variant:a,size:s,className:n})),ref:t},o))});ga.displayName="Button";const ya=["className","type"],ba=e.forwardRef((e,t)=>{let{className:n,type:a}=e,s=r(e,ya);return(0,jt.jsx)("input",c({type:a,className:ha("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:t},s))});ba.displayName="Input";var va=n(950);const xa=["asChild"];var wa=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((t,n)=>{const a=Xt("Primitive.".concat(n)),s=e.forwardRef((e,t)=>{const{asChild:s}=e,i=r(e,xa),o=s?a:n;return"undefined"!==typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,jt.jsx)(o,c(c({},i),{},{ref:t}))});return s.displayName="Primitive.".concat(n),c(c({},t),{},{[n]:s})},{});var ka=e.forwardRef((e,t)=>(0,jt.jsx)(wa.label,c(c({},e),{},{ref:t,onMouseDown:t=>{var n;t.target.closest("button, input, select, textarea")||(null===(n=e.onMouseDown)||void 0===n||n.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}})));ka.displayName="Label";var Sa=ka;const Na=["className"],Ia=rn("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ca=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Na);return(0,jt.jsx)(Sa,c({ref:t,className:ha(Ia(),n)},a))});Ca.displayName=Sa.displayName;const Ta=["className"],Ea=["className"],_a=["className"],Aa=["className"],Ra=["className"],Fa=["className"],Da=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Ta);return(0,jt.jsx)("div",c({ref:t,className:ha("rounded-xl border bg-card text-card-foreground shadow",n)},a))});Da.displayName="Card";const Ma=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Ea);return(0,jt.jsx)("div",c({ref:t,className:ha("flex flex-col space-y-1.5 p-6",n)},a))});Ma.displayName="CardHeader";const Oa=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,_a);return(0,jt.jsx)("div",c({ref:t,className:ha("font-semibold leading-none tracking-tight",n)},a))});Oa.displayName="CardTitle";const Pa=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Aa);return(0,jt.jsx)("div",c({ref:t,className:ha("text-sm text-muted-foreground",n)},a))});Pa.displayName="CardDescription";const La=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Ra);return(0,jt.jsx)("div",c({ref:t,className:ha("p-6 pt-0",n)},a))});La.displayName="CardContent";e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Fa);return(0,jt.jsx)("div",c({ref:t,className:ha("flex items-center p-6 pt-0",n)},a))}).displayName="CardFooter";const za=["className","variant"],ja=["className"],Ba=["className"],Wa=rn("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Va=e.forwardRef((e,t)=>{let{className:n,variant:a}=e,s=r(e,za);return(0,jt.jsx)("div",c({ref:t,role:"alert",className:ha(Wa({variant:a}),n)},s))});Va.displayName="Alert";e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,ja);return(0,jt.jsx)("h5",c({ref:t,className:ha("mb-1 font-medium leading-none tracking-tight",n)},a))}).displayName="AlertTitle";const Ua=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Ba);return(0,jt.jsx)("div",c({ref:t,className:ha("text-sm [&_p]:leading-relaxed",n)},a))});Ua.displayName="AlertDescription";const Ha=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},Ga=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var qa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ka=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],Xa=(0,e.forwardRef)((t,n)=>{let{color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,iconNode:d}=t,p=r(t,Ka);return(0,e.createElement)("svg",c(c(c({ref:n},qa),{},{width:s,height:s,stroke:a,strokeWidth:o?24*Number(i)/Number(s):i,className:Ga("lucide",l)},!u&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(p)&&{"aria-hidden":"true"}),p),[...d.map(t=>{let[n,a]=t;return(0,e.createElement)(n,a)}),...Array.isArray(u)?u:[u]])}),Ya=["className"],Qa=(t,n)=>{const a=(0,e.forwardRef)((a,s)=>{let{className:i}=a,o=r(a,Ya);return(0,e.createElement)(Xa,c({ref:s,iconNode:n,className:Ga("lucide-".concat((l=Ha(t),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(t),i)},o));var l});return a.displayName=Ha(t),a},Ja=Qa("fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]),Za=Qa("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),$a=Qa("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),er=Qa("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),tr=()=>{const[t,n]=(0,e.useState)(""),[a,r]=(0,e.useState)(""),[s,i]=(0,e.useState)(""),[o,l]=(0,e.useState)(!1),{login:c,isLoading:u}=Wt(),d=fe(),p=()=>(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)(Da,{className:"w-96",children:[(0,jt.jsxs)(Ma,{className:"text-center",children:[(0,jt.jsxs)(Oa,{className:"flex items-center justify-center space-x-2",children:[(0,jt.jsx)(Ja,{className:"h-6 w-6 text-[#5d87ff]"}),(0,jt.jsx)("span",{children:"Biometric Verification"})]}),(0,jt.jsx)(Pa,{children:"Please verify your identity"})]}),(0,jt.jsxs)(La,{className:"text-center space-y-4",children:[(0,jt.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,jt.jsx)("div",{className:"bg-[#5d87ff] bg-opacity-10 p-4 rounded-full animate-pulse",children:(0,jt.jsx)(Ja,{className:"h-8 w-8 text-[#5d87ff]"})}),(0,jt.jsx)("div",{className:"bg-[#5d87ff] bg-opacity-10 p-4 rounded-full animate-pulse",children:(0,jt.jsx)(Za,{className:"h-8 w-8 text-[#5d87ff]"})})]}),(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:"Verifying biometric data..."}),(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,jt.jsx)("div",{className:"bg-[#5d87ff] h-2 rounded-full animate-pulse",style:{width:"70%"}})})]})]})});return(0,jt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:[o&&(0,jt.jsx)(p,{}),(0,jt.jsxs)(Da,{className:"w-full max-w-md shadow-xl",children:[(0,jt.jsxs)(Ma,{className:"text-center space-y-2",children:[(0,jt.jsx)("div",{className:"flex justify-center mb-4",children:(0,jt.jsx)("div",{className:"bg-[#5d87ff] p-3 rounded-full",children:(0,jt.jsx)($a,{className:"h-8 w-8 text-white"})})}),(0,jt.jsx)(Oa,{className:"text-2xl font-bold",children:"Smart Filing System"}),(0,jt.jsx)(Pa,{children:"Digital & IoT-Driven Archive Management"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i("");const n=await c(t,a);n.success?(l(!0),setTimeout(()=>{d("/dashboard")},2e3)):i(n.error)},className:"space-y-4",children:[s&&(0,jt.jsx)(Va,{className:"border-red-200 bg-red-50",children:(0,jt.jsx)(Ua,{className:"text-red-800",children:s})}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{htmlFor:"username",children:"Username"}),(0,jt.jsx)(ba,{id:"username",type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"Enter your username",required:!0})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{htmlFor:"password",children:"Password"}),(0,jt.jsx)(ba,{id:"password",type:"password",value:a,onChange:e=>r(e.target.value),placeholder:"Enter your password",required:!0})]}),(0,jt.jsx)(ga,{type:"submit",className:"w-full bg-[#5d87ff] hover:bg-[#4c75e8] text-white",disabled:u,children:u?(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)(er,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing In..."]}):"Sign In"})]}),(0,jt.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Demo Credentials:"}),(0,jt.jsxs)("div",{className:"text-xs text-gray-600 space-y-1",children:[(0,jt.jsxs)("div",{children:["Archivist: ",(0,jt.jsx)("span",{className:"font-mono",children:"archivist1 / password"})]}),(0,jt.jsxs)("div",{children:["Admin: ",(0,jt.jsx)("span",{className:"font-mono",children:"admin1 / admin123"})]})]})]})]})]})]})},nr=["className","variant"],ar=rn("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function rr(e){let{className:t,variant:n}=e,a=r(e,nr);return(0,jt.jsx)("div",c({className:ha(ar({variant:n}),t)},a))}const sr=["scope","children"];function ir(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[];const s=()=>{const n=a.map(t=>e.createContext(t));return function(a){const r=(null===a||void 0===a?void 0:a[t])||n;return e.useMemo(()=>({["__scope".concat(t)]:c(c({},a),{},{[t]:r})}),[a,r])}};return s.scopeName=t,[function(n,s){const i=e.createContext(s),o=a.length;a=[...a,s];const l=n=>{var a;const{scope:s,children:l}=n,c=r(n,sr),u=(null===s||void 0===s||null===(a=s[t])||void 0===a?void 0:a[o])||i,d=e.useMemo(()=>c,Object.values(c));return(0,jt.jsx)(u.Provider,{value:d,children:l})};return l.displayName=n+"Provider",[l,function(a,r){var l;const c=(null===r||void 0===r||null===(l=r[t])||void 0===l?void 0:l[o])||i,u=e.useContext(c);if(u)return u;if(void 0!==s)return s;throw new Error("`".concat(a,"` must be used within `").concat(n,"`"))}]},or(s,...n)]}function or(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];const r=n[0];if(1===n.length)return r;const s=()=>{const t=n.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(n){const a=t.reduce((e,t)=>{let{useScope:a,scopeName:r}=t;const s=a(n)["__scope".concat(r)];return c(c({},e),s)},{});return e.useMemo(()=>({["__scope".concat(r.scopeName)]:a}),[a])}};return s.scopeName=r.scopeName,s}const lr=["__scopeProgress","value","max","getValueLabel"],cr=["__scopeProgress"];var ur="Progress",dr=100,[pr,hr]=ir(ur),[fr,mr]=pr(ur),gr=e.forwardRef((e,t)=>{const{__scopeProgress:n,value:a=null,max:s,getValueLabel:i=vr}=e,o=r(e,lr);var l,u;!s&&0!==s||kr(s)||console.error((l="".concat(s),u="Progress","Invalid prop `max` of value `".concat(l,"` supplied to `").concat(u,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(dr,"`.")));const d=kr(s)?s:dr;null===a||Sr(a,d)||console.error(function(e,t){return"Invalid prop `value` of value `".concat(e,"` supplied to `").concat(t,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(dr," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")}("".concat(a),"Progress"));const p=Sr(a,d)?a:null,h=wr(p)?i(p,d):void 0;return(0,jt.jsx)(fr,{scope:n,value:p,max:d,children:(0,jt.jsx)(wa.div,c(c({"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":wr(p)?p:void 0,"aria-valuetext":h,role:"progressbar","data-state":xr(p,d),"data-value":null!==p&&void 0!==p?p:void 0,"data-max":d},o),{},{ref:t}))})});gr.displayName=ur;var yr="ProgressIndicator",br=e.forwardRef((e,t)=>{var n;const{__scopeProgress:a}=e,s=r(e,cr),i=mr(yr,a);return(0,jt.jsx)(wa.div,c(c({"data-state":xr(i.value,i.max),"data-value":null!==(n=i.value)&&void 0!==n?n:void 0,"data-max":i.max},s),{},{ref:t}))});function vr(e,t){return"".concat(Math.round(e/t*100),"%")}function xr(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function wr(e){return"number"===typeof e}function kr(e){return wr(e)&&!isNaN(e)&&e>0}function Sr(e,t){return wr(e)&&!isNaN(e)&&e<=t&&e>=0}br.displayName=yr;var Nr=gr,Ir=br;const Cr=["className","value"],Tr=e.forwardRef((e,t)=>{let{className:n,value:a}=e,s=r(e,Cr);return(0,jt.jsx)(Nr,c(c({ref:t,className:ha("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",n)},s),{},{children:(0,jt.jsx)(Ir,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})}))});Tr.displayName=Nr.displayName;const Er=Qa("trending-up",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),_r=Qa("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),Ar=Qa("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Rr=Qa("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Fr=Qa("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Dr=Qa("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Mr=Qa("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),Or=()=>{const{user:e}=Wt(),t=e=>{let{title:t,value:n,icon:a,description:r,trend:s}=e;return(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:t}),(0,jt.jsx)(a,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsx)("div",{className:"text-2xl font-bold",children:n}),r&&(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:r}),s&&(0,jt.jsxs)("div",{className:"flex items-center mt-2",children:[(0,jt.jsx)(Er,{className:"h-3 w-3 text-green-500 mr-1"}),(0,jt.jsx)("span",{className:"text-xs text-green-500",children:s})]})]})]})},n=e=>{switch(e){case"Available":return"bg-green-100 text-green-800";case"Borrowed":return"bg-blue-100 text-blue-800";case"Overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=It.slice(0,5),r=_t.slice(0,5);return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"bg-gradient-to-r from-[#5d87ff] to-[#4c75e8] text-white p-6 rounded-lg",children:[(0,jt.jsxs)("h1",{className:"text-2xl font-bold mb-2",children:["Welcome back, ",null===e||void 0===e?void 0:e.name,"!"]}),(0,jt.jsx)("p",{className:"text-blue-100",children:"Admin"===(null===e||void 0===e?void 0:e.role)?"Manage your archive system and monitor all activities.":"Access and manage documents in the smart filing system."})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,jt.jsx)(t,{title:"Total Documents",value:Rt,icon:$a,description:"Documents in system",trend:"+12% from last month"}),(0,jt.jsx)(t,{title:"Available",value:Ft,icon:_r,description:"Ready for access"}),(0,jt.jsx)(t,{title:"Borrowed",value:Dt,icon:Ar,description:"Currently checked out"}),(0,jt.jsx)(t,{title:"Overdue",value:Mt,icon:Rr,description:"Require attention"})]}),"Admin"===(null===e||void 0===e?void 0:e.role)&&(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,jt.jsx)(t,{title:"Active Users",value:Pt,icon:Fr,description:"of ".concat(Ot," total users")}),(0,jt.jsx)(t,{title:"Security Alerts",value:Lt,icon:Dr,description:"Require review"}),(0,jt.jsx)(t,{title:"System Health",value:"".concat(zt,"%"),icon:Mr,description:"All systems operational"})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Recent Documents"}),(0,jt.jsx)(Pa,{children:"Latest registered documents"})]}),(0,jt.jsx)(La,{children:(0,jt.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,jt.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("h4",{className:"font-medium text-sm",children:e.title}),(0,jt.jsx)("p",{className:"text-xs text-gray-600",children:e.physicalLocation}),(0,jt.jsxs)("p",{className:"text-xs text-gray-500",children:["Year: ",e.year]})]}),(0,jt.jsx)(rr,{className:n(e.status),children:e.status})]},e.id))})})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Recent Activity"}),(0,jt.jsx)(Pa,{children:"Latest system activities"})]}),(0,jt.jsx)(La,{children:(0,jt.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,jt.jsxs)("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[(0,jt.jsx)("div",{className:"p-1 rounded-full ".concat("Success"===e.status?"bg-green-100":"bg-red-100"),children:(0,jt.jsx)(Mr,{className:"h-3 w-3 ".concat("Success"===e.status?"text-green-600":"text-red-600")})}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("p",{className:"text-sm font-medium",children:e.action}),(0,jt.jsx)("p",{className:"text-xs text-gray-600",children:e.document}),(0,jt.jsxs)("p",{className:"text-xs text-gray-500",children:["by ",e.user]}),(0,jt.jsx)("p",{className:"text-xs text-gray-400",children:e.timestamp})]})]},e.id))})})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"System Status"}),(0,jt.jsx)(Pa,{children:"Current system health and performance"})]}),(0,jt.jsx)(La,{children:(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,jt.jsx)("span",{children:"Storage Capacity"}),(0,jt.jsx)("span",{children:"78%"})]}),(0,jt.jsx)(Tr,{value:78,className:"h-2"})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,jt.jsx)("span",{children:"IoT Sensors"}),(0,jt.jsx)("span",{children:"96%"})]}),(0,jt.jsx)(Tr,{value:96,className:"h-2"})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,jt.jsx)("span",{children:"Network Status"}),(0,jt.jsx)("span",{children:"99%"})]}),(0,jt.jsx)(Tr,{value:99,className:"h-2"})]})]})})]})]})};function Pr(e,t){let[n,a]=t;return Math.min(a,Math.max(n,e))}var Lr;"undefined"===typeof window||!window.document||window.document.createElement;function zr(e,t){let{checkForDefaultPrevented:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(a){if(null===e||void 0===e||e(a),!1===n||!a.defaultPrevented)return null===t||void 0===t?void 0:t(a)}}function jr(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Br(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function Wr(e,t){return e.get(Br(e,t))}function Vr(e,t,n){return e.set(Br(e,t),n),n}const Ur=["scope","children"];function Hr(t){const n=t+"CollectionProvider",[a,s]=ir(n),[i,o]=a(n,{collectionRef:{current:null},itemMap:new Map}),l=t=>{const{scope:n,children:a}=t,r=e.useRef(null),s=e.useRef(new Map).current;return(0,jt.jsx)(i,{scope:n,itemMap:s,collectionRef:r,children:a})};l.displayName=n;const u=t+"CollectionSlot",d=Xt(u),p=e.forwardRef((e,t)=>{const{scope:n,children:a}=e,r=Gt(t,o(u,n).collectionRef);return(0,jt.jsx)(d,{ref:r,children:a})});p.displayName=u;const h=t+"CollectionItemSlot",f="data-radix-collection-item",m=Xt(h),g=e.forwardRef((t,n)=>{const{scope:a,children:s}=t,i=r(t,Ur),l=e.useRef(null),u=Gt(n,l),d=o(h,a);return e.useEffect(()=>(d.itemMap.set(l,c({ref:l},i)),()=>{d.itemMap.delete(l)})),(0,jt.jsx)(m,c(c({},{[f]:""}),{},{ref:u,children:s}))});return g.displayName=h,[{Provider:l,Slot:p,ItemSlot:g},function(n){const a=o(t+"CollectionConsumer",n);return e.useCallback(()=>{const e=a.collectionRef.current;if(!e)return[];const t=Array.from(e.querySelectorAll("[".concat(f,"]")));return Array.from(a.itemMap.values()).sort((e,n)=>t.indexOf(e.ref.current)-t.indexOf(n.ref.current))},[a.collectionRef,a.itemMap])},s]}var Gr=new WeakMap;Lr=new WeakMap,Map;function qr(e,t){if("at"in Array.prototype)return Array.prototype.at.call(e,t);const n=function(e,t){const n=e.length,a=Kr(t),r=a>=0?a:n+a;return r<0||r>=n?-1:r}(e,t);return-1===n?void 0:e[n]}function Kr(e){return e!==e||0===e?0:Math.trunc(e)}var Xr=e.createContext(void 0);function Yr(t){const n=e.useContext(Xr);return t||n||"ltr"}function Qr(t){const n=e.useRef(t);return e.useEffect(()=>{n.current=t}),e.useMemo(()=>function(){for(var e,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return null===(e=n.current)||void 0===e?void 0:e.call(n,...a)},[])}const Jr=["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"];var Zr,$r="dismissableLayer.update",es="dismissableLayer.pointerDownOutside",ts="dismissableLayer.focusOutside",ns=e.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),as=e.forwardRef((t,n)=>{var a;const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:l,onInteractOutside:u,onDismiss:d}=t,p=r(t,Jr),h=e.useContext(ns),[f,m]=e.useState(null),g=null!==(a=null===f||void 0===f?void 0:f.ownerDocument)&&void 0!==a?a:null===globalThis||void 0===globalThis?void 0:globalThis.document,[,y]=e.useState({}),b=Gt(n,e=>m(e)),v=Array.from(h.layers),[x]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),w=v.indexOf(x),k=f?v.indexOf(f):-1,S=h.layersWithOutsidePointerEventsDisabled.size>0,N=k>=w,I=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document;const a=Qr(t),r=e.useRef(!1),s=e.useRef(()=>{});return e.useEffect(()=>{const e=e=>{if(e.target&&!r.current){let t=function(){is(es,a,r,{discrete:!0})};const r={originalEvent:e};"touch"===e.pointerType?(n.removeEventListener("click",s.current),s.current=t,n.addEventListener("click",s.current,{once:!0})):t()}else n.removeEventListener("click",s.current);r.current=!1},t=window.setTimeout(()=>{n.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",s.current)}},[n,a]),{onPointerDownCapture:()=>r.current=!0}}(e=>{const t=e.target,n=[...h.branches].some(e=>e.contains(t));N&&!n&&(null===o||void 0===o||o(e),null===u||void 0===u||u(e),e.defaultPrevented||null===d||void 0===d||d())},g),C=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document;const a=Qr(t),r=e.useRef(!1);return e.useEffect(()=>{const e=e=>{if(e.target&&!r.current){is(ts,a,{originalEvent:e},{discrete:!1})}};return n.addEventListener("focusin",e),()=>n.removeEventListener("focusin",e)},[n,a]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}(e=>{const t=e.target;[...h.branches].some(e=>e.contains(t))||(null===l||void 0===l||l(e),null===u||void 0===u||u(e),e.defaultPrevented||null===d||void 0===d||d())},g);return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document;const a=Qr(t);e.useEffect(()=>{const e=e=>{"Escape"===e.key&&a(e)};return n.addEventListener("keydown",e,{capture:!0}),()=>n.removeEventListener("keydown",e,{capture:!0})},[a,n])}(e=>{k===h.layers.size-1&&(null===i||void 0===i||i(e),!e.defaultPrevented&&d&&(e.preventDefault(),d()))},g),e.useEffect(()=>{if(f)return s&&(0===h.layersWithOutsidePointerEventsDisabled.size&&(Zr=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(f)),h.layers.add(f),ss(),()=>{s&&1===h.layersWithOutsidePointerEventsDisabled.size&&(g.body.style.pointerEvents=Zr)}},[f,g,s,h]),e.useEffect(()=>()=>{f&&(h.layers.delete(f),h.layersWithOutsidePointerEventsDisabled.delete(f),ss())},[f,h]),e.useEffect(()=>{const e=()=>y({});return document.addEventListener($r,e),()=>document.removeEventListener($r,e)},[]),(0,jt.jsx)(wa.div,c(c({},p),{},{ref:b,style:c({pointerEvents:S?N?"auto":"none":void 0},t.style),onFocusCapture:zr(t.onFocusCapture,C.onFocusCapture),onBlurCapture:zr(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:zr(t.onPointerDownCapture,I.onPointerDownCapture)}))});as.displayName="DismissableLayer";var rs=e.forwardRef((t,n)=>{const a=e.useContext(ns),r=e.useRef(null),s=Gt(n,r);return e.useEffect(()=>{const e=r.current;if(e)return a.branches.add(e),()=>{a.branches.delete(e)}},[a.branches]),(0,jt.jsx)(wa.div,c(c({},t),{},{ref:s}))});function ss(){const e=new CustomEvent($r);document.dispatchEvent(e)}function is(e,t,n,a){let{discrete:r}=a;const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?function(e,t){e&&va.flushSync(()=>e.dispatchEvent(t))}(s,i):s.dispatchEvent(i)}rs.displayName="DismissableLayerBranch";var os=0;function ls(){e.useEffect(()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:cs()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:cs()),os++,()=>{1===os&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),os--}},[])}function cs(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}const us=["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"];var ds="focusScope.autoFocusOnMount",ps="focusScope.autoFocusOnUnmount",hs={bubbles:!1,cancelable:!0},fs=e.forwardRef((t,n)=>{const{loop:a=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:o}=t,l=r(t,us),[u,d]=e.useState(null),p=Qr(i),h=Qr(o),f=e.useRef(null),m=Gt(n,e=>d(e)),g=e.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;e.useEffect(()=>{if(s){let e=function(e){if(g.paused||!u)return;const t=e.target;u.contains(t)?f.current=t:bs(f.current,{select:!0})},t=function(e){if(g.paused||!u)return;const t=e.relatedTarget;null!==t&&(u.contains(t)||bs(f.current,{select:!0}))},n=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&bs(u)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const a=new MutationObserver(n);return u&&a.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),a.disconnect()}}},[s,u,g.paused]),e.useEffect(()=>{if(u){vs.add(g);const t=document.activeElement;if(!u.contains(t)){const n=new CustomEvent(ds,hs);u.addEventListener(ds,p),u.dispatchEvent(n),n.defaultPrevented||(!function(e){let{select:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=document.activeElement;for(const a of e)if(bs(a,{select:t}),document.activeElement!==n)return}((e=ms(u),e.filter(e=>"A"!==e.tagName)),{select:!0}),document.activeElement===t&&bs(u))}return()=>{u.removeEventListener(ds,p),setTimeout(()=>{const e=new CustomEvent(ps,hs);u.addEventListener(ps,h),u.dispatchEvent(e),e.defaultPrevented||bs(null!==t&&void 0!==t?t:document.body,{select:!0}),u.removeEventListener(ps,h),vs.remove(g)},0)}}var e},[u,p,h,g]);const y=e.useCallback(e=>{if(!a&&!s)return;if(g.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){const t=e.currentTarget,[r,s]=function(e){const t=ms(e),n=gs(t,e),a=gs(t.reverse(),e);return[n,a]}(t);r&&s?e.shiftKey||n!==s?e.shiftKey&&n===r&&(e.preventDefault(),a&&bs(s,{select:!0})):(e.preventDefault(),a&&bs(r,{select:!0})):n===t&&e.preventDefault()}},[a,s,g.paused]);return(0,jt.jsx)(wa.div,c(c({tabIndex:-1},l),{},{ref:m,onKeyDown:y}))});function ms(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function gs(e,t){for(const n of e)if(!ys(n,{upTo:t}))return n}function ys(e,t){let{upTo:n}=t;if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==n&&e===n)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function bs(e){let{select:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}fs.displayName="FocusScope";var vs=function(){let e=[];return{add(t){const n=e[0];t!==n&&(null===n||void 0===n||n.pause()),e=xs(e,t),e.unshift(t)},remove(t){var n;e=xs(e,t),null===(n=e[0])||void 0===n||n.resume()}}}();function xs(e,t){const n=[...e],a=n.indexOf(t);return-1!==a&&n.splice(a,1),n}var ws=null!==globalThis&&void 0!==globalThis&&globalThis.document?e.useLayoutEffect:()=>{},ks=t[" useId ".trim().toString()]||(()=>{}),Ss=0;function Ns(t){const[n,a]=e.useState(ks());return ws(()=>{t||a(e=>null!==e&&void 0!==e?e:String(Ss++))},[t]),t||(n?"radix-".concat(n):"")}const Is=["top","right","bottom","left"],Cs=Math.min,Ts=Math.max,Es=Math.round,_s=Math.floor,As=e=>({x:e,y:e}),Rs={left:"right",right:"left",bottom:"top",top:"bottom"},Fs={start:"end",end:"start"};function Ds(e,t,n){return Ts(e,Cs(t,n))}function Ms(e,t){return"function"===typeof e?e(t):e}function Os(e){return e.split("-")[0]}function Ps(e){return e.split("-")[1]}function Ls(e){return"x"===e?"y":"x"}function zs(e){return"y"===e?"height":"width"}const js=new Set(["top","bottom"]);function Bs(e){return js.has(Os(e))?"y":"x"}function Ws(e){return Ls(Bs(e))}function Vs(e){return e.replace(/start|end/g,e=>Fs[e])}const Us=["left","right"],Hs=["right","left"],Gs=["top","bottom"],qs=["bottom","top"];function Ks(e,t,n,a){const r=Ps(e);let s=function(e,t,n){switch(e){case"top":case"bottom":return n?t?Hs:Us:t?Us:Hs;case"left":case"right":return t?Gs:qs;default:return[]}}(Os(e),"start"===n,a);return r&&(s=s.map(e=>e+"-"+r),t&&(s=s.concat(s.map(Vs)))),s}function Xs(e){return e.replace(/left|right|bottom|top/g,e=>Rs[e])}function Ys(e){return"number"!==typeof e?function(e){return c({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function Qs(e){const{x:t,y:n,width:a,height:r}=e;return{width:a,height:r,top:n,left:t,right:t+a,bottom:n+r,x:t,y:n}}const Js=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],Zs=["strategy"],$s=["mainAxis","crossAxis","limiter"],ei=["apply"];function ti(e,t,n){let{reference:a,floating:r}=e;const s=Bs(t),i=Ws(t),o=zs(i),l=Os(t),c="y"===s,u=a.x+a.width/2-r.width/2,d=a.y+a.height/2-r.height/2,p=a[o]/2-r[o]/2;let h;switch(l){case"top":h={x:u,y:a.y-r.height};break;case"bottom":h={x:u,y:a.y+a.height};break;case"right":h={x:a.x+a.width,y:d};break;case"left":h={x:a.x-r.width,y:d};break;default:h={x:a.x,y:a.y}}switch(Ps(t)){case"start":h[i]-=p*(n&&c?-1:1);break;case"end":h[i]+=p*(n&&c?-1:1)}return h}async function ni(e,t){var n;void 0===t&&(t={});const{x:a,y:r,platform:s,rects:i,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:h=0}=Ms(t,e),f=Ys(h),m=o[p?"floating"===d?"reference":"floating":d],g=Qs(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(m)))||n?m:m.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),y="floating"===d?{x:a,y:r,width:i.floating.width,height:i.floating.height}:i.reference,b=await(null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),v=await(null==s.isElement?void 0:s.isElement(b))&&await(null==s.getScale?void 0:s.getScale(b))||{x:1,y:1},x=Qs(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:y,offsetParent:b,strategy:l}):y);return{top:(g.top-x.top+f.top)/v.y,bottom:(x.bottom-g.bottom+f.bottom)/v.y,left:(g.left-x.left+f.left)/v.x,right:(x.right-g.right+f.right)/v.x}}function ai(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function ri(e){return Is.some(t=>e[t]>=0)}const si=new Set(["left","top"]);function ii(){return"undefined"!==typeof window}function oi(e){return ui(e)?(e.nodeName||"").toLowerCase():"#document"}function li(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function ci(e){var t;return null==(t=(ui(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function ui(e){return!!ii()&&(e instanceof Node||e instanceof li(e).Node)}function di(e){return!!ii()&&(e instanceof Element||e instanceof li(e).Element)}function pi(e){return!!ii()&&(e instanceof HTMLElement||e instanceof li(e).HTMLElement)}function hi(e){return!(!ii()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof li(e).ShadowRoot)}const fi=new Set(["inline","contents"]);function mi(e){const{overflow:t,overflowX:n,overflowY:a,display:r}=Ti(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+n)&&!fi.has(r)}const gi=new Set(["table","td","th"]);function yi(e){return gi.has(oi(e))}const bi=[":popover-open",":modal"];function vi(e){return bi.some(t=>{try{return e.matches(t)}catch(uh){return!1}})}const xi=["transform","translate","scale","rotate","perspective"],wi=["transform","translate","scale","rotate","perspective","filter"],ki=["paint","layout","strict","content"];function Si(e){const t=Ni(),n=di(e)?Ti(e):e;return xi.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||wi.some(e=>(n.willChange||"").includes(e))||ki.some(e=>(n.contain||"").includes(e))}function Ni(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const Ii=new Set(["html","body","#document"]);function Ci(e){return Ii.has(oi(e))}function Ti(e){return li(e).getComputedStyle(e)}function Ei(e){return di(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function _i(e){if("html"===oi(e))return e;const t=e.assignedSlot||e.parentNode||hi(e)&&e.host||ci(e);return hi(t)?t.host:t}function Ai(e){const t=_i(e);return Ci(t)?e.ownerDocument?e.ownerDocument.body:e.body:pi(t)&&mi(t)?t:Ai(t)}function Ri(e,t,n){var a;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=Ai(e),s=r===(null==(a=e.ownerDocument)?void 0:a.body),i=li(r);if(s){const e=Fi(i);return t.concat(i,i.visualViewport||[],mi(r)?r:[],e&&n?Ri(e):[])}return t.concat(r,Ri(r,[],n))}function Fi(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Di(e){const t=Ti(e);let n=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const r=pi(e),s=r?e.offsetWidth:n,i=r?e.offsetHeight:a,o=Es(n)!==s||Es(a)!==i;return o&&(n=s,a=i),{width:n,height:a,$:o}}function Mi(e){return di(e)?e:e.contextElement}function Oi(e){const t=Mi(e);if(!pi(t))return As(1);const n=t.getBoundingClientRect(),{width:a,height:r,$:s}=Di(t);let i=(s?Es(n.width):n.width)/a,o=(s?Es(n.height):n.height)/r;return i&&Number.isFinite(i)||(i=1),o&&Number.isFinite(o)||(o=1),{x:i,y:o}}const Pi=As(0);function Li(e){const t=li(e);return Ni()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Pi}function zi(e,t,n,a){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),s=Mi(e);let i=As(1);t&&(a?di(a)&&(i=Oi(a)):i=Oi(e));const o=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==li(e))&&t}(s,n,a)?Li(s):As(0);let l=(r.left+o.x)/i.x,c=(r.top+o.y)/i.y,u=r.width/i.x,d=r.height/i.y;if(s){const e=li(s),t=a&&di(a)?li(a):a;let n=e,r=Fi(n);for(;r&&a&&t!==n;){const e=Oi(r),t=r.getBoundingClientRect(),a=Ti(r),s=t.left+(r.clientLeft+parseFloat(a.paddingLeft))*e.x,i=t.top+(r.clientTop+parseFloat(a.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=s,c+=i,n=li(r),r=Fi(n)}}return Qs({width:u,height:d,x:l,y:c})}function ji(e,t){const n=Ei(e).scrollLeft;return t?t.left+n:zi(ci(e)).left+n}function Bi(e,t){const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-ji(e,n),y:n.top+t.scrollTop}}const Wi=new Set(["absolute","fixed"]);function Vi(e,t,n){let a;if("viewport"===t)a=function(e,t){const n=li(e),a=ci(e),r=n.visualViewport;let s=a.clientWidth,i=a.clientHeight,o=0,l=0;if(r){s=r.width,i=r.height;const e=Ni();(!e||e&&"fixed"===t)&&(o=r.offsetLeft,l=r.offsetTop)}const c=ji(a);if(c<=0){const e=a.ownerDocument,t=e.body,n=getComputedStyle(t),r="CSS1Compat"===e.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,i=Math.abs(a.clientWidth-t.clientWidth-r);i<=25&&(s-=i)}else c<=25&&(s+=c);return{width:s,height:i,x:o,y:l}}(e,n);else if("document"===t)a=function(e){const t=ci(e),n=Ei(e),a=e.ownerDocument.body,r=Ts(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),s=Ts(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let i=-n.scrollLeft+ji(e);const o=-n.scrollTop;return"rtl"===Ti(a).direction&&(i+=Ts(t.clientWidth,a.clientWidth)-r),{width:r,height:s,x:i,y:o}}(ci(e));else if(di(t))a=function(e,t){const n=zi(e,!0,"fixed"===t),a=n.top+e.clientTop,r=n.left+e.clientLeft,s=pi(e)?Oi(e):As(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:r*s.x,y:a*s.y}}(t,n);else{const n=Li(e);a={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return Qs(a)}function Ui(e,t){const n=_i(e);return!(n===t||!di(n)||Ci(n))&&("fixed"===Ti(n).position||Ui(n,t))}function Hi(e,t,n){const a=pi(t),r=ci(t),s="fixed"===n,i=zi(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=As(0);function c(){l.x=ji(r)}if(a||!a&&!s)if(("body"!==oi(t)||mi(r))&&(o=Ei(t)),a){const e=zi(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&c();s&&!a&&r&&c();const u=!r||a||s?As(0):Bi(r,o);return{x:i.left+o.scrollLeft-l.x-u.x,y:i.top+o.scrollTop-l.y-u.y,width:i.width,height:i.height}}function Gi(e){return"static"===Ti(e).position}function qi(e,t){if(!pi(e)||"fixed"===Ti(e).position)return null;if(t)return t(e);let n=e.offsetParent;return ci(e)===n&&(n=n.ownerDocument.body),n}function Ki(e,t){const n=li(e);if(vi(e))return n;if(!pi(e)){let t=_i(e);for(;t&&!Ci(t);){if(di(t)&&!Gi(t))return t;t=_i(t)}return n}let a=qi(e,t);for(;a&&yi(a)&&Gi(a);)a=qi(a,t);return a&&Ci(a)&&Gi(a)&&!Si(a)?n:a||function(e){let t=_i(e);for(;pi(t)&&!Ci(t);){if(Si(t))return t;if(vi(t))return null;t=_i(t)}return null}(e)||n}const Xi={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:a,strategy:r}=e;const s="fixed"===r,i=ci(a),o=!!t&&vi(t.floating);if(a===i||o&&s)return n;let l={scrollLeft:0,scrollTop:0},c=As(1);const u=As(0),d=pi(a);if((d||!d&&!s)&&(("body"!==oi(a)||mi(i))&&(l=Ei(a)),pi(a))){const e=zi(a);c=Oi(a),u.x=e.x+a.clientLeft,u.y=e.y+a.clientTop}const p=!i||d||s?As(0):Bi(i,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+p.x,y:n.y*c.y-l.scrollTop*c.y+u.y+p.y}},getDocumentElement:ci,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:a,strategy:r}=e;const s="clippingAncestors"===n?vi(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let a=Ri(e,[],!1).filter(e=>di(e)&&"body"!==oi(e)),r=null;const s="fixed"===Ti(e).position;let i=s?_i(e):e;for(;di(i)&&!Ci(i);){const t=Ti(i),n=Si(i);n||"fixed"!==t.position||(r=null),(s?!n&&!r:!n&&"static"===t.position&&r&&Wi.has(r.position)||mi(i)&&!n&&Ui(e,i))?a=a.filter(e=>e!==i):r=t,i=_i(i)}return t.set(e,a),a}(t,this._c):[].concat(n),i=[...s,a],o=i[0],l=i.reduce((e,n)=>{const a=Vi(t,n,r);return e.top=Ts(a.top,e.top),e.right=Cs(a.right,e.right),e.bottom=Cs(a.bottom,e.bottom),e.left=Ts(a.left,e.left),e},Vi(t,o,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:Ki,getElementRects:async function(e){const t=this.getOffsetParent||Ki,n=this.getDimensions,a=await n(e.floating);return{reference:Hi(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Di(e);return{width:t,height:n}},getScale:Oi,isElement:di,isRTL:function(e){return"rtl"===Ti(e).direction}};function Yi(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Qi(e,t,n,a){void 0===a&&(a={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:i="function"===typeof ResizeObserver,layoutShift:o="function"===typeof IntersectionObserver,animationFrame:l=!1}=a,u=Mi(e),d=r||s?[...u?Ri(u):[],...Ri(t)]:[];d.forEach(e=>{r&&e.addEventListener("scroll",n,{passive:!0}),s&&e.addEventListener("resize",n)});const p=u&&o?function(e,t){let n,a=null;const r=ci(e);function s(){var e;clearTimeout(n),null==(e=a)||e.disconnect(),a=null}return function i(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();const u=e.getBoundingClientRect(),{left:d,top:p,width:h,height:f}=u;if(o||t(),!h||!f)return;const m={rootMargin:-_s(p)+"px "+-_s(r.clientWidth-(d+h))+"px "+-_s(r.clientHeight-(p+f))+"px "+-_s(d)+"px",threshold:Ts(0,Cs(1,l))||1};let g=!0;function y(t){const a=t[0].intersectionRatio;if(a!==l){if(!g)return i();a?i(!1,a):n=setTimeout(()=>{i(!1,1e-7)},1e3)}1!==a||Yi(u,e.getBoundingClientRect())||i(),g=!1}try{a=new IntersectionObserver(y,c(c({},m),{},{root:r.ownerDocument}))}catch(uh){a=new IntersectionObserver(y,m)}a.observe(e)}(!0),s}(u,n):null;let h,f=-1,m=null;i&&(m=new ResizeObserver(e=>{let[a]=e;a&&a.target===u&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;null==(e=m)||e.observe(t)})),n()}),u&&!l&&m.observe(u),m.observe(t));let g=l?zi(e):null;return l&&function t(){const a=zi(e);g&&!Yi(g,a)&&n();g=a,h=requestAnimationFrame(t)}(),n(),()=>{var e;d.forEach(e=>{r&&e.removeEventListener("scroll",n),s&&e.removeEventListener("resize",n)}),null==p||p(),null==(e=m)||e.disconnect(),m=null,l&&cancelAnimationFrame(h)}}const Ji=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,a;const{x:r,y:s,placement:i,middlewareData:o}=t,l=await async function(e,t){const{placement:n,platform:a,elements:r}=e,s=await(null==a.isRTL?void 0:a.isRTL(r.floating)),i=Os(n),o=Ps(n),l="y"===Bs(n),c=si.has(i)?-1:1,u=s&&l?-1:1,d=Ms(t,e);let{mainAxis:p,crossAxis:h,alignmentAxis:f}="number"===typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&"number"===typeof f&&(h="end"===o?-1*f:f),l?{x:h*u,y:p*c}:{x:p*c,y:h*u}}(t,e);return i===(null==(n=o.offset)?void 0:n.placement)&&null!=(a=o.arrow)&&a.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:c(c({},l),{},{placement:i})}}}},Zi=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:a,placement:s}=t,i=Ms(e,t),{mainAxis:o=!0,crossAxis:l=!1,limiter:u={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}}}=i,d=r(i,$s),p={x:n,y:a},h=await ni(t,d),f=Bs(Os(s)),m=Ls(f);let g=p[m],y=p[f];if(o){const e="y"===m?"bottom":"right";g=Ds(g+h["y"===m?"top":"left"],g,g-h[e])}if(l){const e="y"===f?"bottom":"right";y=Ds(y+h["y"===f?"top":"left"],y,y-h[e])}const b=u.fn(c(c({},t),{},{[m]:g,[f]:y}));return c(c({},b),{},{data:{x:b.x-n,y:b.y-a,enabled:{[m]:o,[f]:l}}})}}},$i=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,a;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=t,d=Ms(e,t),{mainAxis:p=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:y=!0}=d,b=r(d,Js);if(null!=(n=i.arrow)&&n.alignmentOffset)return{};const v=Os(s),x=Bs(l),w=Os(l)===l,k=await(null==c.isRTL?void 0:c.isRTL(u.floating)),S=f||(w||!y?[Xs(l)]:function(e){const t=Xs(e);return[Vs(e),t,Vs(t)]}(l)),N="none"!==g;!f&&N&&S.push(...Ks(l,y,g,k));const I=[l,...S],C=await ni(t,b),T=[];let E=(null==(a=i.flip)?void 0:a.overflows)||[];if(p&&T.push(C[v]),h){const e=function(e,t,n){void 0===n&&(n=!1);const a=Ps(e),r=Ws(e),s=zs(r);let i="x"===r?a===(n?"end":"start")?"right":"left":"start"===a?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=Xs(i)),[i,Xs(i)]}(s,o,k);T.push(C[e[0]],C[e[1]])}if(E=[...E,{placement:s,overflows:T}],!T.every(e=>e<=0)){var _,A;const e=((null==(_=i.flip)?void 0:_.index)||0)+1,t=I[e];if(t){if(!("alignment"===h&&x!==Bs(t))||E.every(e=>Bs(e.placement)!==x||e.overflows[0]>0))return{data:{index:e,overflows:E},reset:{placement:t}}}let n=null==(A=E.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:A.placement;if(!n)switch(m){case"bestFit":{var R;const e=null==(R=E.filter(e=>{if(N){const t=Bs(e.placement);return t===x||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:R[0];e&&(n=e);break}case"initialPlacement":n=l}if(s!==n)return{reset:{placement:n}}}return{}}}},eo=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var n,a;const{placement:s,rects:i,platform:o,elements:l}=t,u=Ms(e,t),{apply:d=()=>{}}=u,p=r(u,ei),h=await ni(t,p),f=Os(s),m=Ps(s),g="y"===Bs(s),{width:y,height:b}=i.floating;let v,x;"top"===f||"bottom"===f?(v=f,x=m===(await(null==o.isRTL?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(x=f,v="end"===m?"top":"bottom");const w=b-h.top-h.bottom,k=y-h.left-h.right,S=Cs(b-h[v],w),N=Cs(y-h[x],k),I=!t.middlewareData.shift;let C=S,T=N;if(null!=(n=t.middlewareData.shift)&&n.enabled.x&&(T=k),null!=(a=t.middlewareData.shift)&&a.enabled.y&&(C=w),I&&!m){const e=Ts(h.left,0),t=Ts(h.right,0),n=Ts(h.top,0),a=Ts(h.bottom,0);g?T=y-2*(0!==e||0!==t?e+t:Ts(h.left,h.right)):C=b-2*(0!==n||0!==a?n+a:Ts(h.top,h.bottom))}await d(c(c({},t),{},{availableWidth:T,availableHeight:C}));const E=await o.getDimensions(l.floating);return y!==E.width||b!==E.height?{reset:{rects:!0}}:{}}}},to=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,a=Ms(e,t),{strategy:s="referenceHidden"}=a,i=r(a,Zs);switch(s){case"referenceHidden":{const e=ai(await ni(t,c(c({},i),{},{elementContext:"reference"})),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:ri(e)}}}case"escaped":{const e=ai(await ni(t,c(c({},i),{},{altBoundary:!0})),n.floating);return{data:{escapedOffsets:e,escaped:ri(e)}}}default:return{}}}}},no=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:a,placement:r,rects:s,platform:i,elements:o,middlewareData:l}=t,{element:u,padding:d=0}=Ms(e,t)||{};if(null==u)return{};const p=Ys(d),h={x:n,y:a},f=Ws(r),m=zs(f),g=await i.getDimensions(u),y="y"===f,b=y?"top":"left",v=y?"bottom":"right",x=y?"clientHeight":"clientWidth",w=s.reference[m]+s.reference[f]-h[f]-s.floating[m],k=h[f]-s.reference[f],S=await(null==i.getOffsetParent?void 0:i.getOffsetParent(u));let N=S?S[x]:0;N&&await(null==i.isElement?void 0:i.isElement(S))||(N=o.floating[x]||s.floating[m]);const I=w/2-k/2,C=N/2-g[m]/2-1,T=Cs(p[b],C),E=Cs(p[v],C),_=T,A=N-g[m]-E,R=N/2-g[m]/2+I,F=Ds(_,R,A),D=!l.arrow&&null!=Ps(r)&&R!==F&&s.reference[m]/2-(R<_?T:E)-g[m]/2<0,M=D?R<_?R-_:R-A:0;return{[f]:h[f]+M,data:c({[f]:F,centerOffset:R-F-M},D&&{alignmentOffset:M}),reset:D}}}),ao=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:a,placement:r,rects:s,middlewareData:i}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=Ms(e,t),d={x:n,y:a},p=Bs(r),h=Ls(p);let f=d[h],m=d[p];const g=Ms(o,t),y="number"===typeof g?{mainAxis:g,crossAxis:0}:c({mainAxis:0,crossAxis:0},g);if(l){const e="y"===h?"height":"width",t=s.reference[h]-s.floating[e]+y.mainAxis,n=s.reference[h]+s.reference[e]-y.mainAxis;f<t?f=t:f>n&&(f=n)}if(u){var b,v;const e="y"===h?"width":"height",t=si.has(Os(r)),n=s.reference[p]-s.floating[e]+(t&&(null==(b=i.offset)?void 0:b[p])||0)+(t?0:y.crossAxis),a=s.reference[p]+s.reference[e]+(t?0:(null==(v=i.offset)?void 0:v[p])||0)-(t?y.crossAxis:0);m<n?m=n:m>a&&(m=a)}return{[h]:f,[p]:m}}}},ro=(e,t,n)=>{const a=new Map,r=c({platform:Xi},n),s=c(c({},r.platform),{},{_c:a});return(async(e,t,n)=>{const{placement:a="bottom",strategy:r="absolute",middleware:s=[],platform:i}=n,o=s.filter(Boolean),l=await(null==i.isRTL?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:r}),{x:d,y:p}=ti(u,a,l),h=a,f={},m=0;for(let g=0;g<o.length;g++){const{name:n,fn:s}=o[g],{x:y,y:b,data:v,reset:x}=await s({x:d,y:p,initialPlacement:a,placement:h,strategy:r,middlewareData:f,rects:u,platform:i,elements:{reference:e,floating:t}});d=null!=y?y:d,p=null!=b?b:p,f=c(c({},f),{},{[n]:c(c({},f[n]),v)}),x&&m<=50&&(m++,"object"===typeof x&&(x.placement&&(h=x.placement),x.rects&&(u=!0===x.rects?await i.getElementRects({reference:e,floating:t,strategy:r}):x.rects),({x:d,y:p}=ti(u,h,l))),g=-1)}return{x:d,y:p,placement:h,strategy:r,middlewareData:f}})(e,t,c(c({},r),{},{platform:s}))};var so="undefined"!==typeof document?e.useLayoutEffect:function(){};function io(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;let n,a,r;if(e&&t&&"object"===typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(a=n;0!==a--;)if(!io(e[a],t[a]))return!1;return!0}if(r=Object.keys(e),n=r.length,n!==Object.keys(t).length)return!1;for(a=n;0!==a--;)if(!{}.hasOwnProperty.call(t,r[a]))return!1;for(a=n;0!==a--;){const n=r[a];if(("_owner"!==n||!e.$$typeof)&&!io(e[n],t[n]))return!1}return!0}return e!==e&&t!==t}function oo(e){if("undefined"===typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function lo(e,t){const n=oo(e);return Math.round(t*n)/n}function co(t){const n=e.useRef(t);return so(()=>{n.current=t}),n}const uo=(e,t)=>c(c({},Ji(e)),{},{options:[e,t]}),po=(e,t)=>c(c({},Zi(e)),{},{options:[e,t]}),ho=(e,t)=>c(c({},ao(e)),{},{options:[e,t]}),fo=(e,t)=>c(c({},$i(e)),{},{options:[e,t]}),mo=(e,t)=>c(c({},eo(e)),{},{options:[e,t]}),go=(e,t)=>c(c({},to(e)),{},{options:[e,t]}),yo=(e,t)=>c(c({},(e=>({name:"arrow",options:e,fn(t){const{element:n,padding:a}="function"===typeof e?e(t):e;return n&&(r=n,{}.hasOwnProperty.call(r,"current"))?null!=n.current?no({element:n.current,padding:a}).fn(t):{}:n?no({element:n,padding:a}).fn(t):{};var r}}))(e)),{},{options:[e,t]}),bo=["children","width","height"];var vo=e.forwardRef((e,t)=>{const{children:n,width:a=10,height:s=5}=e,i=r(e,bo);return(0,jt.jsx)(wa.svg,c(c({},i),{},{ref:t,width:a,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:(0,jt.jsx)("polygon",{points:"0,0 30,0 15,10"})}))});vo.displayName="Arrow";var xo=vo;function wo(t){const[n,a]=e.useState(void 0);return ws(()=>{if(t){a({width:t.offsetWidth,height:t.offsetHeight});const e=new ResizeObserver(e=>{if(!Array.isArray(e))return;if(!e.length)return;const n=e[0];let r,s;if("borderBoxSize"in n){const e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,s=t.blockSize}else r=t.offsetWidth,s=t.offsetHeight;a({width:r,height:s})});return e.observe(t,{box:"border-box"}),()=>e.unobserve(t)}a(void 0)},[t]),n}const ko=["__scopePopper","virtualRef"],So=["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","avoidCollisions","collisionBoundary","collisionPadding","sticky","hideWhenDetached","updatePositionStrategy","onPlaced"],No=["__scopePopper"];var Io="Popper",[Co,To]=ir(Io),[Eo,_o]=Co(Io),Ao=t=>{const{__scopePopper:n,children:a}=t,[r,s]=e.useState(null);return(0,jt.jsx)(Eo,{scope:n,anchor:r,onAnchorChange:s,children:a})};Ao.displayName=Io;var Ro="PopperAnchor",Fo=e.forwardRef((t,n)=>{const{__scopePopper:a,virtualRef:s}=t,i=r(t,ko),o=_o(Ro,a),l=e.useRef(null),u=Gt(n,l),d=e.useRef(null);return e.useEffect(()=>{const e=d.current;d.current=(null===s||void 0===s?void 0:s.current)||l.current,e!==d.current&&o.onAnchorChange(d.current)}),s?null:(0,jt.jsx)(wa.div,c(c({},i),{},{ref:u}))});Fo.displayName=Ro;var Do="PopperContent",[Mo,Oo]=Co(Do),Po=e.forwardRef((t,n)=>{var a,s,i,o,l,u,d,p;const{__scopePopper:h,side:f="bottom",sideOffset:m=0,align:g="center",alignOffset:y=0,arrowPadding:b=0,avoidCollisions:v=!0,collisionBoundary:x=[],collisionPadding:w=0,sticky:k="partial",hideWhenDetached:S=!1,updatePositionStrategy:N="optimized",onPlaced:I}=t,C=r(t,So),T=_o(Do,h),[E,_]=e.useState(null),A=Gt(n,e=>_(e)),[R,F]=e.useState(null),D=wo(R),M=null!==(a=null===D||void 0===D?void 0:D.width)&&void 0!==a?a:0,O=null!==(s=null===D||void 0===D?void 0:D.height)&&void 0!==s?s:0,P=f+("center"!==g?"-"+g:""),L="number"===typeof w?w:c({top:0,right:0,bottom:0,left:0},w),z=Array.isArray(x)?x:[x],j=z.length>0,B={padding:L,boundary:z.filter(Bo),altBoundary:j},{refs:W,floatingStyles:V,placement:U,isPositioned:H,middlewareData:G}=function(t){void 0===t&&(t={});const{placement:n="bottom",strategy:a="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:u,open:d}=t,[p,h]=e.useState({x:0,y:0,strategy:a,placement:n,middlewareData:{},isPositioned:!1}),[f,m]=e.useState(r);io(f,r)||m(r);const[g,y]=e.useState(null),[b,v]=e.useState(null),x=e.useCallback(e=>{e!==N.current&&(N.current=e,y(e))},[]),w=e.useCallback(e=>{e!==I.current&&(I.current=e,v(e))},[]),k=i||g,S=o||b,N=e.useRef(null),I=e.useRef(null),C=e.useRef(p),T=null!=u,E=co(u),_=co(s),A=co(d),R=e.useCallback(()=>{if(!N.current||!I.current)return;const e={placement:n,strategy:a,middleware:f};_.current&&(e.platform=_.current),ro(N.current,I.current,e).then(e=>{const t=c(c({},e),{},{isPositioned:!1!==A.current});F.current&&!io(C.current,t)&&(C.current=t,va.flushSync(()=>{h(t)}))})},[f,n,a,_,A]);so(()=>{!1===d&&C.current.isPositioned&&(C.current.isPositioned=!1,h(e=>c(c({},e),{},{isPositioned:!1})))},[d]);const F=e.useRef(!1);so(()=>(F.current=!0,()=>{F.current=!1}),[]),so(()=>{if(k&&(N.current=k),S&&(I.current=S),k&&S){if(E.current)return E.current(k,S,R);R()}},[k,S,R,E,T]);const D=e.useMemo(()=>({reference:N,floating:I,setReference:x,setFloating:w}),[x,w]),M=e.useMemo(()=>({reference:k,floating:S}),[k,S]),O=e.useMemo(()=>{const e={position:a,left:0,top:0};if(!M.floating)return e;const t=lo(M.floating,p.x),n=lo(M.floating,p.y);return l?c(c({},e),{},{transform:"translate("+t+"px, "+n+"px)"},oo(M.floating)>=1.5&&{willChange:"transform"}):{position:a,left:t,top:n}},[a,l,M.floating,p.x,p.y]);return e.useMemo(()=>c(c({},p),{},{update:R,refs:D,elements:M,floatingStyles:O}),[p,R,D,M,O])}({strategy:"fixed",placement:P,whileElementsMounted:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qi(...t,{animationFrame:"always"===N})},elements:{reference:T.anchor},middleware:[uo({mainAxis:m+O,alignmentAxis:y}),v&&po(c({mainAxis:!0,crossAxis:!1,limiter:"partial"===k?ho():void 0},B)),v&&fo(c({},B)),mo(c(c({},B),{},{apply:e=>{let{elements:t,rects:n,availableWidth:a,availableHeight:r}=e;const{width:s,height:i}=n.reference,o=t.floating.style;o.setProperty("--radix-popper-available-width","".concat(a,"px")),o.setProperty("--radix-popper-available-height","".concat(r,"px")),o.setProperty("--radix-popper-anchor-width","".concat(s,"px")),o.setProperty("--radix-popper-anchor-height","".concat(i,"px"))}})),R&&yo({element:R,padding:b}),Wo({arrowWidth:M,arrowHeight:O}),S&&go(c({strategy:"referenceHidden"},B))]}),[q,K]=Vo(U),X=Qr(I);ws(()=>{H&&(null===X||void 0===X||X())},[H,X]);const Y=null===(i=G.arrow)||void 0===i?void 0:i.x,Q=null===(o=G.arrow)||void 0===o?void 0:o.y,J=0!==(null===(l=G.arrow)||void 0===l?void 0:l.centerOffset),[Z,$]=e.useState();return ws(()=>{E&&$(window.getComputedStyle(E).zIndex)},[E]),(0,jt.jsx)("div",{ref:W.setFloating,"data-radix-popper-content-wrapper":"",style:c(c({},V),{},{transform:H?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Z,"--radix-popper-transform-origin":[null===(u=G.transformOrigin)||void 0===u?void 0:u.x,null===(d=G.transformOrigin)||void 0===d?void 0:d.y].join(" ")},(null===(p=G.hide)||void 0===p?void 0:p.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}),dir:t.dir,children:(0,jt.jsx)(Mo,{scope:h,placedSide:q,onArrowChange:F,arrowX:Y,arrowY:Q,shouldHideArrow:J,children:(0,jt.jsx)(wa.div,c(c({"data-side":q,"data-align":K},C),{},{ref:A,style:c(c({},C.style),{},{animation:H?void 0:"none"})}))})})});Po.displayName=Do;var Lo="PopperArrow",zo={top:"bottom",right:"left",bottom:"top",left:"right"},jo=e.forwardRef(function(e,t){const{__scopePopper:n}=e,a=r(e,No),s=Oo(Lo,n),i=zo[s.placedSide];return(0,jt.jsx)("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:(0,jt.jsx)(xo,c(c({},a),{},{ref:t,style:c(c({},a.style),{},{display:"block"})}))})});function Bo(e){return null!==e}jo.displayName=Lo;var Wo=e=>({name:"transformOrigin",options:e,fn(t){var n,a,r,s,i;const{placement:o,rects:l,middlewareData:c}=t,u=0!==(null===(n=c.arrow)||void 0===n?void 0:n.centerOffset),d=u?0:e.arrowWidth,p=u?0:e.arrowHeight,[h,f]=Vo(o),m={start:"0%",center:"50%",end:"100%"}[f],g=(null!==(a=null===(r=c.arrow)||void 0===r?void 0:r.x)&&void 0!==a?a:0)+d/2,y=(null!==(s=null===(i=c.arrow)||void 0===i?void 0:i.y)&&void 0!==s?s:0)+p/2;let b="",v="";return"bottom"===h?(b=u?m:"".concat(g,"px"),v="".concat(-p,"px")):"top"===h?(b=u?m:"".concat(g,"px"),v="".concat(l.floating.height+p,"px")):"right"===h?(b="".concat(-p,"px"),v=u?m:"".concat(y,"px")):"left"===h&&(b="".concat(l.floating.width+p,"px"),v=u?m:"".concat(y,"px")),{data:{x:b,y:v}}}});function Vo(e){const[t,n="center"]=e.split("-");return[t,n]}var Uo=Ao,Ho=Fo,Go=Po,qo=jo;const Ko=["container"];var Xo=e.forwardRef((t,n)=>{var a;const{container:s}=t,i=r(t,Ko),[o,l]=e.useState(!1);ws(()=>l(!0),[]);const u=s||o&&(null===globalThis||void 0===globalThis||null===(a=globalThis.document)||void 0===a?void 0:a.body);return u?va.createPortal((0,jt.jsx)(wa.div,c(c({},i),{},{ref:n})),u):null});Xo.displayName="Portal";var Yo=t[" useInsertionEffect ".trim().toString()]||ws;function Qo(t){let{prop:n,defaultProp:a,onChange:r=()=>{},caller:s}=t;const[i,o,l]=function(t){let{defaultProp:n,onChange:a}=t;const[r,s]=e.useState(n),i=e.useRef(r),o=e.useRef(a);return Yo(()=>{o.current=a},[a]),e.useEffect(()=>{var e;i.current!==r&&(null===(e=o.current)||void 0===e||e.call(o,r),i.current=r)},[r,i]),[r,s,o]}({defaultProp:a,onChange:r}),c=void 0!==n,u=c?n:i;{const t=e.useRef(void 0!==n);e.useEffect(()=>{const e=t.current;if(e!==c){const t=e?"controlled":"uncontrolled",n=c?"controlled":"uncontrolled";console.warn("".concat(s," is changing from ").concat(t," to ").concat(n,". Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component."))}t.current=c},[c,s])}const d=e.useCallback(e=>{if(c){const a=function(e){return"function"===typeof e}(e)?e(n):e;var t;if(a!==n)null===(t=l.current)||void 0===t||t.call(l,a)}else o(e)},[c,n,o,l]);return[u,d]}Symbol("RADIX:SYNC_STATE");function Jo(t){const n=e.useRef({value:t,previous:t});return e.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var Zo=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),$o=e.forwardRef((e,t)=>(0,jt.jsx)(wa.span,c(c({},e),{},{ref:t,style:c(c({},Zo),e.style)})));$o.displayName="VisuallyHidden";var el=function(e){return"undefined"===typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},tl=new WeakMap,nl=new WeakMap,al={},rl=0,sl=function(e){return e&&(e.host||sl(e.parentNode))},il=function(e,t,n,a){var r=function(e,t){return t.map(function(t){if(e.contains(t))return t;var n=sl(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(e){return Boolean(e)})}(t,Array.isArray(e)?e:[e]);al[n]||(al[n]=new WeakMap);var s=al[n],i=[],o=new Set,l=new Set(r),c=function(e){e&&!o.has(e)&&(o.add(e),c(e.parentNode))};r.forEach(c);var u=function(e){e&&!l.has(e)&&Array.prototype.forEach.call(e.children,function(e){if(o.has(e))u(e);else try{var t=e.getAttribute(a),r=null!==t&&"false"!==t,l=(tl.get(e)||0)+1,c=(s.get(e)||0)+1;tl.set(e,l),s.set(e,c),i.push(e),1===l&&r&&nl.set(e,!0),1===c&&e.setAttribute(n,"true"),r||e.setAttribute(a,"true")}catch(tv){console.error("aria-hidden: cannot operate on ",e,tv)}})};return u(t),o.clear(),rl++,function(){i.forEach(function(e){var t=tl.get(e)-1,r=s.get(e)-1;tl.set(e,t),s.set(e,r),t||(nl.has(e)||e.removeAttribute(a),nl.delete(e)),r||e.removeAttribute(n)}),--rl||(tl=new WeakMap,tl=new WeakMap,nl=new WeakMap,al={})}},ol=function(e,t,n){void 0===n&&(n="data-aria-hidden");var a=Array.from(Array.isArray(e)?e:[e]),r=t||el(e);return r?(a.push.apply(a,Array.from(r.querySelectorAll("[aria-live], script"))),il(a,r,n,"aria-hidden")):function(){return null}};var ll=function(){return ll=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},ll.apply(this,arguments)};function cl(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}Object.create;function ul(e,t,n){if(n||2===arguments.length)for(var a,r=0,s=t.length;r<s;r++)!a&&r in t||(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}Object.create;"function"===typeof SuppressedError&&SuppressedError;var dl="right-scroll-bar-position",pl="width-before-scroll-bar";function hl(e,t){return"function"===typeof e?e(t):e&&(e.current=t),e}var fl="undefined"!==typeof window?e.useLayoutEffect:e.useEffect,ml=new WeakMap;function gl(t,n){var a=function(t,n){var a=(0,e.useState)(function(){return{value:t,callback:n,facade:{get current(){return a.value},set current(e){var t=a.value;t!==e&&(a.value=e,a.callback(e,t))}}}})[0];return a.callback=n,a.facade}(n||null,function(e){return t.forEach(function(t){return hl(t,e)})});return fl(function(){var e=ml.get(a);if(e){var n=new Set(e),r=new Set(t),s=a.current;n.forEach(function(e){r.has(e)||hl(e,null)}),r.forEach(function(e){n.has(e)||hl(e,s)})}ml.set(a,t)},[t]),a}function yl(e){return e}function bl(e,t){void 0===t&&(t=yl);var n=[],a=!1,r={read:function(){if(a)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var r=t(e,a);return n.push(r),function(){n=n.filter(function(e){return e!==r})}},assignSyncMedium:function(e){for(a=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){a=!0;var t=[];if(n.length){var r=n;n=[],r.forEach(e),t=n}var s=function(){var n=t;t=[],n.forEach(e)},i=function(){return Promise.resolve().then(s)};i(),n={push:function(e){t.push(e),i()},filter:function(e){return t=t.filter(e),n}}}};return r}var vl=function(e){void 0===e&&(e={});var t=bl(null);return t.options=ll({async:!0,ssr:!1},e),t}(),xl=function(){},wl=e.forwardRef(function(t,n){var a=e.useRef(null),r=e.useState({onScrollCapture:xl,onWheelCapture:xl,onTouchMoveCapture:xl}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,p=t.shards,h=t.sideCar,f=t.noRelative,m=t.noIsolation,g=t.inert,y=t.allowPinchZoom,b=t.as,v=void 0===b?"div":b,x=t.gapMode,w=cl(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=h,S=gl([a,n]),N=ll(ll({},w),s);return e.createElement(e.Fragment,null,d&&e.createElement(k,{sideCar:vl,removeScrollBar:u,shards:p,noRelative:f,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!y,lockRef:a,gapMode:x}),o?e.cloneElement(e.Children.only(l),ll(ll({},N),{ref:S})):e.createElement(v,ll({},N,{className:c,ref:S}),l))});wl.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},wl.classNames={fullWidth:pl,zeroRight:dl};var kl,Sl=function(t){var n=t.sideCar,a=cl(t,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=n.read();if(!r)throw new Error("Sidecar medium not found");return e.createElement(r,ll({},a))};Sl.isSideCarExport=!0;function Nl(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=kl||n.nc;return t&&e.setAttribute("nonce",t),e}var Il=function(){var e=0,t=null;return{add:function(n){var a,r;0==e&&(t=Nl())&&(r=n,(a=t).styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r)),function(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}(t)),e++},remove:function(){! --e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Cl=function(){var t=function(){var t=Il();return function(n,a){e.useEffect(function(){return t.add(n),function(){t.remove()}},[n&&a])}}();return function(e){var n=e.styles,a=e.dynamic;return t(n,a),null}},Tl={left:0,top:0,right:0,gap:0},El=function(e){return parseInt(e||"",10)||0},_l=function(e){if(void 0===e&&(e="margin"),"undefined"===typeof window)return Tl;var t=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],a=t["padding"===e?"paddingTop":"marginTop"],r=t["padding"===e?"paddingRight":"marginRight"];return[El(n),El(a),El(r)]}(e),n=document.documentElement.clientWidth,a=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,a-n+t[2]-t[0])}},Al=Cl(),Rl="data-scroll-locked",Fl=function(e,t,n,a){var r=e.left,s=e.top,i=e.right,o=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(a,";\n   padding-right: ").concat(o,"px ").concat(a,";\n  }\n  body[").concat(Rl,"] {\n    overflow: hidden ").concat(a,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(a,";"),"margin"===n&&"\n    padding-left: ".concat(r,"px;\n    padding-top: ").concat(s,"px;\n    padding-right: ").concat(i,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(a,";\n    "),"padding"===n&&"padding-right: ".concat(o,"px ").concat(a,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(dl," {\n    right: ").concat(o,"px ").concat(a,";\n  }\n  \n  .").concat(pl," {\n    margin-right: ").concat(o,"px ").concat(a,";\n  }\n  \n  .").concat(dl," .").concat(dl," {\n    right: 0 ").concat(a,";\n  }\n  \n  .").concat(pl," .").concat(pl," {\n    margin-right: 0 ").concat(a,";\n  }\n  \n  body[").concat(Rl,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(o,"px;\n  }\n")},Dl=function(){var e=parseInt(document.body.getAttribute(Rl)||"0",10);return isFinite(e)?e:0},Ml=function(t){var n=t.noRelative,a=t.noImportant,r=t.gapMode,s=void 0===r?"margin":r;e.useEffect(function(){return document.body.setAttribute(Rl,(Dl()+1).toString()),function(){var e=Dl()-1;e<=0?document.body.removeAttribute(Rl):document.body.setAttribute(Rl,e.toString())}},[]);var i=e.useMemo(function(){return _l(s)},[s]);return e.createElement(Al,{styles:Fl(i,!n,s,a?"":"!important")})},Ol=!1;if("undefined"!==typeof window)try{var Pl=Object.defineProperty({},"passive",{get:function(){return Ol=!0,!0}});window.addEventListener("test",Pl,Pl),window.removeEventListener("test",Pl,Pl)}catch(Tre){Ol=!1}var Ll=!!Ol&&{passive:!1},zl=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===n[t])},jl=function(e,t){var n=t.ownerDocument,a=t;do{if("undefined"!==typeof ShadowRoot&&a instanceof ShadowRoot&&(a=a.host),Bl(e,a)){var r=Wl(e,a);if(r[1]>r[2])return!0}a=a.parentNode}while(a&&a!==n.body);return!1},Bl=function(e,t){return"v"===e?function(e){return zl(e,"overflowY")}(t):function(e){return zl(e,"overflowX")}(t)},Wl=function(e,t){return"v"===e?function(e){return[e.scrollTop,e.scrollHeight,e.clientHeight]}(t):function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t)},Vl=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Ul=function(e){return[e.deltaX,e.deltaY]},Hl=function(e){return e&&"current"in e?e.current:e},Gl=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},ql=0,Kl=[];function Xl(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Yl=(Ql=function(t){var n=e.useRef([]),a=e.useRef([0,0]),r=e.useRef(),s=e.useState(ql++)[0],i=e.useState(Cl)[0],o=e.useRef(t);e.useEffect(function(){o.current=t},[t]),e.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var e=ul([t.lockRef.current],(t.shards||[]).map(Hl),!0).filter(Boolean);return e.forEach(function(e){return e.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),e.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=e.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!o.current.allowPinchZoom;var n,s=Vl(e),i=a.current,l="deltaX"in e?e.deltaX:i[0]-s[0],c="deltaY"in e?e.deltaY:i[1]-s[1],u=e.target,d=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===d&&"range"===u.type)return!1;var p=jl(d,u);if(!p)return!0;if(p?n=d:(n="v"===d?"h":"v",p=jl(d,u)),!p)return!1;if(!r.current&&"changedTouches"in e&&(l||c)&&(r.current=n),!n)return!0;var h=r.current||n;return function(e,t,n,a,r){var s=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),i=s*a,o=n.target,l=t.contains(o),c=!1,u=i>0,d=0,p=0;do{if(!o)break;var h=Wl(e,o),f=h[0],m=h[1]-h[2]-s*f;(f||m)&&Bl(e,o)&&(d+=m,p+=f);var g=o.parentNode;o=g&&g.nodeType===Node.DOCUMENT_FRAGMENT_NODE?g.host:g}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&(r&&Math.abs(d)<1||!r&&i>d)||!u&&(r&&Math.abs(p)<1||!r&&-i>p))&&(c=!0),c}(h,t,e,"h"===h?l:c,!0)},[]),c=e.useCallback(function(e){var t=e;if(Kl.length&&Kl[Kl.length-1]===i){var a="deltaY"in t?Ul(t):Vl(t),r=n.current.filter(function(e){return e.name===t.type&&(e.target===t.target||t.target===e.shadowParent)&&(n=e.delta,r=a,n[0]===r[0]&&n[1]===r[1]);var n,r})[0];if(r&&r.should)t.cancelable&&t.preventDefault();else if(!r){var s=(o.current.shards||[]).map(Hl).filter(Boolean).filter(function(e){return e.contains(t.target)});(s.length>0?l(t,s[0]):!o.current.noIsolation)&&t.cancelable&&t.preventDefault()}}},[]),u=e.useCallback(function(e,t,a,r){var s={name:e,delta:t,target:a,should:r,shadowParent:Xl(a)};n.current.push(s),setTimeout(function(){n.current=n.current.filter(function(e){return e!==s})},1)},[]),d=e.useCallback(function(e){a.current=Vl(e),r.current=void 0},[]),p=e.useCallback(function(e){u(e.type,Ul(e),e.target,l(e,t.lockRef.current))},[]),h=e.useCallback(function(e){u(e.type,Vl(e),e.target,l(e,t.lockRef.current))},[]);e.useEffect(function(){return Kl.push(i),t.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:h}),document.addEventListener("wheel",c,Ll),document.addEventListener("touchmove",c,Ll),document.addEventListener("touchstart",d,Ll),function(){Kl=Kl.filter(function(e){return e!==i}),document.removeEventListener("wheel",c,Ll),document.removeEventListener("touchmove",c,Ll),document.removeEventListener("touchstart",d,Ll)}},[]);var f=t.removeScrollBar,m=t.inert;return e.createElement(e.Fragment,null,m?e.createElement(i,{styles:Gl(s)}):null,f?e.createElement(Ml,{noRelative:t.noRelative,gapMode:t.gapMode}):null)},vl.useMedium(Ql),Sl);var Ql,Jl=e.forwardRef(function(t,n){return e.createElement(wl,ll({},t,{ref:n,sideCar:Yl}))});Jl.classNames=wl.classNames;const Zl=Jl,$l=["__scopeSelect","disabled"],ec=["__scopeSelect","className","style","children","placeholder"],tc=["__scopeSelect","children"],nc=["__scopeSelect","position","onCloseAutoFocus","onEscapeKeyDown","onPointerDownOutside","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions"],ac=["__scopeSelect","onPlaced"],rc=["__scopeSelect","align","collisionPadding"],sc=["__scopeSelect","nonce"],ic=["__scopeSelect"],oc=["__scopeSelect"],lc=["__scopeSelect","value","disabled","textValue"],cc=["__scopeSelect","className","style"],uc=["__scopeSelect"],dc=["__scopeSelect","onAutoScroll"],pc=["__scopeSelect"],hc=["__scopeSelect"],fc=["__scopeSelect","value"];var mc=[" ","Enter","ArrowUp","ArrowDown"],gc=[" ","Enter"],yc="Select",[bc,vc,xc]=Hr(yc),[wc,kc]=ir(yc,[xc,To]),Sc=To(),[Nc,Ic]=wc(yc),[Cc,Tc]=wc(yc),Ec=t=>{const{__scopeSelect:n,children:a,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:u,dir:d,name:p,autoComplete:h,disabled:f,required:m,form:g}=t,y=Sc(n),[b,v]=e.useState(null),[x,w]=e.useState(null),[k,S]=e.useState(!1),N=Yr(d),[I,C]=Qo({prop:r,defaultProp:null!==s&&void 0!==s&&s,onChange:i,caller:yc}),[T,E]=Qo({prop:o,defaultProp:l,onChange:u,caller:yc}),_=e.useRef(null),A=!b||(g||!!b.closest("form")),[R,F]=e.useState(new Set),D=Array.from(R).map(e=>e.props.value).join(";");return(0,jt.jsx)(Uo,c(c({},y),{},{children:(0,jt.jsxs)(Nc,{required:m,scope:n,trigger:b,onTriggerChange:v,valueNode:x,onValueNodeChange:w,valueNodeHasChildren:k,onValueNodeHasChildrenChange:S,contentId:Ns(),value:T,onValueChange:E,open:I,onOpenChange:C,dir:N,triggerPointerDownPosRef:_,disabled:f,children:[(0,jt.jsx)(bc.Provider,{scope:n,children:(0,jt.jsx)(Cc,{scope:t.__scopeSelect,onNativeOptionAdd:e.useCallback(e=>{F(t=>new Set(t).add(e))},[]),onNativeOptionRemove:e.useCallback(e=>{F(t=>{const n=new Set(t);return n.delete(e),n})},[]),children:a})}),A?(0,jt.jsxs)(gu,{"aria-hidden":!0,required:m,tabIndex:-1,name:p,autoComplete:h,value:T,onChange:e=>E(e.target.value),disabled:f,form:g,children:[void 0===T?(0,jt.jsx)("option",{value:""}):null,Array.from(R)]},D):null]})}))};Ec.displayName=yc;var _c="SelectTrigger",Ac=e.forwardRef((t,n)=>{const{__scopeSelect:a,disabled:s=!1}=t,i=r(t,$l),o=Sc(a),l=Ic(_c,a),u=l.disabled||s,d=Gt(n,l.onTriggerChange),p=vc(a),h=e.useRef("touch"),[f,m,g]=bu(e=>{const t=p().filter(e=>!e.disabled),n=t.find(e=>e.value===l.value),a=vu(t,e,n);void 0!==a&&l.onValueChange(a.value)}),y=e=>{u||(l.onOpenChange(!0),g()),e&&(l.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return(0,jt.jsx)(Ho,c(c({asChild:!0},o),{},{children:(0,jt.jsx)(wa.button,c(c({type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":yu(l.value)?"":void 0},i),{},{ref:d,onClick:zr(i.onClick,e=>{e.currentTarget.focus(),"mouse"!==h.current&&y(e)}),onPointerDown:zr(i.onPointerDown,e=>{h.current=e.pointerType;const t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(y(e),e.preventDefault())}),onKeyDown:zr(i.onKeyDown,e=>{const t=""!==f.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||m(e.key),t&&" "===e.key||mc.includes(e.key)&&(y(),e.preventDefault())})}))}))});Ac.displayName=_c;var Rc="SelectValue",Fc=e.forwardRef((e,t)=>{const{__scopeSelect:n,className:a,style:s,children:i,placeholder:o=""}=e,l=r(e,ec),u=Ic(Rc,n),{onValueNodeHasChildrenChange:d}=u,p=void 0!==i,h=Gt(t,u.onValueNodeChange);return ws(()=>{d(p)},[d,p]),(0,jt.jsx)(wa.span,c(c({},l),{},{ref:h,style:{pointerEvents:"none"},children:yu(u.value)?(0,jt.jsx)(jt.Fragment,{children:o}):i}))});Fc.displayName=Rc;var Dc=e.forwardRef((e,t)=>{const{__scopeSelect:n,children:a}=e,s=r(e,tc);return(0,jt.jsx)(wa.span,c(c({"aria-hidden":!0},s),{},{ref:t,children:a||"\u25bc"}))});Dc.displayName="SelectIcon";var Mc=e=>(0,jt.jsx)(Xo,c({asChild:!0},e));Mc.displayName="SelectPortal";var Oc="SelectContent",Pc=e.forwardRef((t,n)=>{const a=Ic(Oc,t.__scopeSelect),[r,s]=e.useState();if(ws(()=>{s(new DocumentFragment)},[]),!a.open){const e=r;return e?va.createPortal((0,jt.jsx)(zc,{scope:t.__scopeSelect,children:(0,jt.jsx)(bc.Slot,{scope:t.__scopeSelect,children:(0,jt.jsx)("div",{children:t.children})})}),e):null}return(0,jt.jsx)(Wc,c(c({},t),{},{ref:n}))});Pc.displayName=Oc;var Lc=10,[zc,jc]=wc(Oc),Bc=Xt("SelectContent.RemoveScroll"),Wc=e.forwardRef((t,n)=>{const{__scopeSelect:a,position:s="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:l,side:u,sideOffset:d,align:p,alignOffset:h,arrowPadding:f,collisionBoundary:m,collisionPadding:g,sticky:y,hideWhenDetached:b,avoidCollisions:v}=t,x=r(t,nc),w=Ic(Oc,a),[k,S]=e.useState(null),[N,I]=e.useState(null),C=Gt(n,e=>S(e)),[T,E]=e.useState(null),[_,A]=e.useState(null),R=vc(a),[F,D]=e.useState(!1),M=e.useRef(!1);e.useEffect(()=>{if(k)return ol(k)},[k]),ls();const O=e.useCallback(e=>{const[t,...n]=R().map(e=>e.ref.current),[a]=n.slice(-1),r=document.activeElement;for(const s of e){if(s===r)return;if(null===s||void 0===s||s.scrollIntoView({block:"nearest"}),s===t&&N&&(N.scrollTop=0),s===a&&N&&(N.scrollTop=N.scrollHeight),null===s||void 0===s||s.focus(),document.activeElement!==r)return}},[R,N]),P=e.useCallback(()=>O([T,k]),[O,T,k]);e.useEffect(()=>{F&&P()},[F,P]);const{onOpenChange:L,triggerPointerDownPosRef:z}=w;e.useEffect(()=>{if(k){let e={x:0,y:0};const t=t=>{var n,a,r,s;e={x:Math.abs(Math.round(t.pageX)-(null!==(n=null===(a=z.current)||void 0===a?void 0:a.x)&&void 0!==n?n:0)),y:Math.abs(Math.round(t.pageY)-(null!==(r=null===(s=z.current)||void 0===s?void 0:s.y)&&void 0!==r?r:0))}},n=n=>{e.x<=10&&e.y<=10?n.preventDefault():k.contains(n.target)||L(!1),document.removeEventListener("pointermove",t),z.current=null};return null!==z.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",n,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",n,{capture:!0})}}},[k,L,z]),e.useEffect(()=>{const e=()=>L(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[L]);const[j,B]=bu(e=>{const t=R().filter(e=>!e.disabled),n=t.find(e=>e.ref.current===document.activeElement),a=vu(t,e,n);a&&setTimeout(()=>a.ref.current.focus())}),W=e.useCallback((e,t,n)=>{const a=!M.current&&!n;(void 0!==w.value&&w.value===t||a)&&(E(e),a&&(M.current=!0))},[w.value]),V=e.useCallback(()=>null===k||void 0===k?void 0:k.focus(),[k]),U=e.useCallback((e,t,n)=>{const a=!M.current&&!n;(void 0!==w.value&&w.value===t||a)&&A(e)},[w.value]),H="popper"===s?Uc:Vc,G=H===Uc?{side:u,sideOffset:d,align:p,alignOffset:h,arrowPadding:f,collisionBoundary:m,collisionPadding:g,sticky:y,hideWhenDetached:b,avoidCollisions:v}:{};return(0,jt.jsx)(zc,{scope:a,content:k,viewport:N,onViewportChange:I,itemRefCallback:W,selectedItem:T,onItemLeave:V,itemTextRefCallback:U,focusSelectedItem:P,selectedItemText:_,position:s,isPositioned:F,searchRef:j,children:(0,jt.jsx)(Zl,{as:Bc,allowPinchZoom:!0,children:(0,jt.jsx)(fs,{asChild:!0,trapped:w.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:zr(i,e=>{var t;null===(t=w.trigger)||void 0===t||t.focus({preventScroll:!0}),e.preventDefault()}),children:(0,jt.jsx)(as,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:(0,jt.jsx)(H,c(c(c({role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:e=>e.preventDefault()},x),G),{},{onPlaced:()=>D(!0),ref:C,style:c({display:"flex",flexDirection:"column",outline:"none"},x.style),onKeyDown:zr(x.onKeyDown,e=>{const t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||B(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=R().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){const n=e.target,a=t.indexOf(n);t=t.slice(a+1)}setTimeout(()=>O(t)),e.preventDefault()}})}))})})})})});Wc.displayName="SelectContentImpl";var Vc=e.forwardRef((t,n)=>{const{__scopeSelect:a,onPlaced:s}=t,i=r(t,ac),o=Ic(Oc,a),l=jc(Oc,a),[u,d]=e.useState(null),[p,h]=e.useState(null),f=Gt(n,e=>h(e)),m=vc(a),g=e.useRef(!1),y=e.useRef(!0),{viewport:b,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=l,k=e.useCallback(()=>{if(o.trigger&&o.valueNode&&u&&p&&b&&v&&x){const e=o.trigger.getBoundingClientRect(),t=p.getBoundingClientRect(),n=o.valueNode.getBoundingClientRect(),a=x.getBoundingClientRect();if("rtl"!==o.dir){const r=a.left-t.left,s=n.left-r,i=e.left-s,o=e.width+i,l=Math.max(o,t.width),c=window.innerWidth-Lc,d=Pr(s,[Lc,Math.max(Lc,c-l)]);u.style.minWidth=o+"px",u.style.left=d+"px"}else{const r=t.right-a.right,s=window.innerWidth-n.right-r,i=window.innerWidth-e.right-s,o=e.width+i,l=Math.max(o,t.width),c=window.innerWidth-Lc,d=Pr(s,[Lc,Math.max(Lc,c-l)]);u.style.minWidth=o+"px",u.style.right=d+"px"}const r=m(),i=window.innerHeight-2*Lc,l=b.scrollHeight,c=window.getComputedStyle(p),d=parseInt(c.borderTopWidth,10),h=parseInt(c.paddingTop,10),f=parseInt(c.borderBottomWidth,10),y=d+h+l+parseInt(c.paddingBottom,10)+f,w=Math.min(5*v.offsetHeight,y),k=window.getComputedStyle(b),S=parseInt(k.paddingTop,10),N=parseInt(k.paddingBottom,10),I=e.top+e.height/2-Lc,C=i-I,T=v.offsetHeight/2,E=d+h+(v.offsetTop+T),_=y-E;if(E<=I){const e=r.length>0&&v===r[r.length-1].ref.current;u.style.bottom="0px";const t=p.clientHeight-b.offsetTop-b.offsetHeight,n=E+Math.max(C,T+(e?N:0)+t+f);u.style.height=n+"px"}else{const e=r.length>0&&v===r[0].ref.current;u.style.top="0px";const t=Math.max(I,d+b.offsetTop+(e?S:0)+T)+_;u.style.height=t+"px",b.scrollTop=E-I+b.offsetTop}u.style.margin="".concat(Lc,"px 0"),u.style.minHeight=w+"px",u.style.maxHeight=i+"px",null===s||void 0===s||s(),requestAnimationFrame(()=>g.current=!0)}},[m,o.trigger,o.valueNode,u,p,b,v,x,o.dir,s]);ws(()=>k(),[k]);const[S,N]=e.useState();ws(()=>{p&&N(window.getComputedStyle(p).zIndex)},[p]);const I=e.useCallback(e=>{e&&!0===y.current&&(k(),null===w||void 0===w||w(),y.current=!1)},[k,w]);return(0,jt.jsx)(Hc,{scope:a,contentWrapper:u,shouldExpandOnScrollRef:g,onScrollButtonChange:I,children:(0,jt.jsx)("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:(0,jt.jsx)(wa.div,c(c({},i),{},{ref:f,style:c({boxSizing:"border-box",maxHeight:"100%"},i.style)}))})})});Vc.displayName="SelectItemAlignedPosition";var Uc=e.forwardRef((e,t)=>{const{__scopeSelect:n,align:a="start",collisionPadding:s=Lc}=e,i=r(e,rc),o=Sc(n);return(0,jt.jsx)(Go,c(c(c({},o),i),{},{ref:t,align:a,collisionPadding:s,style:c(c({boxSizing:"border-box"},i.style),{"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"})}))});Uc.displayName="SelectPopperPosition";var[Hc,Gc]=wc(Oc,{}),qc="SelectViewport",Kc=e.forwardRef((t,n)=>{const{__scopeSelect:a,nonce:s}=t,i=r(t,sc),o=jc(qc,a),l=Gc(qc,a),u=Gt(n,o.onViewportChange),d=e.useRef(0);return(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),(0,jt.jsx)(bc.Slot,{scope:a,children:(0,jt.jsx)(wa.div,c(c({"data-radix-select-viewport":"",role:"presentation"},i),{},{ref:u,style:c({position:"relative",flex:1,overflow:"hidden auto"},i.style),onScroll:zr(i.onScroll,e=>{const t=e.currentTarget,{contentWrapper:n,shouldExpandOnScrollRef:a}=l;if(null!==a&&void 0!==a&&a.current&&n){const e=Math.abs(d.current-t.scrollTop);if(e>0){const a=window.innerHeight-2*Lc,r=parseFloat(n.style.minHeight),s=parseFloat(n.style.height),i=Math.max(r,s);if(i<a){const r=i+e,s=Math.min(a,r),o=r-s;n.style.height=s+"px","0px"===n.style.bottom&&(t.scrollTop=o>0?o:0,n.style.justifyContent="flex-end")}}}d.current=t.scrollTop})}))})]})});Kc.displayName=qc;var Xc="SelectGroup",[Yc,Qc]=wc(Xc),Jc=e.forwardRef((e,t)=>{const{__scopeSelect:n}=e,a=r(e,ic),s=Ns();return(0,jt.jsx)(Yc,{scope:n,id:s,children:(0,jt.jsx)(wa.div,c(c({role:"group","aria-labelledby":s},a),{},{ref:t}))})});Jc.displayName=Xc;var Zc="SelectLabel",$c=e.forwardRef((e,t)=>{const{__scopeSelect:n}=e,a=r(e,oc),s=Qc(Zc,n);return(0,jt.jsx)(wa.div,c(c({id:s.id},a),{},{ref:t}))});$c.displayName=Zc;var eu="SelectItem",[tu,nu]=wc(eu),au=e.forwardRef((t,n)=>{const{__scopeSelect:a,value:s,disabled:i=!1,textValue:o}=t,l=r(t,lc),u=Ic(eu,a),d=jc(eu,a),p=u.value===s,[h,f]=e.useState(null!==o&&void 0!==o?o:""),[m,g]=e.useState(!1),y=Gt(n,e=>{var t;return null===(t=d.itemRefCallback)||void 0===t?void 0:t.call(d,e,s,i)}),b=Ns(),v=e.useRef("touch"),x=()=>{i||(u.onValueChange(s),u.onOpenChange(!1))};if(""===s)throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,jt.jsx)(tu,{scope:a,value:s,disabled:i,textId:b,isSelected:p,onItemTextChange:e.useCallback(e=>{f(t=>{var n;return t||(null!==(n=null===e||void 0===e?void 0:e.textContent)&&void 0!==n?n:"").trim()})},[]),children:(0,jt.jsx)(bc.ItemSlot,{scope:a,value:s,disabled:i,textValue:h,children:(0,jt.jsx)(wa.div,c(c({role:"option","aria-labelledby":b,"data-highlighted":m?"":void 0,"aria-selected":p&&m,"data-state":p?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1},l),{},{ref:y,onFocus:zr(l.onFocus,()=>g(!0)),onBlur:zr(l.onBlur,()=>g(!1)),onClick:zr(l.onClick,()=>{"mouse"!==v.current&&x()}),onPointerUp:zr(l.onPointerUp,()=>{"mouse"===v.current&&x()}),onPointerDown:zr(l.onPointerDown,e=>{v.current=e.pointerType}),onPointerMove:zr(l.onPointerMove,e=>{var t;(v.current=e.pointerType,i)?null===(t=d.onItemLeave)||void 0===t||t.call(d):"mouse"===v.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:zr(l.onPointerLeave,e=>{var t;e.currentTarget===document.activeElement&&(null===(t=d.onItemLeave)||void 0===t||t.call(d))}),onKeyDown:zr(l.onKeyDown,e=>{var t;""!==(null===(t=d.searchRef)||void 0===t?void 0:t.current)&&" "===e.key||(gc.includes(e.key)&&x()," "===e.key&&e.preventDefault())})}))})})});au.displayName=eu;var ru="SelectItemText",su=e.forwardRef((t,n)=>{const{__scopeSelect:a,className:s,style:i}=t,o=r(t,cc),l=Ic(ru,a),u=jc(ru,a),d=nu(ru,a),p=Tc(ru,a),[h,f]=e.useState(null),m=Gt(n,e=>f(e),d.onItemTextChange,e=>{var t;return null===(t=u.itemTextRefCallback)||void 0===t?void 0:t.call(u,e,d.value,d.disabled)}),g=null===h||void 0===h?void 0:h.textContent,y=e.useMemo(()=>(0,jt.jsx)("option",{value:d.value,disabled:d.disabled,children:g},d.value),[d.disabled,d.value,g]),{onNativeOptionAdd:b,onNativeOptionRemove:v}=p;return ws(()=>(b(y),()=>v(y)),[b,v,y]),(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)(wa.span,c(c({id:d.textId},o),{},{ref:m})),d.isSelected&&l.valueNode&&!l.valueNodeHasChildren?va.createPortal(o.children,l.valueNode):null]})});su.displayName=ru;var iu="SelectItemIndicator",ou=e.forwardRef((e,t)=>{const{__scopeSelect:n}=e,a=r(e,uc);return nu(iu,n).isSelected?(0,jt.jsx)(wa.span,c(c({"aria-hidden":!0},a),{},{ref:t})):null});ou.displayName=iu;var lu="SelectScrollUpButton",cu=e.forwardRef((t,n)=>{const a=jc(lu,t.__scopeSelect),r=Gc(lu,t.__scopeSelect),[s,i]=e.useState(!1),o=Gt(n,r.onScrollButtonChange);return ws(()=>{if(a.viewport&&a.isPositioned){let e=function(){const e=t.scrollTop>0;i(e)};const t=a.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[a.viewport,a.isPositioned]),s?(0,jt.jsx)(pu,c(c({},t),{},{ref:o,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=a;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}})):null});cu.displayName=lu;var uu="SelectScrollDownButton",du=e.forwardRef((t,n)=>{const a=jc(uu,t.__scopeSelect),r=Gc(uu,t.__scopeSelect),[s,i]=e.useState(!1),o=Gt(n,r.onScrollButtonChange);return ws(()=>{if(a.viewport&&a.isPositioned){let e=function(){const e=t.scrollHeight-t.clientHeight,n=Math.ceil(t.scrollTop)<e;i(n)};const t=a.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[a.viewport,a.isPositioned]),s?(0,jt.jsx)(pu,c(c({},t),{},{ref:o,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=a;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}})):null});du.displayName=uu;var pu=e.forwardRef((t,n)=>{const{__scopeSelect:a,onAutoScroll:s}=t,i=r(t,dc),o=jc("SelectScrollButton",a),l=e.useRef(null),u=vc(a),d=e.useCallback(()=>{null!==l.current&&(window.clearInterval(l.current),l.current=null)},[]);return e.useEffect(()=>()=>d(),[d]),ws(()=>{var e;const t=u().find(e=>e.ref.current===document.activeElement);null===t||void 0===t||null===(e=t.ref.current)||void 0===e||e.scrollIntoView({block:"nearest"})},[u]),(0,jt.jsx)(wa.div,c(c({"aria-hidden":!0},i),{},{ref:n,style:c({flexShrink:0},i.style),onPointerDown:zr(i.onPointerDown,()=>{null===l.current&&(l.current=window.setInterval(s,50))}),onPointerMove:zr(i.onPointerMove,()=>{var e;null===(e=o.onItemLeave)||void 0===e||e.call(o),null===l.current&&(l.current=window.setInterval(s,50))}),onPointerLeave:zr(i.onPointerLeave,()=>{d()})}))}),hu=e.forwardRef((e,t)=>{const{__scopeSelect:n}=e,a=r(e,pc);return(0,jt.jsx)(wa.div,c(c({"aria-hidden":!0},a),{},{ref:t}))});hu.displayName="SelectSeparator";var fu="SelectArrow",mu=e.forwardRef((e,t)=>{const{__scopeSelect:n}=e,a=r(e,hc),s=Sc(n),i=Ic(fu,n),o=jc(fu,n);return i.open&&"popper"===o.position?(0,jt.jsx)(qo,c(c(c({},s),a),{},{ref:t})):null});mu.displayName=fu;var gu=e.forwardRef((t,n)=>{let{__scopeSelect:a,value:s}=t,i=r(t,fc);const o=e.useRef(null),l=Gt(n,o),u=Jo(s);return e.useEffect(()=>{const e=o.current;if(!e)return;const t=window.HTMLSelectElement.prototype,n=Object.getOwnPropertyDescriptor(t,"value").set;if(u!==s&&n){const t=new Event("change",{bubbles:!0});n.call(e,s),e.dispatchEvent(t)}},[u,s]),(0,jt.jsx)(wa.select,c(c({},i),{},{style:c(c({},Zo),i.style),ref:l,defaultValue:s}))});function yu(e){return""===e||void 0===e}function bu(t){const n=Qr(t),a=e.useRef(""),r=e.useRef(0),s=e.useCallback(e=>{const t=a.current+e;n(t),function e(t){a.current=t,window.clearTimeout(r.current),""!==t&&(r.current=window.setTimeout(()=>e(""),1e3))}(t)},[n]),i=e.useCallback(()=>{a.current="",window.clearTimeout(r.current)},[]);return e.useEffect(()=>()=>window.clearTimeout(r.current),[]),[a,s,i]}function vu(e,t,n){const a=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,r=n?e.indexOf(n):-1;let s=(i=e,o=Math.max(r,0),i.map((e,t)=>i[(o+t)%i.length]));var i,o;1===a.length&&(s=s.filter(e=>e!==n));const l=s.find(e=>e.textValue.toLowerCase().startsWith(a.toLowerCase()));return l!==n?l:void 0}gu.displayName="SelectBubbleInput";var xu=Ec,wu=Ac,ku=Fc,Su=Dc,Nu=Mc,Iu=Pc,Cu=Kc,Tu=$c,Eu=au,_u=su,Au=ou,Ru=cu,Fu=du,Du=hu;const Mu=Qa("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Ou=Qa("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Pu=Qa("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Lu=["className","children"],zu=["className"],ju=["className"],Bu=["className","children","position"],Wu=["className"],Vu=["className","children"],Uu=["className"],Hu=xu,Gu=ku,qu=e.forwardRef((e,t)=>{let{className:n,children:a}=e,s=r(e,Lu);return(0,jt.jsxs)(wu,c(c({ref:t,className:ha("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n)},s),{},{children:[a,(0,jt.jsx)(Su,{asChild:!0,children:(0,jt.jsx)(Mu,{className:"h-4 w-4 opacity-50"})})]}))});qu.displayName=wu.displayName;const Ku=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,zu);return(0,jt.jsx)(Ru,c(c({ref:t,className:ha("flex cursor-default items-center justify-center py-1",n)},a),{},{children:(0,jt.jsx)(Ou,{className:"h-4 w-4"})}))});Ku.displayName=Ru.displayName;const Xu=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,ju);return(0,jt.jsx)(Fu,c(c({ref:t,className:ha("flex cursor-default items-center justify-center py-1",n)},a),{},{children:(0,jt.jsx)(Mu,{className:"h-4 w-4"})}))});Xu.displayName=Fu.displayName;const Yu=e.forwardRef((e,t)=>{let{className:n,children:a,position:s="popper"}=e,i=r(e,Bu);return(0,jt.jsx)(Nu,{children:(0,jt.jsxs)(Iu,c(c({ref:t,className:ha("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:s},i),{},{children:[(0,jt.jsx)(Ku,{}),(0,jt.jsx)(Cu,{className:ha("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,jt.jsx)(Xu,{})]}))})});Yu.displayName=Iu.displayName;e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Wu);return(0,jt.jsx)(Tu,c({ref:t,className:ha("px-2 py-1.5 text-sm font-semibold",n)},a))}).displayName=Tu.displayName;const Qu=e.forwardRef((e,t)=>{let{className:n,children:a}=e,s=r(e,Vu);return(0,jt.jsxs)(Eu,c(c({ref:t,className:ha("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n)},s),{},{children:[(0,jt.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,jt.jsx)(Au,{children:(0,jt.jsx)(Pu,{className:"h-4 w-4"})})}),(0,jt.jsx)(_u,{children:a})]}))});Qu.displayName=Eu.displayName;e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Uu);return(0,jt.jsx)(Du,c({ref:t,className:ha("-mx-1 my-1 h-px bg-muted",n)},a))}).displayName=Du.displayName;var Ju=t=>{const{present:n,children:a}=t,r=function(t){const[n,a]=e.useState(),r=e.useRef(null),s=e.useRef(t),i=e.useRef("none"),o=t?"mounted":"unmounted",[l,c]=function(t,n){return e.useReducer((e,t)=>{const a=n[e][t];return null!==a&&void 0!==a?a:e},t)}(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return e.useEffect(()=>{const e=Zu(r.current);i.current="mounted"===l?e:"none"},[l]),ws(()=>{const e=r.current,n=s.current;if(n!==t){const a=i.current,r=Zu(e);if(t)c("MOUNT");else if("none"===r||"none"===(null===e||void 0===e?void 0:e.display))c("UNMOUNT");else{c(n&&a!==r?"ANIMATION_OUT":"UNMOUNT")}s.current=t}},[t,c]),ws(()=>{if(n){var e;let t;const a=null!==(e=n.ownerDocument.defaultView)&&void 0!==e?e:window,o=e=>{const i=Zu(r.current).includes(CSS.escape(e.animationName));if(e.target===n&&i&&(c("ANIMATION_END"),!s.current)){const e=n.style.animationFillMode;n.style.animationFillMode="forwards",t=a.setTimeout(()=>{"forwards"===n.style.animationFillMode&&(n.style.animationFillMode=e)})}},l=e=>{e.target===n&&(i.current=Zu(r.current))};return n.addEventListener("animationstart",l),n.addEventListener("animationcancel",o),n.addEventListener("animationend",o),()=>{a.clearTimeout(t),n.removeEventListener("animationstart",l),n.removeEventListener("animationcancel",o),n.removeEventListener("animationend",o)}}c("ANIMATION_END")},[n,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:e.useCallback(e=>{r.current=e?getComputedStyle(e):null,a(e)},[])}}(n),s="function"===typeof a?a({present:r.isPresent}):e.Children.only(a),i=Gt(r.ref,function(e){var t,n;let a=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,r=a&&"isReactWarning"in a&&a.isReactWarning;if(r)return e.ref;if(a=null===(n=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===n?void 0:n.get,r=a&&"isReactWarning"in a&&a.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(s));return"function"===typeof a||r.isPresent?e.cloneElement(s,{ref:i}):null};function Zu(e){return(null===e||void 0===e?void 0:e.animationName)||"none"}Ju.displayName="Presence";const $u=["__scopeCheckbox","onKeyDown","onClick"],ed=["__scopeCheckbox","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"],td=["__scopeCheckbox","forceMount"],nd=["__scopeCheckbox"];var ad="Checkbox",[rd,sd]=ir(ad),[id,od]=rd(ad);function ld(t){const{__scopeCheckbox:n,checked:a,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:u,required:d,value:p="on",internal_do_not_use_render:h}=t,[f,m]=Qo({prop:a,defaultProp:null!==s&&void 0!==s&&s,onChange:u,caller:ad}),[g,y]=e.useState(null),[b,v]=e.useState(null),x=e.useRef(!1),w=!g||(!!o||!!g.closest("form")),k={checked:f,disabled:i,setChecked:m,control:g,setControl:y,name:l,form:o,value:p,hasConsumerStoppedPropagationRef:x,required:d,defaultChecked:!yd(s)&&s,isFormControl:w,bubbleInput:b,setBubbleInput:v};return(0,jt.jsx)(id,c(c({scope:n},k),{},{children:gd(h)?h(k):r}))}var cd="CheckboxTrigger",ud=e.forwardRef((t,n)=>{let{__scopeCheckbox:a,onKeyDown:s,onClick:i}=t,o=r(t,$u);const{control:l,value:u,disabled:d,checked:p,required:h,setControl:f,setChecked:m,hasConsumerStoppedPropagationRef:g,isFormControl:y,bubbleInput:b}=od(cd,a),v=Gt(n,f),x=e.useRef(p);return e.useEffect(()=>{const e=null===l||void 0===l?void 0:l.form;if(e){const t=()=>m(x.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[l,m]),(0,jt.jsx)(wa.button,c(c({type:"button",role:"checkbox","aria-checked":yd(p)?"mixed":p,"aria-required":h,"data-state":bd(p),"data-disabled":d?"":void 0,disabled:d,value:u},o),{},{ref:v,onKeyDown:zr(s,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:zr(i,e=>{m(e=>!!yd(e)||!e),b&&y&&(g.current=e.isPropagationStopped(),g.current||e.stopPropagation())})}))});ud.displayName=cd;var dd=e.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:a,checked:s,defaultChecked:i,required:o,disabled:l,value:u,onCheckedChange:d,form:p}=e,h=r(e,ed);return(0,jt.jsx)(ld,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:d,name:a,form:p,value:u,internal_do_not_use_render:e=>{let{isFormControl:a}=e;return(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)(ud,c(c({},h),{},{ref:t,__scopeCheckbox:n})),a&&(0,jt.jsx)(md,{__scopeCheckbox:n})]})}})});dd.displayName=ad;var pd="CheckboxIndicator",hd=e.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:a}=e,s=r(e,td),i=od(pd,n);return(0,jt.jsx)(Ju,{present:a||yd(i.checked)||!0===i.checked,children:(0,jt.jsx)(wa.span,c(c({"data-state":bd(i.checked),"data-disabled":i.disabled?"":void 0},s),{},{ref:t,style:c({pointerEvents:"none"},e.style)}))})});hd.displayName=pd;var fd="CheckboxBubbleInput",md=e.forwardRef((t,n)=>{let{__scopeCheckbox:a}=t,s=r(t,nd);const{control:i,hasConsumerStoppedPropagationRef:o,checked:l,defaultChecked:u,required:d,disabled:p,name:h,value:f,form:m,bubbleInput:g,setBubbleInput:y}=od(fd,a),b=Gt(n,y),v=Jo(l),x=wo(i);e.useEffect(()=>{const e=g;if(!e)return;const t=window.HTMLInputElement.prototype,n=Object.getOwnPropertyDescriptor(t,"checked").set,a=!o.current;if(v!==l&&n){const t=new Event("click",{bubbles:a});e.indeterminate=yd(l),n.call(e,!yd(l)&&l),e.dispatchEvent(t)}},[g,v,l,o]);const w=e.useRef(!yd(l)&&l);return(0,jt.jsx)(wa.input,c(c({type:"checkbox","aria-hidden":!0,defaultChecked:null!==u&&void 0!==u?u:w.current,required:d,disabled:p,name:h,value:f,form:m},s),{},{tabIndex:-1,ref:b,style:c(c(c({},s.style),x),{},{position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"})}))});function gd(e){return"function"===typeof e}function yd(e){return"indeterminate"===e}function bd(e){return yd(e)?"indeterminate":e?"checked":"unchecked"}md.displayName=fd;const vd=["className"],xd=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,vd);return(0,jt.jsx)(dd,c(c({ref:t,className:ha("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",n)},a),{},{children:(0,jt.jsx)(hd,{className:ha("flex items-center justify-center text-current"),children:(0,jt.jsx)(Pu,{className:"h-4 w-4"})})}))});xd.displayName=dd.displayName;let wd=0;const kd=new Map,Sd=e=>{if(kd.has(e))return;const t=setTimeout(()=>{kd.delete(e),Td({type:"REMOVE_TOAST",toastId:e})},1e6);kd.set(e,t)},Nd=(e,t)=>{switch(t.type){case"ADD_TOAST":return c(c({},e),{},{toasts:[t.toast,...e.toasts].slice(0,1)});case"UPDATE_TOAST":return c(c({},e),{},{toasts:e.toasts.map(e=>e.id===t.toast.id?c(c({},e),t.toast):e)});case"DISMISS_TOAST":{const{toastId:n}=t;return n?Sd(n):e.toasts.forEach(e=>{Sd(e.id)}),c(c({},e),{},{toasts:e.toasts.map(e=>e.id===n||void 0===n?c(c({},e),{},{open:!1}):e)})}case"REMOVE_TOAST":return void 0===t.toastId?c(c({},e),{},{toasts:[]}):c(c({},e),{},{toasts:e.toasts.filter(e=>e.id!==t.toastId)})}},Id=[];let Cd={toasts:[]};function Td(e){Cd=Nd(Cd,e),Id.forEach(e=>{e(Cd)})}function Ed(e){let t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));const n=(wd=(wd+1)%Number.MAX_SAFE_INTEGER,wd.toString()),a=()=>Td({type:"DISMISS_TOAST",toastId:n});return Td({type:"ADD_TOAST",toast:c(c({},t),{},{id:n,open:!0,onOpenChange:e=>{e||a()}})}),{id:n,dismiss:a,update:e=>Td({type:"UPDATE_TOAST",toast:c(c({},e),{},{id:n})})}}function _d(){const[t,n]=e.useState(Cd);return e.useEffect(()=>(Id.push(n),()=>{const e=Id.indexOf(n);e>-1&&Id.splice(e,1)}),[t]),c(c({},t),{},{toast:Ed,dismiss:e=>Td({type:"DISMISS_TOAST",toastId:e})})}const Ad=Qa("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Rd=Qa("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Fd=Qa("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Dd=Qa("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Md=Qa("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Od=()=>{const{toast:t}=_d(),[n,a]=(0,e.useState)({title:"",year:(new Date).getFullYear(),physicalLocation:"",softFile:null,ownership:"",accessRights:[]}),[r,s]=(0,e.useState)(!1),[i,o]=(0,e.useState)(!1),l=(e,t)=>{a(n=>c(c({},n),{},{[e]:t}))},u=()=>{a({title:"",year:(new Date).getFullYear(),physicalLocation:"",softFile:null,ownership:"",accessRights:[]}),s(!1)};var d;return r?(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2 text-green-600",children:[(0,jt.jsx)(Ad,{className:"h-6 w-6"}),(0,jt.jsx)("h1",{className:"text-2xl font-bold",children:"Document Registered Successfully"})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Document Preview"}),(0,jt.jsx)(Pa,{children:"Review the registered document details"})]}),(0,jt.jsxs)(La,{className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)(Ca,{className:"text-sm font-medium text-gray-500",children:"Document Title"}),(0,jt.jsx)("p",{className:"text-lg font-semibold",children:n.title})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)(Ca,{className:"text-sm font-medium text-gray-500",children:"Year"}),(0,jt.jsx)("p",{className:"text-lg",children:n.year})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)(Ca,{className:"text-sm font-medium text-gray-500",children:"Physical Location"}),(0,jt.jsx)("p",{className:"text-lg",children:n.physicalLocation})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)(Ca,{className:"text-sm font-medium text-gray-500",children:"Ownership"}),(0,jt.jsx)("p",{className:"text-lg",children:n.ownership})]})]}),(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)(Ca,{className:"text-sm font-medium text-gray-500",children:"Uploaded File"}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[(0,jt.jsx)($a,{className:"h-5 w-5 text-gray-600"}),(0,jt.jsx)("span",{children:(null===(d=n.softFile)||void 0===d?void 0:d.name)||"No file uploaded"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)(Ca,{className:"text-sm font-medium text-gray-500",children:"Access Rights"}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:n.accessRights.map(e=>(0,jt.jsx)(rr,{variant:"outline",children:e},e))})]})]})]}),(0,jt.jsx)("div",{className:"pt-4 border-t",children:(0,jt.jsxs)("div",{className:"flex space-x-4",children:[(0,jt.jsx)(ga,{onClick:u,className:"bg-[#5d87ff] hover:bg-[#4c75e8]",children:"Register Another Document"}),(0,jt.jsx)(ga,{variant:"outline",children:"View in Archive"})]})})]})]})]}):(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Document Registration"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Add a new document to the smart filing system"})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Register New Document"}),(0,jt.jsx)(Pa,{children:"Fill in the document details to add it to the archive"})]}),(0,jt.jsx)(La,{children:(0,jt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),o(!0),await new Promise(e=>setTimeout(e,2e3)),s(!0),o(!1),t({title:"Document registered successfully!",description:"The document has been added to the archive system."})},className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)(Ca,{htmlFor:"title",className:"flex items-center space-x-2",children:[(0,jt.jsx)($a,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:"Document Title *"})]}),(0,jt.jsx)(ba,{id:"title",value:n.title,onChange:e=>l("title",e.target.value),placeholder:"Enter document title",required:!0})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)(Ca,{htmlFor:"year",className:"flex items-center space-x-2",children:[(0,jt.jsx)(Rd,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:"Year *"})]}),(0,jt.jsx)(ba,{id:"year",type:"number",value:n.year,onChange:e=>l("year",parseInt(e.target.value)),min:"1900",max:(new Date).getFullYear()+10,required:!0})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)(Ca,{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Fd,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:"Physical Location *"})]}),(0,jt.jsxs)(Hu,{value:n.physicalLocation,onValueChange:e=>l("physicalLocation",e),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Select location"})}),(0,jt.jsx)(Yu,{children:Ct.map(e=>(0,jt.jsx)(Qu,{value:e,children:e},e))})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)(Ca,{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Dd,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:"Ownership *"})]}),(0,jt.jsxs)(Hu,{value:n.ownership,onValueChange:e=>l("ownership",e),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Select department"})}),(0,jt.jsx)(Yu,{children:Tt.map(e=>(0,jt.jsx)(Qu,{value:e,children:e},e))})]})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)(Ca,{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Md,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:"Upload Soft File"})]}),(0,jt.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)(Md,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,jt.jsxs)("div",{className:"mt-4",children:[(0,jt.jsxs)(Ca,{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,jt.jsx)("span",{className:"text-[#5d87ff] hover:text-[#4c75e8] font-medium",children:"Click to upload"}),(0,jt.jsx)("span",{className:"text-gray-600",children:" or drag and drop"})]}),(0,jt.jsx)(ba,{id:"file-upload",type:"file",className:"hidden",onChange:e=>{const n=e.target.files[0];n&&(a(e=>c(c({},e),{},{softFile:n})),t({title:"File uploaded",description:"".concat(n.name," has been selected for upload.")}))},accept:".pdf,.doc,.docx,.txt"})]}),(0,jt.jsx)("p",{className:"text-xs text-gray-500",children:"PDF, DOC, DOCX, TXT up to 10MB"}),n.softFile&&(0,jt.jsxs)(Va,{className:"mt-4 border-green-200 bg-green-50",children:[(0,jt.jsx)(Ad,{className:"h-4 w-4 text-green-600"}),(0,jt.jsxs)(Ua,{className:"text-green-800",children:[n.softFile.name," ready for upload"]})]})]})})]}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)(Ca,{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Dr,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:"Access Rights *"})]}),(0,jt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Et.map(e=>(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(xd,{id:e,checked:n.accessRights.includes(e),onCheckedChange:t=>((e,t)=>{a(n=>c(c({},n),{},{accessRights:t?[...n.accessRights,e]:n.accessRights.filter(t=>t!==e)}))})(e,t)}),(0,jt.jsx)(Ca,{htmlFor:e,className:"text-sm font-normal cursor-pointer",children:e})]},e))})]}),(0,jt.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,jt.jsx)(ga,{type:"button",variant:"outline",onClick:u,children:"Reset Form"}),(0,jt.jsx)(ga,{type:"submit",className:"bg-[#5d87ff] hover:bg-[#4c75e8]",disabled:i||!n.title||!n.physicalLocation||!n.ownership||0===n.accessRights.length,children:i?"Registering...":"Register Document"})]})]})})]})]})},Pd=Qa("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),Ld=Qa("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),zd=Qa("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),jd=()=>{const t=fe(),[n,a]=(0,e.useState)(""),[r,s]=(0,e.useState)({year:"",location:"",ownership:"",accessRights:"",status:""}),[i,o]=(0,e.useState)(!1),l=(0,e.useMemo)(()=>{let e=It;return n&&(e=e.filter(e=>e.title.toLowerCase().includes(n.toLowerCase())||e.ownership.toLowerCase().includes(n.toLowerCase()))),r.year&&(e=e.filter(e=>e.year.toString()===r.year)),r.location&&(e=e.filter(e=>e.physicalLocation===r.location)),r.ownership&&(e=e.filter(e=>e.ownership===r.ownership)),r.accessRights&&(e=e.filter(e=>e.accessRights.includes(r.accessRights))),r.status&&(e=e.filter(e=>e.status===r.status)),e},[n,r]),u=(e,t)=>{s(n=>c(c({},n),{},{[e]:t}))},d=()=>{s({year:"",location:"",ownership:"",accessRights:"",status:""}),a("")},p=e=>{switch(e){case"Available":return"bg-green-100 text-green-800 border-green-200";case"Borrowed":return"bg-blue-100 text-blue-800 border-blue-200";case"Overdue":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},h=Object.values(r).filter(Boolean).length;return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Document Search"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Find and access documents in the archive system"})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsx)(Ma,{children:(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)(Oa,{children:"Search Documents"}),(0,jt.jsx)(Pa,{children:"Use filters to narrow down your search"})]}),(0,jt.jsxs)(ga,{variant:"outline",onClick:()=>o(!i),className:"flex items-center space-x-2",children:[(0,jt.jsx)(Pd,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:"Filters"}),h>0&&(0,jt.jsx)(rr,{className:"bg-[#5d87ff] text-white ml-2",children:h})]})]})}),(0,jt.jsxs)(La,{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)(Ld,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,jt.jsx)(ba,{placeholder:"Search by title, ownership, or keywords...",value:n,onChange:e=>a(e.target.value),className:"pl-10"})]}),i&&(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{children:"Year"}),(0,jt.jsxs)(Hu,{value:r.year,onValueChange:e=>u("year",e),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Any year"})}),(0,jt.jsxs)(Yu,{children:[(0,jt.jsx)(Qu,{value:"",children:"Any year"}),[...new Set(It.map(e=>e.year))].sort().reverse().map(e=>(0,jt.jsx)(Qu,{value:e.toString(),children:e},e))]})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{children:"Location"}),(0,jt.jsxs)(Hu,{value:r.location,onValueChange:e=>u("location",e),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Any location"})}),(0,jt.jsxs)(Yu,{children:[(0,jt.jsx)(Qu,{value:"",children:"Any location"}),Ct.map(e=>(0,jt.jsx)(Qu,{value:e,children:e},e))]})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{children:"Ownership"}),(0,jt.jsxs)(Hu,{value:r.ownership,onValueChange:e=>u("ownership",e),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Any department"})}),(0,jt.jsxs)(Yu,{children:[(0,jt.jsx)(Qu,{value:"",children:"Any department"}),Tt.map(e=>(0,jt.jsx)(Qu,{value:e,children:e},e))]})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{children:"Access Rights"}),(0,jt.jsxs)(Hu,{value:r.accessRights,onValueChange:e=>u("accessRights",e),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Any access"})}),(0,jt.jsxs)(Yu,{children:[(0,jt.jsx)(Qu,{value:"",children:"Any access"}),Et.map(e=>(0,jt.jsx)(Qu,{value:e,children:e},e))]})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{children:"Status"}),(0,jt.jsxs)(Hu,{value:r.status,onValueChange:e=>u("status",e),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Any status"})}),(0,jt.jsxs)(Yu,{children:[(0,jt.jsx)(Qu,{value:"",children:"Any status"}),(0,jt.jsx)(Qu,{value:"Available",children:"Available"}),(0,jt.jsx)(Qu,{value:"Borrowed",children:"Borrowed"}),(0,jt.jsx)(Qu,{value:"Overdue",children:"Overdue"})]})]})]}),h>0&&(0,jt.jsx)("div",{className:"flex items-end",children:(0,jt.jsxs)(ga,{variant:"outline",onClick:d,className:"w-full",children:[(0,jt.jsx)(zd,{className:"h-4 w-4 mr-2"}),"Clear"]})})]})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Search Results"}),(0,jt.jsxs)(Pa,{children:["Found ",l.length," document",1!==l.length?"s":""]})]}),(0,jt.jsx)(La,{children:0===l.length?(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsx)($a,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,jt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents found"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search criteria or filters"}),(0,jt.jsx)(ga,{onClick:d,variant:"outline",children:"Clear all filters"})]}):(0,jt.jsx)("div",{className:"space-y-4",children:l.map(e=>(0,jt.jsx)("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:(0,jt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,jt.jsx)("h3",{className:"font-semibold text-lg",children:e.title}),(0,jt.jsx)(rr,{className:p(e.status),children:e.status})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Rd,{className:"h-4 w-4"}),(0,jt.jsxs)("span",{children:["Year: ",e.year]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Fd,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:e.physicalLocation})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Dd,{className:"h-4 w-4"}),(0,jt.jsx)("span",{children:e.ownership})]})]}),(0,jt.jsx)("div",{className:"mt-3",children:(0,jt.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.accessRights.slice(0,3).map(e=>(0,jt.jsx)(rr,{variant:"outline",className:"text-xs",children:e},e)),e.accessRights.length>3&&(0,jt.jsxs)(rr,{variant:"outline",className:"text-xs",children:["+",e.accessRights.length-3," more"]})]})}),e.borrowedBy&&(0,jt.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:[(0,jt.jsxs)("span",{children:["Borrowed by: ",(0,jt.jsx)("strong",{children:e.borrowedBy})]}),e.returnDate&&(0,jt.jsxs)("span",{className:"ml-4",children:["Due: ",e.returnDate]})]})]}),(0,jt.jsxs)(ga,{onClick:()=>t("/document/".concat(e.id)),className:"bg-[#5d87ff] hover:bg-[#4c75e8] ml-4",children:[(0,jt.jsx)(Za,{className:"h-4 w-4 mr-2"}),"View Details"]})]})},e.id))})})]})]})},Bd=Qa("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Wd=Qa("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Vd=Qa("download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ud=Qa("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Hd=Qa("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Gd=()=>{const{id:t}=me(),n=fe(),{toast:a}=_d(),[r,s]=(0,e.useState)(!1),[i,o]=(0,e.useState)("scanning"),[l,c]=(0,e.useState)("ready"),[u,d]=(0,e.useState)(!1),p=It.find(e=>e.id===parseInt(t));if(!p)return(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsx)($a,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,jt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Document not found"}),(0,jt.jsx)(ga,{onClick:()=>n("/search"),variant:"outline",children:"Back to Search"})]});const h=e=>{switch(e){case"ready":default:return"bg-gray-400";case"green":return"bg-green-500 animate-pulse";case"red":return"bg-red-500 animate-pulse";case"yellow":return"bg-yellow-500 animate-pulse"}},f=()=>(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)(Da,{className:"w-96",children:[(0,jt.jsxs)(Ma,{className:"text-center",children:[(0,jt.jsxs)(Oa,{className:"flex items-center justify-center space-x-2",children:[(0,jt.jsx)(Ja,{className:"h-6 w-6 text-[#5d87ff]"}),(0,jt.jsx)("span",{children:"Biometric Verification"})]}),(0,jt.jsx)(Pa,{children:"Verifying your identity for document access"})]}),(0,jt.jsxs)(La,{className:"text-center space-y-4",children:["scanning"===i&&(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("div",{className:"bg-[#5d87ff] bg-opacity-10 p-6 rounded-full mx-auto w-fit animate-pulse",children:(0,jt.jsx)(Ja,{className:"h-12 w-12 text-[#5d87ff]"})}),(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:"Place your finger on the scanner..."}),(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,jt.jsx)("div",{className:"bg-[#5d87ff] h-2 rounded-full animate-pulse",style:{width:"60%"}})})]}),"success"===i&&(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("div",{className:"bg-green-100 p-6 rounded-full mx-auto w-fit",children:(0,jt.jsx)(Ad,{className:"h-12 w-12 text-green-600"})}),(0,jt.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Verification Successful!"}),(0,jt.jsx)("p",{className:"text-xs text-gray-600",children:"Processing request..."})]}),"denied"===i&&(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("div",{className:"bg-red-100 p-6 rounded-full mx-auto w-fit",children:(0,jt.jsx)(Bd,{className:"h-12 w-12 text-red-600"})}),(0,jt.jsx)("p",{className:"text-sm text-red-600 font-medium",children:"Access Denied"}),(0,jt.jsx)("p",{className:"text-xs text-gray-600",children:"Biometric verification failed"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-center space-x-2 pt-4 border-t",children:[(0,jt.jsx)("span",{className:"text-sm text-gray-600",children:"LED Status:"}),(0,jt.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(h(l))}),(0,jt.jsx)("span",{className:"text-sm capitalize text-gray-600",children:"ready"===l?"Ready":l})]})]})]})});return(0,jt.jsxs)("div",{className:"space-y-6",children:[r&&(0,jt.jsx)(f,{}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,jt.jsxs)(ga,{variant:"outline",onClick:()=>n("/search"),children:[(0,jt.jsx)(Wd,{className:"h-4 w-4 mr-2"}),"Back to Search"]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Document Details"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"View and manage document information"})]})]}),(0,jt.jsx)(rr,{className:(e=>{switch(e){case"Available":return"bg-green-100 text-green-800 border-green-200";case"Borrowed":return"bg-blue-100 text-blue-800 border-blue-200";case"Overdue":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(p.status),children:p.status})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,jt.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsxs)(Oa,{className:"flex items-center space-x-2",children:[(0,jt.jsx)($a,{className:"h-5 w-5"}),(0,jt.jsx)("span",{children:p.title})]}),(0,jt.jsx)(Pa,{children:"Document metadata and details"})]}),(0,jt.jsxs)(La,{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Rd,{className:"h-4 w-4 text-gray-500"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium",children:"Year"}),(0,jt.jsx)("p",{className:"text-lg",children:p.year})]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Fd,{className:"h-4 w-4 text-gray-500"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium",children:"Physical Location"}),(0,jt.jsx)("p",{className:"text-lg",children:p.physicalLocation})]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Dd,{className:"h-4 w-4 text-gray-500"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium",children:"Ownership"}),(0,jt.jsx)("p",{className:"text-lg",children:p.ownership})]})]})]}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Registration Date"}),(0,jt.jsx)("p",{children:p.registrationDate})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Last Accessed"}),(0,jt.jsx)("p",{children:p.lastAccessed})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Soft File"}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)($a,{className:"h-4 w-4 text-gray-500"}),(0,jt.jsx)("span",{className:"text-sm",children:p.softFile}),(0,jt.jsxs)(ga,{variant:"outline",size:"sm",children:[(0,jt.jsx)(Vd,{className:"h-3 w-3 mr-1"}),"Download"]})]})]})]})]}),(0,jt.jsxs)("div",{className:"pt-4 border-t",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,jt.jsx)(Dr,{className:"h-4 w-4 text-gray-500"}),(0,jt.jsx)("p",{className:"text-sm font-medium",children:"Access Rights"})]}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:p.accessRights.map(e=>(0,jt.jsx)(rr,{variant:"outline",children:e},e))})]})]})]}),"Available"!==p.status&&(0,jt.jsxs)(Da,{children:[(0,jt.jsx)(Ma,{children:(0,jt.jsx)(Oa,{children:"Borrowing Information"})}),(0,jt.jsx)(La,{children:(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Borrowed By"}),(0,jt.jsx)("p",{className:"text-lg",children:p.borrowedBy})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Borrow Date"}),(0,jt.jsx)("p",{children:p.borrowDate})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Expected Return Date"}),(0,jt.jsx)("p",{className:"Overdue"===p.status?"text-red-600 font-medium":"",children:p.returnDate})]}),"Overdue"===p.status&&(0,jt.jsx)(Va,{className:"border-red-200 bg-red-50",children:(0,jt.jsx)(Ua,{className:"text-red-800",children:"This document is overdue and requires immediate return."})})]})})]})]}),(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Document Actions"}),(0,jt.jsx)(Pa,{children:"Retrieve or return document"})]}),(0,jt.jsxs)(La,{className:"space-y-4",children:["Available"===p.status?(0,jt.jsxs)(ga,{onClick:()=>{s(!0),o("scanning"),c("ready"),setTimeout(()=>{Math.random()>.2?(o("success"),c("green"),a({title:"Access Granted",description:"Document retrieval authorized. Drawer is opening..."}),setTimeout(()=>{c("red"),s(!1),a({title:"Document Retrieved",description:"Please take the document from the drawer."})},3e3)):(o("denied"),c("ready"),a({title:"Access Denied",description:"Biometric verification failed. Please try again.",variant:"destructive"}),setTimeout(()=>{s(!1)},2e3))},2e3)},className:"w-full bg-[#5d87ff] hover:bg-[#4c75e8]",disabled:u,children:[(0,jt.jsx)(Ud,{className:"h-4 w-4 mr-2"}),"Retrieve Document"]}):(0,jt.jsxs)(ga,{onClick:()=>{d(!0),s(!0),o("scanning"),c("red"),setTimeout(()=>{o("success"),c("yellow"),a({title:"Document Returned",description:"Document has been successfully returned to the archive."}),setTimeout(()=>{c("ready"),s(!1),d(!1)},2e3)},2e3)},className:"w-full bg-green-600 hover:bg-green-700",disabled:u,children:[(0,jt.jsx)(Hd,{className:"h-4 w-4 mr-2"}),"Return Document"]}),(0,jt.jsxs)("div",{className:"pt-4 border-t",children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"IoT Status"}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(h(l))}),(0,jt.jsx)("span",{className:"text-sm capitalize",children:"ready"===l?"Ready":l})]})]})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsx)(Ma,{children:(0,jt.jsx)(Oa,{children:"Security Information"})}),(0,jt.jsxs)(La,{className:"space-y-3",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsx)("span",{className:"text-sm",children:"Fingerprint Required"}),(0,jt.jsx)(Ad,{className:"h-4 w-4 text-green-600"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsx)("span",{className:"text-sm",children:"Face Recognition"}),(0,jt.jsx)(Ad,{className:"h-4 w-4 text-green-600"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsx)("span",{className:"text-sm",children:"Tamper Detection"}),(0,jt.jsx)(Ad,{className:"h-4 w-4 text-green-600"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsx)("span",{className:"text-sm",children:"Location Tracking"}),(0,jt.jsx)(Ad,{className:"h-4 w-4 text-green-600"})]})]})]})]})]})]})},qd=["__scopeRovingFocusGroup","orientation","loop","dir","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus","preventScrollOnEntryFocus"],Kd=["__scopeRovingFocusGroup","focusable","active","tabStopId","children"];var Xd="rovingFocusGroup.onEntryFocus",Yd={bubbles:!1,cancelable:!0},Qd="RovingFocusGroup",[Jd,Zd,$d]=Hr(Qd),[ep,tp]=ir(Qd,[$d]),[np,ap]=ep(Qd),rp=e.forwardRef((e,t)=>(0,jt.jsx)(Jd.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,jt.jsx)(Jd.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,jt.jsx)(sp,c(c({},e),{},{ref:t}))})}));rp.displayName=Qd;var sp=e.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:a,orientation:s,loop:i=!1,dir:o,currentTabStopId:l,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:d,onEntryFocus:p,preventScrollOnEntryFocus:h=!1}=t,f=r(t,qd),m=e.useRef(null),g=Gt(n,m),y=Yr(o),[b,v]=Qo({prop:l,defaultProp:null!==u&&void 0!==u?u:null,onChange:d,caller:Qd}),[x,w]=e.useState(!1),k=Qr(p),S=Zd(a),N=e.useRef(!1),[I,C]=e.useState(0);return e.useEffect(()=>{const e=m.current;if(e)return e.addEventListener(Xd,k),()=>e.removeEventListener(Xd,k)},[k]),(0,jt.jsx)(np,{scope:a,orientation:s,dir:y,loop:i,currentTabStopId:b,onItemFocus:e.useCallback(e=>v(e),[v]),onItemShiftTab:e.useCallback(()=>w(!0),[]),onFocusableItemAdd:e.useCallback(()=>C(e=>e+1),[]),onFocusableItemRemove:e.useCallback(()=>C(e=>e-1),[]),children:(0,jt.jsx)(wa.div,c(c({tabIndex:x||0===I?-1:0,"data-orientation":s},f),{},{ref:g,style:c({outline:"none"},t.style),onMouseDown:zr(t.onMouseDown,()=>{N.current=!0}),onFocus:zr(t.onFocus,e=>{const t=!N.current;if(e.target===e.currentTarget&&t&&!x){const t=new CustomEvent(Xd,Yd);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){const e=S().filter(e=>e.focusable);cp([e.find(e=>e.active),e.find(e=>e.id===b),...e].filter(Boolean).map(e=>e.ref.current),h)}}N.current=!1}),onBlur:zr(t.onBlur,()=>w(!1))}))})}),ip="RovingFocusGroupItem",op=e.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:a,focusable:s=!0,active:i=!1,tabStopId:o,children:l}=t,u=r(t,Kd),d=Ns(),p=o||d,h=ap(ip,a),f=h.currentTabStopId===p,m=Zd(a),{onFocusableItemAdd:g,onFocusableItemRemove:y,currentTabStopId:b}=h;return e.useEffect(()=>{if(s)return g(),()=>y()},[s,g,y]),(0,jt.jsx)(Jd.ItemSlot,{scope:a,id:p,focusable:s,active:i,children:(0,jt.jsx)(wa.span,c(c({tabIndex:f?0:-1,"data-orientation":h.orientation},u),{},{ref:n,onMouseDown:zr(t.onMouseDown,e=>{s?h.onItemFocus(p):e.preventDefault()}),onFocus:zr(t.onFocus,()=>h.onItemFocus(p)),onKeyDown:zr(t.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void h.onItemShiftTab();if(e.target!==e.currentTarget)return;const t=function(e,t,n){const a=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,n);return"vertical"===t&&["ArrowLeft","ArrowRight"].includes(a)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)?void 0:lp[a]}(e,h.orientation,h.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let r=m().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)r.reverse();else if("prev"===t||"next"===t){"prev"===t&&r.reverse();const s=r.indexOf(e.currentTarget);r=h.loop?(a=s+1,(n=r).map((e,t)=>n[(a+t)%n.length])):r.slice(s+1)}setTimeout(()=>cp(r))}var n,a}),children:"function"===typeof l?l({isCurrentTabStop:f,hasTabStop:null!=b}):l}))})});op.displayName=ip;var lp={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function cp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.activeElement;for(const a of e){if(a===n)return;if(a.focus({preventScroll:t}),document.activeElement!==n)return}}var up=rp,dp=op;const pp=["__scopeTabs","value","onValueChange","defaultValue","orientation","dir","activationMode"],hp=["__scopeTabs","loop"],fp=["__scopeTabs","value","disabled"],mp=["__scopeTabs","value","forceMount","children"];var gp="Tabs",[yp,bp]=ir(gp,[tp]),vp=tp(),[xp,wp]=yp(gp),kp=e.forwardRef((e,t)=>{const{__scopeTabs:n,value:a,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:u="automatic"}=e,d=r(e,pp),p=Yr(l),[h,f]=Qo({prop:a,onChange:s,defaultProp:null!==i&&void 0!==i?i:"",caller:gp});return(0,jt.jsx)(xp,{scope:n,baseId:Ns(),value:h,onValueChange:f,orientation:o,dir:p,activationMode:u,children:(0,jt.jsx)(wa.div,c(c({dir:p,"data-orientation":o},d),{},{ref:t}))})});kp.displayName=gp;var Sp="TabsList",Np=e.forwardRef((e,t)=>{const{__scopeTabs:n,loop:a=!0}=e,s=r(e,hp),i=wp(Sp,n),o=vp(n);return(0,jt.jsx)(up,c(c({asChild:!0},o),{},{orientation:i.orientation,dir:i.dir,loop:a,children:(0,jt.jsx)(wa.div,c(c({role:"tablist","aria-orientation":i.orientation},s),{},{ref:t}))}))});Np.displayName=Sp;var Ip="TabsTrigger",Cp=e.forwardRef((e,t)=>{const{__scopeTabs:n,value:a,disabled:s=!1}=e,i=r(e,fp),o=wp(Ip,n),l=vp(n),u=_p(o.baseId,a),d=Ap(o.baseId,a),p=a===o.value;return(0,jt.jsx)(dp,c(c({asChild:!0},l),{},{focusable:!s,active:p,children:(0,jt.jsx)(wa.button,c(c({type:"button",role:"tab","aria-selected":p,"aria-controls":d,"data-state":p?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:u},i),{},{ref:t,onMouseDown:zr(e.onMouseDown,e=>{s||0!==e.button||!1!==e.ctrlKey?e.preventDefault():o.onValueChange(a)}),onKeyDown:zr(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&o.onValueChange(a)}),onFocus:zr(e.onFocus,()=>{const e="manual"!==o.activationMode;p||s||!e||o.onValueChange(a)})}))}))});Cp.displayName=Ip;var Tp="TabsContent",Ep=e.forwardRef((t,n)=>{const{__scopeTabs:a,value:s,forceMount:i,children:o}=t,l=r(t,mp),u=wp(Tp,a),d=_p(u.baseId,s),p=Ap(u.baseId,s),h=s===u.value,f=e.useRef(h);return e.useEffect(()=>{const e=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,jt.jsx)(Ju,{present:i||h,children:e=>{let{present:a}=e;return(0,jt.jsx)(wa.div,c(c({"data-state":h?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":d,hidden:!a,id:p,tabIndex:0},l),{},{ref:n,style:c(c({},t.style),{},{animationDuration:f.current?"0s":void 0}),children:a&&o}))}})});function _p(e,t){return"".concat(e,"-trigger-").concat(t)}function Ap(e,t){return"".concat(e,"-content-").concat(t)}Ep.displayName=Tp;var Rp=Np,Fp=Cp,Dp=Ep;const Mp=["className"],Op=["className"],Pp=["className"],Lp=kp,zp=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Mp);return(0,jt.jsx)(Rp,c({ref:t,className:ha("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",n)},a))});zp.displayName=Rp.displayName;const jp=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Op);return(0,jt.jsx)(Fp,c({ref:t,className:ha("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",n)},a))});jp.displayName=Fp.displayName;const Bp=e.forwardRef((e,t)=>{let{className:n}=e,a=r(e,Pp);return(0,jt.jsx)(Dp,c({ref:t,className:ha("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n)},a))});Bp.displayName=Dp.displayName;const Wp=Qa("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Vp=()=>{const{toast:t}=_d(),[n,a]=(0,e.useState)({documentId:"",borrower:"",startDate:"",endDate:"",purpose:""}),r=It.filter(e=>"Available"===e.status),s=It.filter(e=>"Borrowed"===e.status||"Overdue"===e.status),i=It.filter(e=>"Overdue"===e.status),o=e=>{t({title:"Document Returned",description:"Document has been successfully returned to the archive."})},l=e=>{switch(e){case"Borrowed":return"bg-blue-100 text-blue-800 border-blue-200";case"Overdue":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},u=e=>{const t=new Date,n=new Date(e)-t;return Math.ceil(n/864e5)};return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Borrowing System"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Manage document borrowing and returns"})]}),(0,jt.jsxs)(Lp,{defaultValue:"overview",className:"space-y-6",children:[(0,jt.jsxs)(zp,{className:"grid w-full grid-cols-4",children:[(0,jt.jsx)(jp,{value:"overview",children:"Overview"}),(0,jt.jsx)(jp,{value:"borrow",children:"Borrow Document"}),(0,jt.jsx)(jp,{value:"borrowed",children:"Borrowed Documents"}),(0,jt.jsx)(jp,{value:"overdue",children:"Overdue Documents"})]}),(0,jt.jsxs)(Bp,{value:"overview",className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:"Total Borrowed"}),(0,jt.jsx)(_r,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsx)("div",{className:"text-2xl font-bold",children:s.length}),(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently checked out"})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:"Available"}),(0,jt.jsx)(Ad,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsx)("div",{className:"text-2xl font-bold",children:r.length}),(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ready for borrowing"})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:"Overdue"}),(0,jt.jsx)(Rr,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsx)("div",{className:"text-2xl font-bold text-red-600",children:i.length}),(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:"Require attention"})]})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Recent Borrowing Activity"}),(0,jt.jsx)(Pa,{children:"Latest document borrowing and returns"})]}),(0,jt.jsx)(La,{children:(0,jt.jsx)("div",{className:"space-y-4",children:s.slice(0,5).map(e=>(0,jt.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)($a,{className:"h-5 w-5 text-gray-500"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"font-medium",children:e.title}),(0,jt.jsxs)("p",{className:"text-sm text-gray-600",children:["Borrowed by ",e.borrowedBy]}),(0,jt.jsxs)("p",{className:"text-xs text-gray-500",children:["Due: ",e.returnDate]})]})]}),(0,jt.jsx)(rr,{className:l(e.status),children:e.status})]},e.id))})})]})]}),(0,jt.jsx)(Bp,{value:"borrow",className:"space-y-6",children:(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsxs)(Oa,{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Wp,{className:"h-5 w-5"}),(0,jt.jsx)("span",{children:"Borrow Document"})]}),(0,jt.jsx)(Pa,{children:"Check out a document from the archive"})]}),(0,jt.jsx)(La,{children:(0,jt.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({title:"Document Borrowed Successfully",description:"Document has been checked out to ".concat(n.borrower,".")}),a({documentId:"",borrower:"",startDate:"",endDate:"",purpose:""})},className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{htmlFor:"document",children:"Document *"}),(0,jt.jsxs)(Hu,{value:n.documentId,onValueChange:e=>a(t=>c(c({},t),{},{documentId:e})),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Select a document"})}),(0,jt.jsx)(Yu,{children:r.map(e=>(0,jt.jsxs)(Qu,{value:e.id.toString(),children:[e.title," - ",e.physicalLocation]},e.id))})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{htmlFor:"borrower",children:"Borrower *"}),(0,jt.jsxs)(Hu,{value:n.borrower,onValueChange:e=>a(t=>c(c({},t),{},{borrower:e})),children:[(0,jt.jsx)(qu,{children:(0,jt.jsx)(Gu,{placeholder:"Select borrower"})}),(0,jt.jsx)(Yu,{children:Nt.map(e=>(0,jt.jsxs)(Qu,{value:e.name,children:[e.name," (",e.role,")"]},e.id))})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{htmlFor:"startDate",children:"Start Date *"}),(0,jt.jsx)(ba,{id:"startDate",type:"date",value:n.startDate,onChange:e=>a(t=>c(c({},t),{},{startDate:e.target.value})),required:!0})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{htmlFor:"endDate",children:"Return Date *"}),(0,jt.jsx)(ba,{id:"endDate",type:"date",value:n.endDate,onChange:e=>a(t=>c(c({},t),{},{endDate:e.target.value})),required:!0})]})]}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)(Ca,{htmlFor:"purpose",children:"Purpose (Optional)"}),(0,jt.jsx)(ba,{id:"purpose",placeholder:"Reason for borrowing...",value:n.purpose,onChange:e=>a(t=>c(c({},t),{},{purpose:e.target.value}))})]}),(0,jt.jsx)(ga,{type:"submit",className:"bg-[#5d87ff] hover:bg-[#4c75e8]",disabled:!n.documentId||!n.borrower||!n.startDate||!n.endDate,children:"Borrow Document"})]})})]})}),(0,jt.jsx)(Bp,{value:"borrowed",className:"space-y-6",children:(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Currently Borrowed Documents"}),(0,jt.jsx)(Pa,{children:"Documents that are currently checked out"})]}),(0,jt.jsx)(La,{children:(0,jt.jsxs)("div",{className:"space-y-4",children:[s.map(e=>{const t=u(e.returnDate);return(0,jt.jsx)("div",{className:"border rounded-lg p-4",children:(0,jt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,jt.jsx)("h3",{className:"font-semibold",children:e.title}),(0,jt.jsx)(rr,{className:l(e.status),children:e.status})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600 mb-3",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Dd,{className:"h-4 w-4"}),(0,jt.jsxs)("span",{children:["Borrowed by: ",(0,jt.jsx)("strong",{children:e.borrowedBy})]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Rd,{className:"h-4 w-4"}),(0,jt.jsxs)("span",{children:["Borrowed: ",e.borrowDate]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Ar,{className:"h-4 w-4"}),(0,jt.jsxs)("span",{className:t<0?"text-red-600 font-medium":t<=3?"text-yellow-600 font-medium":"",children:["Due: ",e.returnDate,t<0?" (".concat(Math.abs(t)," days overdue)"):t<=3?" (".concat(t," days left)"):""]})]})]}),(0,jt.jsxs)("p",{className:"text-sm text-gray-600",children:["Location: ",e.physicalLocation]})]}),(0,jt.jsx)(ga,{onClick:()=>o(e.id),variant:"outline",className:"ml-4",children:"Mark as Returned"})]})},e.id)}),0===s.length&&(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsx)(_r,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,jt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No borrowed documents"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"All documents are currently available in the archive."})]})]})})]})}),(0,jt.jsx)(Bp,{value:"overdue",className:"space-y-6",children:(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsxs)(Oa,{className:"flex items-center space-x-2 text-red-600",children:[(0,jt.jsx)(Rr,{className:"h-5 w-5"}),(0,jt.jsx)("span",{children:"Overdue Documents"})]}),(0,jt.jsx)(Pa,{children:"Documents that are past their return date"})]}),(0,jt.jsx)(La,{children:(0,jt.jsxs)("div",{className:"space-y-4",children:[i.map(e=>{const t=Math.abs(u(e.returnDate));return(0,jt.jsx)("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4",children:(0,jt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,jt.jsx)("h3",{className:"font-semibold text-red-900",children:e.title}),(0,jt.jsxs)(rr,{className:"bg-red-100 text-red-800 border-red-200",children:[t," days overdue"]})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-red-700 mb-3",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Dd,{className:"h-4 w-4"}),(0,jt.jsxs)("span",{children:["Borrowed by: ",(0,jt.jsx)("strong",{children:e.borrowedBy})]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Rd,{className:"h-4 w-4"}),(0,jt.jsxs)("span",{children:["Borrowed: ",e.borrowDate]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Ar,{className:"h-4 w-4"}),(0,jt.jsxs)("span",{children:["Was due: ",e.returnDate]})]})]}),(0,jt.jsxs)("p",{className:"text-sm text-red-600",children:["Location: ",e.physicalLocation]})]}),(0,jt.jsxs)("div",{className:"flex flex-col space-y-2 ml-4",children:[(0,jt.jsx)(ga,{onClick:()=>o(e.id),className:"bg-red-600 hover:bg-red-700 text-white",size:"sm",children:"Force Return"}),(0,jt.jsx)(ga,{variant:"outline",size:"sm",children:"Send Reminder"})]})]})},e.id)}),0===i.length&&(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsx)(Ad,{className:"mx-auto h-12 w-12 text-green-400 mb-4"}),(0,jt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No overdue documents"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"All borrowed documents are within their return periods."})]})]})})]})})]})]})},Up=Qa("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Hp=Qa("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),Gp=Qa("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),qp=Qa("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Kp=()=>{const[t,n]=(0,e.useState)([]),[a,r]=(0,e.useState)({iotSensors:96,networkStatus:99,databaseHealth:98,securityLevel:100});(0,e.useEffect)(()=>{const e=setInterval(()=>{const e=[{type:"warning",message:"Unusual access pattern detected at Rack B",icon:Rr},{type:"info",message:"Scheduled maintenance completed successfully",icon:Ad},{type:"error",message:"Sensor communication timeout at Drawer 2",icon:Bd},{type:"success",message:"Backup completed successfully",icon:Up}];if(Math.random()>.7){const t=e[Math.floor(Math.random()*e.length)],a=c(c({id:Date.now()},t),{},{timestamp:(new Date).toLocaleTimeString(),read:!1});n(e=>[a,...e.slice(0,9)])}},5e3);return()=>clearInterval(e)},[]);const s=e=>{switch(e){case"error":return"border-red-200 bg-red-50 text-red-800";case"warning":return"border-yellow-200 bg-yellow-50 text-yellow-800";case"success":return"border-green-200 bg-green-50 text-green-800";case"info":return"border-blue-200 bg-blue-50 text-blue-800";default:return"border-gray-200 bg-gray-50 text-gray-800"}};return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"System Monitoring"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Real-time monitoring and security dashboard"})]}),(0,jt.jsxs)(ga,{onClick:()=>{const e={id:Date.now(),type:"error",message:"SECURITY ALERT: Unauthorized tampering detected at Rack A - Drawer 1",icon:Dr,timestamp:(new Date).toLocaleTimeString(),read:!1};n(t=>[e,...t.slice(0,9)])},variant:"outline",className:"text-red-600 border-red-200",children:[(0,jt.jsx)(Dr,{className:"h-4 w-4 mr-2"}),"Simulate Tampering Alert"]})]}),(0,jt.jsxs)(Lp,{defaultValue:"overview",className:"space-y-6",children:[(0,jt.jsxs)(zp,{className:"grid w-full grid-cols-4",children:[(0,jt.jsx)(jp,{value:"overview",children:"System Overview"}),(0,jt.jsx)(jp,{value:"activity",children:"Activity Logs"}),(0,jt.jsx)(jp,{value:"security",children:"Security Monitoring"}),(0,jt.jsx)(jp,{value:"alerts",children:"Real-time Alerts"})]}),(0,jt.jsxs)(Bp,{value:"overview",className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:"IoT Sensors"}),(0,jt.jsx)(Hp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[a.iotSensors,"%"]}),(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:"24/25 sensors online"}),(0,jt.jsx)(Tr,{value:a.iotSensors,className:"mt-2 h-2"})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:"Network Status"}),(0,jt.jsx)(Gp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[a.networkStatus,"%"]}),(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:"All connections stable"}),(0,jt.jsx)(Tr,{value:a.networkStatus,className:"mt-2 h-2"})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:"Database Health"}),(0,jt.jsx)(Up,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[a.databaseHealth,"%"]}),(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:"Optimal performance"}),(0,jt.jsx)(Tr,{value:a.databaseHealth,className:"mt-2 h-2"})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,jt.jsx)(Oa,{className:"text-sm font-medium",children:"Security Level"}),(0,jt.jsx)(Dr,{className:"h-4 w-4 text-muted-foreground"})]}),(0,jt.jsxs)(La,{children:[(0,jt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[a.securityLevel,"%"]}),(0,jt.jsx)("p",{className:"text-xs text-muted-foreground",children:"All systems secure"}),(0,jt.jsx)(Tr,{value:a.securityLevel,className:"mt-2 h-2"})]})]})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Live System Statistics"}),(0,jt.jsx)(Pa,{children:"Current system performance metrics"})]}),(0,jt.jsxs)(La,{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,jt.jsx)("span",{className:"text-sm font-medium",children:"Active Users"}),(0,jt.jsx)("span",{className:"text-lg font-bold text-[#5d87ff]",children:Pt})]}),(0,jt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,jt.jsx)("span",{className:"text-sm font-medium",children:"Documents Accessed Today"}),(0,jt.jsx)("span",{className:"text-lg font-bold text-[#5d87ff]",children:"47"})]}),(0,jt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,jt.jsx)("span",{className:"text-sm font-medium",children:"Security Scans Completed"}),(0,jt.jsx)("span",{className:"text-lg font-bold text-[#5d87ff]",children:"1,247"})]}),(0,jt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,jt.jsx)("span",{className:"text-sm font-medium",children:"System Uptime"}),(0,jt.jsx)("span",{className:"text-lg font-bold text-green-600",children:"99.8%"})]})]})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"IoT Device Status"}),(0,jt.jsx)(Pa,{children:"Smart drawer and sensor monitoring"})]}),(0,jt.jsx)(La,{className:"space-y-3",children:["Rack A - Drawer 1","Rack A - Drawer 2","Rack B - Drawer 1","Rack C - Drawer 1"].map((e,t)=>(0,jt.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(1===t?"bg-yellow-500":"bg-green-500")}),(0,jt.jsx)("span",{className:"text-sm font-medium",children:e})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)(rr,{variant:"outline",className:"text-xs",children:1===t?"Maintenance":"Online"}),1!==t&&(0,jt.jsx)(Ad,{className:"h-4 w-4 text-green-600"})]})]},e))})]})]})]}),(0,jt.jsx)(Bp,{value:"activity",className:"space-y-6",children:(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"System Activity Logs"}),(0,jt.jsx)(Pa,{children:"Detailed log of all system activities and user interactions"})]}),(0,jt.jsx)(La,{children:(0,jt.jsx)("div",{className:"space-y-3",children:_t.map(e=>{return(0,jt.jsxs)("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[(0,jt.jsx)("div",{className:"p-1 rounded-full ".concat("Success"===e.status?"bg-green-100":"bg-red-100"),children:(0,jt.jsx)(Mr,{className:"h-3 w-3 ".concat((t=e.status,"Success"===t?"text-green-600":"Denied"===t?"text-red-600":"text-gray-600"))})}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,jt.jsx)("span",{className:"font-medium text-sm",children:e.action}),(0,jt.jsx)(rr,{className:"Success"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:e.status})]}),(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:e.document}),(0,jt.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[(0,jt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,jt.jsx)(Dd,{className:"h-3 w-3"}),(0,jt.jsx)("span",{children:e.user})]}),(0,jt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,jt.jsx)($a,{className:"h-3 w-3"}),(0,jt.jsx)("span",{children:e.location})]}),(0,jt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,jt.jsx)(Ar,{className:"h-3 w-3"}),(0,jt.jsx)("span",{children:e.timestamp})]})]})]})]},e.id);var t})})})]})}),(0,jt.jsx)(Bp,{value:"security",className:"space-y-6",children:(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsxs)(Oa,{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Dr,{className:"h-5 w-5"}),(0,jt.jsx)("span",{children:"Security Events"})]}),(0,jt.jsx)(Pa,{children:"Recent security-related activities"})]}),(0,jt.jsx)(La,{className:"space-y-3",children:At.filter(e=>"alert"===e.type).map(e=>(0,jt.jsxs)(Va,{className:"border-red-200 bg-red-50",children:[(0,jt.jsx)(Rr,{className:"h-4 w-4 text-red-600"}),(0,jt.jsxs)(Ua,{className:"text-red-800",children:[(0,jt.jsx)("div",{className:"font-medium",children:e.title}),(0,jt.jsx)("div",{className:"text-sm mt-1",children:e.message}),(0,jt.jsx)("div",{className:"text-xs mt-2 text-red-600",children:e.timestamp})]})]},e.id))})]}),(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsx)(Oa,{children:"Access Control Status"}),(0,jt.jsx)(Pa,{children:"Biometric and security system status"})]}),(0,jt.jsxs)(La,{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)(qp,{className:"h-5 w-5 text-green-600"}),(0,jt.jsx)("span",{className:"font-medium",children:"Fingerprint Scanner"})]}),(0,jt.jsx)(rr,{className:"bg-green-100 text-green-800",children:"Active"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)(Za,{className:"h-5 w-5 text-green-600"}),(0,jt.jsx)("span",{className:"font-medium",children:"Face Recognition"})]}),(0,jt.jsx)(rr,{className:"bg-green-100 text-green-800",children:"Active"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)(Dr,{className:"h-5 w-5 text-green-600"}),(0,jt.jsx)("span",{className:"font-medium",children:"Tamper Detection"})]}),(0,jt.jsx)(rr,{className:"bg-green-100 text-green-800",children:"Monitoring"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)(Ud,{className:"h-5 w-5 text-yellow-600"}),(0,jt.jsx)("span",{className:"font-medium",children:"Emergency Override"})]}),(0,jt.jsx)(rr,{className:"bg-yellow-100 text-yellow-800",children:"Standby"})]})]})]})]})}),(0,jt.jsx)(Bp,{value:"alerts",className:"space-y-6",children:(0,jt.jsxs)(Da,{children:[(0,jt.jsxs)(Ma,{children:[(0,jt.jsxs)(Oa,{className:"flex items-center space-x-2",children:[(0,jt.jsx)(Mr,{className:"h-5 w-5"}),(0,jt.jsx)("span",{children:"Real-time System Alerts"})]}),(0,jt.jsx)(Pa,{children:"Live feed of system events and notifications"})]}),(0,jt.jsx)(La,{children:(0,jt.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===t.length?(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsx)(Ad,{className:"mx-auto h-12 w-12 text-green-400 mb-4"}),(0,jt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"All Systems Normal"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"No alerts at this time. System is operating normally."})]}):t.map(e=>(0,jt.jsxs)(Va,{className:s(e.type),children:[(0,jt.jsx)(e.icon,{className:"h-4 w-4"}),(0,jt.jsx)(Ua,{children:(0,jt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("div",{className:"font-medium",children:e.message}),(0,jt.jsx)("div",{className:"text-xs mt-1 opacity-75",children:e.timestamp})]}),(0,jt.jsx)(ga,{variant:"ghost",size:"sm",className:"text-xs h-6",children:"Acknowledge"})]})})]},e.id))})})]})})]})]})},Xp=Qa("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Yp=Qa("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]),Qp=Qa("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),Jp=Qa("log-out",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Zp=t=>{let{children:n}=t;const[a,r]=(0,e.useState)(!1),[s,i]=(0,e.useState)(!1),{user:o,logout:l}=Wt(),c=fe(),u=de(),d=[{name:"Dashboard",href:"/dashboard",icon:$a},{name:"Register Document",href:"/register",icon:Wp},{name:"Search Documents",href:"/search",icon:Ld},{name:"Borrowing System",href:"/borrowing",icon:_r},{name:"Monitoring",href:"/monitoring",icon:Xp},{name:"Face Recognition",href:"/face-recognition",icon:Hd}],p=At.filter(e=>!e.read).length;return(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a&&(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>r(!1)}),(0,jt.jsxs)("div",{className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 ".concat(a?"translate-x-0":"-translate-x-full"),children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 border-b",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("div",{className:"bg-[#5d87ff] p-2 rounded",children:(0,jt.jsx)($a,{className:"h-5 w-5 text-white"})}),(0,jt.jsx)("span",{className:"font-bold text-lg",children:"SFS"})]}),(0,jt.jsx)(ga,{variant:"ghost",size:"sm",className:"lg:hidden",onClick:()=>r(!1),children:(0,jt.jsx)(zd,{className:"h-4 w-4"})})]}),(0,jt.jsx)("nav",{className:"mt-4 px-2",children:d.map(e=>{const t=u.pathname===e.href;return(0,jt.jsxs)(ga,{variant:t?"default":"ghost",className:"w-full justify-start mb-1 ".concat(t?"bg-[#5d87ff] text-white hover:bg-[#4c75e8]":"text-gray-700 hover:bg-gray-100"),onClick:()=>{c(e.href),r(!1)},children:[(0,jt.jsx)(e.icon,{className:"mr-3 h-4 w-4"}),e.name]},e.name)})}),(0,jt.jsx)("div",{className:"absolute bottom-4 left-4 right-4",children:(0,jt.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,jt.jsx)(Dd,{className:"h-4 w-4 text-gray-600"}),(0,jt.jsx)("span",{className:"text-sm font-medium",children:null===o||void 0===o?void 0:o.name})]}),(0,jt.jsx)(rr,{variant:"outline",className:"text-xs",children:null===o||void 0===o?void 0:o.role})]})})]}),(0,jt.jsxs)("div",{className:"lg:pl-64",children:[(0,jt.jsxs)("header",{className:"bg-white shadow-sm border-b h-16 flex items-center justify-between px-4",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,jt.jsx)(ga,{variant:"ghost",size:"sm",className:"lg:hidden",onClick:()=>r(!0),children:(0,jt.jsx)(Yp,{className:"h-5 w-5"})}),(0,jt.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Smart Filing System"})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsxs)(ga,{variant:"ghost",size:"sm",onClick:()=>i(!s),className:"relative",children:[(0,jt.jsx)(Qp,{className:"h-5 w-5"}),p>0&&(0,jt.jsx)(rr,{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs min-w-5 h-5 flex items-center justify-center rounded-full",children:p})]}),s&&(0,jt.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border z-50",children:[(0,jt.jsx)("div",{className:"p-3 border-b",children:(0,jt.jsx)("h3",{className:"font-medium",children:"Notifications"})}),(0,jt.jsx)("div",{className:"max-h-96 overflow-y-auto",children:At.slice(0,5).map(e=>(0,jt.jsx)("div",{className:"p-3 border-b hover:bg-gray-50 ".concat(e.read?"":"bg-blue-50"),children:(0,jt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("p",{className:"font-medium text-sm",children:e.title}),(0,jt.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.message}),(0,jt.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.timestamp})]}),!e.read&&(0,jt.jsx)("div",{className:"w-2 h-2 bg-[#5d87ff] rounded-full ml-2 mt-1"})]})},e.id))})]})]}),(0,jt.jsxs)(ga,{variant:"ghost",size:"sm",onClick:()=>{l(),c("/login")},className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[(0,jt.jsx)(Jp,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),(0,jt.jsx)("main",{className:"p-6",children:n})]})]})};var $p="/index.js",eh=Object.defineProperty,th=n(291),nh=(e,t)=>{for(var n in t)eh(e,n,{get:t[n],enumerable:!0})};nh({},{Abs:()=>jf,Acos:()=>Bf,Acosh:()=>Wf,AdadeltaOptimizer:()=>CT,AdagradOptimizer:()=>TT,AdamOptimizer:()=>ET,AdamaxOptimizer:()=>_T,Add:()=>Vf,AddN:()=>Uf,All:()=>Hf,Any:()=>Gf,ArgMax:()=>qf,ArgMin:()=>Kf,Asin:()=>Xf,Asinh:()=>Yf,Atan:()=>Qf,Atan2:()=>Zf,Atanh:()=>Jf,AvgPool:()=>$f,AvgPool3D:()=>tm,AvgPool3DGrad:()=>nm,AvgPoolGrad:()=>em,BackendWasm:()=>lte,BatchMatMul:()=>am,BatchToSpaceND:()=>rm,Bincount:()=>sm,BitwiseAnd:()=>im,BroadcastArgs:()=>lm,BroadcastTo:()=>om,Callback:()=>sB,CallbackList:()=>BM,Cast:()=>cm,Ceil:()=>um,ClipByValue:()=>dm,Complex:()=>pm,ComplexAbs:()=>hm,Concat:()=>fm,Conv2D:()=>mm,Conv2DBackpropFilter:()=>gm,Conv2DBackpropInput:()=>ym,Conv3D:()=>bm,Conv3DBackpropFilterV2:()=>vm,Conv3DBackpropInputV2:()=>xm,Cos:()=>wm,Cosh:()=>km,CropAndResize:()=>Im,Cumprod:()=>Sm,Cumsum:()=>Nm,CustomCallback:()=>UM,DataStorage:()=>Dh,DenseBincount:()=>Cm,DepthToSpace:()=>Tm,DepthwiseConv2dNative:()=>Em,DepthwiseConv2dNativeBackpropFilter:()=>_m,DepthwiseConv2dNativeBackpropInput:()=>Am,Diag:()=>Rm,Dilation2D:()=>Fm,Dilation2DBackpropFilter:()=>Mm,Dilation2DBackpropInput:()=>Dm,Draw:()=>Om,ENV:()=>Pf,EarlyStopping:()=>lB,Einsum:()=>Lm,Elu:()=>zm,EluGrad:()=>jm,Environment:()=>Ff,Equal:()=>Wm,Erf:()=>Bm,Exp:()=>Vm,ExpandDims:()=>Um,Expm1:()=>Hm,FFT:()=>Gm,Fill:()=>qm,FlipLeftRight:()=>Km,Floor:()=>Xm,FloorDiv:()=>Ym,FromPixels:()=>Zy,FusedBatchNorm:()=>Qm,FusedConv2D:()=>tb,FusedDepthwiseConv2D:()=>nb,GPGPUContext:()=>iZ,GatherNd:()=>Zm,GatherV2:()=>Jm,GraphModel:()=>QW,Greater:()=>$m,GreaterEqual:()=>eg,History:()=>VM,IFFT:()=>ng,Identity:()=>tg,Imag:()=>ag,InputSpec:()=>VD,IsFinite:()=>rg,IsInf:()=>sg,IsNan:()=>ig,KernelBackend:()=>Mh,LRN:()=>vg,LRNGrad:()=>xg,LayerVariable:()=>jD,LayersModel:()=>HO,LeakyRelu:()=>og,Less:()=>lg,LessEqual:()=>cg,LinSpace:()=>ug,Log:()=>dg,Log1p:()=>pg,LogSoftmax:()=>yg,LogicalAnd:()=>hg,LogicalNot:()=>fg,LogicalOr:()=>mg,LogicalXor:()=>gg,LowerBound:()=>bg,MathBackendCPU:()=>mU,MathBackendWebGL:()=>w$,MatrixBandPart:()=>wg,Max:()=>kg,MaxPool:()=>Ng,MaxPool3D:()=>Cg,MaxPool3DGrad:()=>Tg,MaxPoolGrad:()=>Ig,MaxPoolWithArgmax:()=>Eg,Maximum:()=>Sg,Mean:()=>_g,Min:()=>Ag,Minimum:()=>Rg,MirrorPad:()=>Fg,Mod:()=>Dg,MomentumOptimizer:()=>RT,Multinomial:()=>Mg,Multiply:()=>Og,Neg:()=>Pg,NonMaxSuppressionV3:()=>zg,NonMaxSuppressionV4:()=>jg,NonMaxSuppressionV5:()=>Bg,NotEqual:()=>Lg,OP_SCOPE_SUFFIX:()=>Mv,OneHot:()=>Vg,OnesLike:()=>Wg,Optimizer:()=>IT,OptimizerConstructors:()=>PE,Pack:()=>Ug,PadV2:()=>Hg,Pool:()=>Gg,Pow:()=>qg,Prelu:()=>Kg,Prod:()=>Xg,RMSPropOptimizer:()=>FT,RNN:()=>ZP,RaggedGather:()=>Yg,RaggedRange:()=>Qg,RaggedTensorToTensor:()=>Jg,Range:()=>Zg,Rank:()=>ev,Real:()=>$g,RealDiv:()=>Pm,Reciprocal:()=>ey,Reduction:()=>qC,Relu:()=>ty,Relu6:()=>oy,Reshape:()=>ny,ResizeBilinear:()=>sy,ResizeBilinearGrad:()=>iy,ResizeNearestNeighbor:()=>ay,ResizeNearestNeighborGrad:()=>ry,Reverse:()=>ly,RotateWithOffset:()=>$y,Round:()=>cy,Rsqrt:()=>uy,SGDOptimizer:()=>AT,ScatterNd:()=>dy,SearchSorted:()=>hy,Select:()=>fy,Selu:()=>my,Sequential:()=>XO,Sigmoid:()=>xy,Sign:()=>vy,Sin:()=>yy,Sinh:()=>by,Slice:()=>gy,Softmax:()=>Cy,Softplus:()=>wy,SpaceToBatchND:()=>Ny,SparseFillEmptyRows:()=>Ty,SparseReshape:()=>Ey,SparseSegmentMean:()=>_y,SparseSegmentSum:()=>Ay,SparseToDense:()=>Ry,SplitV:()=>Iy,Sqrt:()=>ky,Square:()=>Dy,SquaredDifference:()=>Fy,StaticRegexReplace:()=>My,Step:()=>Jy,StridedSlice:()=>Oy,StringNGrams:()=>Py,StringSplit:()=>Ly,StringToHashBucketFast:()=>zy,Sub:()=>jy,Sum:()=>Sy,SymbolicTensor:()=>UD,Tan:()=>By,Tanh:()=>Wy,Tensor:()=>Jb,TensorBuffer:()=>Xb,TensorScatterUpdate:()=>py,Tile:()=>Vy,TopK:()=>Uy,Transform:()=>Hy,Transpose:()=>Gy,Unique:()=>qy,Unpack:()=>Ky,UnsortedSegmentSum:()=>Xy,UpperBound:()=>Yy,Variable:()=>$b,ZerosLike:()=>Qy,_FusedMatMul:()=>eb,abs:()=>hw,acos:()=>fw,acosh:()=>mw,add:()=>cw,addN:()=>gw,all:()=>yw,any:()=>bw,argMax:()=>vw,argMin:()=>xw,asin:()=>ww,asinh:()=>kw,atan:()=>Sw,atan2:()=>Nw,atanh:()=>Iw,avgPool:()=>Vw,avgPool3d:()=>Uw,backend:()=>ix,backend_util:()=>WE,basicLSTMCell:()=>Yw,batchNorm:()=>Zw,batchNorm2d:()=>$w,batchNorm3d:()=>ek,batchNorm4d:()=>tk,batchToSpaceND:()=>Qw,bincount:()=>nk,bitwiseAnd:()=>ak,booleanMaskAsync:()=>KI,broadcastArgs:()=>rk,broadcastTo:()=>sk,broadcast_util:()=>_k,browser:()=>aE,buffer:()=>sw,callbacks:()=>dB,cast:()=>iw,ceil:()=>ik,clipByValue:()=>lk,clone:()=>ow,complex:()=>Pv,concat:()=>Hw,concat1d:()=>ck,concat2d:()=>uk,concat3d:()=>dk,concat4d:()=>pk,constraints:()=>rM,conv1d:()=>fk,conv2d:()=>hk,conv2dTranspose:()=>gk,conv3d:()=>yk,conv3dTranspose:()=>vk,copyRegisteredKernels:()=>fb,cos:()=>xk,cosh:()=>wk,cosineWindow:()=>tC,cumprod:()=>kk,cumsum:()=>Sk,customGrad:()=>RS,data:()=>eV,denseBincount:()=>Nk,deprecationWarn:()=>Hv,depthToSpace:()=>Ik,depthwiseConv2d:()=>Ck,deregisterOp:()=>mB,device_util:()=>Nv,diag:()=>Tk,dilation2d:()=>Ek,disableDeprecationWarnings:()=>Uv,dispose:()=>Qv,disposeVariables:()=>Gv,div:()=>dw,divNoNan:()=>Pk,dot:()=>Lk,dropout:()=>$I,einsum:()=>zk,elu:()=>jk,enableDebugMode:()=>Vv,enableProdMode:()=>Wv,enclosingPowerOfTwo:()=>eC,engine:()=>qv,ensureShape:()=>Bk,env:()=>Mf,equal:()=>Dk,erf:()=>Wk,euclideanNorm:()=>sS,exp:()=>iS,expandDims:()=>oS,expm1:()=>lS,eye:()=>uS,fft:()=>gI,fill:()=>ok,findBackend:()=>ax,findBackendFactory:()=>rx,floor:()=>dS,floorDiv:()=>uw,forceHalfFloat:()=>S$,fused:()=>aC,gather:()=>pS,gatherND:()=>ZI,gather_util:()=>hE,getBackend:()=>tx,getGradient:()=>lb,getKernel:()=>ob,getKernelsForBackend:()=>cb,getThreadsCount:()=>kte,gpgpu_util:()=>LJ,grad:()=>CS,grads:()=>TS,greater:()=>hS,greaterEqual:()=>fS,ifft:()=>yI,imag:()=>mS,image:()=>hT,inTopKAsync:()=>nC,initializers:()=>vM,input:()=>JO,io:()=>MT,irfft:()=>bI,isFinite:()=>gS,isInf:()=>yS,isNaN:()=>bS,keep:()=>Jv,kernel_impls:()=>K_,layers:()=>PM,leakyRelu:()=>vS,less:()=>xS,lessEqual:()=>wS,linalg:()=>fT,linspace:()=>kS,loadGraphModel:()=>JW,loadGraphModelSync:()=>ZW,loadLayersModel:()=>KO,localResponseNormalization:()=>SS,log:()=>NS,log1p:()=>IS,logSigmoid:()=>OS,logSoftmax:()=>LS,logSumExp:()=>zS,logicalAnd:()=>jS,logicalNot:()=>BS,logicalOr:()=>WS,logicalXor:()=>VS,losses:()=>mT,lowerBound:()=>GS,matMul:()=>Gw,math:()=>tE,max:()=>Qk,maxPool:()=>qS,maxPool3d:()=>KS,maxPoolWithArgmax:()=>XS,maximum:()=>YS,mean:()=>QS,memory:()=>Kv,meshgrid:()=>$S,metrics:()=>Lj,min:()=>Jk,minimum:()=>eN,mirrorPad:()=>tN,mod:()=>nN,model:()=>YO,models:()=>eB,moments:()=>aN,movingAverage:()=>YI,mul:()=>pw,multiRNNCell:()=>rN,multinomial:()=>sN,neg:()=>DS,nextFrame:()=>jE,norm:()=>rS,notEqual:()=>iN,oneHot:()=>oN,ones:()=>ZS,onesLike:()=>lN,op:()=>Ov,outerProduct:()=>cN,pad:()=>uN,pad1d:()=>dN,pad2d:()=>pN,pad3d:()=>hN,pad4d:()=>fN,pool:()=>gN,pow:()=>Zk,prelu:()=>yN,print:()=>lw,prod:()=>bN,profile:()=>Xv,raggedGather:()=>vN,raggedRange:()=>xN,raggedTensorToTensor:()=>wN,rand:()=>kN,randomGamma:()=>VN,randomNormal:()=>UN,randomStandardNormal:()=>HN,randomUniform:()=>GN,randomUniformInt:()=>qN,range:()=>KN,ready:()=>ex,real:()=>XN,reciprocal:()=>YN,registerBackend:()=>sx,registerCallbackConstructor:()=>ZO,registerGradient:()=>db,registerKernel:()=>ub,registerOp:()=>hB,regularizers:()=>tB,relu:()=>QN,relu6:()=>JN,removeBackend:()=>nx,reshape:()=>Ww,reverse:()=>ZN,reverse1d:()=>$N,reverse2d:()=>eI,reverse3d:()=>tI,reverse4d:()=>nI,rfft:()=>xI,round:()=>aI,rsqrt:()=>rI,scalar:()=>$k,scatterND:()=>QI,scatter_util:()=>DI,searchSorted:()=>HS,selu:()=>sI,separableConv2d:()=>iI,sequential:()=>QO,serialization:()=>bT,setBackend:()=>$v,setPlatform:()=>ox,setThreadsCount:()=>wte,setWasmPath:()=>yte,setWasmPaths:()=>bte,setWebGLContext:()=>nQ,setdiff1dAsync:()=>oI,shared:()=>gU,sigmoid:()=>qw,sign:()=>lI,signal:()=>pT,sin:()=>cI,sinh:()=>uI,slice:()=>Kw,slice1d:()=>dI,slice2d:()=>pI,slice3d:()=>hI,slice4d:()=>fI,slice_util:()=>mE,softmax:()=>mI,softplus:()=>MS,spaceToBatchND:()=>mN,sparse:()=>gT,sparseToDense:()=>JI,spectral:()=>dT,split:()=>vI,sqrt:()=>eS,square:()=>tS,squaredDifference:()=>wI,squeeze:()=>kI,stack:()=>SI,step:()=>NI,stridedSlice:()=>II,string:()=>yT,sub:()=>PS,sum:()=>nS,sumOutType:()=>cv,tan:()=>CI,tanh:()=>Xw,tensor:()=>zv,tensor1d:()=>TI,tensor2d:()=>EI,tensor3d:()=>_I,tensor4d:()=>AI,tensor5d:()=>RI,tensor6d:()=>FI,tensorScatterUpdate:()=>LI,tensor_util:()=>iv,test_util:()=>NN,tidy:()=>Yv,tile:()=>cS,time:()=>Zv,topk:()=>zI,train:()=>LE,transpose:()=>XI,truncatedNormal:()=>jI,unique:()=>BI,unregisterGradient:()=>hb,unregisterKernel:()=>pb,unsortedSegmentSum:()=>WI,unstack:()=>VI,upcastType:()=>lv,upperBound:()=>UI,util:()=>gb,valueAndGrad:()=>ES,valueAndGrads:()=>_S,variable:()=>HI,variableGrads:()=>AS,version:()=>Ite,version_converter:()=>$W,version_core:()=>OE,version_cpu:()=>UG,version_layers:()=>IO,version_wasm:()=>Ste,version_webgl:()=>k$,webgl:()=>N$,webgl_util:()=>QY,where:()=>Mk,whereAsync:()=>qI,zeros:()=>JS,zerosLike:()=>Ok});var ah=Object.create,rh=Object.defineProperty,sh=Object.getOwnPropertyDescriptor,ih=Object.getOwnPropertyNames,oh=Object.getPrototypeOf,lh=Object.prototype.hasOwnProperty,ch=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),uh=(e,t)=>{for(var n in t)rh(e,n,{get:t[n],enumerable:!0})},dh=(e,t,n)=>(n=null!=e?ah(oh(e)):{},((e,t,n,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of ih(t))!lh.call(e,r)&&r!==n&&rh(e,r,{get:()=>t[r],enumerable:!(a=sh(t,r))||a.enumerable});return e})(!t&&e&&e.__esModule?n:rh(n,"default",{value:e,enumerable:!0}),e)),ph=ch((e,t)=>{t.exports=a;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function a(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}a.prototype.__isLong__,Object.defineProperty(a.prototype,"__isLong__",{value:!0}),a.isLong=r;var s={},i={};function o(e,t){var n,a,r;return t?(r=0<=(e>>>=0)&&e<256)&&(a=i[e])?a:(n=c(e,(0|e)<0?-1:0,!0),r&&(i[e]=n),n):(r=-128<=(e|=0)&&e<128)&&(a=s[e])?a:(n=c(e,e<0?-1:0,!1),r&&(s[e]=n),n)}function l(e,t){if(isNaN(e))return t?b:y;if(t){if(e<0)return b;if(e>=f)return S}else{if(e<=-m)return N;if(e+1>=m)return k}return e<0?l(-e,t).neg():c(e%h|0,e/h|0,t)}function c(e,t,n){return new a(e,t,n)}a.fromInt=o,a.fromNumber=l,a.fromBits=c;var u=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var a;if((a=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===a)return d(e.substring(1),t,n).neg();for(var r=l(u(n,8)),s=y,i=0;i<e.length;i+=8){var o=Math.min(8,e.length-i),c=parseInt(e.substring(i,i+o),n);if(o<8){var p=l(u(n,o));s=s.mul(p).add(l(c))}else s=(s=s.mul(r)).add(l(c))}return s.unsigned=t,s}function p(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?d(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}a.fromString=d,a.fromValue=p;var h=4294967296,f=h*h,m=f/2,g=o(1<<24),y=o(0);a.ZERO=y;var b=o(0,!0);a.UZERO=b;var v=o(1);a.ONE=v;var x=o(1,!0);a.UONE=x;var w=o(-1);a.NEG_ONE=w;var k=c(-1,2147483647,!1);a.MAX_VALUE=k;var S=c(-1,-1,!0);a.MAX_UNSIGNED_VALUE=S;var N=c(0,-2147483648,!1);a.MIN_VALUE=N;var I=a.prototype;I.toInt=function(){return this.unsigned?this.low>>>0:this.low},I.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},I.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=l(e),n=this.div(t),a=n.mul(t).sub(this);return n.toString(e)+a.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=l(u(e,6),this.unsigned),s=this,i="";;){var o=s.div(r),c=(s.sub(o.mul(r)).toInt()>>>0).toString(e);if((s=o).isZero())return c+i;for(;c.length<6;)c="0"+c;i=""+c+i}},I.getHighBits=function(){return this.high},I.getHighBitsUnsigned=function(){return this.high>>>0},I.getLowBits=function(){return this.low},I.getLowBitsUnsigned=function(){return this.low>>>0},I.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},I.isZero=function(){return 0===this.high&&0===this.low},I.eqz=I.isZero,I.isNegative=function(){return!this.unsigned&&this.high<0},I.isPositive=function(){return this.unsigned||this.high>=0},I.isOdd=function(){return 1===(1&this.low)},I.isEven=function(){return 0===(1&this.low)},I.equals=function(e){return r(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},I.eq=I.equals,I.notEquals=function(e){return!this.eq(e)},I.neq=I.notEquals,I.ne=I.notEquals,I.lessThan=function(e){return this.comp(e)<0},I.lt=I.lessThan,I.lessThanOrEqual=function(e){return this.comp(e)<=0},I.lte=I.lessThanOrEqual,I.le=I.lessThanOrEqual,I.greaterThan=function(e){return this.comp(e)>0},I.gt=I.greaterThan,I.greaterThanOrEqual=function(e){return this.comp(e)>=0},I.gte=I.greaterThanOrEqual,I.ge=I.greaterThanOrEqual,I.compare=function(e){if(r(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},I.comp=I.compare,I.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(v)},I.neg=I.negate,I.add=function(e){r(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,s=65535&this.low,i=e.high>>>16,o=65535&e.high,l=e.low>>>16,u=0,d=0,h=0,f=0;return h+=(f+=s+(65535&e.low))>>>16,d+=(h+=a+l)>>>16,u+=(d+=n+o)>>>16,u+=t+i,c((h&=65535)<<16|(f&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},I.subtract=function(e){return r(e)||(e=p(e)),this.add(e.neg())},I.sub=I.subtract,I.multiply=function(e){if(this.isZero())return y;if(r(e)||(e=p(e)),n)return c(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(N))return e.isOdd()?N:y;if(e.eq(N))return this.isOdd()?N:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return l(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,a=65535&this.high,s=this.low>>>16,i=65535&this.low,o=e.high>>>16,u=65535&e.high,d=e.low>>>16,h=65535&e.low,f=0,m=0,b=0,v=0;return b+=(v+=i*h)>>>16,m+=(b+=s*h)>>>16,b&=65535,m+=(b+=i*d)>>>16,f+=(m+=a*h)>>>16,m&=65535,f+=(m+=s*d)>>>16,m&=65535,f+=(m+=i*u)>>>16,f+=t*h+a*d+s*u+i*o,c((b&=65535)<<16|(v&=65535),(f&=65535)<<16|(m&=65535),this.unsigned)},I.mul=I.multiply,I.divide=function(e){if(r(e)||(e=p(e)),e.isZero())throw Error("division by zero");var t,a,s;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return x;s=b}else{if(this.eq(N))return e.eq(v)||e.eq(w)?N:e.eq(N)?v:(t=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?v:w:(a=this.sub(e.mul(t)),s=t.add(a.div(e)));if(e.eq(N))return this.unsigned?b:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=y}for(a=this;a.gte(e);){t=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:u(2,i-48),d=l(t),h=d.mul(e);h.isNegative()||h.gt(a);)h=(d=l(t-=o,this.unsigned)).mul(e);d.isZero()&&(d=v),s=s.add(d),a=a.sub(h)}return s},I.div=I.divide,I.modulo=function(e){return r(e)||(e=p(e)),n?c((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},I.mod=I.modulo,I.rem=I.modulo,I.not=function(){return c(~this.low,~this.high,this.unsigned)},I.and=function(e){return r(e)||(e=p(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},I.or=function(e){return r(e)||(e=p(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},I.xor=function(e){return r(e)||(e=p(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},I.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},I.shl=I.shiftLeft,I.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},I.shr=I.shiftRight,I.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},I.shru=I.shiftRightUnsigned,I.shr_u=I.shiftRightUnsigned,I.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},I.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},I.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},I.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},I.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},a.fromBytes=function(e,t,n){return n?a.fromBytesLE(e,t):a.fromBytesBE(e,t)},a.fromBytesLE=function(e,t){return new a(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},a.fromBytesBE=function(e,t){return new a(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}}),hh=ch(()=>{}),fh=ch(()=>{}),mh=ch((e,t)=>{!function(e,t,n){function a(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var a=.02519603282416938*(e+=t.charCodeAt(n));a-=e=a>>>0,e=(a*=e)>>>0,e+=4294967296*(a-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new a(e),s=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,s&&("object"==typeof s&&r(s,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=s:n&&n.amd?n(function(){return s}):this.alea=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),gh=ch((e,t)=>{!function(e,t,n){function a(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=0|n.charCodeAt(a),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new a(e),s=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,s&&("object"==typeof s&&r(s,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=s:n&&n.amd?n(function(){return s}):this.xor128=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),yh=ch((e,t)=>{!function(e,t,n){function a(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=0|n.charCodeAt(a),a==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new a(e),s=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,s&&("object"==typeof s&&r(s,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=s:n&&n.amd?n(function(){return s}):this.xorwow=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),bh=ch((e,t)=>{!function(e,t,n){function a(e){var t=this;t.next=function(){var e,n,a=t.x,r=t.i;return e=a[r],n=(e^=e>>>7)^e<<24,n^=(e=a[r+1&7])^e>>>10,n^=(e=a[r+3&7])^e>>>3,n^=(e=a[r+4&7])^e<<7,e=a[r+7&7],n^=(e^=e<<13)^e<<9,a[r]=n,t.i=r+1&7,n},function(e,t){var n,a=[];if(t===(0|t))a[0]=t;else for(t=""+t,n=0;n<t.length;++n)a[7&n]=a[7&n]<<15^t.charCodeAt(n)+a[n+1&7]<<13;for(;a.length<8;)a.push(0);for(n=0;n<8&&0===a[n];++n);for(8==n?a[7]=-1:a[n],e.x=a,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),s=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,s&&(s.x&&r(s,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=s:n&&n.amd?n(function(){return s}):this.xorshift7=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),vh=ch((e,t)=>{!function(e,t,n){function a(e){var t=this;t.next=function(){var e,n,a=t.w,r=t.X,s=t.i;return t.w=a=a+1640531527|0,n=r[s+34&127],e=r[s=s+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=r[s]=n^e,t.i=s,n+(a^a>>>16)|0},function(e,t){var n,a,r,s,i,o=[],l=128;for(t===(0|t)?(a=t,t=null):(t+="\0",a=0,l=Math.max(l,t.length)),r=0,s=-32;s<l;++s)t&&(a^=t.charCodeAt((s+32)%t.length)),0===s&&(i=a),a^=a<<10,a^=a>>>15,a^=a<<4,a^=a>>>13,s>=0&&(i=i+1640531527|0,r=0==(n=o[127&s]^=a+i)?r+1:0);for(r>=128&&(o[127&(t&&t.length||0)]=-1),r=127,s=512;s>0;--s)a=o[r+34&127],n=o[r=r+1&127],a^=a<<13,n^=n<<17,a^=a>>>15,n^=n>>>12,o[r]=a^n;e.w=i,e.X=o,e.i=r}(t,e)}function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),s=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,s&&(s.X&&r(s,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=s:n&&n.amd?n(function(){return s}):this.xor4096=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),xh=ch((e,t)=>{!function(e,t,n){function a(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,a=t.d,r=t.a;return e=e<<25^e>>>7^n,n=n-a|0,a=a<<24^a>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-a|0,t.d=a<<16^n>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var a=0;a<n.length+20;a++)t.b^=0|n.charCodeAt(a),t.next()}function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new a(e),s=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,s&&("object"==typeof s&&r(s,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=s:n&&n.amd?n(function(){return s}):this.tychei=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),wh=ch(()=>{}),kh=ch((e,t)=>{!function(e,a,r){var s,i=256,o="random",l=r.pow(i,6),c=r.pow(2,52),u=2*c,d=255;function p(t,n,d){var p=[],b=g(m((n=1==n?{entropy:!0}:n||{}).entropy?[t,y(a)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(i):(t=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(t)),y(t)}catch(p){var n=e.navigator,r=n&&n.plugins;return[+new Date,e,r,e.screen,y(a)]}}():t,3),p),v=new h(p),x=function(){for(var e=v.g(6),t=l,n=0;e<c;)e=(e+n)*i,t*=i,n=v.g(1);for(;e>=u;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|v.g(4)},x.quick=function(){return v.g(4)/4294967296},x.double=x,g(y(v.S),a),(n.pass||d||function(e,t,n,a){return a&&(a.S&&f(a,v),e.state=function(){return f(v,{})}),n?(r[o]=e,t):e})(x,b,"global"in n?n.global:this==r,n.state)}function h(e){var t,n=e.length,a=this,r=0,s=a.i=a.j=0,o=a.S=[];for(n||(e=[n++]);r<i;)o[r]=r++;for(r=0;r<i;r++)o[r]=o[s=d&s+e[r%n]+(t=o[r])],o[s]=t;(a.g=function(e){for(var t,n=0,r=a.i,s=a.j,o=a.S;e--;)t=o[r=d&r+1],n=n*i+o[d&(o[r]=o[s=d&s+t])+(o[s]=t)];return a.i=r,a.j=s,n})(i)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,a=[],r=typeof e;if(t&&"object"==r)for(n in e)try{a.push(m(e[n],t-1))}catch(s){}return a.length?a:"string"==r?e:e+"\0"}function g(e,t){for(var n,a=e+"",r=0;r<a.length;)t[d&r]=d&(n^=19*t[d&r])+a.charCodeAt(r++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(g(r.random(),a),"object"==typeof t&&t.exports){t.exports=p;try{s=wh()}catch(b){}}else"function"==typeof define&&n.amdO?define(function(){return p}):r["seed"+o]=p}("undefined"!=typeof self?self:e,[],Math)}),Sh=ch((e,t)=>{var n=mh(),a=gh(),r=yh(),s=bh(),i=vh(),o=xh(),l=kh();l.alea=n,l.xor128=a,l.xorwow=r,l.xorshift7=s,l.xor4096=i,l.tychei=o,t.exports=l}),Nh=ch(()=>{}),Ih=ch(()=>{}),Ch=ch(()=>{}),Th=ch(()=>{}),Eh=ch(()=>{}),_h=ch(()=>{}),Ah=ch((e,t)=>{var a=(()=>{var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return e=e||$p,function(t){function a(){return R.buffer!=O&&H(R.buffer),L}function r(){return R.buffer!=O&&H(R.buffer),z}function s(){return R.buffer!=O&&H(R.buffer),j}function i(){return R.buffer!=O&&H(R.buffer),B}var o,l,c,u="undefined"!=typeof(t=t||{})?t:{};u.ready=new Promise(function(e,t){o=e,l=t}),"undefined"!=typeof process&&process.listeners&&(c={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var d,p,h,f=Object.assign({},u),m=[],g=(e,t)=>{throw t},y="object"==typeof window,b="function"==typeof importScripts,v="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,x=u.ENVIRONMENT_IS_PTHREAD||!1,w="";function k(e){return u.locateFile?u.locateFile(e,w):w+e}if(v){var S=Ih(),N=Ch();let e;w=b?N.dirname(w)+"/":"//",d=(e,t)=>(e=ie(e)?new URL(e):N.normalize(e),S.readFileSync(e,t?void 0:"utf8")),h=e=>{var t=d(e,!0);return t.buffer||(t=new Uint8Array(t)),t},p=(e,t,n)=>{e=ie(e)?new URL(e):N.normalize(e),S.readFile(e,function(e,a){e?n(e):t(a.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),m=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof ce))throw e}),process.on("unhandledRejection",function(e){throw e}),g=(e,t)=>{if(Q())throw process.exitCode=e,t;(function(e){e instanceof ce||E("exiting due to exception: "+e)})(t),process.exit(e)},u.inspect=function(){return"[Emscripten Module object]"};try{e=Th()}catch(Je){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),Je}n.g.Worker=e.Worker}else(y||b)&&(b?w=self.location.href:"undefined"!=typeof document&&document.currentScript&&(w=document.currentScript.src),"undefined"!=typeof e&&e&&(w=e),w=0!==w.indexOf("blob:")?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",v||(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},b&&(h=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),p=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)}),e=>document.title=e);v&&"undefined"==typeof performance&&(n.g.performance=Eh().performance);var I=console.log.bind(console),C=console.warn.bind(console);v&&(I=e=>S.writeSync(1,e+"\n"),C=e=>S.writeSync(2,e+"\n"));var T=u.print||I,E=u.printErr||C;Object.assign(u,f),f=null,u.arguments&&(m=u.arguments),u.thisProgram&&u.thisProgram,u.quit&&(g=u.quit);var _;Atomics.load,Atomics.store,Atomics.compareExchange;u.wasmBinary&&(_=u.wasmBinary);var A=u.noExitRuntime||!0;"object"!=typeof WebAssembly&&ae("no native wasm support detected");var R,F,D,M=!1;var O,P,L,z,j,B,W="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function V(e,t,n){for(var a=(t>>>=0)+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.buffer&&W)return W.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(var s="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192!=(224&i)){var l=63&e[t++];if((i=224==(240&i)?(15&i)<<12|o<<6|l:(7&i)<<18|o<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(i);else{var c=i-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&i)<<6|o)}else s+=String.fromCharCode(i)}return s}function U(e,t){return(e>>>=0)?V(a(),e,t):""}function H(e){O=e,u.HEAP8=P=new Int8Array(e),u.HEAP16=new Int16Array(e),u.HEAP32=z=new Int32Array(e),u.HEAPU8=L=new Uint8Array(e),u.HEAPU16=new Uint16Array(e),u.HEAPU32=j=new Uint32Array(e),u.HEAPF32=new Float32Array(e),u.HEAPF64=B=new Float64Array(e)}x&&(O=u.buffer);var G=u.INITIAL_MEMORY||16777216;if(x)R=u.wasmMemory,O=u.buffer;else if(u.wasmMemory)R=u.wasmMemory;else if(!((R=new WebAssembly.Memory({initial:G/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw E("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&E("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");R&&(O=R.buffer),G=O.byteLength,H(O);var q,K=[],X=[],Y=[];function Q(){return A}function J(){!x&&me(X)}function Z(e){K.unshift(e)}function $(e){Y.unshift(e)}var ee=0,te=null,ne=null;function ae(e){u.onAbort&&u.onAbort(e),E(e="Aborted("+e+")"),M=!0,D=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw l(t),t}var re;function se(e){return e.startsWith("data:application/octet-stream;base64,")}function ie(e){return e.startsWith("file://")}function oe(e){try{if(e==re&&_)return new Uint8Array(_);if(h)return h(e);throw"both async and sync fetching of the wasm failed"}catch(Je){ae(Je)}}se(re="tfjs-backend-wasm-threaded-simd.wasm")||(re=k(re));var le={};function ce(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ue(e){var t=fe.pthreads[e];(function(e,t){e||ae(t)})(t),fe.returnWorkerToPool(t)}function de(e){var t=fe.getNewWorker();if(!t)return 6;fe.runningWorkers.push(t),fe.pthreads[e.pthread_ptr]=t,t.pthread_ptr=e.pthread_ptr;var n={cmd:"run",start_routine:e.startRoutine,arg:e.arg,pthread_ptr:e.pthread_ptr};return t.runPthread=()=>{v&&t.ref(),t.postMessage(n,e.transferList),delete t.runPthread},t.loaded&&t.runPthread(),0}function pe(e){if(x)return Se(1,1,e);D=e,Q()||(fe.terminateAllThreads(),u.onExit&&u.onExit(e),M=!0),g(e,new ce(e))}var he=function(e,t){if(D=e,!t&&x)throw ge(e),"unwind";pe(e)};var fe={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){x?fe.initWorker():fe.initMainThread()},initMainThread:function(){for(var e=8;e--;)fe.allocateUnusedWorker()},initWorker:function(){A=!1},setExitStatus:function(e){D=e},terminateAllThreads:function(){for(var e of Object.values(fe.pthreads))fe.returnWorkerToPool(e);for(var e of fe.unusedWorkers)e.terminate();fe.unusedWorkers=[]},returnWorkerToPool:function(e){var t=e.pthread_ptr;delete fe.pthreads[t],fe.unusedWorkers.push(e),fe.runningWorkers.splice(fe.runningWorkers.indexOf(e),1),e.pthread_ptr=0,v&&e.unref(),Ue(t)},receiveObjectTransfer:function(e){},threadInitTLS:function(){fe.tlsInitFunctions.forEach(e=>e())},loadWasmModuleToWorker:function(t,n){t.onmessage=e=>{var a=e.data,r=a.cmd;if(t.pthread_ptr&&(fe.currentProxiedOperationCallerThread=t.pthread_ptr),a.targetThread&&a.targetThread!=je()){var s=fe.pthreads[a.targetThread];return s?s.postMessage(a,a.transferList):E('Internal error! Worker sent a message "'+r+'" to target pthread '+a.targetThread+", but that thread no longer exists!"),void(fe.currentProxiedOperationCallerThread=void 0)}"processProxyingQueue"===r?we(a.queue):"spawnThread"===r?de(a):"cleanupThread"===r?ue(a.thread):"killThread"===r?function(e){var t=fe.pthreads[e];delete fe.pthreads[e],t.terminate(),Ue(e),fe.runningWorkers.splice(fe.runningWorkers.indexOf(t),1),t.pthread_ptr=0}(a.thread):"cancelThread"===r?function(e){fe.pthreads[e].postMessage({cmd:"cancel"})}(a.thread):"loaded"===r?(t.loaded=!0,v&&t.unref(),n&&n(t),t.runPthread&&t.runPthread()):"print"===r?T("Thread "+a.threadId+": "+a.text):"printErr"===r?E("Thread "+a.threadId+": "+a.text):"alert"===r?alert("Thread "+a.threadId+": "+a.text):"setimmediate"===a.target?t.postMessage(a):"callHandler"===r?u[a.handler](...a.args):r&&E("worker sent an unknown command "+r),fe.currentProxiedOperationCallerThread=void 0},t.onerror=e=>{throw E("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},v&&(t.on("message",function(e){t.onmessage({data:e})}),t.on("error",function(e){t.onerror(e)}),t.on("detachedExit",function(){}));var a=[];for(var r of["onExit","onAbort","print","printErr"])u.hasOwnProperty(r)&&a.push(r);t.postMessage({cmd:"load",handlers:a,urlOrBlob:u.mainScriptUrlOrBlob||e,wasmMemory:R,wasmModule:F})},allocateUnusedWorker:function(){var e,t=k("tfjs-backend-wasm-threaded-simd.worker.js");e=new Worker(t),fe.unusedWorkers.push(e)},getNewWorker:function(){return 0==fe.unusedWorkers.length&&(fe.allocateUnusedWorker(),fe.loadWasmModuleToWorker(fe.unusedWorkers[0])),fe.unusedWorkers.pop()}};function me(e){for(;e.length>0;)e.shift()(u)}function ge(e){if(x)return Se(2,0,e);try{he(e)}catch(Je){!function(e){if(e instanceof ce||"unwind"==e)return D;g(1,e)}(Je)}}u.PThread=fe,u.establishStackSpace=function(){var e=je(),t=r()[e+52>>>2],n=r()[e+56>>>2];Ge(t,t-n),Ke(t)};var ye=[];function be(e,t,n,a){return x?Se(3,1,e,t,n,a):ve(e,t,n,a)}function ve(e,t,n,a){if("undefined"==typeof SharedArrayBuffer)return E("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var r=[];if(x&&0===r.length)return be(e,t,n,a);var s={startRoutine:n,pthread_ptr:e,arg:a,transferList:r};return x?(s.cmd="spawnThread",postMessage(s,r),0):de(s)}u.invokeEntryPoint=function(e,t){var n=function(e){var t=ye[e];return t||(e>=ye.length&&(ye.length=e+1),ye[e]=t=q.get(e)),t}(e)(t);Q()?fe.setExitStatus(n):He(n)};var xe;function we(e){Atomics.store(r(),e>>2,1),je()&&Ve(e),Atomics.compareExchange(r(),e>>2,1,0)}function ke(e){ke.shown||(ke.shown={}),ke.shown[e]||(ke.shown[e]=1,v&&(e="warning: "+e),E(e))}function Se(e,t){var n=arguments.length-2,a=arguments;return function(e){var t=qe(),n=e();return Ke(t),n}(()=>{for(var r=n,s=Xe(8*r),o=s>>3,l=0;l<n;l++){var c=a[2+l];i()[o+l>>>0]=c}return We(e,r,s,t)})}u.executeNotifiedProxyingQueue=we,xe=v?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.timeOrigin+performance.now();var Ne=[];function Ie(e){try{return R.grow(e-O.byteLength+65535>>>16),H(R.buffer),1}catch(Je){}}function Ce(e){return x?Se(4,1,e):52}function Te(e,t,n,a,r){return x?Se(5,1,e,t,n,a,r):70}var Ee=[null,[],[]];function _e(e,t){var n=Ee[e];0===t||10===t?((1===e?T:E)(V(n,0)),n.length=0):n.push(t)}function Ae(e,t,n,r){if(x)return Se(6,1,e,t,n,r);for(var i=0,o=0;o<n;o++){var l=s()[t>>>2],c=s()[t+4>>>2];t+=8;for(var u=0;u<c;u++)_e(e,a()[l+u>>>0]);i+=c}return s()[r>>>2]=i,0}function Re(e){return u["_"+e]}function Fe(e,t){(R.buffer!=O&&H(R.buffer),P).set(e,t>>>0)}function De(e,t,n,r,s){var i={string:e=>{var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);(function(e,t,n){(function(e,t,n,a){if(!(a>0))return 0;for(var r=n>>>=0,s=n+a-1,i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++i)),o<=127){if(n>=s)break;t[n++>>>0]=o}else if(o<=2047){if(n+1>=s)break;t[n++>>>0]=192|o>>6,t[n++>>>0]=128|63&o}else if(o<=65535){if(n+2>=s)break;t[n++>>>0]=224|o>>12,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}else{if(n+3>=s)break;t[n++>>>0]=240|o>>18,t[n++>>>0]=128|o>>12&63,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}}t[n>>>0]=0})(e,a(),t,n)})(e,t=Xe(n),n)}return t},array:e=>{var t=Xe(e.length);return Fe(e,t),t}};var o=Re(e),l=[],c=0;if(r)for(var u=0;u<r.length;u++){var d=i[n[u]];d?(0===c&&(c=qe()),l[u]=d(r[u])):l[u]=r[u]}var p,h=o.apply(null,l);return p=h,0!==c&&Ke(c),h=function(e){return"string"===t?U(e):"boolean"===t?!!e:e}(p),h}fe.init();var Me,Oe,Pe,Le=[null,pe,ge,be,Ce,Te,Ae],ze={__emscripten_init_main_thread_js:function(e){Be(e,!b,1,!y),fe.threadInitTLS()},__emscripten_thread_cleanup:function(e){x?postMessage({cmd:"cleanupThread",thread:e}):ue(e)},__pthread_create_js:ve,_emscripten_default_pthread_stack_size:function(){return 65536},_emscripten_get_now_is_monotonic:function(){return true},_emscripten_notify_task_queue:function(e,t,n,a){if(e==t)setTimeout(()=>we(a));else if(x)postMessage({targetThread:e,cmd:"processProxyingQueue",queue:a});else{var r=fe.pthreads[e];if(!r)return;r.postMessage({cmd:"processProxyingQueue",queue:a})}return 1},_emscripten_set_offscreencanvas_size:function(e,t,n){return-1},abort:function(){ae("")},emscripten_check_blocking_allowed:function(){v||b||ke("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")},emscripten_date_now:function(){return Date.now()},emscripten_get_heap_max:function(){return 4294901760},emscripten_get_now:xe,emscripten_memcpy_big:function(e,t,n){a().copyWithin(e>>>0,t>>>0,t+n>>>0)},emscripten_num_logical_cores:function(){return v?_h().cpus().length:navigator.hardwareConcurrency},emscripten_receive_on_main_thread_js:function(e,t,n){Ne.length=t;for(var a=n>>3,r=0;r<t;r++)Ne[r]=i()[a+r>>>0];return(e<0?le[-e-1]:Le[e]).apply(null,Ne)},emscripten_resize_heap:function(e){var t=a().length;if((e>>>=0)<=t)return!1;var n=4294901760;if(e>n)return!1;let r=(e,t)=>e+(t-e%t)%t;for(var s=1;s<=4;s*=2){var i=t*(1+.2/s);if(i=Math.min(i,e+100663296),Ie(Math.min(n,r(Math.max(e,i),65536))))return!0}return!1},emscripten_unwind_to_js_event_loop:function(){throw"unwind"},exit:he,fd_close:Ce,fd_seek:Te,fd_write:Ae,memory:R||u.wasmMemory},je=(function(){var e={env:ze,wasi_snapshot_preview1:ze};function t(e,t){var n=e.exports;if(u.asm=n,function(e){fe.tlsInitFunctions.push(e)}(u.asm._emscripten_tls_init),q=u.asm.__indirect_function_table,function(e){X.unshift(e)}(u.asm.__wasm_call_ctors),F=t,!x){var a=fe.unusedWorkers.length;fe.unusedWorkers.forEach(function(e){fe.loadWasmModuleToWorker(e,function(){--a||function(){if(ee--,u.monitorRunDependencies&&u.monitorRunDependencies(ee),0==ee&&(null!==te&&(clearInterval(te),te=null),ne)){var e=ne;ne=null,e()}}()})})}}function n(e){t(e.instance,e.module)}function a(t){return function(){if(!_&&(y||b)){if("function"==typeof fetch&&!ie(re))return fetch(re,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+re+"'";return e.arrayBuffer()}).catch(function(){return oe(re)});if(p)return new Promise(function(e,t){p(re,function(t){e(new Uint8Array(t))},t)})}return Promise.resolve().then(function(){return oe(re)})}().then(function(t){return WebAssembly.instantiate(t,e)}).then(function(e){return e}).then(t,function(e){E("failed to asynchronously prepare wasm: "+e),ae(e)})}if(x||(ee++,u.monitorRunDependencies&&u.monitorRunDependencies(ee)),u.instantiateWasm)try{return u.instantiateWasm(e,t)}catch(r){E("Module.instantiateWasm callback failed with error: "+r),l(r)}(_||"function"!=typeof WebAssembly.instantiateStreaming||se(re)||ie(re)||v||"function"!=typeof fetch?a(n):fetch(re,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(n,function(e){return E("wasm streaming compile failed: "+e),E("falling back to ArrayBuffer instantiation"),a(n)})})).catch(l)}(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.__wasm_call_ctors).apply(null,arguments)},u._init=function(){return(u._init=u.asm.init).apply(null,arguments)},u._init_with_threads_count=function(){return(u._init_with_threads_count=u.asm.init_with_threads_count).apply(null,arguments)},u._get_threads_count=function(){return(u._get_threads_count=u.asm.get_threads_count).apply(null,arguments)},u._register_tensor=function(){return(u._register_tensor=u.asm.register_tensor).apply(null,arguments)},u._dispose_data=function(){return(u._dispose_data=u.asm.dispose_data).apply(null,arguments)},u._dispose=function(){return(u._dispose=u.asm.dispose).apply(null,arguments)},u._Abs=function(){return(u._Abs=u.asm.Abs).apply(null,arguments)},u._Acos=function(){return(u._Acos=u.asm.Acos).apply(null,arguments)},u._Acosh=function(){return(u._Acosh=u.asm.Acosh).apply(null,arguments)},u._Add=function(){return(u._Add=u.asm.Add).apply(null,arguments)},u._AddN=function(){return(u._AddN=u.asm.AddN).apply(null,arguments)},u._All=function(){return(u._All=u.asm.All).apply(null,arguments)},u._Any=function(){return(u._Any=u.asm.Any).apply(null,arguments)},u._ArgMax=function(){return(u._ArgMax=u.asm.ArgMax).apply(null,arguments)},u._ArgMin=function(){return(u._ArgMin=u.asm.ArgMin).apply(null,arguments)},u._Asin=function(){return(u._Asin=u.asm.Asin).apply(null,arguments)},u._Asinh=function(){return(u._Asinh=u.asm.Asinh).apply(null,arguments)},u._Atan=function(){return(u._Atan=u.asm.Atan).apply(null,arguments)},u._Atan2=function(){return(u._Atan2=u.asm.Atan2).apply(null,arguments)},u._Atanh=function(){return(u._Atanh=u.asm.Atanh).apply(null,arguments)},u._AvgPool=function(){return(u._AvgPool=u.asm.AvgPool).apply(null,arguments)},u._AvgPool3D=function(){return(u._AvgPool3D=u.asm.AvgPool3D).apply(null,arguments)},u._AvgPool3DGrad=function(){return(u._AvgPool3DGrad=u.asm.AvgPool3DGrad).apply(null,arguments)},u._AvgPoolGrad=function(){return(u._AvgPoolGrad=u.asm.AvgPoolGrad).apply(null,arguments)},u._BatchMatMul=function(){return(u._BatchMatMul=u.asm.BatchMatMul).apply(null,arguments)},u._Bincount=function(){return(u._Bincount=u.asm.Bincount).apply(null,arguments)},u._BitwiseAnd=function(){return(u._BitwiseAnd=u.asm.BitwiseAnd).apply(null,arguments)},u._Ceil=function(){return(u._Ceil=u.asm.Ceil).apply(null,arguments)},u._ClipByValue=function(){return(u._ClipByValue=u.asm.ClipByValue).apply(null,arguments)},u._Conv2D=function(){return(u._Conv2D=u.asm.Conv2D).apply(null,arguments)},u._Conv2DBackpropInput=function(){return(u._Conv2DBackpropInput=u.asm.Conv2DBackpropInput).apply(null,arguments)},u._Conv3D=function(){return(u._Conv3D=u.asm.Conv3D).apply(null,arguments)},u._Conv3DBackpropFilterV2=function(){return(u._Conv3DBackpropFilterV2=u.asm.Conv3DBackpropFilterV2).apply(null,arguments)},u._Conv3DBackpropInputV2=function(){return(u._Conv3DBackpropInputV2=u.asm.Conv3DBackpropInputV2).apply(null,arguments)},u._Cos=function(){return(u._Cos=u.asm.Cos).apply(null,arguments)},u._Cosh=function(){return(u._Cosh=u.asm.Cosh).apply(null,arguments)},u._CropAndResize=function(){return(u._CropAndResize=u.asm.CropAndResize).apply(null,arguments)},u._Cumprod=function(){return(u._Cumprod=u.asm.Cumprod).apply(null,arguments)},u._Cumsum=function(){return(u._Cumsum=u.asm.Cumsum).apply(null,arguments)},u._DenseBincount=function(){return(u._DenseBincount=u.asm.DenseBincount).apply(null,arguments)},u._DepthToSpace=function(){return(u._DepthToSpace=u.asm.DepthToSpace).apply(null,arguments)},u._DepthwiseConv2dNative=function(){return(u._DepthwiseConv2dNative=u.asm.DepthwiseConv2dNative).apply(null,arguments)},u._Diag=function(){return(u._Diag=u.asm.Diag).apply(null,arguments)},u._Dilation2D=function(){return(u._Dilation2D=u.asm.Dilation2D).apply(null,arguments)},u._Dilation2DBackpropFilter=function(){return(u._Dilation2DBackpropFilter=u.asm.Dilation2DBackpropFilter).apply(null,arguments)},u._Dilation2DBackpropInput=function(){return(u._Dilation2DBackpropInput=u.asm.Dilation2DBackpropInput).apply(null,arguments)},u._Elu=function(){return(u._Elu=u.asm.Elu).apply(null,arguments)},u._EluGrad=function(){return(u._EluGrad=u.asm.EluGrad).apply(null,arguments)},u._Equal=function(){return(u._Equal=u.asm.Equal).apply(null,arguments)},u._Erf=function(){return(u._Erf=u.asm.Erf).apply(null,arguments)},u._Exp=function(){return(u._Exp=u.asm.Exp).apply(null,arguments)},u._Expm1=function(){return(u._Expm1=u.asm.Expm1).apply(null,arguments)},u._FlipLeftRight=function(){return(u._FlipLeftRight=u.asm.FlipLeftRight).apply(null,arguments)},u._Floor=function(){return(u._Floor=u.asm.Floor).apply(null,arguments)},u._FloorDiv=function(){return(u._FloorDiv=u.asm.FloorDiv).apply(null,arguments)},u._FusedBatchNorm=function(){return(u._FusedBatchNorm=u.asm.FusedBatchNorm).apply(null,arguments)},u._FusedConv2D=function(){return(u._FusedConv2D=u.asm.FusedConv2D).apply(null,arguments)},u._FusedDepthwiseConv2D=function(){return(u._FusedDepthwiseConv2D=u.asm.FusedDepthwiseConv2D).apply(null,arguments)},u._Gather=function(){return(u._Gather=u.asm.Gather).apply(null,arguments)},u._GatherNd=function(){return(u._GatherNd=u.asm.GatherNd).apply(null,arguments)},u._Greater=function(){return(u._Greater=u.asm.Greater).apply(null,arguments)},u._GreaterEqual=function(){return(u._GreaterEqual=u.asm.GreaterEqual).apply(null,arguments)},u._IsFinite=function(){return(u._IsFinite=u.asm.IsFinite).apply(null,arguments)},u._IsInf=function(){return(u._IsInf=u.asm.IsInf).apply(null,arguments)},u._IsNan=function(){return(u._IsNan=u.asm.IsNan).apply(null,arguments)},u._LRN=function(){return(u._LRN=u.asm.LRN).apply(null,arguments)},u._LRNGrad=function(){return(u._LRNGrad=u.asm.LRNGrad).apply(null,arguments)},u._LeakyRelu=function(){return(u._LeakyRelu=u.asm.LeakyRelu).apply(null,arguments)},u._Less=function(){return(u._Less=u.asm.Less).apply(null,arguments)},u._LessEqual=function(){return(u._LessEqual=u.asm.LessEqual).apply(null,arguments)},u._LinSpace=function(){return(u._LinSpace=u.asm.LinSpace).apply(null,arguments)},u._Log=function(){return(u._Log=u.asm.Log).apply(null,arguments)},u._Log1p=function(){return(u._Log1p=u.asm.Log1p).apply(null,arguments)},u._LogicalAnd=function(){return(u._LogicalAnd=u.asm.LogicalAnd).apply(null,arguments)},u._LogicalNot=function(){return(u._LogicalNot=u.asm.LogicalNot).apply(null,arguments)},u._LogicalOr=function(){return(u._LogicalOr=u.asm.LogicalOr).apply(null,arguments)},u._LogicalXor=function(){return(u._LogicalXor=u.asm.LogicalXor).apply(null,arguments)},u._Max=function(){return(u._Max=u.asm.Max).apply(null,arguments)},u._MaxPool=function(){return(u._MaxPool=u.asm.MaxPool).apply(null,arguments)},u._MaxPool3D=function(){return(u._MaxPool3D=u.asm.MaxPool3D).apply(null,arguments)},u._MaxPool3DGrad=function(){return(u._MaxPool3DGrad=u.asm.MaxPool3DGrad).apply(null,arguments)},u._MaxPoolGrad=function(){return(u._MaxPoolGrad=u.asm.MaxPoolGrad).apply(null,arguments)},u._MaxPoolWithArgmax=function(){return(u._MaxPoolWithArgmax=u.asm.MaxPoolWithArgmax).apply(null,arguments)},u._Maximum=function(){return(u._Maximum=u.asm.Maximum).apply(null,arguments)},u._Mean=function(){return(u._Mean=u.asm.Mean).apply(null,arguments)},u._Min=function(){return(u._Min=u.asm.Min).apply(null,arguments)},u._Minimum=function(){return(u._Minimum=u.asm.Minimum).apply(null,arguments)},u._MirrorPad=function(){return(u._MirrorPad=u.asm.MirrorPad).apply(null,arguments)},u._Mod=function(){return(u._Mod=u.asm.Mod).apply(null,arguments)},u._Multinomial=function(){return(u._Multinomial=u.asm.Multinomial).apply(null,arguments)},u._Multiply=function(){return(u._Multiply=u.asm.Multiply).apply(null,arguments)},u._Neg=function(){return(u._Neg=u.asm.Neg).apply(null,arguments)},u._NonMaxSuppressionV3=function(){return(u._NonMaxSuppressionV3=u.asm.NonMaxSuppressionV3).apply(null,arguments)},u._NonMaxSuppressionV4=function(){return(u._NonMaxSuppressionV4=u.asm.NonMaxSuppressionV4).apply(null,arguments)},u._NonMaxSuppressionV5=function(){return(u._NonMaxSuppressionV5=u.asm.NonMaxSuppressionV5).apply(null,arguments)},u._NotEqual=function(){return(u._NotEqual=u.asm.NotEqual).apply(null,arguments)},u._OneHot=function(){return(u._OneHot=u.asm.OneHot).apply(null,arguments)},u._PadV2=function(){return(u._PadV2=u.asm.PadV2).apply(null,arguments)},u._Pow=function(){return(u._Pow=u.asm.Pow).apply(null,arguments)},u._Prelu=function(){return(u._Prelu=u.asm.Prelu).apply(null,arguments)},u._Prod=function(){return(u._Prod=u.asm.Prod).apply(null,arguments)},u._RealDiv=function(){return(u._RealDiv=u.asm.RealDiv).apply(null,arguments)},u._Reciprocal=function(){return(u._Reciprocal=u.asm.Reciprocal).apply(null,arguments)},u._Relu=function(){return(u._Relu=u.asm.Relu).apply(null,arguments)},u._Relu6=function(){return(u._Relu6=u.asm.Relu6).apply(null,arguments)},u._ResizeBilinear=function(){return(u._ResizeBilinear=u.asm.ResizeBilinear).apply(null,arguments)},u._ResizeBilinearGrad=function(){return(u._ResizeBilinearGrad=u.asm.ResizeBilinearGrad).apply(null,arguments)},u._ResizeNearestNeighbor=function(){return(u._ResizeNearestNeighbor=u.asm.ResizeNearestNeighbor).apply(null,arguments)},u._ResizeNearestNeighborGrad=function(){return(u._ResizeNearestNeighborGrad=u.asm.ResizeNearestNeighborGrad).apply(null,arguments)},u._Reverse=function(){return(u._Reverse=u.asm.Reverse).apply(null,arguments)},u._RotateWithOffset=function(){return(u._RotateWithOffset=u.asm.RotateWithOffset).apply(null,arguments)},u._Round=function(){return(u._Round=u.asm.Round).apply(null,arguments)},u._Rsqrt=function(){return(u._Rsqrt=u.asm.Rsqrt).apply(null,arguments)},u._ScatterNd=function(){return(u._ScatterNd=u.asm.ScatterNd).apply(null,arguments)},u._SearchSorted=function(){return(u._SearchSorted=u.asm.SearchSorted).apply(null,arguments)},u._SelectV2=function(){return(u._SelectV2=u.asm.SelectV2).apply(null,arguments)},u._Selu=function(){return(u._Selu=u.asm.Selu).apply(null,arguments)},u._Sigmoid=function(){return(u._Sigmoid=u.asm.Sigmoid).apply(null,arguments)},u._Sign=function(){return(u._Sign=u.asm.Sign).apply(null,arguments)},u._Sin=function(){return(u._Sin=u.asm.Sin).apply(null,arguments)},u._Sinh=function(){return(u._Sinh=u.asm.Sinh).apply(null,arguments)},u._Softmax=function(){return(u._Softmax=u.asm.Softmax).apply(null,arguments)},u._Softplus=function(){return(u._Softplus=u.asm.Softplus).apply(null,arguments)},u._SparseFillEmptyRows=function(){return(u._SparseFillEmptyRows=u.asm.SparseFillEmptyRows).apply(null,arguments)},u._SparseReshape=function(){return(u._SparseReshape=u.asm.SparseReshape).apply(null,arguments)},u._SparseSegmentReduction=function(){return(u._SparseSegmentReduction=u.asm.SparseSegmentReduction).apply(null,arguments)},u._SparseToDense=function(){return(u._SparseToDense=u.asm.SparseToDense).apply(null,arguments)},u._Sqrt=function(){return(u._Sqrt=u.asm.Sqrt).apply(null,arguments)},u._Square=function(){return(u._Square=u.asm.Square).apply(null,arguments)},u._SquaredDifference=function(){return(u._SquaredDifference=u.asm.SquaredDifference).apply(null,arguments)},u._Step=function(){return(u._Step=u.asm.Step).apply(null,arguments)},u._StridedSlice=function(){return(u._StridedSlice=u.asm.StridedSlice).apply(null,arguments)},u._Sub=function(){return(u._Sub=u.asm.Sub).apply(null,arguments)},u._Sum=function(){return(u._Sum=u.asm.Sum).apply(null,arguments)},u._Tan=function(){return(u._Tan=u.asm.Tan).apply(null,arguments)},u._Tanh=function(){return(u._Tanh=u.asm.Tanh).apply(null,arguments)},u._TensorScatterUpdate=function(){return(u._TensorScatterUpdate=u.asm.TensorScatterUpdate).apply(null,arguments)},u._Tile=function(){return(u._Tile=u.asm.Tile).apply(null,arguments)},u._TopK=function(){return(u._TopK=u.asm.TopK).apply(null,arguments)},u._Transform=function(){return(u._Transform=u.asm.Transform).apply(null,arguments)},u._Transpose=function(){return(u._Transpose=u.asm.Transpose).apply(null,arguments)},u.__FusedMatMul=function(){return(u.__FusedMatMul=u.asm._FusedMatMul).apply(null,arguments)},u._malloc=function(){return(u._malloc=u.asm.malloc).apply(null,arguments)},u._free=function(){return(u._free=u.asm.free).apply(null,arguments)},u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm._emscripten_tls_init).apply(null,arguments)},u._pthread_self=function(){return(je=u._pthread_self=u.asm.pthread_self).apply(null,arguments)}),Be=(u.___errno_location=function(){return(u.___errno_location=u.asm.__errno_location).apply(null,arguments)},u.__emscripten_thread_init=function(){return(Be=u.__emscripten_thread_init=u.asm._emscripten_thread_init).apply(null,arguments)}),We=(u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm._emscripten_thread_crashed).apply(null,arguments)},u._emscripten_main_thread_process_queued_calls=function(){return(u._emscripten_main_thread_process_queued_calls=u.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},u._emscripten_main_browser_thread_id=function(){return(u._emscripten_main_browser_thread_id=u.asm.emscripten_main_browser_thread_id).apply(null,arguments)},u._emscripten_run_in_main_runtime_thread_js=function(){return(We=u._emscripten_run_in_main_runtime_thread_js=u.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)}),Ve=(u._emscripten_dispatch_to_thread_=function(){return(u._emscripten_dispatch_to_thread_=u.asm.emscripten_dispatch_to_thread_).apply(null,arguments)},u.__emscripten_proxy_execute_task_queue=function(){return(Ve=u.__emscripten_proxy_execute_task_queue=u.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)}),Ue=u.__emscripten_thread_free_data=function(){return(Ue=u.__emscripten_thread_free_data=u.asm._emscripten_thread_free_data).apply(null,arguments)},He=u.__emscripten_thread_exit=function(){return(He=u.__emscripten_thread_exit=u.asm._emscripten_thread_exit).apply(null,arguments)},Ge=u._emscripten_stack_set_limits=function(){return(Ge=u._emscripten_stack_set_limits=u.asm.emscripten_stack_set_limits).apply(null,arguments)},qe=u.stackSave=function(){return(qe=u.stackSave=u.asm.stackSave).apply(null,arguments)},Ke=u.stackRestore=function(){return(Ke=u.stackRestore=u.asm.stackRestore).apply(null,arguments)},Xe=u.stackAlloc=function(){return(Xe=u.stackAlloc=u.asm.stackAlloc).apply(null,arguments)};u.dynCall_iijjiiii=function(){return(u.dynCall_iijjiiii=u.asm.dynCall_iijjiiii).apply(null,arguments)},u.dynCall_jiji=function(){return(u.dynCall_jiji=u.asm.dynCall_jiji).apply(null,arguments)};function Ye(e){if(e=e||m,!(ee>0)){if(x)return o(u),J(),void startWorker(u);(function(){if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)Z(u.preRun.shift());me(K)})(),ee>0||(u.setStatus?(u.setStatus("Running..."),setTimeout(function(){setTimeout(function(){u.setStatus("")},1),t()},1)):t())}function t(){Me||(Me=!0,u.calledRun=!0,!M&&(J(),o(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),function(){if(!x){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;)$(u.postRun.shift());me(Y)}}()))}}if(u.keepRuntimeAlive=Q,u.wasmMemory=R,u.cwrap=function(e,t,n,a){var r=(n=n||[]).every(e=>"number"===e||"boolean"===e);return"string"!==t&&r&&!a?Re(e):function(){return De(e,t,n,arguments)}},u.ExitStatus=ce,u.PThread=fe,ne=function e(){Me||Ye(),Me||(ne=e)},u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();if(Ye(),c&&(Oe={uncaughtException:process.listeners("uncaughtException").filter(function(e){return!c.uncaughtException.indexOf(e)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(e){return!c.unhandledRejection.indexOf(e)>-1})}),"undefined"!=typeof WasmBackendModule)Pe=WasmBackendModule;else{if("undefined"==typeof t)throw new Error("Could not find wasm module in post.js");Pe=t}if(Oe){var Qe=Pe._dispose;Pe._dispose=function(){Qe(),Oe.uncaughtException.forEach(function(e){process.removeListener("uncaughtException",e)}),Oe.unhandledRejection.forEach(function(e){process.removeListener("unhandledRejection",e)})}}return t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=a:"function"==typeof define&&n.amdO?define([],function(){return a}):"object"==typeof e&&(e.WasmBackendModuleThreadedSimd=a)}),Rh=ch((e,t)=>{t.exports.wasmWorkerContents='"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"\n");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};'}),Fh=ch((e,t)=>{var a=(()=>{var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return e=e||$p,function(t){var n,a,r,s="undefined"!=typeof(t=t||{})?t:{};s.ready=new Promise(function(e,t){n=e,a=t}),"undefined"!=typeof process&&process.listeners&&(r={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var i,o,l,c=Object.assign({},s),u=[],d="object"==typeof window,p="function"==typeof importScripts,h="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,f="";if(h){var m=Ih(),g=Ch();f=p?g.dirname(f)+"/":"//",i=(e,t)=>(e=U(e)?new URL(e):g.normalize(e),m.readFileSync(e,t?void 0:"utf8")),l=e=>{var t=i(e,!0);return t.buffer||(t=new Uint8Array(t)),t},o=(e,t,n)=>{e=U(e)?new URL(e):g.normalize(e),m.readFile(e,function(e,a){e?n(e):t(a.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),u=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof G))throw e}),process.on("unhandledRejection",function(e){throw e}),s.inspect=function(){return"[Emscripten Module object]"}}else(d||p)&&(p?f=self.location.href:"undefined"!=typeof document&&document.currentScript&&(f=document.currentScript.src),e&&(f=e),f=0!==f.indexOf("blob:")?f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):"",i=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},p&&(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),o=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)},e=>document.title=e);var y=s.print||console.log.bind(console),b=s.printErr||console.warn.bind(console);Object.assign(s,c),c=null,s.arguments&&(u=s.arguments),s.thisProgram&&s.thisProgram,s.quit&&s.quit;var v;s.wasmBinary&&(v=s.wasmBinary);var x=s.noExitRuntime||!0;"object"!=typeof WebAssembly&&j("no native wasm support detected");var w,k=!1;var S,N,I,C,T="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,t,n){for(var a=(t>>>=0)+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.buffer&&T)return T.decode(e.subarray(t,r));for(var s="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192!=(224&i)){var l=63&e[t++];if((i=224==(240&i)?(15&i)<<12|o<<6|l:(7&i)<<18|o<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(i);else{var c=i-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&i)<<6|o)}else s+=String.fromCharCode(i)}return s}function _(e,t){return(e>>>=0)?E(I,e,t):""}function A(e){S=e,s.HEAP8=N=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAP32=new Int32Array(e),s.HEAPU8=I=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAPU32=C=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=new Float64Array(e)}s.INITIAL_MEMORY;var R=[],F=[],D=[];function M(e){R.unshift(e)}function O(e){D.unshift(e)}var P=0,L=null,z=null;function j(e){s.onAbort&&s.onAbort(e),b(e="Aborted("+e+")"),k=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw a(t),t}var B,W;function V(e){return e.startsWith("data:application/octet-stream;base64,")}function U(e){return e.startsWith("file://")}function H(e){try{if(e==B&&v)return new Uint8Array(v);if(l)return l(e);throw"both async and sync fetching of the wasm failed"}catch(t){j(t)}}function G(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function q(e){for(;e.length>0;)e.shift()(s)}function K(e){try{return w.grow(e-S.byteLength+65535>>>16),A(w.buffer),1}catch(t){}}V(B="tfjs-backend-wasm.wasm")||(W=B,B=s.locateFile?s.locateFile(W,f):f+W);var X=[null,[],[]];function Y(e,t){var n=X[e];0===t||10===t?((1===e?y:b)(E(n,0)),n.length=0):n.push(t)}function Q(e){return s["_"+e]}function J(e,t,n,a,r){var s={string:e=>{var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);(function(e,t,n){(function(e,t,n,a){if(!(a>0))return 0;for(var r=n>>>=0,s=n+a-1,i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++i)),o<=127){if(n>=s)break;t[n++>>>0]=o}else if(o<=2047){if(n+1>=s)break;t[n++>>>0]=192|o>>6,t[n++>>>0]=128|63&o}else if(o<=65535){if(n+2>=s)break;t[n++>>>0]=224|o>>12,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}else{if(n+3>=s)break;t[n++>>>0]=240|o>>18,t[n++>>>0]=128|o>>12&63,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}}t[n>>>0]=0})(e,I,t,n)})(e,t=re(n),n)}return t},array:e=>{var t=re(e.length);return function(e,t){N.set(e,t>>>0)}(e,t),t}};var i=Q(e),o=[],l=0;if(a)for(var c=0;c<a.length;c++){var u=s[n[c]];u?(0===l&&(l=ne()),o[c]=u(a[c])):o[c]=a[c]}var d,p=i.apply(null,o);return d=p,0!==l&&ae(l),p=function(e){return"string"===t?_(e):"boolean"===t?!!e:e}(d),p}var Z,$,ee,te={abort:function(){j("")},emscripten_get_heap_max:function(){return 4294901760},emscripten_memcpy_big:function(e,t,n){I.copyWithin(e>>>0,t>>>0,t+n>>>0)},emscripten_resize_heap:function(e){var t=I.length,n=4294901760;if((e>>>=0)>n)return!1;let a=(e,t)=>e+(t-e%t)%t;for(var r=1;r<=4;r*=2){var s=t*(1+.2/r);if(s=Math.min(s,e+100663296),K(Math.min(n,a(Math.max(e,s),65536))))return!0}return!1},fd_close:function(e){return 52},fd_seek:function(e,t,n,a,r){return 70},fd_write:function(e,t,n,a){for(var r=0,s=0;s<n;s++){var i=C[t>>>2],o=C[t+4>>>2];t+=8;for(var l=0;l<o;l++)Y(e,I[i+l>>>0]);r+=o}return C[a>>>2]=r,0}},ne=(function(){var e={env:te,wasi_snapshot_preview1:te};function t(e,t){var n=e.exports;s.asm=n,A((w=s.asm.memory).buffer),s.asm.__indirect_function_table,function(e){F.unshift(e)}(s.asm.__wasm_call_ctors),function(){if(P--,s.monitorRunDependencies&&s.monitorRunDependencies(P),0==P&&(null!==L&&(clearInterval(L),L=null),z)){var e=z;z=null,e()}}()}function n(e){t(e.instance)}function r(t){return function(){if(!v&&(d||p)){if("function"==typeof fetch&&!U(B))return fetch(B,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+B+"'";return e.arrayBuffer()}).catch(function(){return H(B)});if(o)return new Promise(function(e,t){o(B,function(t){e(new Uint8Array(t))},t)})}return Promise.resolve().then(function(){return H(B)})}().then(function(t){return WebAssembly.instantiate(t,e)}).then(function(e){return e}).then(t,function(e){b("failed to asynchronously prepare wasm: "+e),j(e)})}if(P++,s.monitorRunDependencies&&s.monitorRunDependencies(P),s.instantiateWasm)try{return s.instantiateWasm(e,t)}catch(i){b("Module.instantiateWasm callback failed with error: "+i),a(i)}(v||"function"!=typeof WebAssembly.instantiateStreaming||V(B)||U(B)||h||"function"!=typeof fetch?r(n):fetch(B,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(n,function(e){return b("wasm streaming compile failed: "+e),b("falling back to ArrayBuffer instantiation"),r(n)})})).catch(a)}(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},s._init=function(){return(s._init=s.asm.init).apply(null,arguments)},s._init_with_threads_count=function(){return(s._init_with_threads_count=s.asm.init_with_threads_count).apply(null,arguments)},s._get_threads_count=function(){return(s._get_threads_count=s.asm.get_threads_count).apply(null,arguments)},s._register_tensor=function(){return(s._register_tensor=s.asm.register_tensor).apply(null,arguments)},s._dispose_data=function(){return(s._dispose_data=s.asm.dispose_data).apply(null,arguments)},s._dispose=function(){return(s._dispose=s.asm.dispose).apply(null,arguments)},s._Abs=function(){return(s._Abs=s.asm.Abs).apply(null,arguments)},s._Acos=function(){return(s._Acos=s.asm.Acos).apply(null,arguments)},s._Acosh=function(){return(s._Acosh=s.asm.Acosh).apply(null,arguments)},s._Add=function(){return(s._Add=s.asm.Add).apply(null,arguments)},s._AddN=function(){return(s._AddN=s.asm.AddN).apply(null,arguments)},s._All=function(){return(s._All=s.asm.All).apply(null,arguments)},s._Any=function(){return(s._Any=s.asm.Any).apply(null,arguments)},s._ArgMax=function(){return(s._ArgMax=s.asm.ArgMax).apply(null,arguments)},s._ArgMin=function(){return(s._ArgMin=s.asm.ArgMin).apply(null,arguments)},s._Asin=function(){return(s._Asin=s.asm.Asin).apply(null,arguments)},s._Asinh=function(){return(s._Asinh=s.asm.Asinh).apply(null,arguments)},s._Atan=function(){return(s._Atan=s.asm.Atan).apply(null,arguments)},s._Atan2=function(){return(s._Atan2=s.asm.Atan2).apply(null,arguments)},s._Atanh=function(){return(s._Atanh=s.asm.Atanh).apply(null,arguments)},s._AvgPool=function(){return(s._AvgPool=s.asm.AvgPool).apply(null,arguments)},s._AvgPool3D=function(){return(s._AvgPool3D=s.asm.AvgPool3D).apply(null,arguments)},s._AvgPool3DGrad=function(){return(s._AvgPool3DGrad=s.asm.AvgPool3DGrad).apply(null,arguments)},s._AvgPoolGrad=function(){return(s._AvgPoolGrad=s.asm.AvgPoolGrad).apply(null,arguments)},s._BatchMatMul=function(){return(s._BatchMatMul=s.asm.BatchMatMul).apply(null,arguments)},s._Bincount=function(){return(s._Bincount=s.asm.Bincount).apply(null,arguments)},s._BitwiseAnd=function(){return(s._BitwiseAnd=s.asm.BitwiseAnd).apply(null,arguments)},s._Ceil=function(){return(s._Ceil=s.asm.Ceil).apply(null,arguments)},s._ClipByValue=function(){return(s._ClipByValue=s.asm.ClipByValue).apply(null,arguments)},s._Conv2D=function(){return(s._Conv2D=s.asm.Conv2D).apply(null,arguments)},s._Conv2DBackpropInput=function(){return(s._Conv2DBackpropInput=s.asm.Conv2DBackpropInput).apply(null,arguments)},s._Conv3D=function(){return(s._Conv3D=s.asm.Conv3D).apply(null,arguments)},s._Conv3DBackpropFilterV2=function(){return(s._Conv3DBackpropFilterV2=s.asm.Conv3DBackpropFilterV2).apply(null,arguments)},s._Conv3DBackpropInputV2=function(){return(s._Conv3DBackpropInputV2=s.asm.Conv3DBackpropInputV2).apply(null,arguments)},s._Cos=function(){return(s._Cos=s.asm.Cos).apply(null,arguments)},s._Cosh=function(){return(s._Cosh=s.asm.Cosh).apply(null,arguments)},s._CropAndResize=function(){return(s._CropAndResize=s.asm.CropAndResize).apply(null,arguments)},s._Cumprod=function(){return(s._Cumprod=s.asm.Cumprod).apply(null,arguments)},s._Cumsum=function(){return(s._Cumsum=s.asm.Cumsum).apply(null,arguments)},s._DenseBincount=function(){return(s._DenseBincount=s.asm.DenseBincount).apply(null,arguments)},s._DepthToSpace=function(){return(s._DepthToSpace=s.asm.DepthToSpace).apply(null,arguments)},s._DepthwiseConv2dNative=function(){return(s._DepthwiseConv2dNative=s.asm.DepthwiseConv2dNative).apply(null,arguments)},s._Diag=function(){return(s._Diag=s.asm.Diag).apply(null,arguments)},s._Dilation2D=function(){return(s._Dilation2D=s.asm.Dilation2D).apply(null,arguments)},s._Dilation2DBackpropFilter=function(){return(s._Dilation2DBackpropFilter=s.asm.Dilation2DBackpropFilter).apply(null,arguments)},s._Dilation2DBackpropInput=function(){return(s._Dilation2DBackpropInput=s.asm.Dilation2DBackpropInput).apply(null,arguments)},s._Elu=function(){return(s._Elu=s.asm.Elu).apply(null,arguments)},s._EluGrad=function(){return(s._EluGrad=s.asm.EluGrad).apply(null,arguments)},s._Equal=function(){return(s._Equal=s.asm.Equal).apply(null,arguments)},s._Erf=function(){return(s._Erf=s.asm.Erf).apply(null,arguments)},s._Exp=function(){return(s._Exp=s.asm.Exp).apply(null,arguments)},s._Expm1=function(){return(s._Expm1=s.asm.Expm1).apply(null,arguments)},s._FlipLeftRight=function(){return(s._FlipLeftRight=s.asm.FlipLeftRight).apply(null,arguments)},s._Floor=function(){return(s._Floor=s.asm.Floor).apply(null,arguments)},s._FloorDiv=function(){return(s._FloorDiv=s.asm.FloorDiv).apply(null,arguments)},s._FusedBatchNorm=function(){return(s._FusedBatchNorm=s.asm.FusedBatchNorm).apply(null,arguments)},s._FusedConv2D=function(){return(s._FusedConv2D=s.asm.FusedConv2D).apply(null,arguments)},s._FusedDepthwiseConv2D=function(){return(s._FusedDepthwiseConv2D=s.asm.FusedDepthwiseConv2D).apply(null,arguments)},s._Gather=function(){return(s._Gather=s.asm.Gather).apply(null,arguments)},s._GatherNd=function(){return(s._GatherNd=s.asm.GatherNd).apply(null,arguments)},s._Greater=function(){return(s._Greater=s.asm.Greater).apply(null,arguments)},s._GreaterEqual=function(){return(s._GreaterEqual=s.asm.GreaterEqual).apply(null,arguments)},s._IsFinite=function(){return(s._IsFinite=s.asm.IsFinite).apply(null,arguments)},s._IsInf=function(){return(s._IsInf=s.asm.IsInf).apply(null,arguments)},s._IsNan=function(){return(s._IsNan=s.asm.IsNan).apply(null,arguments)},s._LRN=function(){return(s._LRN=s.asm.LRN).apply(null,arguments)},s._LRNGrad=function(){return(s._LRNGrad=s.asm.LRNGrad).apply(null,arguments)},s._LeakyRelu=function(){return(s._LeakyRelu=s.asm.LeakyRelu).apply(null,arguments)},s._Less=function(){return(s._Less=s.asm.Less).apply(null,arguments)},s._LessEqual=function(){return(s._LessEqual=s.asm.LessEqual).apply(null,arguments)},s._LinSpace=function(){return(s._LinSpace=s.asm.LinSpace).apply(null,arguments)},s._Log=function(){return(s._Log=s.asm.Log).apply(null,arguments)},s._Log1p=function(){return(s._Log1p=s.asm.Log1p).apply(null,arguments)},s._LogicalAnd=function(){return(s._LogicalAnd=s.asm.LogicalAnd).apply(null,arguments)},s._LogicalNot=function(){return(s._LogicalNot=s.asm.LogicalNot).apply(null,arguments)},s._LogicalOr=function(){return(s._LogicalOr=s.asm.LogicalOr).apply(null,arguments)},s._LogicalXor=function(){return(s._LogicalXor=s.asm.LogicalXor).apply(null,arguments)},s._Max=function(){return(s._Max=s.asm.Max).apply(null,arguments)},s._MaxPool=function(){return(s._MaxPool=s.asm.MaxPool).apply(null,arguments)},s._MaxPool3D=function(){return(s._MaxPool3D=s.asm.MaxPool3D).apply(null,arguments)},s._MaxPool3DGrad=function(){return(s._MaxPool3DGrad=s.asm.MaxPool3DGrad).apply(null,arguments)},s._MaxPoolGrad=function(){return(s._MaxPoolGrad=s.asm.MaxPoolGrad).apply(null,arguments)},s._MaxPoolWithArgmax=function(){return(s._MaxPoolWithArgmax=s.asm.MaxPoolWithArgmax).apply(null,arguments)},s._Maximum=function(){return(s._Maximum=s.asm.Maximum).apply(null,arguments)},s._Mean=function(){return(s._Mean=s.asm.Mean).apply(null,arguments)},s._Min=function(){return(s._Min=s.asm.Min).apply(null,arguments)},s._Minimum=function(){return(s._Minimum=s.asm.Minimum).apply(null,arguments)},s._MirrorPad=function(){return(s._MirrorPad=s.asm.MirrorPad).apply(null,arguments)},s._Mod=function(){return(s._Mod=s.asm.Mod).apply(null,arguments)},s._Multinomial=function(){return(s._Multinomial=s.asm.Multinomial).apply(null,arguments)},s._Multiply=function(){return(s._Multiply=s.asm.Multiply).apply(null,arguments)},s._Neg=function(){return(s._Neg=s.asm.Neg).apply(null,arguments)},s._NonMaxSuppressionV3=function(){return(s._NonMaxSuppressionV3=s.asm.NonMaxSuppressionV3).apply(null,arguments)},s._NonMaxSuppressionV4=function(){return(s._NonMaxSuppressionV4=s.asm.NonMaxSuppressionV4).apply(null,arguments)},s._NonMaxSuppressionV5=function(){return(s._NonMaxSuppressionV5=s.asm.NonMaxSuppressionV5).apply(null,arguments)},s._NotEqual=function(){return(s._NotEqual=s.asm.NotEqual).apply(null,arguments)},s._OneHot=function(){return(s._OneHot=s.asm.OneHot).apply(null,arguments)},s._PadV2=function(){return(s._PadV2=s.asm.PadV2).apply(null,arguments)},s._Pow=function(){return(s._Pow=s.asm.Pow).apply(null,arguments)},s._Prelu=function(){return(s._Prelu=s.asm.Prelu).apply(null,arguments)},s._Prod=function(){return(s._Prod=s.asm.Prod).apply(null,arguments)},s._RealDiv=function(){return(s._RealDiv=s.asm.RealDiv).apply(null,arguments)},s._Reciprocal=function(){return(s._Reciprocal=s.asm.Reciprocal).apply(null,arguments)},s._Relu=function(){return(s._Relu=s.asm.Relu).apply(null,arguments)},s._Relu6=function(){return(s._Relu6=s.asm.Relu6).apply(null,arguments)},s._ResizeBilinear=function(){return(s._ResizeBilinear=s.asm.ResizeBilinear).apply(null,arguments)},s._ResizeBilinearGrad=function(){return(s._ResizeBilinearGrad=s.asm.ResizeBilinearGrad).apply(null,arguments)},s._ResizeNearestNeighbor=function(){return(s._ResizeNearestNeighbor=s.asm.ResizeNearestNeighbor).apply(null,arguments)},s._ResizeNearestNeighborGrad=function(){return(s._ResizeNearestNeighborGrad=s.asm.ResizeNearestNeighborGrad).apply(null,arguments)},s._Reverse=function(){return(s._Reverse=s.asm.Reverse).apply(null,arguments)},s._RotateWithOffset=function(){return(s._RotateWithOffset=s.asm.RotateWithOffset).apply(null,arguments)},s._Round=function(){return(s._Round=s.asm.Round).apply(null,arguments)},s._Rsqrt=function(){return(s._Rsqrt=s.asm.Rsqrt).apply(null,arguments)},s._ScatterNd=function(){return(s._ScatterNd=s.asm.ScatterNd).apply(null,arguments)},s._SearchSorted=function(){return(s._SearchSorted=s.asm.SearchSorted).apply(null,arguments)},s._SelectV2=function(){return(s._SelectV2=s.asm.SelectV2).apply(null,arguments)},s._Selu=function(){return(s._Selu=s.asm.Selu).apply(null,arguments)},s._Sigmoid=function(){return(s._Sigmoid=s.asm.Sigmoid).apply(null,arguments)},s._Sign=function(){return(s._Sign=s.asm.Sign).apply(null,arguments)},s._Sin=function(){return(s._Sin=s.asm.Sin).apply(null,arguments)},s._Sinh=function(){return(s._Sinh=s.asm.Sinh).apply(null,arguments)},s._Softmax=function(){return(s._Softmax=s.asm.Softmax).apply(null,arguments)},s._Softplus=function(){return(s._Softplus=s.asm.Softplus).apply(null,arguments)},s._SparseFillEmptyRows=function(){return(s._SparseFillEmptyRows=s.asm.SparseFillEmptyRows).apply(null,arguments)},s._SparseReshape=function(){return(s._SparseReshape=s.asm.SparseReshape).apply(null,arguments)},s._SparseSegmentReduction=function(){return(s._SparseSegmentReduction=s.asm.SparseSegmentReduction).apply(null,arguments)},s._SparseToDense=function(){return(s._SparseToDense=s.asm.SparseToDense).apply(null,arguments)},s._Sqrt=function(){return(s._Sqrt=s.asm.Sqrt).apply(null,arguments)},s._Square=function(){return(s._Square=s.asm.Square).apply(null,arguments)},s._SquaredDifference=function(){return(s._SquaredDifference=s.asm.SquaredDifference).apply(null,arguments)},s._Step=function(){return(s._Step=s.asm.Step).apply(null,arguments)},s._StridedSlice=function(){return(s._StridedSlice=s.asm.StridedSlice).apply(null,arguments)},s._Sub=function(){return(s._Sub=s.asm.Sub).apply(null,arguments)},s._Sum=function(){return(s._Sum=s.asm.Sum).apply(null,arguments)},s._Tan=function(){return(s._Tan=s.asm.Tan).apply(null,arguments)},s._Tanh=function(){return(s._Tanh=s.asm.Tanh).apply(null,arguments)},s._TensorScatterUpdate=function(){return(s._TensorScatterUpdate=s.asm.TensorScatterUpdate).apply(null,arguments)},s._Tile=function(){return(s._Tile=s.asm.Tile).apply(null,arguments)},s._TopK=function(){return(s._TopK=s.asm.TopK).apply(null,arguments)},s._Transform=function(){return(s._Transform=s.asm.Transform).apply(null,arguments)},s._Transpose=function(){return(s._Transpose=s.asm.Transpose).apply(null,arguments)},s.__FusedMatMul=function(){return(s.__FusedMatMul=s.asm._FusedMatMul).apply(null,arguments)},s._malloc=function(){return(s._malloc=s.asm.malloc).apply(null,arguments)},s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)},s.stackSave=function(){return(ne=s.stackSave=s.asm.stackSave).apply(null,arguments)}),ae=s.stackRestore=function(){return(ae=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},re=s.stackAlloc=function(){return(re=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)};s.dynCall_iijjiiii=function(){return(s.dynCall_iijjiiii=s.asm.dynCall_iijjiiii).apply(null,arguments)},s.dynCall_jiji=function(){return(s.dynCall_jiji=s.asm.dynCall_jiji).apply(null,arguments)};function se(e){function t(){Z||(Z=!0,s.calledRun=!0,!k&&(q(F),n(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),function(){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)O(s.postRun.shift());q(D)}()))}e=e||u,P>0||(function(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)M(s.preRun.shift());q(R)}(),P>0)||(s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),t()},1)):t())}if(s.cwrap=function(e,t,n,a){var r=(n=n||[]).every(e=>"number"===e||"boolean"===e);return"string"!==t&&r&&!a?Q(e):function(){return J(e,t,n,arguments)}},z=function e(){Z||se(),Z||(z=e)},s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();if(se(),r&&($={uncaughtException:process.listeners("uncaughtException").filter(function(e){return!r.uncaughtException.indexOf(e)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(e){return!r.unhandledRejection.indexOf(e)>-1})}),"undefined"!=typeof t)ee=t;else{if("undefined"==typeof WasmBackendModuleThreadedSimd)throw new Error("Could not find wasm module in post.js");ee=WasmBackendModuleThreadedSimd}if($){var ie=ee._dispose;ee._dispose=function(){ie(),$.uncaughtException.forEach(function(e){process.removeListener("uncaughtException",e)}),$.unhandledRejection.forEach(function(e){process.removeListener("unhandledRejection",e)})}}return t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=a:"function"==typeof define&&n.amdO?define([],function(){return a}):"object"==typeof e&&(e.WasmBackendModule=a)}),Dh=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},Mh=class{refCount(e){return Oh("refCount")}incRef(e){return Oh("incRef")}timerAvailable(){return!0}time(e){return Oh("time")}read(e){return Oh("read")}readSync(e){return Oh("readSync")}readToGPU(e,t){return Oh("readToGPU")}numDataIds(){return Oh("numDataIds")}disposeData(e,t){return Oh("disposeData")}write(e,t,n){return Oh("write")}move(e,t,n,a,r){return Oh("move")}createTensorFromGPUData(e,t,n){return Oh("createTensorFromGPUData")}memory(){return Oh("memory")}floatPrecision(){return Oh("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Oh("dispose")}};function Oh(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen"))}function Ph(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Bh(e,t,n)}function Lh(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together First array length was ".concat(e.length,"Second array length was ").concat(t.length));let n=e.length,a=0;for(;n>0;)a=Math.random()*n|0,n--,Bh(e,n,a),Bh(t,n,a)}function zh(e,t,n){return Math.max(e,Math.min(t,n))}function jh(e){return e%2===0?e:e+1}function Bh(e,t,n){let a=e[t];e[t]=e[n],e[n]=a}function Wh(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function Vh(e,t){let n=Math.random();return t*n+(1-n)*e}function Uh(e,t){let n=0;for(let a=0;a<e.length;a++){let r=Number(e[a])-Number(t[a]);n+=r*r}return n}function Hh(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function Gh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Hh(Qh(e,t),()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}function qh(e){Hh(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function Kh(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Xh(e){return 0===e.length}function Yh(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function Qh(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Jh(e){return e%1===0}function Zh(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function $h(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function ef(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return Ph(t),t}function tf(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function nf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return new Promise((r,s)=>{let i=0,o=()=>{if(e())return void r();i++;let l=t(i);null!=n&&i>=n?s():null!=a?a(o,l):setTimeout(o,l)};o()})}function af(e,t){let n=1,a=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(-1===e[s]){if(-1!==a)throw Error("Shapes can only have 1 implicit size. Found -1 at dim ".concat(a," and dim ").concat(s));a=s}else if(e[s]<0)throw Error("Shapes can not be < 0. Found ".concat(e[s]," at dim ").concat(s));if(-1===a){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when there are 0 elements"));if(t%n!==0)throw Error("The implicit shape can't be a fractional number. Got ".concat(t," / ").concat(n));let r=e.slice();return r[a]=t/n,r}function rf(e,t){let n=t.length;return e=null==e?t.map((e,t)=>t):[].concat(e),Hh(e.every(e=>e>=-n&&e<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but got axis ").concat(e)),Hh(e.every(e=>Jh(e)),()=>"All values in axis param must be integers but got axis ".concat(e)),e.map(e=>e<0?n+e:e)}function sf(e,t){let n=[],a=[],r=null!=t&&Array.isArray(t)&&0===t.length,s=null==t||r?null:rf(t,e).sort(),i=0;for(let o=0;o<e.length;++o){if(null!=s){if(s[i]===o&&1!==e[o])throw new Error("Can't squeeze axis ".concat(o," since its dim '").concat(e[o],"' is not 1"));(null==s[i]||s[i]>o)&&1===e[o]&&(n.push(e[o]),a.push(o)),s[i]<=o&&i++}1!==e[o]&&(n.push(e[o]),a.push(o))}return{newShape:n,keptDims:a}}function of(e,t){return lf(e,t)}function lf(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function cf(e,t){for(let n=0;n<e.length;n++){let a=e[n];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(a,"."))}}function uf(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function df(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function pf(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function hf(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}function ff(e){return"string"==typeof e||e instanceof String}function mf(e){return"boolean"==typeof e}function gf(e){return"number"==typeof e}function yf(e){return Array.isArray(e)?yf(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":gf(e)?"float32":ff(e)?"string":mf(e)?"bool":"float32"}function bf(e){return!!(e&&e.constructor&&e.call&&e.apply)}function vf(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function xf(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let a=t-3;a>=0;--a)n[a]=n[a+1]*e[a+1];return n}function wf(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Array;if(1===t.length){let s=t[0]*(a?2:1);for(let t=0;t<s;t++)r[t]=n[e+t]}else{let s=t[0],i=t.slice(1),o=i.reduce((e,t)=>e*t)*(a?2:1);for(let t=0;t<s;t++)r[t]=wf(e+t*o,i,n,a)}return r}function kf(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];let a=e.reduce((e,t)=>e*t)*(n?2:1);if(0===a)return[];if(a!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return wf(0,e,t,n)}function Sf(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function Nf(e,t){let n=If(e,t);for(let a=0;a<n.length;a++)n[a]=1;return n}function If(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function Cf(e,t){let n=e.reduce((e,t)=>e*t,1);if(null==t||"float32"===t)return kf(e,new Float32Array(n));if("int32"===t)return kf(e,new Int32Array(n));if("bool"===t)return kf(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function Tf(e){e.forEach(t=>{Hh(Number.isInteger(t)&&t>=0,()=>"Tensor must have a shape comprised of positive integers but got shape [".concat(e,"]."))})}function Ef(e,t,n){if(0===t)return 0;if(1===t)return e[0];let a=e[e.length-1];for(let r=0;r<e.length-1;++r)a+=n[r]*e[r];return a}function _f(e,t,n){if(0===t)return[];if(1===t)return[e];let a=new Array(t);for(let r=0;r<a.length-1;++r)a[r]=Math.floor(e/n[r]),e-=a[r]*n[r];return a[a.length-1]=e,a}function Af(e){return e&&e.then&&"function"==typeof e.then}var Rf="tfjsflags",Ff=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Df,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(Mf().getBool("IS_TEST")||Mf().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. Overwriting the platform with ").concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){let t=this.urlFlags[e];Mf().getBool("IS_TEST")||Mf().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(Af(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. Please use getAsync() instead."));return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"==typeof this.global||"undefined"==typeof this.global.location||"undefined"==typeof this.global.location.search)return;let e=this.getQueryParams(this.global.location.search);Rf in e&&e[Rf].split(",").forEach(e=>{let[t,n]=e.split(":");this.urlFlags[t]=function(e,t){let n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)})}};function Df(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,a[0],a[1]),a.join("=")}),t}function Mf(){return Pf}var Of,Pf=null;function Lf(){if(null==Of){let e;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Of=e}return Of}function zf(e,t){let n=function(){let e=Lf();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{let a=t();return n.set(e,a),n.get(e)}}var jf="Abs",Bf="Acos",Wf="Acosh",Vf="Add",Uf="AddN",Hf="All",Gf="Any",qf="ArgMax",Kf="ArgMin",Xf="Asin",Yf="Asinh",Qf="Atan",Jf="Atanh",Zf="Atan2",$f="AvgPool",em="AvgPoolGrad",tm="AvgPool3D",nm="AvgPool3DGrad",am="BatchMatMul",rm="BatchToSpaceND",sm="Bincount",im="BitwiseAnd",om="BroadcastTo",lm="BroadcastArgs",cm="Cast",um="Ceil",dm="ClipByValue",pm="Complex",hm="ComplexAbs",fm="Concat",mm="Conv2D",gm="Conv2DBackpropFilter",ym="Conv2DBackpropInput",bm="Conv3D",vm="Conv3DBackpropFilterV2",xm="Conv3DBackpropInputV2",wm="Cos",km="Cosh",Sm="Cumprod",Nm="Cumsum",Im="CropAndResize",Cm="DenseBincount",Tm="DepthToSpace",Em="DepthwiseConv2dNative",_m="DepthwiseConv2dNativeBackpropFilter",Am="DepthwiseConv2dNativeBackpropInput",Rm="Diag",Fm="Dilation2D",Dm="Dilation2DBackpropInput",Mm="Dilation2DBackpropFilter",Om="Draw",Pm="RealDiv",Lm="Einsum",zm="Elu",jm="EluGrad",Bm="Erf",Wm="Equal",Vm="Exp",Um="ExpandDims",Hm="Expm1",Gm="FFT",qm="Fill",Km="FlipLeftRight",Xm="Floor",Ym="FloorDiv",Qm="FusedBatchNorm",Jm="GatherV2",Zm="GatherNd",$m="Greater",eg="GreaterEqual",tg="Identity",ng="IFFT",ag="Imag",rg="IsFinite",sg="IsInf",ig="IsNan",og="LeakyRelu",lg="Less",cg="LessEqual",ug="LinSpace",dg="Log",pg="Log1p",hg="LogicalAnd",fg="LogicalNot",mg="LogicalOr",gg="LogicalXor",yg="LogSoftmax",bg="LowerBound",vg="LRN",xg="LRNGrad",wg="MatrixBandPart",kg="Max",Sg="Maximum",Ng="MaxPool",Ig="MaxPoolGrad",Cg="MaxPool3D",Tg="MaxPool3DGrad",Eg="MaxPoolWithArgmax",_g="Mean",Ag="Min",Rg="Minimum",Fg="MirrorPad",Dg="Mod",Mg="Multinomial",Og="Multiply",Pg="Neg",Lg="NotEqual",zg="NonMaxSuppressionV3",jg="NonMaxSuppressionV4",Bg="NonMaxSuppressionV5",Wg="OnesLike",Vg="OneHot",Ug="Pack",Hg="PadV2",Gg="Pool",qg="Pow",Kg="Prelu",Xg="Prod",Yg="RaggedGather",Qg="RaggedRange",Jg="RaggedTensorToTensor",Zg="Range",$g="Real",ey="Reciprocal",ty="Relu",ny="Reshape",ay="ResizeNearestNeighbor",ry="ResizeNearestNeighborGrad",sy="ResizeBilinear",iy="ResizeBilinearGrad",oy="Relu6",ly="Reverse",cy="Round",uy="Rsqrt",dy="ScatterNd",py="TensorScatterUpdate",hy="SearchSorted",fy="Select",my="Selu",gy="Slice",yy="Sin",by="Sinh",vy="Sign",xy="Sigmoid",wy="Softplus",ky="Sqrt",Sy="Sum",Ny="SpaceToBatchND",Iy="SplitV",Cy="Softmax",Ty="SparseFillEmptyRows",Ey="SparseReshape",_y="SparseSegmentMean",Ay="SparseSegmentSum",Ry="SparseToDense",Fy="SquaredDifference",Dy="Square",My="StaticRegexReplace",Oy="StridedSlice",Py="StringNGrams",Ly="StringSplit",zy="StringToHashBucketFast",jy="Sub",By="Tan",Wy="Tanh",Vy="Tile",Uy="TopK",Hy="Transform",Gy="Transpose",qy="Unique",Ky="Unpack",Xy="UnsortedSegmentSum",Yy="UpperBound",Qy="ZerosLike",Jy="Step",Zy="FromPixels",$y="RotateWithOffset",eb="_FusedMatMul",tb="FusedConv2D",nb="FusedDepthwiseConv2D";function ab(){Mf().getBool("IS_TEST")||Mf().getBool("PROD")||console.warn(...arguments)}function rb(){Mf().getBool("IS_TEST")||Mf().getBool("PROD")||console.log(...arguments)}var sb=zf("kernelRegistry",()=>new Map),ib=zf("gradRegistry",()=>new Map);function ob(e,t){let n=mb(e,t);return sb.get(n)}function lb(e){return ib.get(e)}function cb(e){let t=sb.entries(),n=[];for(;;){let{done:a,value:r}=t.next();if(a)break;let[s,i]=r,[o]=s.split("_");o===e&&n.push(i)}return n}function ub(e){let{kernelName:t,backendName:n}=e,a=mb(t,n);sb.has(a)&&ab("The kernel '".concat(t,"' for backend '").concat(n,"' is already registered")),sb.set(a,e)}function db(e){let{kernelName:t}=e;ib.has(t)&&Mf().getBool("DEBUG")&&ab("Overriding the gradient for '".concat(t,"'")),ib.set(t,e)}function pb(e,t){let n=mb(e,t);if(!sb.has(n))throw new Error("The kernel '".concat(e,"' for backend '").concat(t,"' is not registered"));sb.delete(n)}function hb(e){if(!ib.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));ib.delete(e)}function fb(e,t){cb(e).forEach(e=>{ub(Object.assign({},e,{backendName:t}))})}function mb(e,t){return"".concat(t,"_").concat(e)}var gb={};function yb(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}uh(gb,{arraysEqual:()=>Qh,arraysEqualWithNull:()=>Yh,assert:()=>Hh,assertNonNegativeIntegerDimensions:()=>Tf,assertNonNull:()=>qh,assertShapesMatch:()=>Gh,bytesFromStringArray:()=>hf,bytesPerElement:()=>pf,checkConversionForErrors:()=>cf,clamp:()=>zh,computeStrides:()=>xf,convertBackendValuesAndArrayBuffer:()=>Sf,createScalarValue:()=>Fb,createShuffledIndices:()=>ef,decodeString:()=>Lb,distSquared:()=>Uh,encodeString:()=>Pb,fetch:()=>Ob,fingerPrint64:()=>Rb,flatten:()=>jb,getArrayFromDType:()=>lf,getTypedArrayFromDType:()=>of,hasEncodingLoss:()=>df,hexToLong:()=>xb,indexToLoc:()=>_f,inferDtype:()=>yf,inferFromImplicitShape:()=>af,isBoolean:()=>mf,isFunction:()=>bf,isInt:()=>Jh,isNumber:()=>gf,isPromise:()=>Af,isScalarShape:()=>Xh,isString:()=>ff,isTypedArray:()=>zb,isValidDtype:()=>uf,locToIndex:()=>Ef,makeOnesTypedArray:()=>Nf,makeZerosNestedTypedArray:()=>Cf,makeZerosTypedArray:()=>If,nearestDivisor:()=>vf,nearestLargerEven:()=>jh,now:()=>Mb,parseAxisParam:()=>rf,randUniform:()=>Vh,repeatedTry:()=>nf,rightPad:()=>tf,shuffle:()=>Ph,shuffleCombo:()=>Lh,sizeFromShape:()=>Kh,sizeToSquarishShape:()=>$h,squeezeShape:()=>sf,sum:()=>Wh,swap:()=>Bh,tanh:()=>Zh,toNestedArray:()=>kf,toTypedArray:()=>Db});var bb=dh(ph()),vb=bb.default||bb;function xb(e){return vb.fromString(e,!0,16)}var wb=xb("c3a5c85c97cb3127"),kb=xb("b492b66fbe98f273"),Sb=xb("9ae16a3b2f90404f");function Nb(e){return e.xor(e.shru(47))}function Ib(e,t,n){let a=e.slice(t,t+n);return vb.fromBytes(Array.from(a),!0,!0)}function Cb(e,t){return Ib(e,t,8)}function Tb(e,t){return Ib(e,t,4)}function Eb(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function _b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xb("9ddfea08eb382d69"),a=e.xor(t).mul(n);a=a.xor(a.shru(47));let r=t.xor(a).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function Ab(e,t,n,a){return function(e,t,n,a,r,s){r=r.add(e),s=Eb(s.add(r).add(a),21);let i=r;return r=(r=r.add(t)).add(n),s=s.add(Eb(r,44)),[r.add(a),s.add(i)]}(Cb(e,t),Cb(e,t+8),Cb(e,t+16),Cb(e,t+24),n,a)}function Rb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=vb.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){let n=Sb.add(2*t),a=Cb(e,0).add(Sb),r=Cb(e,t-8);return _b(Eb(r,37).mul(n).add(a),Eb(a,25).add(r).mul(n),n)}if(t>=4){let n=Sb.add(2*t);return _b(Tb(e,0).shl(3).add(t),Tb(e,t-4),n)}if(t>0){let n=e[0]+(e[t>>1]<<8),a=t+(e[t-1]<<2);return Nb(Sb.mul(n).xor(wb.mul(a))).mul(Sb)}return Sb}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=Sb.add(2*t),a=Cb(e,0).mul(kb),r=Cb(e,8),s=Cb(e,t-8).mul(n),i=Cb(e,t-16).mul(Sb);return _b(Eb(a.add(r),43).add(Eb(s,30)).add(i),a.add(Eb(r.add(Sb),18)).add(s),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=Sb.add(2*t),a=Cb(e,0).mul(Sb),r=Cb(e,8),s=Cb(e,t-8).mul(n),i=Cb(e,t-16).mul(Sb),o=Eb(a.add(r),43).add(Eb(s,30)).add(i),l=_b(o,a.add(Eb(r.add(Sb),18)).add(s),n),c=Cb(e,16).mul(n),u=Cb(e,24),d=o.add(Cb(e,t-32)).mul(n),p=l.add(Cb(e,t-24)).mul(n);return _b(Eb(c.add(u),43).add(Eb(d,30)).add(p),c.add(Eb(u.add(a),18)).add(d),n)}(e,t);let a=n,r=n.mul(kb).add(113),s=Nb(r.mul(Sb).add(113)).mul(Sb),i=[vb.UZERO,vb.UZERO],o=[vb.UZERO,vb.UZERO];a=a.mul(Sb).add(Cb(e,0));let l=0,c=64*(t-1>>6),u=c+(t-1&63)-63;do{a=Eb(a.add(r).add(i[0]).add(Cb(e,l+8)),37).mul(kb),r=Eb(r.add(i[1]).add(Cb(e,l+48)),42).mul(kb),a=a.xor(o[1]),r=r.add(i[0]).add(Cb(e,l+40)),s=Eb(s.add(o[0]),33).mul(kb),i=Ab(e,l,i[1].mul(kb),a.add(o[0])),o=Ab(e,l+32,s.add(o[1]),r.add(Cb(e,l+16))),[s,a]=[a,s],l+=64}while(l!==c);let d=kb.add(s.and(255).shl(1));return l=u,o[0]=o[0].add(t-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),a=Eb(a.add(r).add(i[0]).add(Cb(e,l+8)),37).mul(d),r=Eb(r.add(i[1]).add(Cb(e,l+48)),42).mul(d),a=a.xor(o[1].mul(9)),r=r.add(i[0].mul(9).add(Cb(e,l+40))),s=Eb(s.add(o[0]),33).mul(d),i=Ab(e,l,i[1].mul(d),a.add(o[0])),o=Ab(e,l+32,s.add(o[1]),r.add(Cb(e,l+16))),[s,a]=[a,s],_b(_b(i[0],o[0],d).add(Nb(r).mul(wb)).add(s),_b(i[1],o[1],d).add(a),d)}function Fb(e,t){return"string"===t?Pb(e):Db([e],t)}function Db(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=jb(e)),Mf().getBool("DEBUG")&&cf(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){let t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error("Unknown data type ".concat(t))}function Mb(){return Mf().platform.now()}function Ob(e,t){return Mf().platform.fetch(e,t)}function Pb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Mf().platform.encode(e,t)}function Lb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Mf().platform.decode(e,t)}function zb(e){return null!=Mf().platform.isTypedArray?Mf().platform.isTypedArray(e):yb(e)}function jb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"==typeof e||"number"==typeof e||"string"==typeof e||Af(e)||null==e||zb(e)&&n)t.push(e);else if(Array.isArray(e)||zb(e))for(let a=0;a<e.length;++a)jb(e[a],t,n);else{let a=-1;for(let t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(a=Math.max(a,Number(t)));for(let r=0;r<=a;r++)jb(e[r],t,n)}return t}var Bb=class{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new Vb)}profileKernel(e,t,n){let a,r,s=()=>{a=n()},i=Mb();if(this.backendTimer.timerAvailable())r=this.backendTimer.time(s);else{s();for(let e of a)e.dataSync();r=Promise.resolve({kernelMs:Mb()-i})}if(Mf().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<a.length;o++){let t=a[o];t.data().then(n=>{Wb(n,t.dtype,e)})}return{kernelName:e,outputs:a,inputs:t,timeMs:r.then(e=>e.kernelMs),extraInfo:r.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:a,inputs:r,extraInfo:s}=e;n.forEach(e=>{Promise.all([e.data(),a,s]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],r,n[2])})})}};function Wb(e,t,n){if("float32"!==t)return!1;for(let a=0;a<e.length;a++){let t=e[a];if(isNaN(t)||!isFinite(t))return console.warn("Found ".concat(t," in the result of '").concat(n,"'")),!0}return!1}var Vb=class{logKernelProfile(e,t,n,a,r,s){let i="number"==typeof a?tf("".concat(a,"ms"),9):a.error,o=tf(e,25),l=t.rank,c=t.size,u=tf(t.shape.toString(),14),d="";for(let p in r){let e=r[p];if(null!=e){let n=e.shape||t.shape,a=n.length;d+="".concat(p,": ").concat(a,"D ").concat(a>0?n:""," ")}}console.log("%c".concat(o,"\t%c").concat(i,"\t%c").concat(l,"D ").concat(u,"\t%c").concat(c,"\t%c").concat(d,"\t%c").concat(s),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function Ub(e,t,n,a){let r=xf(t),s=function(e,t,n,a){let r=Kh(t),s=a[a.length-1],i=new Array(s).fill(0),o=t.length,l="complex64"===n?Kb(e):e;if(o>1)for(let c=0;c<r/s;c++){let e=c*s;for(let t=0;t<s;t++)i[t]=Math.max(i[t],Hb(l[e+t],0,n).length)}return i}(e,t,n,r),i=t.length,o=qb(e,t,n,r,s),l=["Tensor"];return a&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(i)),l.push("  shape: [".concat(t,"]")),l.push("  values:")),l.push(o.map(e=>"    "+e).join("\n")),l.join("\n")}function Hb(e,t,n){let a;return a=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ").concat(parseFloat(e[1].toFixed(7)),"j"):ff(e)?"'".concat(e,"'"):"bool"===n?Gb(e):parseFloat(e.toFixed(7)).toString(),tf(a,t)}function Gb(e){return 0===e?"false":"true"}function qb(e,t,n,a,r){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i="complex64"===n?2:1,o=t[0],l=t.length;if(0===l){if("complex64"===n){return[Hb(Kb(e)[0],0,n)]}return"bool"===n?[Gb(e[0])]:[e[0].toString()]}if(1===l){if(o>20){let t=3*i,a=Array.from(e.slice(0,t)),s=Array.from(e.slice((o-3)*i,o*i));return"complex64"===n&&(a=Kb(a),s=Kb(s)),["["+a.map((e,t)=>Hb(e,r[t],n)).join(", ")+", ..., "+s.map((e,t)=>Hb(e,r[o-3+t],n)).join(", ")+"]"]}return["["+("complex64"===n?Kb(e):Array.from(e)).map((e,t)=>Hb(e,r[t],n)).join(", ")+"]"]}let c=t.slice(1),u=a.slice(1),d=a[0]*i,p=[];if(o>20){for(let t=0;t<3;t++){let a=t*d,s=a+d;p.push(...qb(e.slice(a,s),c,n,u,r,!1))}p.push("...");for(let t=o-3;t<o;t++){let a=t*d,s=a+d;p.push(...qb(e.slice(a,s),c,n,u,r,t===o-1))}}else for(let m=0;m<o;m++){let t=m*d,a=t+d;p.push(...qb(e.slice(t,a),c,n,u,r,m===o-1))}let h=2===l?",":"";p[0]="["+(o>0?p[0]+h:"");for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+h;let f=",\n";for(let m=2;m<l;m++)f+="\n";return p[p.length-1]=" "+p[p.length-1]+"]"+(s?"":f),p}function Kb(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Xb=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Kh(e),null!=n){let e=n.length;Hh(e===this.size,()=>"Length of values '".concat(e,"' does not match the size inferred by the shape '").concat(this.size,"'."))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||lf(t,this.size),this.strides=xf(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];0===n.length&&(n=[0]),Hh(n.length===this.rank,()=>"The number of provided coordinates (".concat(n.length,") must match the rank (").concat(this.rank,")"));let r=this.locToIndex(n);this.values[r]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let a=0;for(let s of t){if(s<0||s>=this.shape[a]){let e="Requested out of range element at ".concat(t,".   Buffer shape=").concat(this.shape);throw new Error(e)}a++}let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=this.strides[s]*t[s];return this.values[r]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Yb().makeTensor(this.values,this.shape,this.dtype)}},Yb=null,Qb=null;var Jb=class{constructor(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Kh(e),this.strides=xf(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return Qb.buffer(this.shape,this.dtype,e)}bufferSync(){return Qb.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return kf(this.shape,e,"complex64"===this.dtype)}arraySync(){return kf(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();let e=Yb().read(this.dataId);if("string"===this.dtype){let t=await e;try{return t.map(e=>Lb(e))}catch(uae){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Yb().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=Yb().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>Lb(e))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await Yb().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Yb().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Qb.print(this,e)}clone(){return this.throwIfDisposed(),Qb.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Ub(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Qb.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),Yb().makeVariable(this,e,t,n)}};function Zb(){return zf("Tensor",()=>Jb)}Object.defineProperty(Jb,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),Zb();var $b=class extends Jb{constructor(e,t,n,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and previous value (").concat(this.dtype,") must match"));if(!Qh(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and previous value (").concat(this.shape,") must match"));Yb().disposeTensor(this),this.dataId=e.dataId,Yb().incRef(this,null)}dispose(){Yb().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty($b,Symbol.hasInstance,{value:e=>e instanceof Jb&&null!=e.assign&&e.assign instanceof Function});var ev,tv,nv,av,rv,sv,iv={};uh(iv,{assertTypesMatch:()=>hv,getTensorsInContainer:()=>mv,isTensorInList:()=>fv,makeTypesMatch:()=>pv}),(tv=ev||(ev={})).R0="R0",tv.R1="R1",tv.R2="R2",tv.R3="R3",tv.R4="R4",tv.R5="R5",tv.R6="R6",function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(nv||(nv={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(av||(av={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(rv||(rv={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(sv||(sv={}));var ov={float32:rv,int32:nv,bool:av,complex64:sv};function lv(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return ov[e][t]}function cv(e){return lv(e,"int32")}function uv(e){return null!=e&&"object"==typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function dv(e){return"undefined"!=typeof GPUBuffer&&null!=e&&"object"==typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function pv(e,t){if(e.dtype===t.dtype)return[e,t];let n=lv(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function hv(e,t){Hh(e.dtype===t.dtype,()=>"The dtypes of the first(".concat(e.dtype,") and second(").concat(t.dtype,") input must match"))}function fv(e,t){return t.some(t=>t.id===e.id)}function mv(e){let t=[];return gv(e,t,new Set),t}function gv(e,t,n){if(null==e)return;if(e instanceof Jb)return void t.push(e);if(!function(e){return Array.isArray(e)||"object"==typeof e}(e))return;let a=e;for(let r in a){let e=a[r];n.has(e)||(n.add(e),gv(e,t,n))}}function yv(e){return null!=e.kernelName}var bv=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},vv=class e{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new bv}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));if(null==this.backendInstance){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{let{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(ab("".concat(e," backend was already registered. Reusing existing backend factory.")),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Bb(this.backendInstance),!0}setupRegisteredKernels(){cb(this.backendName).forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){cb(e).forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{let n=t.factory();if(!n||n instanceof Mh||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{let t=++this.pendingBackendInitId,a=n.then(n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,ab("Initialization of backend ".concat(e," failed")),ab(n.stack||n.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}}catch(n){return ab("Initialization of backend ".concat(e," failed")),ab(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:a,asyncInit:r}=this.initializeBackend(n);if(r||a)return{name:n,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),a=n.backend,r=this.readSync(t),s=a.refCount(t);a.disposeData(t,!0),n.backend=e,e.move(t,r,n.shape,n.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun(()=>this.startScope(a),()=>this.endScope(n),()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{let e=n();return t(),e}catch($t){throw t(),$t}}nextTensorId(){return e.nextTensorId++}nextVariableId(){return e.nextVariableId++}clone(e){let t=wv.runKernel(tg,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],e=>({x:()=>{let t={x:e},n={dtype:"float32"};return wv.runKernel(cm,t,n)}}),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,null==ob(e,this.backendName))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let a=this.backend.numDataIds(),r=0;n.forEach(e=>{r+="complex64"===e.dtype?3:1});let s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=a-t-r-s;if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak (").concat(i," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n,a=[],r=this.isTapeOn(),s=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;let o,l=yv(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(yv(e)){let{kernelName:t,inputs:s,attrs:i}=e;null==this.backendName&&this.backend;let l=ob(t,this.backendName);Hh(null!=l,()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'")),n=()=>{let e=this.backend.numDataIds();o=l.kernelFunc({inputs:s,attrs:i,backend:this.backend});let n=Array.isArray(o)?o:[o];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,n);let c=n.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(r){let e=this.getTensorsForGradient(t,s,c);a=this.saveTensorsForBackwardMode(e)}return c}}else{let{forwardFunc:t}=e,s=e=>{r&&(a=e.map(e=>this.keep(this.clone(e))))};n=()=>{let e=this.backend.numDataIds();o=this.tidy(()=>t(this.backend,s));let n=Array.isArray(o)?o:[o];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}let c,{inputs:u,attrs:d}=e,p=yv(e)?null:e.backwardsFunc;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(c=this.profiler.profileKernel(l,u,()=>n()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(c),t=c.outputs):t=n()}),r&&this.addTapeNode(l,u,t,p,a,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(e=>null!=u[e]?u[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:c.timeMs,extraInfo:c.extraInfo}),Array.isArray(o)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(e=>this.keep(this.clone(e)))}getTensorsForGradient(e,t,n){let a=lb(e);if(null!=a){let e,r=a.inputsToSave||[],s=a.outputsToSave||[];a.saveAllInputs?(Hh(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),e=Object.keys(t).map(e=>t[e])):e=r.map(e=>t[e]);let i=n.filter((e,t)=>s[t]);return e.concat(i)}return[]}makeTensor(e,t,n,a){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;let r=e;"string"===n&&ff(e[0])&&(r=e.map(e=>Pb(e)));let s=a.write(r,t,n),i=new Jb(t,n,s,this.nextTensorId());if(this.trackTensor(i,a),"string"===n){let e=this.state.tensorInfo.get(s),t=hf(r);this.state.numBytes+=t-e.bytes,e.bytes=t}return i}makeTensorFromDataId(e,t,n,a){let r={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(r,a)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:a,dtype:r}=e,s=new Jb(a,r,n,this.nextTensorId());return this.trackTensor(s,t),s}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=a&&a!==e.dtype&&(e=e.cast(a));let r=new $b(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[r.name])throw new Error("Variable with name ".concat(r.name," was already registered"));return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*pf(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof $b||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){let t=e.size*pf(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,a,r,s){let i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:r},o=lb(e);null!=o&&(a=o.gradFunc),null!=a&&(i.gradient=e=>(e=e.map((e,t)=>{if(null==e){let e=n[t],a=If(e.size,e.dtype);return this.makeTensor(a,e.shape,e.dtype)}return e}),a(e.length>1?e:e[0],r,s))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=mv(e),n=new Set(t.map(e=>e.id));for(let r=0;r<this.state.activeScope.track.length;r++){let e=this.state.activeScope.track[r];!e.kept&&!n.has(e.id)&&e.dispose()}let a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{!e.kept&&e.scopeId===a.id&&this.track(e)})}gradients(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Hh(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));let r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));Hh(r instanceof Jb,()=>"The result y returned by f() must be a tensor.");let s=function(e,t,n){let a={},r={};for(let l=0;l<t.length;l++)a[t[l].id]=!0;for(let l=0;l<e.length;l++){let n=e[l],s=n.inputs;for(let e in s){let i=s[e],o=!1;for(let e=0;e<t.length;e++)if(a[i.id]){n.outputs.forEach(e=>a[e.id]=!0),o=!0,r[n.id]=!0;break}if(o)break}}let s={};s[n.id]=!0;let i={};for(let l=e.length-1;l>=0;l--){let t=e[l],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(s[t.outputs[e].id]){for(let e in n)s[n[e].id]=!0,i[t.id]=!0;break}}let o=[];for(let l=0;l<e.length;l++){let t=e[l];if(r[t.id]&&i[t.id]){let e={};for(let r in t.inputs){let n=t.inputs[r];a[n.id]&&(e[r]=n)}let n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,o.push(n)}}return o}(this.state.activeTape,t,r);if(!a&&0===s.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let e={};e[r.id]=null==n?function(e){let t=Nf(Kh(e),"float32");return wv.makeTensor(t,e,"float32")}(r.shape):n,function(e,t,n,a){for(let r=t.length-1;r>=0;r--){let s=t[r],i=[];if(s.outputs.forEach(t=>{let n=e[t.id];null!=n?i.push(n):i.push(null)}),null==s.gradient)throw new Error("Cannot compute gradient: gradient function not found for ".concat(s.kernelName,"."));let o=s.gradient(i);for(let t in s.inputs){if(!(t in o))throw new Error("Cannot backprop through input ".concat(t,". Available gradients found: ").concat(Object.keys(o),"."));let r=n(()=>o[t]());if("float32"!==r.dtype)throw new Error("Error in gradient for op ".concat(s.kernelName,". The gradient of input ").concat(t," must have 'float32' dtype, but has '").concat(r.dtype,"'"));let i=s.inputs[t];if(!Qh(r.shape,i.shape))throw new Error("Error in gradient for op ".concat(s.kernelName,". The gradient of input '").concat(t,"' has shape '").concat(r.shape,"', which does not match the shape of the input '").concat(i.shape,"'"));if(null==e[i.id])e[i.id]=r;else{let t=e[i.id];e[i.id]=a(t,r),t.dispose()}}}}(e,s,e=>this.tidy(e),kv);let a=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(let t of e.saved)t.dispose()}),this.state.activeTape=null),{value:r,grads:a}})}customGrad(e){var t=this;return Hh(bf(e),()=>"The f passed in customGrad(f) must be a function."),function(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];Hh(a.every(e=>e instanceof Jb),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s,i={};a.forEach((e,t)=>{i[t]=e});return t.runKernelFunc({forwardFunc:(t,n)=>(s=e(...a,n),Hh(s.value instanceof Jb,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Hh(bf(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),backwardsFunc:(e,t)=>{let n=s.gradFunc(e,t),r=Array.isArray(n)?n:[n];Hh(r.length===a.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Hh(r.every(e=>e instanceof Jb),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let i={};return r.forEach((e,t)=>{i[t]=()=>e}),i},inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=Mb(),n=await this.backend.time(e);return n.wallMs=Mb()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new bv;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};function xv(){let e=Lf();if(null==e._tfengine){let t=new Ff(e);e._tfengine=new vv(t)}return function(e){Pf=e}(e._tfengine.ENV),function(e){Yb=e}(()=>e._tfengine),e._tfengine}vv.nextTensorId=0,vv.nextVariableId=0;var wv=xv();function kv(e,t){let n={a:e,b:t};return wv.runKernel(Vf,n)}var Sv,Nv={};function Iv(e){Sv=e}function Cv(e){if(void 0!==Sv)return Sv;if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;let t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){let t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function Tv(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}uh(Nv,{isBrowser:()=>Tv,isMobile:()=>Cv,mockIsMobile:()=>Iv});var Ev=Mf();function _v(e,t){let n=e;if(zb(e))return"string"===t?[]:[e.length];if(uv(e)){let t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(dv(e))return[e.buffer.size/(null==t?4:pf(t))];if(!Array.isArray(e))return[];let a=[];for(;Array.isArray(n)||zb(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&Mf().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Av(e,a,[]),a}function Av(e,t,n){if(n=n||[],!Array.isArray(e)&&!zb(e))return void Hh(0===t.length,()=>"Element arr[".concat(n.join("]["),"] is a primitive, but should be an array/TypedArray of ").concat(t[0]," elements"));Hh(t.length>0,()=>"Element arr[".concat(n.join("]["),"] should be a primitive, but is an array of ").concat(e.length," elements")),Hh(e.length===t[0],()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," elements, but has ").concat(e.length," elements"));let a=t.slice(1);for(let r=0;r<e.length;++r)Av(e[r],a,n.concat(r))}function Rv(e,t,n,a){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(a,"' must be ").concat(e," tensor, but got ").concat(t," tensor"))}}function Fv(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof Zb())return Rv(a,e.dtype,t,n),e;let r=yf(e);if("string"!==r&&["bool","int32","float32"].indexOf(a)>=0&&(r=a),Rv(a,r,t,n),null==e||!zb(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){let a=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a Tensor or TensorLike, but got '").concat(a,"'"))}let s=_v(e,r);!zb(e)&&!Array.isArray(e)&&(e=[e]);let i="string"!==r?Db(e,r):jb(e,[],!0);return wv.makeTensor(i,s,r)}function Dv(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a `Tensor[]` or `TensorLike[]`"));return e.map((e,r)=>Fv(e,"".concat(t,"[").concat(r,"]"),n,a))}Ev.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ev.registerFlag("IS_BROWSER",()=>Tv()),Ev.registerFlag("IS_NODE",()=>"undefined"!=typeof process&&"undefined"!=typeof process.versions&&"undefined"!=typeof process.versions.node),Ev.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Ev.registerFlag("IS_SAFARI",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),Ev.registerFlag("PROD",()=>!1),Ev.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ev.getBool("DEBUG")),Ev.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Ev.registerFlag("IS_TEST",()=>!1),Ev.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Ev.getBool("DEBUG")),Ev.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),Ev.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),Ev.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);var Mv="__op";function Ov(e){let t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with ".concat(t.length," keys."));let n=t[0],a=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=Mv;let r=function(){wv.startScope(n);try{let e=a(...arguments);return Af(e)&&console.error("Cannot return a Promise inside of tidy."),wv.endScope(e),e}catch(e){throw wv.endScope(null),e}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}var Pv=Ov({complex_:function(e,t){let n=Fv(e,"real","complex"),a=Fv(t,"imag","complex");Gh(n.shape,a.shape,"real and imag shapes, ".concat(n.shape," and ").concat(a.shape,", must match in call to tf.complex()."));let r={real:n,imag:a};return wv.runKernel(pm,r)}});function Lv(e,t,n,a){if(null==a)a=yf(e);else if("complex64"===a)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(dv(e)||uv(e)){if("float32"!==a&&"int32"!==a)throw new Error("Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ".concat(a,"."));return wv.backend.createTensorFromGPUData(e,t||n,a)}if(!zb(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Tf(t);let e=Kh(t),a=Kh(n);Hh(e===a,()=>"Based on the provided shape, [".concat(t,"], the tensor should have ").concat(e," values but has ").concat(a));for(let r=0;r<n.length;++r){let e=n[r],a=r!==n.length-1||e!==Kh(t.slice(r));Hh(n[r]===t[r]||!a,()=>"Error creating a new Tensor. Inferred shape (".concat(n,") does not match the provided shape (").concat(t,"). "))}}return!zb(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e="string"!==a?Db(e,a):jb(e,[],!0),wv.makeTensor(e,t,a)}function zv(e,t,n){return Lv(e,t,_v(e,n),n)}var jv={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Bv=class e{static join(t){return new e(t).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e||(e instanceof Array||(e=[e]),0===(e=e.map(e=>zb(e)?e.buffer:e)).length))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let a=e[n];n!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let r=t+a.byteLength;this.shards.push({buffer:a,start:t,end:r}),t=r}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);let n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));let a=new ArrayBuffer(t-e),r=new Uint8Array(a),s=0;for(let i=n;i<this.shards.length;i++){let n=this.shards[i],a=e+s-n.start,o=s,l=Math.min(t,n.end)-n.start,c=new Uint8Array(n.buffer,a,l-a);if(r.set(c,o),s+=c.length,t<n.end)break}return a}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;let n=function(e,t){let n=0,a=e.length;for(;n<=a;){let r=Math.floor((a-n)/2)+n,s=t(e[r]);if(0===s)return r;s<0?a=r:n=r+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}};function Wv(){Mf().set("PROD",!0)}function Vv(){Mf().set("DEBUG",!0)}function Uv(){Mf().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Hv(e){Mf().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Gv(){wv.disposeVariables()}function qv(){return wv}function Kv(){return wv.memory()}function Xv(e){return wv.profile(e)}function Yv(e,t){return wv.tidy(e,t)}function Qv(e){mv(e).forEach(e=>e.dispose())}function Jv(e){return wv.keep(e)}function Zv(e){return wv.time(e)}function $v(e){return wv.setBackend(e)}function ex(){return wv.ready()}function tx(){return wv.backendName}function nx(e){wv.removeBackend(e)}function ax(e){return wv.findBackend(e)}function rx(e){return wv.findBackendFactory(e)}function sx(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return wv.registerBackend(e,t,n)}function ix(){return wv.backend}function ox(e,t){Mf().setPlatform(e,t)}!function(e){0}(Hv);async function lx(e,t){let n=[],a=[],r=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let s=0;s<r.length;++s){let i=r[s],o=Array.isArray(e)?e[s].tensor:e[i];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw new Error("Unsupported dtype in weight '".concat(i,"': ").concat(o.dtype));let l={name:i,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){let e=new Promise(async e=>{let t=await o.bytes(),n=t.reduce((e,t)=>e+t.length,0)+4*t.length,a=new Uint8Array(n),r=0;for(let s=0;s<t.length;s++){let e=t[s],n=new Uint8Array(new Uint32Array([e.length]).buffer);a.set(n,r),r+=4,a.set(e,r),r+=e.length}e(a)});a.push(e)}else a.push(o.data());null!=t&&(l.group=t),n.push(l)}return{data:mx(await Promise.all(a)),specs:n}}function cx(e,t){let n=new Bv(e),a={},r=0;for(let s of t){let e=ux(s,(e,t)=>n.slice(r+e,r+t));a[s.name]=px(s,n.slice(r,r+e)),r+=e}return a}function ux(e,t){let n,a=Kh(e.shape);if("quantization"in e){let t=e.quantization;n=jv[t.dtype]}else{if("string"===e.dtype){let e=0;for(let n=0;n<a;n++)e+=4+new Uint32Array(t(e,e+4))[0];return e}n=jv[e.dtype]}return a*n}async function dx(e,t){let n,a=Kh(e.shape);if("quantization"in e){let t=e.quantization;n=jv[t.dtype]}else{if("string"===e.dtype){let e=0;for(let n=0;n<a;n++)e+=4+new Uint32Array(await t(e,e+4))[0];return e}n=jv[e.dtype]}return a*n}function px(e,t){let n,a=e.name,r=e.dtype,s=e.shape,i=Kh(s),o=0;if("quantization"in e){let s=e.quantization;if("uint8"===s.dtype||"uint16"===s.dtype){if(!("min"in s)||!("scale"in s))throw new Error("Weight ".concat(e.name," with quantization ").concat(s.dtype," doesn't have corresponding metadata min and scale."))}else{if("float16"!==s.dtype)throw new Error("Weight ".concat(e.name," has unknown quantization dtype ").concat(s.dtype,". Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'."));if("float32"!==r)throw new Error("Weight ".concat(e.name," is quantized with ").concat(s.dtype," which only supports weights of type float32 not ").concat(r,"."))}let l=jv[s.dtype],c="uint8"===s.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===s.dtype||"uint16"===s.dtype){n=new Float32Array(c.length);for(let e=0;e<c.length;e++){let t=c[e];n[e]=t*s.scale+s.min}}else{if("float16"!==s.dtype)throw new Error("Unsupported quantization type ".concat(s.dtype," for weight type float32."));n=function(){let e=function(){let e=e=>{let t=e<<13,n=0;for(;!(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return a=>{let r=new ArrayBuffer(4*a.length),s=new Uint32Array(r);for(let i=0;i<a.length;i++){let r=a[i],o=e[n[r>>10]+(1023&r)]+t[r>>10];s[i]=o}return new Float32Array(r)}}()(c)}else{if("int32"!==r)throw new Error("Unsupported dtype in weight '".concat(a,"': ").concat(r));if("uint8"!==s.dtype&&"uint16"!==s.dtype)throw new Error("Unsupported quantization type ".concat(s.dtype," for weight type int32."));n=new Int32Array(c.length);for(let e=0;e<c.length;e++){let t=c[e];n[e]=Math.round(t*s.scale+s.min)}}o+=i*l}else if("string"===r){let a=Kh(e.shape);n=[];for(let e=0;e<a;e++){let e=new Uint32Array(t.slice(o,o+4))[0];o+=4;let a=new Uint8Array(t.slice(o,o+e));n.push(a),o+=e}}else{let e=jv[r];if("float32"===r)n=new Float32Array(t);else if("int32"===r)n=new Int32Array(t);else{if("bool"!==r){if("complex64"===r){n=new Float32Array(t);let e=new Float32Array(n.length/2),a=new Float32Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=n[2*t],a[t]=n[2*t+1];let r=zv(e,s,"float32"),i=zv(a,s,"float32"),o=Pv(r,i);return r.dispose(),i.dispose(),o}throw new Error("Unsupported dtype in weight '".concat(a,"': ").concat(r))}n=new Uint8Array(t)}o+=i*e}return zv(n,s,r)}async function hx(e,t,n){let a=new Uint8Array(t);for(;a.byteLength<n;){let{done:t,value:r}=await e.read();if(t&&null==r){let e=n-a.byteLength;throw new Error("Reader is done but ".concat(e," bytes are still expected"))}let s=new Uint8Array(a.length+r.byteLength);s.set(a,0),s.set(new Uint8Array(r),a.length),a=s}return a.buffer}async function fx(e,t){let n={},a=e.getReader(),r=new ArrayBuffer(0);for(let s of t){let e=await dx(s,async(e,t)=>(r=await hx(a,r,t),r.slice(e,t)));r=await hx(a,r,e);let t=r.slice(0,e);r=r.slice(e);let i=px(s,t);if(n[s.name]=i,"webgpu"===tx()){let e=ix();"uploadToGPU"in e&&Kh(i.shape)>=Mf().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(i.dataId)}}return n}function mx(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0,n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))});let a=new Uint8Array(t),r=0;return n.forEach(e=>{a.set(new Uint8Array(e.buffer),r),r+=e.byteLength}),a.buffer}var gx="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function yx(e){return gx?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function bx(e){return Bv.join(e)}function vx(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);let t=e.split("/");return t[t.length-1]}function xx(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function wx(e,t,n){let a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(a.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");a.weightSpecs=t,a.weightData=n}return null!=e.signature&&(a.signature=e.signature),null!=e.userDefinedMetadata&&(a.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(a.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(a.initializerSignature=e.initializerSignature),a}async function kx(e,t){let n,a;return null!=e.weightsManifest&&([n,a]=await t(e.weightsManifest)),wx(e,n,a)}function Sx(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:yx(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:yx(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new Bv(e.weightData).byteLength}}function Nx(e){let t=[];for(let n of e)t.push(...n.weights);return t}var Ix=class e{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==e.instance&&(e.instance=new e),e.instance}static registerSaveRouter(t){e.getInstance().saveRouters.push(t)}static registerLoadRouter(t){e.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return e.getHandlers(t,"save")}static getLoadHandlers(t,n){return e.getHandlers(t,"load",n)}static getHandlers(t,n,a){let r=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(e=>{let n=e(t,a);null!==n&&r.push(n)}),r}},Cx=e=>Ix.registerSaveRouter(e),Tx=e=>Ix.registerLoadRouter(e),Ex=e=>Ix.getSaveHandlers(e),_x=(e,t)=>Ix.getLoadHandlers(e,t),Ax="tensorflowjs",Rx="models_store",Fx="model_info_store";function Dx(){if(!Mf().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Mx(e){let t=e.result;t.createObjectStore(Rx,{keyPath:"modelPath"}),t.createObjectStore(Fx,{keyPath:"modelPath"})}var Ox=class{constructor(e){if(this.indexedDB=Dx(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{let a=this.indexedDB.open(Ax,1);a.onupgradeneeded=()=>Mx(a),a.onsuccess=()=>{let r=a.result;if(null==t){let t=r.transaction(Rx,"readonly"),a=t.objectStore(Rx).get(this.modelPath);a.onsuccess=()=>{if(null==a.result)return r.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' in IndexedDB.")));e(a.result.modelArtifacts)},a.onerror=e=>(r.close(),n(a.error)),t.oncomplete=()=>r.close()}else{t.weightData=Bv.join(t.weightData);let a,i,o=Sx(t),l=r.transaction(Fx,"readwrite"),c=l.objectStore(Fx);try{a=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(s){return n(s)}a.onsuccess=()=>{i=r.transaction(Rx,"readwrite");let a,s=i.objectStore(Rx);try{a=s.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(u){return n(u)}a.onsuccess=()=>e({modelArtifactsInfo:o}),a.onerror=e=>{c=l.objectStore(Fx);let t=c.delete(this.modelPath);t.onsuccess=()=>(r.close(),n(a.error)),t.onerror=e=>(r.close(),n(a.error))}},a.onerror=e=>(r.close(),n(a.error)),l.oncomplete=()=>{null==i?r.close():i.oncomplete=()=>r.close()}}},a.onerror=e=>n(a.error)})}};Ox.URL_SCHEME="indexeddb://";var Px=e=>Mf().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ox.URL_SCHEME)?function(e){return new Ox(e)}(e.slice(Ox.URL_SCHEME.length)):null;Ix.registerSaveRouter(Px),Ix.registerLoadRouter(Px);var Lx="/",zx="tensorflowjs_models",jx="info",Bx="model_topology",Wx="weight_specs",Vx="weight_data",Ux="model_metadata";function Hx(e){return{info:[zx,e,jx].join(Lx),topology:[zx,e,Bx].join(Lx),weightSpecs:[zx,e,Wx].join(Lx),weightData:[zx,e,Vx].join(Lx),modelMetadata:[zx,e,Ux].join(Lx)}}function Gx(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function qx(e){let t=e.split(Lx);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(Lx)}var Kx=class{constructor(e){if(!Mf().getBool("IS_BROWSER")||"undefined"==typeof window||"undefined"==typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Hx(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let n=JSON.stringify(e.modelTopology),a=JSON.stringify(e.weightSpecs),r=Sx(e),s=Bv.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,a),this.LS.setItem(this.keys.weightData,function(e){if(gx)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let a=0,r=t.length;a<r;a++)n+=String.fromCharCode(t[a]);return btoa(n)}(s));let t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:r}}catch(t){throw Gx(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=").concat(r.modelTopologyBytes,", weightSpecsBytes=").concat(r.weightSpecsBytes,", weightDataBytes=").concat(r.weightDataBytes,"."))}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' is missing."));t.modelTopology=n;let a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==a)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' are missing."));t.weightSpecs=a;let r=this.LS.getItem(this.keys.modelMetadata);if(null!=r){let e=JSON.parse(r);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}let s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error("In local storage, the binary weight values of model '".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(gx){let t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let a=0;a<t.length;++a)n.set([t.charCodeAt(a)],a);return n.buffer}(s),t}};Kx.URL_SCHEME="localstorage://";var Xx=e=>Mf().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Kx.URL_SCHEME)?function(e){return new Kx(e)}(e.slice(Kx.URL_SCHEME.length)):null;Ix.registerSaveRouter(Xx),Ix.registerLoadRouter(Xx);var Yx="://",Qx=class e{constructor(){this.managers={}}static getInstance(){return null==e.instance&&(e.instance=new e),e.instance}static registerManager(t,n){Hh(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(Yx)&&(t=t.slice(0,t.indexOf(Yx))),Hh(t.length>0,()=>"scheme must not be an empty string.");let a=e.getInstance();Hh(null==a.managers[t],()=>"A model store manager is already registered for scheme '".concat(t,"'.")),a.managers[t]=n}static getManager(t){let n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}static getSchemes(){return Object.keys(e.getInstance().managers)}};function Jx(e){if(-1===e.indexOf(Yx))throw new Error("The url string provided does not contain a scheme. Supported schemes are: ".concat(Qx.getSchemes().join(",")));return{scheme:e.split(Yx)[0],path:e.split(Yx)[1]}}async function Zx(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Hh(e!==t,()=>"Old path and new path are the same: '".concat(e,"'"));let a=Ix.getLoadHandlers(e);Hh(a.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(e,".")),Hh(a.length<2,()=>"Copying failed because more than one (".concat(a.length,") load handlers for source URL ").concat(e,"."));let r=a[0],s=Ix.getSaveHandlers(t);Hh(s.length>0,()=>"Copying failed because no save handler is found for destination URL ".concat(t,".")),Hh(s.length<2,()=>"Copying failed because more than one (".concat(a.length,") save handlers for destination URL ").concat(t,"."));let i=s[0],o=Jx(e).scheme,l=Jx(e).path,c=o===Jx(e).scheme,u=await r.load();n&&c&&await Qx.getManager(o).removeModel(l);let d=await i.save(u);return n&&!c&&await Qx.getManager(o).removeModel(l),d.modelArtifactsInfo}async function $x(){let e=Qx.getSchemes(),t={};for(let n of e){let e=await Qx.getManager(n).listModels();for(let a in e){t[n+Yx+a]=e[a]}}return t}async function ew(e){let t=Jx(e);return Qx.getManager(t.scheme).removeModel(t.path)}async function tw(e,t){return Zx(e,t,!1)}async function nw(e,t){return Zx(e,t,!0)}if(Mf().get("IS_BROWSER")){Mf().setPlatform("browser",new class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!=typeof window&&Mf().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{e.source===window&&e.data.name===this.messageName&&(e.stopPropagation(),(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0))):setTimeout(e,t)}isTypedArray(e){return yb(e)}});try{Qx.registerManager(Kx.URL_SCHEME,new class{constructor(){Hh(Mf().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Hh("undefined"==typeof window||"undefined"!=typeof window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=zx+Lx,n=Lx+jx;for(let a=0;a<this.LS.length;++a){let r=this.LS.key(a);r.startsWith(t)&&r.endsWith(n)&&(e[qx(r)]=JSON.parse(this.LS.getItem(r)))}return e}async removeModel(e){let t=Hx(e=function(e){return e.startsWith(Kx.URL_SCHEME)?e.slice(Kx.URL_SCHEME.length):e}(e));if(null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '".concat(e,"'"));let n=JSON.parse(this.LS.getItem(t.info));return Gx(t),n}})}catch(tv){}try{Qx.registerManager(Ox.URL_SCHEME,new class{constructor(){this.indexedDB=Dx()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(Ax,1);n.onupgradeneeded=()=>Mx(n),n.onsuccess=()=>{let a=n.result,r=a.transaction(Fx,"readonly"),s=r.objectStore(Fx).getAll();s.onsuccess=()=>{let t={};for(let e of s.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},s.onerror=e=>(a.close(),t(s.error)),r.oncomplete=()=>a.close()},n.onerror=e=>t(n.error)})}async removeModel(e){return e=function(e){return e.startsWith(Ox.URL_SCHEME)?e.slice(Ox.URL_SCHEME.length):e}(e),new Promise((t,n)=>{let a=this.indexedDB.open(Ax,1);a.onupgradeneeded=()=>Mx(a),a.onsuccess=()=>{let r,s=a.result,i=s.transaction(Fx,"readwrite"),o=i.objectStore(Fx),l=o.get(e);l.onsuccess=()=>{if(null==l.result)return s.close(),n(new Error("Cannot find model with path '".concat(e,"' in IndexedDB.")));{let a=o.delete(e),i=()=>{r=s.transaction(Rx,"readwrite");let a=r.objectStore(Rx).delete(e);a.onsuccess=()=>t(l.result.modelArtifactsInfo),a.onerror=e=>n(l.error)};a.onsuccess=i,a.onerror=e=>(i(),s.close(),n(l.error))}},l.onerror=e=>(s.close(),n(l.error)),i.oncomplete=()=>{null==r?s.close():r.oncomplete=()=>s.close()}},a.onerror=e=>n(a.error)})}})}catch(tv){}}var aw,rw=()=>hh();function sw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",Tf(e),new Xb(e,t,n)}Mf().get("IS_NODE")&&!Mf().get("IS_BROWSER")&&Mf().setPlatform("node",new class{constructor(){this.util=fh(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=Mf().global.fetch?Mf().global.fetch(e,t):(null==aw&&(aw=rw()),aw(e,t))}now(){let e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}});var iw=Ov({cast_:function(e,t){let n=Fv(e,"x","cast");if(!uf(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");let a={x:n},r={dtype:t};return wv.runKernel(cm,a,r)}});var ow=Ov({clone_:function(e){let t={x:Fv(e,"x","clone","string_or_numeric")};return wv.runKernel(tg,t)}});function lw(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}xv(),function(e){Qb=e}({buffer:sw,cast:iw,clone:ow,print:lw});var cw=Ov({add_:function(e,t){let n=Fv(e,"a","add"),a=Fv(t,"b","add");[n,a]=pv(n,a);let r={a:n,b:a};return wv.runKernel(Vf,r)}});var uw=Ov({floorDiv_:function(e,t){let n=Fv(e,"a","floorDiv"),a=Fv(t,"b","floorDiv");[n,a]=pv(n,a);let r={a:n,b:a};return wv.runKernel(Ym,r)}});var dw=Ov({div_:function(e,t){let n=Fv(e,"a","div"),a=Fv(t,"b","div");if([n,a]=pv(n,a),"int32"===n.dtype&&"int32"===a.dtype)return uw(n,a);let r={a:n,b:a};return wv.runKernel(Pm,r,{})}});var pw=Ov({mul_:function(e,t){let n=Fv(e,"a","mul"),a=Fv(t,"b","mul");[n,a]=pv(n,a);let r={a:n,b:a};return wv.runKernel(Og,r)}});var hw=Ov({abs_:function(e){let t=Fv(e,"x","abs");if("complex64"===t.dtype){let e={x:t};return wv.runKernel(hm,e)}{let e={x:t};return wv.runKernel(jf,e)}}});var fw=Ov({acos_:function(e){let t={x:Fv(e,"x","acos")};return wv.runKernel(Bf,t)}});var mw=Ov({acosh_:function(e){let t={x:Fv(e,"x","acosh")};return wv.runKernel(Wf,t)}});var gw=Ov({addN_:function(e){Hh(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),Hh(e.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got ".concat(e.length));let t=e.map((e,t)=>Fv(e,"tensors".concat(t),"addN")),n=t[0];t.forEach(e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(e=>{if(!Qh(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let a=t;return wv.runKernel(Uf,a)}});var yw=Ov({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Fv(e,"x","all","bool")},r={axis:t,keepDims:n};return wv.runKernel(Hf,a,r)}});var bw=Ov({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Fv(e,"x","any","bool")},r={axis:t,keepDims:n};return wv.runKernel(Gf,a,r)}});var vw=Ov({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Fv(e,"x","argMax")},a={axis:t};return wv.runKernel(qf,n,a)}});var xw=Ov({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Fv(e,"x","argMin")},a={axis:t};return wv.runKernel(Kf,n,a)}});var ww=Ov({asin_:function(e){let t={x:Fv(e,"x","asin")};return wv.runKernel(Xf,t)}});var kw=Ov({asinh_:function(e){let t={x:Fv(e,"x","asinh")};return wv.runKernel(Yf,t)}});var Sw=Ov({atan_:function(e){let t={x:Fv(e,"x","atan")};return wv.runKernel(Qf,t)}});var Nw=Ov({atan2_:function(e,t){let n=Fv(e,"a","atan2"),a=Fv(t,"b","atan2");[n,a]=pv(n,a);let r={a:n,b:a};return wv.runKernel(Zf,r)}});var Iw=Ov({atanh_:function(e){let t={x:Fv(e,"x","atanh")};return wv.runKernel(Jf,t)}});function Cw(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5?arguments[5]:void 0;return _w(e,[...t,e[3]],n,s,a,null,null,jw(r))}function Tw(e,t,n,a,r,s){let i,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",[l,c]=Fw(t);if("channelsLast"===o)i=[l,c,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));i=[l,c,e[1],e[1]]}return _w(e,i,n,a,r,s,!1,o)}function Ew(e,t,n,a,r,s){let i,o,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",[c,u,d]=Dw(t);if("NDHWC"===l)o="channelsLast",i=[c,u,d,e[4],e[4]];else{if("NCDHW"!==l)throw new Error("Unknown dataFormat ".concat(l));o="channelsFirst",i=[c,u,d,e[1],e[1]]}return Aw(e,i,n,a,r,!1,o,s)}function _w(e,t,n,a,r,s){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[l,c,u,d]=[-1,-1,-1,-1];if("channelsLast"===o)[l,c,u,d]=e;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[l,d,c,u]=e}let p,[h,f,,m]=t,[g,y]=Fw(n),[b,v]=Fw(a),x=Mw(h,b),w=Mw(f,v),{padInfo:k,outHeight:S,outWidth:N}=function(e,t,n,a,r,s,i,o,l){let c,u,d;if("number"==typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};let r=function(e,t,n,a,r){null==a&&(a=Rw(e,t,n));let s=e[0],i=e[1],o=Ow((s-t+2*a)/n+1,r),l=Ow((i-t+2*a)/n+1,r);return[o,l]}([t,n],s,a,e,o);u=r[0],d=r[1]}else if("same"===e){u=Math.ceil(t/a),d=Math.ceil(n/r);let e=Math.max(0,(u-1)*a+s-t),o=Math.max(0,(d-1)*r+i-n),l=Math.floor(e/2),p=e-l,h=Math.floor(o/2);c={top:l,bottom:p,left:h,right:o-h,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-s+1)/a),d=Math.ceil((n-i+1)/r);else{if("object"!=typeof e)throw Error("Unknown padding parameter: ".concat(e));{let p="channelsLast"===l?e[1][0]:e[2][0],h="channelsLast"===l?e[1][1]:e[2][1],f="channelsLast"===l?e[2][0]:e[3][0],m="channelsLast"===l?e[2][1]:e[3][1];c={top:p,bottom:h,left:f,right:m,type:0===p&&0===h&&0===f&&0===m?"VALID":"EXPLICIT"},u=Ow((t-s+p+h)/a+1,o),d=Ow((n-i+f+m)/r+1,o)}}return{padInfo:c,outHeight:u,outWidth:d}}(r,c,u,g,y,x,w,s,o),I=i?m*d:m;return"channelsFirst"===o?p=[l,I,S,N]:"channelsLast"===o&&(p=[l,S,N,I]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:d,outHeight:S,outWidth:N,outChannels:I,padInfo:k,strideHeight:g,strideWidth:y,filterHeight:h,filterWidth:f,effectiveFilterHeight:x,effectiveFilterWidth:w,dilationHeight:b,dilationWidth:v,inShape:e,outShape:p,filterShape:t}}function Aw(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",o=arguments.length>7?arguments[7]:void 0,[l,c,u,d,p]=[-1,-1,-1,-1,-1];if("channelsLast"===i)[l,c,u,d,p]=e;else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));[l,p,c,u,d]=e}let h,[f,m,g,,y]=t,[b,v,x]=Dw(n),[w,k,S]=Dw(a),N=Mw(f,w),I=Mw(m,k),C=Mw(g,S),{padInfo:T,outDepth:E,outHeight:_,outWidth:A}=function(e,t,n,a,r,s,i,o,l,c,u){let d,p,h,f;if("valid"===e&&(e=0),"number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};let m=function(e,t,n,a,r,s){null==r&&(r=Rw(e,t[0],a[0]));let i=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*r>=t[o]&&(i[o]=Ow((e[o]-t[o]+2*r)/a[o]+1,s));return i}([t,n,a,1],[o,l,c],1,[r,s,i],e,u);p=m[0],h=m[1],f=m[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));{p=Math.ceil(t/r),h=Math.ceil(n/s),f=Math.ceil(a/i);let e=(p-1)*r+o-t,u=(h-1)*s+l-n,m=(f-1)*i+c-a,g=Math.floor(e/2),y=e-g,b=Math.floor(u/2),v=u-b,x=Math.floor(m/2);d={top:b,bottom:v,left:x,right:m-x,front:g,back:y,type:"SAME"}}}return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}}(r,c,u,d,b,v,x,N,I,C,o),R=s?y*p:y;return"channelsFirst"===i?h=[l,R,E,_,A]:"channelsLast"===i&&(h=[l,E,_,A,R]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:d,inChannels:p,outDepth:E,outHeight:_,outWidth:A,outChannels:R,padInfo:T,strideDepth:b,strideHeight:v,strideWidth:x,filterDepth:f,filterHeight:m,filterWidth:g,effectiveFilterDepth:N,effectiveFilterHeight:I,effectiveFilterWidth:C,dilationDepth:w,dilationHeight:k,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function Rw(e,t,n){let a=Mw(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+a)/2)}function Fw(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Dw(e){return"number"==typeof e?[e,e,e]:e}function Mw(e,t){return t<=1?e:e+(e-1)*(t-1)}function Ow(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function Pw(e){let[t,n,a]=Fw(e);return 1===t&&1===n&&1===a}function Lw(e,t){return Pw(e)||Pw(t)}function zw(e){return Fw(e).every(e=>e>0)}function jw(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function Bw(e,t,n){if(null!=n){if("string"==typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."));if("number"==typeof t)Hh(Jh(t),()=>"Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."));else{if("object"!=typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach(t=>{t.forEach(t=>{Hh(Jh(t),()=>"Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."))})})}}}var Ww=Ov({reshape_:function(e,t){let n={x:Fv(e,"x","reshape","string_or_numeric")},a={shape:t};return wv.runKernel(ny,n,a)}});var Vw=Ov({avgPool_:function(e,t,n,a,r){let s=Fv(e,"x","avgPool","float32");Hh(Lw(n,1),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(1,"'"));let i=s,o=!1;3===s.rank&&(o=!0,i=Ww(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Hh(4===i.rank,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(i.rank,".")),Bw("avgPool",a,r);let l={x:i},c={filterSize:t,strides:n,pad:a,dimRoundingMode:r},u=wv.runKernel($f,l,c);return u=iw(u,s.dtype),o?Ww(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});var Uw=Ov({avgPool3d_:function(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",i=Fv(e,"x","avgPool3d","float32"),o=i,l=!1;4===i.rank&&(l=!0,o=Ww(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Hh(5===o.rank,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),Hh("NDHWC"===s,()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ".concat(s)),Hh("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")),Bw("avgPool3d",a,r);let c={x:o},u={filterSize:t,strides:n,pad:a,dimRoundingMode:r,dataFormat:s},d=wv.runKernel(tm,c,u);return d=iw(d,o.dtype),l?Ww(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var Hw=Ov({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Hh(e.length>=1,()=>"Pass at least one tensor to concat");let n=Dv(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}),1===n.length)return ow(n[0]);let a=n,r={axis:t};return wv.runKernel(fm,a,r)}});var Gw=Ov({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Fv(e,"a","matMul"),s=Fv(t,"b","matMul");[r,s]=pv(r,s);let i={a:r,b:s},o={transposeA:n,transposeB:a};return wv.runKernel(am,i,o)}});var qw=Ov({sigmoid_:function(e){let t={x:Fv(e,"x","sigmoid","float32")};return wv.runKernel(xy,t)}});var Kw=Ov({slice_:function(e,t,n){let a=Fv(e,"x","slice","string_or_numeric");if(0===a.rank)throw new Error("Slicing scalar is not possible");let r={x:a},s={begin:t,size:n};return wv.runKernel(gy,r,s)}});var Xw=Ov({tanh_:function(e){let t={x:Fv(e,"x","tanh","float32")};return wv.runKernel(Wy,t)}});var Yw=Ov({basicLSTMCell_:function(e,t,n,a,r,s){let i=Fv(e,"forgetBias","basicLSTMCell"),o=Fv(t,"lstmKernel","basicLSTMCell"),l=Fv(n,"lstmBias","basicLSTMCell"),c=Fv(a,"data","basicLSTMCell"),u=Fv(r,"c","basicLSTMCell"),d=Fv(s,"h","basicLSTMCell"),p=Hw([c,d],1),h=Gw(p,o),f=cw(h,l),m=f.shape[0],g=f.shape[1]/4,y=[m,g],b=Kw(f,[0,0],y),v=Kw(f,[0,g],y),x=Kw(f,[0,2*g],y),w=Kw(f,[0,3*g],y),k=cw(pw(qw(b),Xw(v)),pw(u,qw(cw(i,x))));return[k,pw(Xw(k),qw(w))]}});var Qw=Ov({batchToSpaceND_:function(e,t,n){let a=Fv(e,"x","batchToSpaceND"),r=t.reduce((e,t)=>e*t);Hh(a.rank>=1+t.length,()=>"input rank is ".concat(a.rank," but should be > than blockShape.length ").concat(t.length)),Hh(n.length===t.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)),Hh(a.shape[0]%r===0,()=>"input tensor batch is ".concat(a.shape[0]," but is not divisible by the product of the elements of blockShape ").concat(t.join(" * ")," === ").concat(r));let s={x:a},i={blockShape:t,crops:n};return wv.runKernel(rm,s,i)}});function Jw(e){let t;return t=0===e.rank||1===e.rank?Ww(e,[1,1,1,e.size]):2===e.rank?Ww(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Ww(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}var Zw=Ov({batchNorm_:function(e,t,n,a,r,s){null==s&&(s=.001);let i,o,l=Fv(e,"x","batchNorm"),c=Fv(t,"mean","batchNorm"),u=Fv(n,"variance","batchNorm");null!=r&&(i=Fv(r,"scale","batchNorm")),null!=a&&(o=Fv(a,"offset","batchNorm")),Hh(c.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Hh(null==o||c.rank===o.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Hh(null==i||c.rank===i.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:Jw(l),scale:i,offset:o,mean:c,variance:u},p={varianceEpsilon:s},h=wv.runKernel(Qm,d,p);return Ww(h,l.shape)}});var $w=Ov({batchNorm2d_:function(e,t,n,a,r,s){let i,o,l=Fv(e,"x","batchNorm"),c=Fv(t,"mean","batchNorm"),u=Fv(n,"variance","batchNorm");return null!=r&&(i=Fv(r,"scale","batchNorm")),null!=a&&(o=Fv(a,"offset","batchNorm")),Hh(2===l.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank ".concat(l.rank,".")),Hh(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ".concat(c.rank,".")),Hh(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ".concat(u.rank,".")),null!=i&&Hh(2===i.rank||1===i.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ".concat(i.rank,".")),null!=o&&Hh(2===o.rank||1===o.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ".concat(o.rank,".")),Zw(l,c,u,o,i,s)}});var ek=Ov({batchNorm3d_:function(e,t,n,a,r,s){let i,o,l=Fv(e,"x","batchNorm"),c=Fv(t,"mean","batchNorm"),u=Fv(n,"variance","batchNorm");return null!=r&&(i=Fv(r,"scale","batchNorm")),null!=a&&(o=Fv(a,"offset","batchNorm")),Hh(3===l.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank ".concat(l.rank,".")),Hh(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ".concat(c.rank,".")),Hh(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ".concat(u.rank,".")),null!=i&&Hh(3===i.rank||1===i.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ".concat(i.rank,".")),null!=o&&Hh(3===o.rank||1===o.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ".concat(o.rank,".")),Zw(l,c,u,o,i,s)}});var tk=Ov({batchNorm4d_:function(e,t,n,a,r,s){let i,o,l=Fv(e,"x","batchNorm"),c=Fv(t,"mean","batchNorm"),u=Fv(n,"variance","batchNorm");return null!=r&&(i=Fv(r,"scale","batchNorm")),null!=a&&(o=Fv(a,"offset","batchNorm")),Hh(4===l.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank ".concat(l.rank,".")),Hh(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ".concat(c.rank,".")),Hh(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ".concat(u.rank,".")),null!=i&&Hh(4===i.rank||1===i.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ".concat(i.rank,".")),null!=o&&Hh(4===o.rank||1===o.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ".concat(o.rank,".")),Zw(l,c,u,o,i,s)}});var nk=Ov({bincount_:function(e,t,n){let a=Fv(e,"x","bincount"),r=Fv(t,"weights","bincount");Hh("int32"===a.dtype,()=>"Error in bincount: input dtype must be int32, but got ".concat(a.dtype)),Hh(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),Hh(r.size===a.size||0===r.size,()=>"Error in bincount: weights must have the same size as input or0-length, but got input shape: ".concat(a.shape,", weights shape: ").concat(r.shape,"."));let s={x:a,weights:r},i={size:n};return wv.runKernel(sm,s,i)}});var ak=Ov({bitwiseAnd_:function(e,t){let n=Fv(e,"x","bitwiseAnd"),a=Fv(t,"y","bitwiseAnd");if(!Qh(n.shape,a.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(a.shape));if("int32"!==n.dtype||"int32"!==a.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(a.dtype));let r={a:n,b:a};return wv.runKernel(im,r)}});var rk=Ov({broadcastArgs_:function(e,t){let n=Fv(e,"s0","broadcastArgs","int32"),a=Fv(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). Has rank ".concat(n.rank));if(1!==a.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). Has rank ".concat(a.rank));let r={s0:n,s1:a};return wv.runKernel(lm,r)}});var sk=Ov({broadcastTo_:function(e,t){let n=Fv(e,"broadcastTo","x"),a=n.shape;if(Tf(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){let e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=Ww(n,e)}let r=n.shape,s=Array.from(t);for(let l=t.length-1;l>=0;l--)if(r[l]===t[l])s[l]=1;else if(1!==n.shape[l])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(t,"]."));if(0===s.map((e,t)=>e>1?t:-1).filter(e=>e>=0).length)return ow(n);let i={x:n},o={reps:s};return wv.runKernel(Vy,i,o)}});var ik=Ov({ceil_:function(e){let t={x:Fv(e,"x","ceil","float32")};return wv.runKernel(um,t)}});function ok(e,t,n){Tf(e);let a={shape:e,value:t,dtype:n=n||yf(t)};return wv.runKernel(qm,{},a)}var lk=Ov({clipByValue_:function(e,t,n){let a=Fv(e,"x","clipByValue");if(Hh(t<=n,()=>"Error in clip: min (".concat(t,") must be less than or equal to max (").concat(n,").")),t===n)return ok(a.shape,t,a.dtype);let r={x:a},s={clipValueMin:t,clipValueMax:n};return wv.runKernel(dm,r,s)}});var ck=Ov({concat1d_:function(e){return Hw(e,0)}});var uk=Ov({concat2d_:function(e,t){return Hw(e,t)}});var dk=Ov({concat3d_:function(e,t){return Hw(e,t)}});var pk=Ov({concat4d_:function(e,t){return Hw(e,t)}});var hk=Ov({conv2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=Fv(e,"x","conv2d","float32"),l=Fv(t,"filter","conv2d","float32"),c=o,u=!1;3===o.rank&&(u=!0,c=Ww(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Hh(4===c.rank,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")),Hh(4===l.rank,()=>"Error in conv2d: filter must be rank 4, but got rank ".concat(l.rank,".")),Bw("conv2d",a,i);let d="NHWC"===r?c.shape[3]:c.shape[1];Hh(d===l.shape[2],()=>"Error in conv2d: depth of input (".concat(d,") must match input depth for filter ").concat(l.shape[2],".")),Hh(Lw(n,s),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(s,"'")),Hh(zw(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),Hh(zw(n),()=>"Error in conv2D: Strides should be larger than 0.");let p={x:c,filter:l},h={strides:n,pad:a,dataFormat:r,dilations:s,dimRoundingMode:i},f=wv.runKernel(mm,p,h);return u?Ww(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var fk=Ov({conv1d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6?arguments[6]:void 0,o=Fv(e,"x","conv1d"),l=Fv(t,"filter","conv1d"),c=o,u=!1;2===o.rank&&(u=!0,c=Ww(o,[1,o.shape[0],o.shape[1]])),Hh(3===c.rank,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")),Hh(3===l.rank,()=>"Error in conv1d: filter must be rank 3, but got rank ".concat(l.rank,".")),Bw("conv1d",a,i),Hh(c.shape[2]===l.shape[1],()=>"Error in conv1d: depth of input (".concat(c.shape[2],") must match input depth for filter ").concat(l.shape[1],".")),Hh(Lw(n,s),()=>"Error in conv1D: Either stride or dilation must be 1. Got stride ".concat(n," and dilation '").concat(s,"'")),Hh(zw(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),Hh(zw(n),()=>"Error in conv1D: Stride should be larger than 0."),Hh("NWC"===r,()=>"Error in conv1d: got dataFormat of ".concat(r," but only NWC is currently supported."));let d=Ww(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=Ww(c,[c.shape[0],1,c.shape[1],c.shape[2]]),h=hk(p,d,[1,n],a,"NHWC",[1,s],i);return Ww(h,u?[h.shape[2],h.shape[3]]:[h.shape[0],h.shape[2],h.shape[3]])}});var mk=Ov({conv2DBackpropInput_:function(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0;Hh(e.length===t.rank,()=>"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let o=e,l=t,c=!1;3===t.rank&&(c=!0,l=Ww(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),Hh(4===o.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length ".concat(o.length,".")),Hh(4===l.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank ".concat(l.rank)),Hh(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank ".concat(n.rank));let u="NHWC"===s?o[3]:o[1],d="NHWC"===s?l.shape[3]:l.shape[1];Hh(u===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(u,") must match input depth for filter ").concat(n.shape[2],".")),Hh(d===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(d,") must match output depth for filter ").concat(n.shape[3],".")),Bw("conv2dDerInput",r,i);let p={dy:l,filter:n},h={strides:a,pad:r,dataFormat:s,dimRoundingMode:i,inputShape:o},f=wv.runKernel(ym,p,h);return c?Ww(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var gk=Ov({conv2dTranspose_:function(e,t,n,a,r,s){let i=Fv(e,"x","conv2dTranspose"),o=Fv(t,"filter","conv2dTranspose");return mk(n,i,o,a,r,"NHWC",s)}});var yk=Ov({conv3d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],i=Fv(e,"x","conv3d"),o=Fv(t,"filter","conv3d"),l=i,c=!1;4===i.rank&&(c=!0,l=Ww(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Hh(5===l.rank,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(l.rank,".")),Hh(5===o.rank,()=>"Error in conv3d: filter must be rank 5, but got rank ".concat(o.rank,".")),Hh(l.shape[4]===o.shape[3],()=>"Error in conv3d: depth of input (".concat(l.shape[4],") must match input depth for filter ").concat(o.shape[3],".")),Hh(Lw(n,s),()=>"Error in conv3D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(s,"'")),Hh("NDHWC"===r,()=>"Error in conv3d: got dataFormat of ".concat(r," but only NDHWC is currently supported.")),Hh(zw(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),Hh(zw(n),()=>"Error in conv3D: Strides should be larger than 0.");let u={x:l,filter:o},d={strides:n,pad:a,dataFormat:r,dilations:s},p=wv.runKernel(bm,u,d);return c?Ww(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});var bk=Ov({conv3DBackpropInput_:function(e,t,n,a,r){Hh(e.length===t.rank,()=>"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let s=e,i=t,o=!1;4===t.rank&&(o=!0,i=Ww(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);let l=s[4],c=i.shape[4];Hh(5===s.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length ".concat(s.length,".")),Hh(5===i.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank ".concat(i.rank)),Hh(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank ".concat(n.rank)),Hh(l===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(l,") must match input depth for filter ").concat(n.shape[3],".")),Hh(c===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(c,") must match output depth for filter ").concat(n.shape[4],"."));let u={dy:i,filter:n},d={pad:r,strides:a,inputShape:s},p=wv.runKernel(xm,u,d);return o?Ww(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});var vk=Ov({conv3dTranspose_:function(e,t,n,a,r){let s=Fv(e,"x","conv3dTranspose"),i=Fv(t,"filter","conv3dTranspose");return bk(n,s,i,a,r)}});var xk=Ov({cos_:function(e){let t={x:Fv(e,"x","cos","float32")};return wv.runKernel(wm,t)}});var wk=Ov({cosh_:function(e){let t={x:Fv(e,"x","cosh","float32")};return wv.runKernel(km,t)}});var kk=Ov({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={x:Fv(e,"x","cumprod")},s={axis:t,exclusive:n,reverse:a};return wv.runKernel(Sm,r,s)}});var Sk=Ov({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={x:Fv(e,"x","cumsum")},s={axis:t,exclusive:n,reverse:a};return wv.runKernel(Nm,r,s)}});var Nk=Ov({denseBincount_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Fv(e,"x","denseBincount"),s=Fv(t,"weights","denseBincount");Hh("int32"===r.dtype,()=>"Error in denseBincount: input dtype must be int32, but got ".concat(r.dtype)),Hh(r.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got rank ".concat(r.rank,".")),Hh(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),Hh(s.size===r.size||0===s.size,()=>"Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ".concat(r.shape,", weights shape: ").concat(s.shape,"."));let i={x:r,weights:s},o={size:n,binaryOutput:a};return wv.runKernel(Cm,i,o)}});var Ik=Ov({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",a=Fv(e,"x","depthToSpace","float32"),r="NHWC"===n?a.shape[1]:a.shape[2],s="NHWC"===n?a.shape[2]:a.shape[3],i="NHWC"===n?a.shape[3]:a.shape[1];Hh(t>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t)),Hh(r*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(r," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(a.shape)),Hh(s*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(t," for depthToSpace with input shape\n        ").concat(a.shape)),Hh(i%(t*t)===0,()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(i," for depthToSpace with input shape ").concat(a.shape));let o={x:a},l={blockSize:t,dataFormat:n};return wv.runKernel(Tm,o,l)}});var Ck=Ov({depthwiseConv2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=Fv(e,"x","depthwiseConv2d","float32"),l=Fv(t,"filter","depthwiseConv2d","float32"),c=o,u=!1;3===o.rank&&(u=!0,c=Ww(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Hh(4===c.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got rank ".concat(c.rank,".")),Hh(4===l.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank ".concat(l.rank,"."));let d="NHWC"===r?c.shape[3]:c.shape[1];Hh(d===l.shape[2],()=>"Error in depthwiseConv2d: number of input channels (".concat(d,") must match the inChannels dimension in filter ").concat(l.shape[2],".")),Bw("depthwiseConv2d",a,i);let p={x:c,filter:l},h={strides:n,pad:a,dataFormat:r,dilations:s,dimRoundingMode:i},f=wv.runKernel(Em,p,h);return u?Ww(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var Tk=Ov({diag_:function(e){let t={x:Fv(e,"x","diag")};return wv.runKernel(Rm,t)}});var Ek=Ov({dilation2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=Fv(e,"x","dilation2d"),o=Fv(t,"filter","dilation2d");Hh(3===i.rank||4===i.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank ".concat(i.rank,".")),Hh(3===o.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank ".concat(o.rank,".")),Hh("NHWC"===s,()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ".concat(s));let l=i,c=!1;3===i.rank&&(l=Ww(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),Hh(l.shape[3]===o.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(l.shape[3]," vs ").concat(o.shape[2]));let u={x:l,filter:o},d={strides:n,pad:a,dilations:r},p=wv.runKernel(Fm,u,d);return c?Ww(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),_k={};function Ak(e,t){let n=e.length,a=[];for(let r=0;r<n;r++){let s=n-1-r,i=e[s]||1;(t[t.length-1-r]||1)>1&&1===i&&a.unshift(s)}return a}function Rk(e,t){let n=[];for(let a=0;a<t.length;a++){let r=e[e.length-a-1],s=t.length-a-1,i=t[s];(null==r||1===r&&i>1)&&n.unshift(s)}return n}function Fk(e,t){let n=Math.max(e.length,t.length),a=new Array(n);for(let r=0;r<n;r++){let s=e[e.length-r-1];null==s&&(s=1);let i=t[t.length-r-1];if(null==i&&(i=1),1===s)a[n-r-1]=i;else if(1===i)a[n-r-1]=s;else{if(s!==i){let n="Operands could not be broadcast together with shapes ".concat(e," and ").concat(t,".");throw Error(n)}a[n-r-1]=s}}return a}uh(_k,{assertAndGetBroadcastShape:()=>Fk,getBroadcastDims:()=>Ak,getReductionAxes:()=>Rk});var Dk=Ov({equal_:function(e,t){let n=Fv(e,"a","equal","string_or_numeric"),a=Fv(t,"b","equal","string_or_numeric");[n,a]=pv(n,a),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(Wm,r)}});var Mk=Ov({where_:function(e,t,n){let a=Fv(t,"a","where"),r=Fv(n,"b","where"),s=Fv(e,"condition","where","bool"),i=Fk(Fk(s.shape,a.shape),r.shape),o={condition:sk(s,i),t:sk(a,i),e:sk(r,i)};return wv.runKernel(fy,o)}});var Ok=Ov({zerosLike_:function(e){let t={x:Fv(e,"x","zerosLike")};return wv.runKernel(Qy,t)}});var Pk=Ov({divNoNan_:function(e,t){let n=Fv(e,"a","div"),a=Fv(t,"b","div");[n,a]=pv(n,a);let r=dw(n,a),s=Ok(r),i=Dk(a,s);return Mk(i,s,r)}});var Lk=Ov({dot_:function(e,t){let n=Fv(e,"t1","dot"),a=Fv(t,"t2","dot");Hh((1===n.rank||2===n.rank)&&(1===a.rank||2===a.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks ".concat(n.rank," and ").concat(a.rank,"."));let r=1===n.rank?n.size:n.shape[1],s=1===a.rank?a.size:a.shape[0];if(Hh(r===s,()=>"Error in dot: inner dimensions of inputs must match, but got ".concat(r," and ").concat(s,".")),1===n.rank&&1===a.rank){let e=Ww(n,[1,-1]),t=Ww(a,[-1,1]),r=Gw(e,t);return Ww(r,[])}if(1===n.rank&&2===a.rank){let e=Ww(n,[1,-1]),t=Ww(a,[a.shape[0],a.shape[1]]),r=Gw(e,t);return Ww(r,[r.size])}if(2===n.rank&&1===a.rank){let e=Ww(a,[-1,1]),t=Gw(n,e);return Ww(t,[t.size])}{let e=Ww(a,[a.shape[0],a.shape[1]]);return Gw(n,e)}}});var zk=Ov({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];let r=n.map((e,t)=>Fv(e,"tensors".concat(t),"einsum")),s={equation:e};return wv.runKernel(Lm,r,s)}});var jk=Ov({elu_:function(e){let t={x:Fv(e,"x","elu","float32")};return wv.runKernel(zm,t)}});var Bk=Ov({ensureShape_:function(e,t){let n=Fv(e,"x","ensureShape","string_or_numeric");if(!Yh(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}});var Wk=Ov({erf_:function(e){let t=Fv(e,"x","erf");Hh("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=iw(t,"float32"));let n={x:t};return wv.runKernel(Bm,n)}});function Vk(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Uk(e,t,n){let a=e.length+t.length,r=[],s=0,i=0;for(let o=0;o<a;o++)-1===n.indexOf(o)?r.push(e[s++]):r.push(t[i++]);return r}function Hk(e,t){let n=[],a=e.length;for(let r=0;r<a;r++)-1===t.indexOf(r)&&n.push(e[r]);return[n,t.map(t=>e[t])]}function Gk(e,t){return Uk(e,t.map(e=>1),t)}function qk(e,t,n){Hh(Vk(t,n),()=>"".concat(e," supports only inner-most axes for now. Got axes ").concat(t," and rank-").concat(n," input."))}function Kk(e,t){if(Vk(e,t))return null;let n=[];for(let a=0;a<t;++a)-1===e.indexOf(a)&&n.push(a);return e.forEach(e=>n.push(e)),n}function Xk(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Yk(e,t){let n=[];for(let a=t-e;a<t;++a)n.push(a);return n}var Qk=Ov({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Fv(e,"x","max")},r={reductionIndices:t,keepDims:n};return wv.runKernel(kg,a,r)}});var Jk=Ov({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Fv(e,"x","min")},r={axis:t,keepDims:n};return wv.runKernel(Ag,a,r)}});var Zk=Ov({pow_:function(e,t){let n=Fv(e,"base","pow"),a=Fv(t,"exp","pow");[n,a]=pv(n,a);let r={a:n,b:a};return wv.runKernel(qg,r)}});function $k(e,t){if((zb(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&zb(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Lv(e,[],[],t)}var eS=Ov({sqrt_:function(e){let t={x:Fv(e,"x","sqrt","float32")};return wv.runKernel(ky,t)}});var tS=Ov({square_:function(e){let t=Fv(e,"x","square");return wv.runKernel("Square",{x:t},{})}});var nS=Ov({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Fv(e,"x","sum");"bool"===a.dtype&&(a=iw(a,"int32"));let r={x:a},s={axis:t,keepDims:n};return wv.runKernel(Sy,r,s)}});function aS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return hw(e);if(1!==e.rank&&null===n)return aS(Ww(e,[-1]),t,n);if(1===e.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===t)return nS(hw(e),n);if(t===1/0)return Qk(hw(e),n);if(t===-1/0)return Jk(hw(e),n);if("euclidean"===t||2===t)return eS(nS(Zk(hw(e),$k(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return Qk(nS(hw(e),n[0]),n[1]-1);if(t===1/0)return Qk(nS(hw(e),n[1]),n[0]);if(t===-1/0)return Jk(nS(hw(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return eS(nS(tS(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var rS=Ov({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aS(e=Fv(e,"x","norm"),t,n),s=r.shape;if(a){let t=rf(n,e.shape);s=Gk(r.shape,t)}return Ww(r,s)}});var sS=Ov({euclideanNorm_:function(e){return rS(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});var iS=Ov({exp_:function(e){let t={x:Fv(e,"x","exp")};return wv.runKernel(Vm,t)}});var oS=Ov({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Fv(e,"x","expandDims","string_or_numeric");Hh(t<=n.rank,()=>"Axis must be <= rank of the tensor");let a={input:n},r={dim:t};return wv.runKernel(Um,a,r)}});var lS=Ov({expm1_:function(e){let t={x:Fv(e,"x","expm1")};return wv.runKernel(Hm,t)}});var cS=Ov({tile_:function(e,t){let n=Fv(e,"x","tile","string_or_numeric");Hh(n.rank===t.length,()=>"Error in transpose: rank of input ".concat(n.rank," must match length of reps ").concat(t,"."));let a={x:n},r={reps:t};return wv.runKernel(Vy,a,r)}});var uS=Ov({eye_:function(e,t,n){null==t&&(t=e);let a=sw([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),r=e<=t?e:t;for(let i=0;i<r;++i)a.set(1,i,i);let s=Ww(a.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return cS(oS(s,0),[n[0],1,1]);if(2===n.length)return cS(oS(oS(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return cS(oS(oS(oS(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received ".concat(n.length,"D."))}});var dS=Ov({floor_:function(e){let t={x:Fv(e,"x","floor","float32")};return wv.runKernel(Xm,t)}});var pS=Ov({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r={x:Fv(e,"x","gather"),indices:Fv(t,"indices","gather","int32")},s={axis:n,batchDims:a};return wv.runKernel(Jm,r,s)}});var hS=Ov({greater_:function(e,t){let n=Fv(e,"a","greater","string_or_numeric"),a=Fv(t,"b","greater","string_or_numeric");[n,a]=pv(n,a),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel($m,r)}});var fS=Ov({greaterEqual_:function(e,t){let n=Fv(e,"a","greaterEqual","string_or_numeric"),a=Fv(t,"b","greaterEqual","string_or_numeric");[n,a]=pv(n,a),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(eg,r)}});var mS=Ov({imag_:function(e){let t={input:Fv(e,"input","imag")};return wv.runKernel(ag,t)}});var gS=Ov({isFinite_:function(e){let t={x:Fv(e,"x","isFinite")};return wv.runKernel(rg,t)}});var yS=Ov({isInf_:function(e){let t={x:Fv(e,"x","isInf")};return wv.runKernel(sg,t)}});var bS=Ov({isNaN_:function(e){let t={x:Fv(e,"x","isNaN")};return wv.runKernel(ig,t)}});var vS=Ov({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n={x:Fv(e,"x","leakyRelu")},a={alpha:t};return wv.runKernel(og,n,a)}});var xS=Ov({less_:function(e,t){let n=Fv(e,"a","less","string_or_numeric"),a=Fv(t,"b","less","string_or_numeric");[n,a]=pv(n,a),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(lg,r)}});var wS=Ov({lessEqual_:function(e,t){let n=Fv(e,"a","lessEqual","string_or_numeric"),a=Fv(t,"b","lessEqual","string_or_numeric");[n,a]=pv(n,a),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(cg,r)}});function kS(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let a={start:e,stop:t,num:n};return wv.runKernel(ug,{},a)}var SS=Ov({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=Fv(e,"x","localResponseNormalization");Hh(4===s.rank||3===s.rank,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(s.rank,".")),Hh(Jh(t),()=>"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ".concat(t,"."));let i=s,o=!1;3===s.rank&&(o=!0,i=Ww(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let l={x:i},c={depthRadius:t,bias:n,alpha:a,beta:r},u=wv.runKernel(vg,l,c);return o?Ww(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});var NS=Ov({log_:function(e){let t={x:Fv(e,"x","log","float32")};return wv.runKernel(dg,t)}});var IS=Ov({log1p_:function(e){let t={x:Fv(e,"x","log1p")};return wv.runKernel(pg,t)}});function CS(e){return Hh(bf(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let a=Fv(t,"x","tf.grad","string_or_numeric"),r=null!=n?Fv(n,"dy","tf.grad"):null;return wv.tidy(()=>{let{value:t,grads:n}=wv.gradients(()=>e(a),[a],r);return null!=r&&Gh(t.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),FS(n),n[0]})}}function TS(e){return Hh(bf(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{Hh(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let a=Dv(t,"args","tf.grads","string_or_numeric"),r=null!=n?Fv(n,"dy","tf.grads"):null;return wv.tidy(()=>{let{value:t,grads:n}=wv.gradients(()=>e(...a),a,r);return null!=r&&Gh(t.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),FS(n),n})}}function ES(e){return Hh(bf(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{Hh(t instanceof Jb,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),Hh(null==n||n instanceof Jb,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:a,value:r}=wv.gradients(()=>e(t),[t],n);return FS(a),{grad:a[0],value:r}}}function _S(e){return Hh(bf(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{Hh(Array.isArray(t)&&t.every(e=>e instanceof Jb),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),Hh(null==n||n instanceof Jb,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let a=wv.gradients(()=>e(...t),t,n);return null!=n&&Gh(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),FS(a.grads),a}}function AS(e,t){Hh(bf(e),()=>"The f passed in variableGrads(f) must be a function"),Hh(null==t||Array.isArray(t)&&t.every(e=>e instanceof $b),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=null!=t;if(!n){t=[];for(let e in wv.registeredVariables)t.push(wv.registeredVariables[e])}let a=n?t.filter(e=>!e.trainable):null,r=t.length;Hh((t=t.filter(e=>e.trainable)).length>0,()=>"variableGrads() expects at least one of the input variables to be trainable, but none of the ".concat(r," variables is trainable."));let{value:s,grads:i}=wv.gradients(e,t,null,!0);Hh(i.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Hh(0===s.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it returned a rank-".concat(s.rank," tensor"));let o={};return t.forEach((e,t)=>{null!=i[t]&&(o[e.name]=i[t])}),null!=a&&a.forEach(e=>o[e.name]=null),{value:s,grads:o}}function RS(e){return wv.customGrad(e)}function FS(e){if(e.filter(e=>null==e).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var DS=Ov({neg_:function(e){let t={x:Fv(e,"x","neg")};return wv.runKernel(Pg,t)}});var MS=Ov({softplus_:function(e){let t={x:Fv(e,"x","softplus")};return wv.runKernel(wy,t)}});var OS=Ov({logSigmoid_:function(e){let t=Fv(e,"x","logSigmoid");return RS(e=>({value:DS(MS(DS(e))),gradFunc:t=>pw(t,qw(DS(e)))}))(t)}});var PS=Ov({sub_:function(e,t){let n=Fv(e,"a","sub"),a=Fv(t,"b","sub");[n,a]=pv(n,a);let r={a:n,b:a};return wv.runKernel(jy,r)}});var LS=Ov({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Fv(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and axis was ").concat(t));return RS((e,n)=>{let a=Qk(e,t,!0),r=PS(e,a),s=PS(iw(r,"float32"),NS(nS(iS(r),t,!0)));return n([s]),{value:s,gradFunc:(e,n)=>{let[a]=n,r=iS(a);return PS(e,pw(nS(e,t,!0),r))}}})(n)}});var zS=Ov({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Fv(e,"x","logSumExp"),r=rf(t,a.shape),s=Qk(a,r,!0),i=PS(a,s),o=iS(i),l=nS(o,r),c=NS(l),u=cw(Ww(s,c.shape),c);if(n){let e=Gk(u.shape,r);return Ww(u,e)}return u}});var jS=Ov({logicalAnd_:function(e,t){let n=Fv(e,"a","logicalAnd","bool"),a=Fv(t,"b","logicalAnd","bool");Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(hg,r)}});var BS=Ov({logicalNot_:function(e){let t={x:Fv(e,"x","logicalNot","bool")};return wv.runKernel(fg,t)}});var WS=Ov({logicalOr_:function(e,t){let n=Fv(e,"a","logicalOr","bool"),a=Fv(t,"b","logicalOr","bool");Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(mg,r)}});var VS=Ov({logicalXor_:function(e,t){let n=Fv(e,"a","logicalXor","bool"),a=Fv(t,"b","logicalXor","bool");return Fk(n.shape,a.shape),jS(WS(e,t),BS(jS(e,t)))}}),US=2147483648;var HS=Ov({searchSorted_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",a=Fv(e,"sortedSequence","searchSorted"),r=Fv(t,"values","searchSorted"),s=a.shape[a.shape.length-1],i=r.shape[r.shape.length-1],o=Ww(a,[-1,s]),l=Ww(r,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Kh(l.shape)>=US)throw new Error("values tensor size must less than ".concat(US));if(o.shape[1]>=US)throw new Error("trailing dim_size must less than ".concat(US," for int32 output type, was ").concat(o.shape[1]));let c={sortedSequence:o,values:l},u={side:n};return wv.runKernel(hy,c,u)}});function GS(e,t){return HS(e,t,"left")}var qS=Ov({maxPool_:function(e,t,n,a,r){let s=Fv(e,"x","maxPool"),i=s,o=!1;3===s.rank&&(o=!0,i=Ww(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Hh(4===i.rank,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(i.rank,".")),Hh(Lw(n,1),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(1,"'")),Bw("maxPool",a,r);let l={x:i},c={filterSize:t,strides:n,pad:a,dimRoundingMode:r},u=wv.runKernel(Ng,l,c);return o?Ww(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});var KS=Ov({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",i=Fv(e,"x","maxPool3d"),o=i,l=!1;4===i.rank&&(l=!0,o=Ww(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Hh(5===o.rank,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),Hh("NDHWC"===s,()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ".concat(s)),Bw("maxPool3d",a,r);let c={x:o},u={filterSize:t,strides:n,pad:a,dimRoundingMode:r,dataFormat:s},d=wv.runKernel(Cg,c,u);return l?Ww(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var XS=Ov({maxPoolWithArgmax_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s={x:Fv(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:n,pad:a,includeBatchInIndex:r},o=wv.runKernel(Eg,s,i);return{result:o[0],indexes:o[1]}}});var YS=Ov({maximum_:function(e,t){let n=Fv(e,"a","maximum"),a=Fv(t,"b","maximum");[n,a]=pv(n,a),"bool"===n.dtype&&(n=iw(n,"int32"),a=iw(a,"int32")),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(Sg,r)}});var QS=Ov({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Fv(e,"x","mean")},r={axis:t,keepDims:n};return wv.runKernel(_g,a,r)}});function JS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Tf(e),"complex64"===t){let t=JS(e,"float32"),n=JS(e,"float32");return Pv(t,n)}let n=If(Kh(e),t);return wv.makeTensor(n,e,t)}function ZS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Tf(e),"complex64"===t){let t=ZS(e,"float32"),n=JS(e,"float32");return Pv(t,n)}let n=Nf(Kh(e),t);return wv.makeTensor(n,e,t)}function $S(e,t){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===e)return[];let a=Fv(e,"x","meshgrid",e instanceof Jb?e.dtype:"float32");if(void 0===t)return[a];let r=Fv(t,"y","meshgrid",t instanceof Jb?t.dtype:"float32"),s=Kh(a.shape),i=Kh(r.shape);return"xy"===n?(a=Ww(a,[1,-1]),r=Ww(r,[-1,1]),[Gw(ZS([i,1],a.dtype),a),Gw(r,ZS([1,s],r.dtype))]):(a=Ww(a,[-1,1]),r=Ww(r,[1,-1]),[Gw(a,ZS([1,i],a.dtype)),Gw(ZS([s,1],r.dtype),r)])}var eN=Ov({minimum_:function(e,t){let n=Fv(e,"a","minimum"),a=Fv(t,"b","minimum");[n,a]=pv(n,a),"bool"===n.dtype&&(n=iw(n,"int32"),a=iw(a,"int32")),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(Rg,r)}});var tN=Ov({mirrorPad_:function(e,t,n){Hh("reflect"===n||"symmetric"===n,()=>"Invalid mode. Mode must be either reflect or symmetric. Got ".concat(n,"."));let a=Fv(e,"x","mirrorPad");if(0===a.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Hh(t.length===a.rank,()=>"Padding doesn't match input. Must be ".concat(a.rank,". Got ").concat(t.length,"."));let r="reflect"===n?1:0;for(let o=0;o<a.rank;o++)Hh(2===t[o].length,()=>"Invalid number of paddings. Must be length of 2 each."),Hh(t[o][0]>=0&&t[o][0]<=a.shape[o]-r&&t[o][1]>=0&&t[o][1]<=a.shape[o]-r,()=>"Padding in dimension ".concat(o," cannot be greater than or equal to ").concat(a.shape[o]-r," or less than 0 for input of shape ").concat(a.shape));let s={paddings:t,mode:n},i={x:a};return wv.runKernel(Fg,i,s)}});var nN=Ov({mod_:function(e,t){let n=Fv(e,"a","mod"),a=Fv(t,"b","mod");[n,a]=pv(n,a);let r={a:n,b:a};return wv.runKernel(Dg,r)}});var aN=Ov({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=rf(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=Fv(e,"x","moments")).shape),a=QS(e,n,t),r=a.shape;t||(r=Gk(a.shape,n));let s=tS(PS(iw(e,"float32"),Ww(a,r)));return{mean:a,variance:QS(s,n,t)}}});var rN=Ov({multiRNNCell_:function(e,t,n,a){let r=Fv(t,"data","multiRNNCell"),s=Dv(n,"c","multiRNNCell"),i=Dv(a,"h","multiRNNCell"),o=r,l=[];for(let d=0;d<e.length;d++){let t=e[d](o,s[d],i[d]);l.push(t[0]),l.push(t[1]),o=t[1]}let c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}});var sN=Ov({multinomial_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Fv(e,"logits","multinomial"),s=r.size,i=r.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got ".concat(s,"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(i));n=n||Math.random();let o={logits:1===i?Ww(r,[1,-1]):r},l={numSamples:t,seed:n,normalized:a},c=wv.runKernel(Mg,o,l);return 1===i?Ww(c,[c.size]):c}});var iN=Ov({notEqual_:function(e,t){let n=Fv(e,"a","notEqual","string_or_numeric"),a=Fv(t,"b","notEqual","string_or_numeric");[n,a]=pv(n,a),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(Lg,r)}});var oN=Ov({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));let s={indices:Fv(e,"indices","oneHot","int32")},i={dtype:r,depth:t,onValue:n,offValue:a};return wv.runKernel(Vg,s,i)}});var lN=Ov({onesLike_:function(e){let t={x:Fv(e,"x","onesLike")};return wv.runKernel(Wg,t)}});var cN=Ov({outerProduct_:function(e,t){let n=Fv(e,"v1","outerProduct"),a=Fv(t,"v2","outerProduct");Hh(1===n.rank&&1===a.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks ".concat(n.rank," and ").concat(a.rank,"."));let r=Ww(n,[-1,1]),s=Ww(a,[1,-1]);return Gw(r,s)}});var uN=Ov({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Fv(e,"x","pad");if(0===a.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let r={paddings:t,constantValue:n},s={x:a};return wv.runKernel(Hg,s,r)}});var dN=Ov({pad1d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Hh(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),uN(e,[t],n)}});var pN=Ov({pad2d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Hh(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),uN(e,t,n)}});var hN=Ov({pad3d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Hh(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),uN(e,t,n)}});var fN=Ov({pad4d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Hh(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),uN(e,t,n)}});var mN=Ov({spaceToBatchND_:function(e,t,n){let a=Fv(e,"x","spaceToBatchND");Hh(a.rank>=1+t.length,()=>"input rank ".concat(a.rank," should be > than [blockShape] ").concat(t.length)),Hh(n.length===t.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)),Hh(a.shape.reduce((e,a,r)=>r>0&&r<=t.length?e&&(a+n[r-1][0]+n[r-1][1])%t[r-1]===0:e,!0),()=>"input spatial dimensions ".concat(a.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString()));let r={x:a},s={blockShape:t,paddings:n};return wv.runKernel(Ny,r,s)}});var gN=Ov({pool_:function(e,t,n,a,r,s,i){null==r&&(r=[1,1]),null==s&&(s=1),0===a&&(a="valid");let o=Fv(e,"x","maxPool"),l=o,c=!1;3===o.rank&&(c=!0,l=Ww(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Hh(Lw(s,r),()=>"Error in pool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(r,"'"));let u,d=Tw(l.shape,t,s,r,a),p=[d.dilationHeight,d.dilationWidth];u="same"===a?function(e,t){let n=e.map((e,n)=>e+(e-1)*(t[n]-1)).map(e=>e-1),a=n.map(e=>Math.floor(e/2)),r=n.map((e,t)=>e-a[t]);return n.map((e,t)=>[a[t],r[t]])}([d.filterHeight,d.filterWidth],p):[[0,0],[0,0]];let h=1===p[0]&&1===p[1],[f,m]=function(e,t,n){let a=n.map(e=>e[0]),r=n.map(e=>e[1]),s=e.concat(a,r),i=t.map((e,t)=>(e-s[t]%e)%e),o=r.map((e,t)=>e+i[t]),l=t.map((e,t)=>[a[t],o[t]]),c=t.map((e,t)=>[0,i[t]]);return[l,c]}([d.inHeight,d.inWidth],p,u),g=h?a:"valid",y=h?l:mN(l,p,f),b=("avg"===n?()=>Vw(y,t,s,g,i):()=>qS(y,t,s,g,i))(),v=h?b:Qw(b,p,m);return c?Ww(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});var yN=Ov({prelu_:function(e,t){let n={x:Fv(e,"x","prelu"),alpha:Fv(t,"alpha","prelu")};return wv.runKernel(Kg,n)}});var bN=Ov({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Fv(e,"x","prod");"bool"===a.dtype&&(a=iw(a,"int32"));let r={x:a},s={axis:t,keepDims:n};return wv.runKernel(Xg,r,s)}});var vN=Ov({raggedGather_:function(e,t,n,a){let r={paramsNestedSplits:e.map((e,t)=>Fv(e,"tensors".concat(t),"raggedGather","int32")),paramsDenseValues:Fv(t,"paramsDenseValues","raggedGather"),indices:Fv(n,"indices","raggedGather","int32")},s={outputRaggedRank:a},i=wv.runKernel(Yg,r,s);return{outputNestedSplits:i.slice(0,i.length-1),outputDenseValues:i[i.length-1]}}});var xN=Ov({raggedRange_:function(e,t,n){let a=Fv(e,"starts","raggedRange"),r={starts:a,limits:Fv(t,"limits","raggedRange",a.dtype),deltas:Fv(n,"deltas","raggedRange",a.dtype)},s=wv.runKernel(Qg,r);return{rtNestedSplits:s[0],rtDenseValues:s[1]}}});var wN=Ov({raggedTensorToTensor_:function(e,t,n,a,r){let s=Fv(e,"shape","raggedTensorToTensor","int32"),i=Fv(t,"values","raggedTensorToTensor"),o={shape:s,values:i,defaultValue:Fv(n,"defaultValue","raggedTensorToTensor",i.dtype),rowPartitionTensors:a.map((e,t)=>Fv(e,"tensors".concat(t),"raggedTensorToTensor","int32"))},l={rowPartitionTypes:r};return wv.runKernel(Jg,o,l)}});var kN=Ov({rand_:function(e,t,n){Tf(e);let a=Kh(e),r=null;if(null==n||"float32"===n)r=new Float32Array(a);else if("int32"===n)r=new Int32Array(a);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));r=new Uint8Array(a)}for(let s=0;s<a;s++)r[s]=t();return wv.makeTensor(r,e,n)}}),SN=dh(Sh()),NN={};uh(NN,{TEST_EPSILON_FLOAT16:()=>CN,createVideoElement:()=>LN,encodeStrings:()=>PN,expectArrayBuffersEqual:()=>ON,expectArraysClose:()=>TN,expectArraysEqual:()=>RN,expectNumbersClose:()=>FN,expectPromiseToFail:()=>AN,expectValuesInRange:()=>MN,play:()=>zN,testEpsilon:()=>EN});var IN=.001,CN=.1;function TN(e,t,n){return null==n&&(n=EN()),_N(e,t,(e,t)=>DN(e,t,n))}function EN(){return 32===wv.backend.floatPrecision()?IN:CN}function _N(e,t,n){let a=!0;if((zb(e)||zb(t))&&(a=!1),zb(e)&&zb(t)&&(a=!0),a){let n=e.constructor.name,a=t.constructor.name;if(n!==a)throw new Error("Arrays are of different type. Actual: ".concat(n,". Expected: ").concat(a))}if(Array.isArray(e)&&Array.isArray(t)){let n=_v(e),a=_v(t);if(!Qh(n,a))throw new Error("Arrays have different shapes. Actual: [".concat(n,"]. Expected: [").concat(a,"]"))}let r=zb(e)?e:jb(e),s=zb(t)?t:jb(t);if(r.length!==s.length)throw new Error("Arrays have different lengths actual: ".concat(r.length," vs expected: ").concat(s.length,".\nActual:   ").concat(r,".\nExpected: ").concat(s,"."));for(let i=0;i<s.length;++i){let e=r[i],t=s[i];if(!n(e,t))throw new Error("Arrays differ: actual[".concat(i,"] = ").concat(e,", expected[").concat(i,"] = ").concat(t,".\nActual:   ").concat(r,".\nExpected: ").concat(s,"."))}"undefined"!=typeof expect&&expect().nothing()}function AN(e,t){e().then(()=>t.fail(),()=>t()),"undefined"!=typeof expect&&expect().nothing()}function RN(e,t){let n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return ff(e)||ff(e[0])||ff(t)||ff(t[0])?_N(e,n,(e,t)=>e==t):_N(e,t,(e,t)=>DN(e,t,0))}function FN(e,t,n){if(null==n&&(n=EN()),!DN(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t));"undefined"!=typeof expect&&expect().nothing()}function DN(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function MN(e,t,n){for(let a=0;a<e.length;a++)if(e[a]<t||e[a]>n)throw new Error("Value out of range:".concat(e[a]," low: ").concat(t,", high: ").concat(n))}function ON(e,t){let n=new Float32Array(e),a=new Float32Array(t);if(n.length!==a.length)throw new Error("Expected ArrayBuffer to be of length ".concat(a.length,", but it was ").concat(n.length));for(let r=0;r<a.length;r++)if(n[r]!==a[r])throw new Error("Expected ArrayBuffer value at ".concat(r," to be ").concat(a[r]," but got ").concat(n[r]," instead"))}function PN(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?PN(n):e[t]=Pb(n)}return e}function LN(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(e=>{t.addEventListener("loadeddata",n=>e(t)),t.load()})}async function zN(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}var jN=class{constructor(e,t,n,a,r){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);let s=r||Math.random();this.random=SN.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){let e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let a,r,s;do{a=2*this.random()-1,r=2*this.random()-1,s=a*a+r*r}while(s>=1||0===s);let i=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*a*i,t=this.mean+this.stdDev*r*i,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},BN=class{constructor(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;let r=a||Math.random();this.randu=SN.alea(r.toString()),this.randn=new jN(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,a,r,s;for(;;){do{a=this.randn.nextValue(),s=1+this.c*a}while(s<=0);if(s*=s*s,e=a*a,t=1-.331*e*e,n=.5*e+this.d*(1-s+Math.log(s)),r=this.randu(),r<t||Math.log(r)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}},WN=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==a&&(a=Math.random()),"number"==typeof a&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=SN.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};var VN=Ov({randomGamma_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",r=arguments.length>4?arguments[4]:void 0;if(Tf(e),null==n&&(n=1),null==a&&(a="float32"),"float32"!==a&&"int32"!==a)throw new Error("Unsupported data type ".concat(a));let s=new BN(t,n,a,r),i=sw(e,a);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}});var UN=Ov({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(Tf(e),null!=a&&"bool"===a)throw new Error("Unsupported data type ".concat(a));let s=new jN(t,n,a,!1,r),i=sw(e,a);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}});var HN=Ov({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return UN(e,0,1,t,n)}});var GN=Ov({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",r=arguments.length>4?arguments[4]:void 0;Tf(e);let s=sw(e,a),i=new WN(t,n,null,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}});var qN=Ov({randomUniformInt_:function(e,t,n,a){return GN(e,t,n,"int32",a)}});function KN(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");let r={start:e,stop:t,step:n,dtype:a};return wv.runKernel(Zg,{},r)}var XN=Ov({real_:function(e){let t={input:Fv(e,"input","real")};return wv.runKernel($g,t)}});var YN=Ov({reciprocal_:function(e){let t={x:Fv(e,"x","reciprocal")};return wv.runKernel(ey,t)}});var QN=Ov({relu_:function(e){let t={x:Fv(e,"x","relu")};return wv.runKernel(ty,t)}});var JN=Ov({relu6_:function(e){let t={x:Fv(e,"x","relu6")};return wv.runKernel(oy,t)}});var ZN=Ov({reverse_:function(e,t){let n={x:Fv(e,"x","reverse")},a={dims:t};return wv.runKernel(ly,n,a)}});var $N=Ov({reverse1d_:function(e){let t=Fv(e,"x","reverse");return Hh(1===t.rank,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")),ZN(t,0)}});var eI=Ov({reverse2d_:function(e,t){let n=Fv(e,"x","reverse");return Hh(2===n.rank,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")),ZN(n,t)}});var tI=Ov({reverse3d_:function(e,t){let n=Fv(e,"x","reverse");return Hh(3===n.rank,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")),ZN(n,t)}});var nI=Ov({reverse4d_:function(e,t){let n=Fv(e,"x","reverse");return Hh(4===n.rank,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")),ZN(n,t)}});var aI=Ov({round_:function(e){let t={x:Fv(e,"x","round")};return wv.runKernel(cy,t)}});var rI=Ov({rsqrt_:function(e){let t={x:Fv(e,"x","rsqrt","float32")};return wv.runKernel(uy,t)}});var sI=Ov({selu_:function(e){let t={x:Fv(e,"x","selu")};return wv.runKernel(my,t)}});var iI=Ov({separableConv2d_:function(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",o=Fv(e,"x","separableConv2d"),l=Fv(t,"depthwiseFilter","separableConv2d"),c=Fv(n,"pointwiseFilter","separableConv2d"),u=o,d=!1;if(3===o.rank&&(d=!0,u=Ww(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===i)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Hh(4===u.rank,()=>"Error in separableConv2d: input must be rank 4, but got rank ".concat(u.rank,".")),Hh(4===l.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but got rank ".concat(l.rank,".")),Hh(4===c.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but got rank ".concat(l.rank,".")),Hh(1===c.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ".concat(c.shape[0],".")),Hh(1===c.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ".concat(c.shape[1],"."));let p=l.shape[2],h=l.shape[3];Hh(c.shape[2]===p*h,()=>"Error in separableConv2d: the third dimension of pointwise filter must be ".concat(p*h,", but got ").concat(c.shape[2],"."));let f=Ck(u,l,a,r,i,s),m=hk(f,c,1,"valid",i);return d?Ww(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});var oI=async function(e,t){let n=Fv(e,"x","setdiff1d"),a=Fv(t,"y","setdiff1d");Hh(n.dtype===a.dtype,()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(a.dtype,").")),Hh(1===n.rank,()=>"x should be 1D tensor, but got x (".concat(n.shape,").")),Hh(1===a.rank,()=>"y should be 1D tensor, but got y (".concat(a.shape,")."));let r=await n.data(),s=await a.data(),i=new Set(s),o=0;for(let u=0;u<r.length;u++)i.has(r[u])||o++;let l=new Xb([o],n.dtype),c=new Xb([o],"int32");for(let u=0,d=0;u<r.length;u++)i.has(r[u])||(l.values[d]=r[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]};var lI=Ov({sign_:function(e){let t={x:Fv(e,"x","sign")};return wv.runKernel(vy,t)}});var cI=Ov({sin_:function(e){let t={x:Fv(e,"x","sin","float32")};return wv.runKernel(yy,t)}});var uI=Ov({sinh_:function(e){let t={x:Fv(e,"x","sinh")};return wv.runKernel(by,t)}});var dI=Ov({slice1d_:function(e,t,n){let a=Fv(e,"x","slice1d");return Hh(1===a.rank,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(a.rank," tensor")),Kw(a,[t],[n])}});var pI=Ov({slice2d_:function(e,t,n){let a=Fv(e,"x","slice2d");return Hh(2===a.rank,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(a.rank," tensor")),Kw(a,t,n)}});var hI=Ov({slice3d_:function(e,t,n){let a=Fv(e,"x","slice3d");return Hh(3===a.rank,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(a.rank," tensor")),Kw(a,t,n)}});var fI=Ov({slice4d_:function(e,t,n){let a=Fv(e,"x","slice4d");return Hh(4===a.rank,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(a.rank," tensor")),Kw(a,t,n)}});var mI=Ov({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Fv(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and dim was ").concat(t));let a={logits:n},r={dim:t};return wv.runKernel(Cy,a,r)}});var gI=Ov({fft_:function(e){Hh("complex64"===e.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 but got ".concat(e.dtype,"."));let t={input:e};return wv.runKernel(Gm,t)}});var yI=Ov({ifft_:function(e){Hh("complex64"===e.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 but got ".concat(e.dtype,"."));let t={input:e};return wv.runKernel(ng,t)}});var bI=Ov({irfft_:function(e){let t,n=e.shape[e.shape.length-1],a=e.size/n;if(n<=2){let r=Ww(e,[a,n]);t=yI(r)}else{let r=[a,2*(n-1)],s=Ww(XN(e),[a,n]),i=Ww(mS(e),[a,n]),o=ZN(Kw(s,[0,1],[a,n-2]),1),l=pw(ZN(Kw(i,[0,1],[a,n-2]),1),$k(-1)),c=Hw([s,o],1),u=Hw([i,l],1),d=Ww(Pv(c,u),[r[0],r[1]]);t=yI(d)}if(t=XN(t),3===e.rank&&0!==e.shape[0]){let n=t,a=e.shape[0];t=Ww(t,[a,t.shape[0]/a,t.shape[1]]),n.dispose()}return t}});var vI=Ov({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a={x:Fv(e,"x","split")},r={numOrSizeSplits:t,axis:n};return wv.runKernel(Iy,a,r)}});var xI=Ov({rfft_:function(e,t){Hh("float32"===e.dtype,()=>"The dtype for rfft() must be real value but got ".concat(e.dtype));let n,a=e.shape[e.shape.length-1],r=e.size/a;if(null!=t&&t<a){let r=e.shape.map(e=>0),s=e.shape.map(e=>e);s[e.shape.length-1]=t,n=Kw(e,r,s),a=t}else if(null!=t&&t>a){let r=e.shape.map(e=>e);r[e.shape.length-1]=t-a,n=Hw([e,JS(r)],e.shape.length-1),a=t}else n=e;let s=Ok(n),i=Ww(Pv(n,s),[r,a]),o=gI(i),l=Math.floor(a/2)+1,c=XN(o),u=mS(o),d=vI(c,[l,a-l],c.shape.length-1),p=vI(u,[l,a-l],u.shape.length-1),h=n.shape.slice();return h[n.shape.length-1]=l,Ww(Pv(d[0],p[0]),h)}});var wI=Ov({squaredDifference_:function(e,t){let n=Fv(e,"a","squaredDifference"),a=Fv(t,"b","squaredDifference");[n,a]=pv(n,a),Fk(n.shape,a.shape);let r={a:n,b:a};return wv.runKernel(Fy,r,{})}});var kI=Ov({squeeze_:function(e,t){let n=Fv(e,"x","squeeze","string_or_numeric");return Ww(n,sf(n.shape,t).newShape)}});var SI=Ov({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Dv(e,"tensors","stack","string_or_numeric");Hh(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&Hh(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");let a=n,r={axis:t};return wv.runKernel(Ug,a,r)}});var NI=Ov({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Fv(e,"x","step")},a={alpha:t};return wv.runKernel(Jy,n,a)}});var II=Ov({stridedSlice_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c={x:Fv(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:a,beginMask:r,endMask:s,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return wv.runKernel(Oy,c,u)}});var CI=Ov({tan_:function(e){let t={x:Fv(e,"x","tan","float32")};return wv.runKernel(By,t)}});function TI(e,t){qh(e);let n=_v(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Lv(e,null,n,t)}function EI(e,t,n){if(qh(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");let a=_v(e,n);if(2!==a.length&&1!==a.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Lv(e,t,a,n)}function _I(e,t,n){if(qh(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");let a=_v(e,n);if(3!==a.length&&1!==a.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Lv(e,t,a,n)}function AI(e,t,n){if(qh(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");let a=_v(e,n);if(4!==a.length&&1!==a.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Lv(e,t,a,n)}function RI(e,t,n){if(qh(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");let a=_v(e,n);if(5!==a.length&&1!==a.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Lv(e,t,a,n)}function FI(e,t,n){if(qh(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");let a=_v(e,n);if(6!==a.length&&1!==a.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Lv(e,t=t||a,a,n)}var DI={};function MI(e,t,n){let a=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,s="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ".concat(n.shape,", indices.shape: ").concat(t.shape,", shape: ").concat(e,", sliceDim: ").concat(a,", and batchDim: ").concat(r,".");if(n.rank<r)throw new Error(s+" update.rank < ".concat(r,". "));if(e.length<a+(n.rank-r))throw new Error(s+" Output shape length < ".concat(a+(n.rank-r)));if(n.rank!==r+e.length-a)throw new Error(s+" update.rank != ".concat(r+e.length-a));for(let i=0;i<r;++i)if(n.shape[i]!==t.shape[i])throw new Error(s+" updates.shape[".concat(i,"] (").concat(n.shape[i],") != indices.shape[").concat(i,"] (").concat(t.shape[i],")."));for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==e[i+a])throw new Error(s+" updates.shape[".concat(i+r,"] (").concat(n.shape[i+r],") != shape[").concat(i+r,"] (").concat(e[i+r],")"))}function OI(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}MI(n,t,e)}function PI(e,t,n){let a=t.shape.length,r=a>1?t.shape[a-1]:1,s=n.length,i=1;for(let l=r;l<s;++l)i*=n[l];let o=r<1?1:r;return{sliceRank:r,numUpdates:Kh(t.shape)/o,sliceSize:i,strides:[...xf(n.slice(0,r)),1],outputSize:Kh(n)}}uh(DI,{calculateShapes:()=>PI,validateInput:()=>OI,validateUpdateShape:()=>MI});var LI=Ov({tensorScatterUpdate_:function(e,t,n){let a=Fv(e,"tensor","tensorScatterupdate"),r=Fv(t,"indices","tensorScatterupdate","int32"),s=Fv(n,"updates","tensorScatterupdate");if(OI(s,r,a.shape),a.dtype!==s.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(a.dtype," and ").concat(s.dtype,"."));let i={tensor:a,indices:r,updates:s};return wv.runKernel(py,i,{})}});var zI=Ov({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Fv(e,"x","topk");if(0===a.rank)throw new Error("topk() expects the input to be of rank 1 or higher");let r=a.shape[a.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>r)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(r,") but got ").concat(t));let s={x:a},i={k:t,sorted:n},[o,l]=wv.runKernel(Uy,s,i);return{values:o,indices:l}}});var jI=Ov({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(Tf(e),null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");let s=new jN(t,n,a,!0,r),i=sw(e,a);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}});var BI=Ov({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Fv(e,"x","unique","string_or_numeric");Hh(n.rank>0,()=>"The input tensor must be at least 1D");let a={x:n},r={axis:t},[s,i]=wv.runKernel(qy,a,r);return{values:s,indices:i}}});var WI=Ov({unsortedSegmentSum_:function(e,t,n){let a=Fv(e,"x","unsortedSegmentSum"),r=Fv(t,"segmentIds","unsortedSegmentSum","int32");Hh(Jh(n),()=>"numSegments must be of dtype int");let s={x:a,segmentIds:r},i={numSegments:n};return wv.runKernel(Xy,s,i)}});var VI=Ov({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Fv(e,"x","unstack","string_or_numeric");Hh(t>=-n.shape.length&&t<n.shape.length,()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"));let a={value:n},r={axis:t};return wv.runKernel(Ky,a,r)}});function UI(e,t){return HS(e,t,"right")}function HI(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return wv.makeVariable(e,t,n,a)}function GI(e,t){let n=[];for(let s=0;s<t.length;s++)t[s]&&n.push(s);let a=sw(e,"int32"),r=sw([n.length,e.length],"int32");for(let s=0;s<n.length;s++){let t=a.indexToLoc(n[s]),i=s*e.length;r.values.set(t,i)}return r.toTensor()}var qI=async function(e){let t=Fv(e,"condition","whereAsync","bool"),n=await t.data(),a=GI(t.shape,n);return e!==t&&t.dispose(),a};var KI=async function(e,t,n){let a=Fv(e,"tensor","boolMask"),r=Fv(t,"mask","boolMask","bool"),s=null==n?0:n,i=r.rank,o=a.shape;Hh(i>0,()=>"mask cannot be scalar"),Gh(o.slice(s,s+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=s;m<s+i;m++)l*=o[m];let c=o.slice(0,s).concat([l],o.slice(s+i)),u=Ww(a,c),d=Ww(r,[-1]),p=await qI(d),h=kI(p,[1]),f=pS(u,h,s);return e!==a&&a.dispose(),t!==r&&r.dispose(),h.dispose(),u.dispose(),d.dispose(),p.dispose(),f};var XI=Ov({transpose_:function(e,t,n){let a=Fv(e,"x","transpose");if(null==t&&(t=a.shape.map((e,t)=>t).reverse()),Hh(a.rank===t.length,()=>"Error in transpose: rank of input ".concat(a.rank," must match length of perm ").concat(t,".")),t.forEach(e=>{Hh(e>=0&&e<a.rank,()=>"All entries in 'perm' must be between 0 and ".concat(a.rank-1," but got ").concat(t))}),a.rank<=1)return a.clone();let r={x:a},s={perm:t};return"complex64"===a.dtype?Yv(()=>{let e=XN(a),t=mS(a);return e=wv.runKernel(Gy,{x:e},s),t=wv.runKernel(Gy,{x:t},s),n&&(t=DS(t)),Pv(e,t)}):wv.runKernel(Gy,r,s)}});var YI=Ov({movingAverage_:function(e,t,n,a){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=Fv(e,"v","movingAverage"),i=Fv(t,"x","movingAverage"),o=Fv(n,"decay","movingAverage");hv(s,i),Hh(Qh(s.shape,i.shape),()=>"Shape mismatch in v and x");let l=$k(1),c=PS(l,o),u=pw(PS(i,s),c);if(r){Hh(null!=a,()=>"When using zeroDebias: true, step is required.");let e=Fv(a,"step","movingAverage");u=dw(u,PS(l,Zk(o,e)))}return cw(s,u)}});var QI=Ov({scatterND_:function(e,t,n){Tf(n);let a=Fv(e,"indices","scatterND","int32"),r=Fv(t,"updates","scatterND");OI(r,a,n);let s={indices:a,updates:r},i={shape:n};return wv.runKernel(dy,s,i)}});var JI=Ov({sparseToDense_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Tf(n);let r=Fv(e,"sparseIndices","sparseToDense","int32"),s=Fv(t,"sparseValues","sparseToDense","string_or_numeric"),i=Fv(a,"defaultValue","sparseToDense",s.dtype);!function(e,t,n,a){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape ".concat(e.shape,"."));let r=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(n.length!==s)throw new Error("outputShape has incorrect number of elements:, ".concat(n.length,", should be: ").concat(s,"."));let i=t.size;if(0!==t.rank&&(1!==t.rank||i!==r))throw new Error("sparseValues has incorrect shape ".concat(t.shape,", should be [] or [").concat(r,"]"));if(t.dtype!==a.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(r,s,n,i);let o={sparseIndices:r,sparseValues:s,defaultValue:i},l={outputShape:n};return wv.runKernel(Ry,o,l)}});var ZI=Ov({gatherND_:function(e,t){let n=Fv(t,"indices","gatherND","int32"),a={params:Fv(e,"x","gatherND","string_or_numeric"),indices:n};return wv.runKernel(Zm,a)}});var $I=Ov({dropout_:function(e,t,n,a){let r=Fv(e,"x","dropout");if(Hh("float32"===r.dtype,()=>"x has to be a floating point tensor since it's going to be scaled, but got a ".concat(r.dtype," tensor instead.")),Hh(t>=0&&t<1,()=>"rate must be a float in the range [0, 1), but got ".concat(t,".")),0===t)return e instanceof Jb?r.clone():r;let s=function(e,t){if(null==t)return e.shape.slice();if(Qh(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let a=0;a<e.shape.length;a++)null==t[a]&&null!=e.shape[a]?n.push(e.shape[a]):n.push(t[a]);return n}return t}(r,n),i=1-t,o=dw(dS(cw(GN(s,0,1,"float32",a),i)),i);return pw(r,o)}});function eC(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function tC(e,t,n){let a=1-e%2,r=new Float32Array(e);for(let s=0;s<e;++s){let i=2*Math.PI*s/(e+a-1);r[s]=t-n*Math.cos(i)}return TI(r,"float32")}var nC=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=Fv(e,"predictions","inTopK"),r=Fv(t,"targets","inTopK");Hh(a.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, but got ".concat(a.rank)),Hh(a.rank-1===r.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank ".concat(a.rank," and targets rank ").concat(r.rank)),Gh(a.shape.slice(0,a.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let s=a.shape[a.shape.length-1];Hh(n>0&&n<=s,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last dimension (".concat(s,"), but got ").concat(n));let i=await a.data(),o=await r.data(),[l,c]=[i.length/s,s],u=of("bool",l);for(let d=0;d<l;d++){let e=d*c,t=i.subarray(e,e+c),a=[];for(let n=0;n<t.length;n++)a.push({value:t[n],index:n});a.sort((e,t)=>t.value-e.value),u[d]=0;for(let r=0;r<n;r++)if(a[r].index===o[d]){u[d]=1;break}}return e!==a&&a.dispose(),t!==r&&r.dispose(),zv(u,r.shape,"bool")},aC={};uh(aC,{conv2d:()=>cC,depthwiseConv2d:()=>pC,matMul:()=>hC});var rC=Ov({conv2DBackpropFilter_:function(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=Ww(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Ww(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Hh(4===o.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape ".concat(o.shape,".")),Hh(4===l.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape ".concat(l.shape,".")),Hh(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got ".concat(n,"."));let c="NHWC"===s?o.shape[3]:o.shape[1],u="NHWC"===s?l.shape[3]:l.shape[1];Hh(c===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(c,") must match input depth in filter (").concat(n[2],".")),Hh(u===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must match output depth for filter (").concat(n[3],").")),Bw("conv2dDerFilter",r,i);let d={x:o,dy:l},p={strides:a,pad:r,dataFormat:s,dimRoundingMode:i,filterShape:n};return wv.runKernel(gm,d,p)}});function sC(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return pw(e,NI(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function iC(e,t){let n=t,a=Rk(e.shape,t.shape);return a.length>0&&(n=nS(n,a)),Ww(n,e.shape)}function oC(e,t,n,a){if("linear"===t)return e;if("relu"===t)return QN(e);if("elu"===t)return jk(e);if("relu6"===t)return JN(e);if("prelu"===t)return yN(e,n);if("leakyrelu"===t)return vS(e,a);if("sigmoid"===t)return qw(e);throw new Error("Unknown fused activation ".concat(t,"."))}var lC=(e,t)=>!(e>0)||"linear"===t;var cC=Ov({fusedConv2d_:function(e){let{x:t,filter:n,strides:a,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:d}=e;if(c=c||"linear",!1===lC(wv.state.gradientDepth,c)){Hh("NHWC"===s,()=>"Error in fused conv2d: got dataFormat of ".concat(s," but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let e=hk(t,n,a,r,s,i,o);return null!=l&&(e=cw(e,l)),oC(e,c,u,d)}let p=Fv(t,"x","conv2d","float32"),h=Fv(n,"filter","conv2d","float32"),f=p,m=!1;3===p.rank&&(m=!0,f=Ww(p,[1,p.shape[0],p.shape[1],p.shape[2]])),Hh(4===f.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank ".concat(f.rank,".")),Hh(4===h.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank ".concat(h.rank,".")),Bw("fused conv2d",r,o);let g="NHWC"===s?f.shape[3]:f.shape[1];Hh(h.shape[2]===g,()=>"Error in conv2d: depth of input (".concat(g,") must match input depth for filter ").concat(h.shape[2],".")),Hh(Lw(a,i),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '").concat(i,"'"));let y,b,v=_w(f.shape,h.shape,a,i,r,o);if(null!=l&&(y=Fv(l,"bias","fused conv2d"),[y]=pv(y,p),"NHWC"===s?Fk(v.outShape,y.shape):(Hh(y.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-".concat(y.shape.length,".")),Hh(0===y.shape.length||y.shape[0]===v.outChannels||1===y.shape[0],()=>"Error in fused conv2d: bias shape (".concat(y.shape,") is not compatible with the number of output channels (").concat(v.outChannels,")")))),null!=u){let e=u.shape;if(Hh(e.length<=1||3===e.length,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-".concat(e.length,".")),1===e.length)Hh(1===e[0]||e[0]===v.outChannels,()=>"Error in fused conv2d: PReLU activation weights (".concat(e,") is not compatible with the number of output channels (").concat(v.outChannels,")."));else if(3===e.length)try{Fk(e,v.outShape)}catch(S){let t="Error in fused conv2d: PReLU activation weights (".concat(e,") is not compatible with the output shape of the conv2d (").concat(v.outShape,").");throw Error(t)}b=Fv(u,"prelu weights","fused conv2d")}let x=(e,t)=>{Hh("NHWC"===s,()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(s," but only NHWC is currently supported."));let[n,o,l,u]=t,d=sC(e,l,c);Hh(Pw(i),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(i,"'"));let p=[mk(o.shape,d,n,a,r),rC(o,d,n.shape,a,r)];if(null!=u){let e=iC(u,d);p.push(e)}return p},w={x:f,filter:h,bias:y,preluActivationWeights:b},k={strides:a,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:c,leakyreluAlpha:d};return null==l?RS((e,t,n)=>{let a=wv.runKernel(tb,w,k);return n([t,e,a]),m&&(a=Ww(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:x}})(f,h):RS((e,t,n,a)=>{let r=wv.runKernel(tb,w,k);return a([t,e,r,n]),m&&(r=Ww(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}})(f,h,y)}});var uC=Ov({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=Ww(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Ww(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={x:o,dy:l},u={strides:a,pad:r,dimRoundingMode:i,dilations:s,filterShape:n};return wv.runKernel(_m,c,u)}});var dC=Ov({depthwiseConv2dNativeBackpropInput_:function(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=t,l=!1;3===t.rank&&(l=!0,o=Ww(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={dy:o,filter:n},u={strides:a,pad:r,dimRoundingMode:i,dilations:s,inputShape:e},d=wv.runKernel(Am,c,u);return l?Ww(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var pC=Ov({fusedDepthwiseConv2d_:function(e){let{x:t,filter:n,strides:a,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:d}=e;if(!1===lC(wv.state.gradientDepth,c)){let e=Ck(t,n,a,r,s,i,o);return null!=l&&(e=cw(e,l)),oC(e,c,u,d)}let p=Fv(t,"x","depthwiseConv2d","float32"),h=Fv(n,"filter","depthwiseConv2d","float32"),f=p,m=!1;3===p.rank&&(m=!0,f=Ww(p,[1,p.shape[0],p.shape[1],p.shape[2]])),Hh(4===f.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got rank ".concat(f.rank,".")),Hh(4===h.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, but got rank ".concat(h.rank,".")),Hh(f.shape[3]===h.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels (".concat(f.shape[3],") must match the inChannels dimension in filter ").concat(h.shape[2],".")),null==i&&(i=[1,1]),Hh(Lw(a,i),()=>"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '").concat(i,"'")),Bw("fused depthwiseConv2d",r,o);let g,y,b=_w(f.shape,h.shape,a,i,r,o,!0);null!=l&&(g=Fv(l,"bias","fused conv2d"),[g]=pv(g,p),Fk(b.outShape,g.shape)),null!=u&&(y=Fv(u,"prelu weights","fused depthwiseConv2d"));let v=(e,t)=>{Hh(Pw(i),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '".concat(i,"'"));let[n,s,l,u]=t,d=sC(e,l,c),p=dC(s.shape,d,n,a,r,i,o),h=uC(s,d,n.shape,a,r,i,o);if(null!=u){return[p,h,iC(g,d)]}return[p,h]},x={x:f,filter:h,bias:g,preluActivationWeights:y},w={strides:a,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:c,leakyreluAlpha:d};return null==l?RS((e,t,n)=>{let a=wv.runKernel(nb,x,w);return n([t,e,a]),m&&(a=Ww(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:v}})(f,h):RS((e,t,n,a)=>{let r=wv.runKernel(nb,x,w);return a([t,e,r,n]),m&&(r=Ww(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}})(f,h,g)}});var hC=Ov({fusedMatMul_:function(e){let{a:t,b:n,transposeA:a=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:l=.2}=e;if(!1===lC(wv.state.gradientDepth,i)){let e=Gw(t,n,a,r);return null!=s&&(e=cw(e,s)),oC(e,i,o,l)}let c=Fv(t,"a","fused matMul"),u=Fv(n,"b","fused matMul");[c,u]=pv(c,u);let d=a?c.shape[c.rank-2]:c.shape[c.rank-1],p=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=a?c.shape[c.rank-1]:c.shape[c.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=c.shape.slice(0,-2),g=u.shape.slice(0,-2),y=Kh(m),b=Kh(g);Hh(d===p,()=>"Error in fused matMul: inner shapes (".concat(d,") and (").concat(p,") of Tensors with shapes ").concat(c.shape," and ").concat(u.shape," and transposeA=").concat(a," and transposeB=").concat(r," must match."));let v,x,w=Fk(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,f]),k=Ww(c,a?[y,d,h]:[y,h,d]),S=Ww(u,r?[b,f,p]:[b,p,f]);null!=s&&(v=Fv(s,"bias","fused matMul"),[v]=pv(v,c),Fk(w,v.shape)),null!=o&&(x=Fv(o,"prelu weights","fused matMul"));let N=(e,t)=>{let n,o,[l,c,u,d]=t,p=sC(Ww(e,u.shape),u,i);if(a||r?!a&&r?(n=Gw(p,c,!1,!1),o=Gw(p,l,!0,!1)):a&&!r?(n=Gw(c,p,!1,!0),o=Gw(l,p,!1,!1)):(n=Gw(c,p,!0,!0),o=Gw(p,l,!0,!0)):(n=Gw(p,c,!1,!0),o=Gw(l,p,!0,!1)),null!=s){return[n,o,iC(d,p)]}return[n,o]},I={a:k,b:S,bias:v,preluActivationWeights:x},C={transposeA:a,transposeB:r,activation:i,leakyreluAlpha:l};return null==s?RS((e,t,n)=>{let a=wv.runKernel(eb,I,C);return n([e,t,a]),{value:Ww(a,w),gradFunc:N}})(k,S):RS((e,t,n,a)=>{let r=wv.runKernel(eb,I,C);return a([e,t,r,n]),{value:Ww(r,w),gradFunc:N}})(k,S,v)}});var fC=Ov({hammingWindow_:function(e){return tC(e,.54,.46)}});var mC=Ov({hannWindow_:function(e){return tC(e,.5,.5)}});var gC=Ov({frame_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=0,i=[];for(;s+t<=e.size;)i.push(Kw(e,s,t)),s+=n;if(a)for(;s<e.size;){let a=s+t-e.size,o=Hw([Kw(e,s,t-a),ok([a],r)]);i.push(o),s+=n}return 0===i.length?EI([],[0,t]):Ww(Hw(i),[i.length,t])}});var yC=Ov({stft_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:mC;null==a&&(a=eC(t));let s=gC(e,t,n),i=pw(s,r(t));return xI(i,a)}});var bC=Ov({cropAndResize_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=Fv(e,"image","cropAndResize"),o=Fv(t,"boxes","cropAndResize","float32"),l=Fv(n,"boxInd","cropAndResize","int32"),c=o.shape[0];Hh(4===i.rank,()=>"Error in cropAndResize: image must be rank 4,but got rank ".concat(i.rank,".")),Hh(2===o.rank&&4===o.shape[1],()=>"Error in cropAndResize: boxes must be have size [".concat(c,",4] but had shape ").concat(o.shape,".")),Hh(1===l.rank&&l.shape[0]===c,()=>"Error in cropAndResize: boxInd must be have size [".concat(c,"] but had shape ").concat(o.shape,".")),Hh(2===a.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got length ".concat(a.length,".")),Hh(a[0]>=1&&a[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(a)),Hh("bilinear"===r||"nearest"===r,()=>"method must be bilinear or nearest, but was ".concat(r));let u={image:i,boxes:o,boxInd:l},d={method:r,extrapolationValue:s,cropSize:a};return wv.runKernel(Im,u,d)}});var vC=Ov({flipLeftRight_:function(e){let t=Fv(e,"image","flipLeftRight","float32");Hh(4===t.rank,()=>"Error in flipLeftRight: image must be rank 4,but got rank ".concat(t.rank,"."));let n={image:t};return wv.runKernel(Km,n,{})}});var xC=Ov({grayscaleToRGB_:function(e){let t=Fv(e,"image","grayscaleToRGB"),n=t.rank-1,a=t.shape[n];Hh(t.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, but got rank ".concat(t.rank,".")),Hh(1===a,()=>"Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ".concat(a,"."));let r=new Array(t.rank);return r.fill(1,0,n),r[n]=3,cS(t,r)}});var wC=Ov({rgbToGrayscale_:function(e){let t=Fv(e,"image","RGBToGrayscale"),n=t.rank-1,a=t.shape[n];Hh(t.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, but got rank ".concat(t.rank,".")),Hh(3===a,()=>"Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ".concat(a,"."));let r,s=t.dtype,i=iw(t,"float32"),o=TI([.2989,.587,.114]);switch(t.rank){case 2:r=zk("ij,j->i",i,o);break;case 3:r=zk("ijk,k->ij",i,o);break;case 4:r=zk("ijkl,l->ijk",i,o);break;case 5:r=zk("ijklm,m->ijkl",i,o);break;case 6:r=zk("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return r=oS(r,-1),iw(r,s)}});var kC=Ov({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=Fv(e,"image","rotateWithOffset","float32");Hh(4===r.rank,()=>"Error in rotateWithOffset: image must be rank 4,but got rank ".concat(r.rank,"."));let s={image:r},i={radians:t,fillValue:n,center:a};return wv.runKernel($y,s,i)}});function SC(e,t,n,a,r,s){null==a&&(a=.5),null==r&&(r=Number.NEGATIVE_INFINITY),null==s&&(s=0);let i=e.shape[0];return n=Math.min(n,i),Hh(0<=a&&a<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(a,"'")),Hh(2===e.rank,()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")),Hh(4===e.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])),Hh(1===t.rank,()=>"scores must be a 1D tensor"),Hh(t.shape[0]===i,()=>"scores has incompatible shape with boxes. Expected ".concat(i,", but was ").concat(t.shape[0])),Hh(0<=s&&s<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(s,"'")),{maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:s}}var NC=Ov({nonMaxSuppression_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=Fv(e,"boxes","nonMaxSuppression","float32"),i=Fv(t,"scores","nonMaxSuppression","float32"),o=SC(s,i,n,a,r);n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold;let l={maxOutputSize:n,iouThreshold:a,scoreThreshold:r};return wv.runKernel(zg,{boxes:s,scores:i},l)}});function IC(e,t,n){let a=function(e,t,n){return function(e,t,n){let a=0,r=e.length,s=0,i=!1;for(;a<r;){s=a+(r-a>>>1);let o=n(t,e[s]);o>0?a=s+1:(r=s,i=!o)}return i?a:-a-1}(e,t,n||CC)}(e,t,n),r=a<0?-(a+1):a;e.splice(r,0,t)}function CC(e,t){return e>t?1:e<t?-1:0}function TC(e,t,n,a,r){return AC(e,t,n,a,r,0)}function EC(e,t,n,a,r,s){return AC(e,t,n,a,r,0,!1,s,!0)}function _C(e,t,n,a,r,s){return AC(e,t,n,a,r,s,!0)}function AC(e,t,n,a,r,s){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[];for(let g=0;g<t.length;g++)t[g]>r&&c.push({score:t[g],boxIndex:g,suppressBeginIndex:0});c.sort(DC);let u=s>0?-.5/s:0,d=[],p=[];for(;d.length<n&&c.length>0;){let t=c.pop(),{score:n,boxIndex:s,suppressBeginIndex:i}=t;if(n<r)break;let o=!1;for(let l=d.length-1;l>=i;--l){let n=RC(e,s,d[l]);if(n>=a){o=!0;break}if(t.score=t.score*FC(a,u,n),t.score<=r)break}t.suppressBeginIndex=d.length,o||(t.score===n?(d.push(s),p.push(t.score)):t.score>r&&IC(c,t,DC))}let h=d.length,f=n-h;o&&f>0&&(d.push(...new Array(f).fill(0)),p.push(...new Array(f).fill(0)));let m={selectedIndices:d};return i&&(m.selectedScores=p),l&&(m.validOutputs=h),m}function RC(e,t,n){let a=e.subarray(4*t,4*t+4),r=e.subarray(4*n,4*n+4),s=Math.min(a[0],a[2]),i=Math.min(a[1],a[3]),o=Math.max(a[0],a[2]),l=Math.max(a[1],a[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),p=Math.max(r[1],r[3]),h=(o-s)*(l-i),f=(d-c)*(p-u);if(h<=0||f<=0)return 0;let m=Math.max(s,c),g=Math.max(i,u),y=Math.min(o,d),b=Math.min(l,p),v=Math.max(y-m,0)*Math.max(b-g,0);return v/(h+f-v)}function FC(e,t,n){let a=Math.exp(t*n*n);return n<=e?a:0}function DC(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}var MC=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=Fv(e,"boxes","nonMaxSuppressionAsync"),i=Fv(t,"scores","nonMaxSuppressionAsync"),o=SC(s,i,n,a,r);n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold;let l=await Promise.all([s.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:d}=TC(c,u,n,a,r);return s!==e&&s.dispose(),i!==t&&i.dispose(),TI(d,"int32")};var OC=Ov({nonMaxSuppressionWithScore_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=Fv(e,"boxes","nonMaxSuppression"),o=Fv(t,"scores","nonMaxSuppression"),l=SC(i,o,n,a,r,s);n=l.maxOutputSize,a=l.iouThreshold,r=l.scoreThreshold,s=l.softNmsSigma;let c={boxes:i,scores:o},u={maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:s},d=wv.runKernel(Bg,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}});var PC=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=Fv(e,"boxes","nonMaxSuppressionAsync"),o=Fv(t,"scores","nonMaxSuppressionAsync"),l=SC(i,o,n,a,r,s);n=l.maxOutputSize,a=l.iouThreshold,r=l.scoreThreshold,s=l.softNmsSigma;let c=await Promise.all([i.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:p,selectedScores:h}=_C(u,d,n,a,r,s);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:TI(p,"int32"),selectedScores:TI(h)}};var LC=Ov({nonMaxSuppressionPadded_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=Fv(e,"boxes","nonMaxSuppression"),o=Fv(t,"scores","nonMaxSuppression"),l=SC(i,o,n,a,r,null),c={boxes:i,scores:o},u={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:s},d=wv.runKernel(jg,c,u);return{selectedIndices:d[0],validOutputs:d[1]}}});var zC=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=Fv(e,"boxes","nonMaxSuppressionAsync"),o=Fv(t,"scores","nonMaxSuppressionAsync"),l=SC(i,o,n,a,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[p,h]=await Promise.all([i.data(),o.data()]),{selectedIndices:f,validOutputs:m}=EC(p,h,c,u,d,s);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:TI(f,"int32"),validOutputs:$k(m,"int32")}};var jC=Ov({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Fv(e,"images","resizeBilinear");Hh(3===r.rank||4===r.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got rank ".concat(r.rank,".")),Hh(2===t.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape ".concat(t,".")),Hh(!1===a||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=r,i=!1;3===r.rank&&(i=!0,s=Ww(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let[]=t,o={images:s},l={alignCorners:n,halfPixelCenters:a,size:t},c=wv.runKernel(sy,o,l);return i?Ww(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var BC=Ov({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Fv(e,"images","resizeNearestNeighbor");Hh(3===r.rank||4===r.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ".concat(r.rank,".")),Hh(2===t.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape ".concat(t,".")),Hh("float32"===r.dtype||"int32"===r.dtype,()=>"`images` must have `int32` or `float32` as dtype"),Hh(!1===a||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=r,i=!1;3===r.rank&&(i=!0,s=Ww(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let[]=t,o={images:s},l={alignCorners:n,halfPixelCenters:a,size:t},c=wv.runKernel(ay,o,l);return i?Ww(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var WC=Ov({threshold_:function(e){let t,n,a,r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,l=Fv(e,"image","threshold"),c=l.shape[0]*l.shape[1],u=pw(TI([o]),255);if(Hh(3===l.rank,()=>"Error in threshold: image must be rank 3,but got rank ".concat(l.rank,".")),Hh(3===l.shape[2]||1===l.shape[2],()=>"Error in threshold: image color channel must be equal to 3 or 1but got ".concat(l.shape[2],".")),Hh("int32"===l.dtype||"float32"===l.dtype,()=>"Error in dtype: image dtype must be int32 or float32,but got dtype ".concat(l.dtype,".")),Hh("otsu"===s||"binary"===s,()=>"Method must be binary or otsu, but was ".concat(s)),3===l.shape[2]){[t,n,a]=vI(l,[1,1,1],-1);let e=pw(t,.2989),s=pw(n,.587),i=pw(a,.114);r=cw(cw(e,s),i)}else r=e;if("otsu"===s){u=function(e,t){let n,a,r,s,i,o,l=TI([-1]),c=TI([0]),u=TI([0]);for(let d=0;d<e.size-1;d++){n=Kw(e,0,d+1),a=Kw(e,d+1),i=dw(nS(n),t),o=dw(nS(a),t);let p=nS(pw(n,KN(0,n.size)));r=dw(p,nS(n));let h=ok(a.shape,n.size),f=cw(KN(0,a.size),h),m=pw(a,f);s=dw(nS(m),nS(a));let g=PS(r,s),y=PS(r,s),b=pw(i,o);u=pw(pw(b,g),y);let v=hS(u,c);c=Mk(v,u,c),l=Mk(v,TI([d]),l)}return l}(nk(iw(aI(r),"int32"),zv([]),256),c)}let d=i?wS(r,u):hS(r,u);return iw(pw(d,255),"int32")}});var VC=Ov({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0,i=Fv(e,"image","transform","float32"),o=Fv(t,"transforms","transform","float32");Hh(4===i.rank,()=>"Error in transform: image must be rank 4,but got rank ".concat(i.rank,".")),Hh(2===o.rank&&(o.shape[0]===i.shape[0]||1===o.shape[0])&&8===o.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Hh(null==s||2===s.length,()=>"Error in transform: outputShape must be [height, width] or null, but got ".concat(s,"."));let l={image:i,transforms:o},c={interpolation:n,fillMode:a,fillValue:r,outputShape:s};return wv.runKernel(Hy,l,c)}});var UC=Ov({bandPart_:function(e,t,n){let a=Fv(e,"a","bandPart");Hh(a.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(a.rank,"."));let r,s,i=a.shape,[o,l]=a.shape.slice(-2);"number"==typeof t?(Hh(t%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(t,".")),Hh(t<=o,()=>"bandPart(): numLower (".concat(t,") must not be greater than the number of rows (").concat(o,").")),r=Fv(t<0?o:t,"numLower","bandPart")):(Hh("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),r=Mk(xS(t,0),o,eN(t,o))),"number"==typeof n?(Hh(n%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")),Hh(n<=l,()=>"bandPart(): numUpper (".concat(n,") must not be greater than the number of columns (").concat(l,").")),s=Fv(n<0?l:n,"numUpper","bandPart")):(Hh("int32"===n.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),s=Mk(xS(n,0),l,eN(n,l)));let c=Ww(KN(0,o,1,"int32"),[-1,1]),u=KN(0,l,1,"int32"),d=PS(c,u),p=jS(wS(d,r),fS(d,DS(s))),h=JS([o,l],a.dtype);return Ww(SI(VI(Ww(a,[-1,o,l])).map(e=>Mk(p,e,h))),i)}});var HC=Ov({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,Hh(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let n=e[0].shape[0];for(let t=1;t<e.length;++t)Hh(e[t].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: (".concat(e[t].shape[0]," vs. ").concat(n,")"))}else t=!0,e=vI(e,e.shape[0],0).map(e=>kI(e,[0]));Hh(e.length<=e[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds number of dimensions (").concat(e[0].shape[0],")."));let n=[],a=e;for(let r=0;r<e.length;++r)n.push(wv.tidy(()=>{let e=a[r];if(r>0)for(let t=0;t<r;++t){let a=pw(nS(pw(n[t],e)),n[t]);e=PS(e,a)}return dw(e,rS(e,"euclidean"))}));return t?SI(n,0):n}});function GC(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return wv.tidy(()=>{Hh(2===e.shape.length,()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));let n=e.shape[0],a=e.shape[1],r=uS(n),s=ow(e),i=EI([[1]],[1,1]),o=ow(i),l=n>=a?a:n;for(let e=0;e<l;++e){let t=s,l=o,c=r;[o,s,r]=wv.tidy(()=>{let t=Kw(s,[e,e],[n-e,1]),l=rS(t),c=Kw(s,[e,e],[1,1]),u=Mk(hS(c,0),EI([[-1]]),EI([[1]])),d=PS(c,pw(u,l)),p=dw(t,d);o=1===p.shape[0]?ow(i):Hw([i,Kw(p,[1,0],[p.shape[0]-1,p.shape[1]])],0);let h=DS(dw(Gw(u,d),l)),f=Kw(s,[e,0],[n-e,a]),m=pw(h,o),g=XI(o);if(0===e)s=PS(f,Gw(m,Gw(g,f)));else{let t=PS(f,Gw(m,Gw(g,f)));s=Hw([Kw(s,[0,0],[e,a]),t],0)}let y=XI(m),b=Kw(r,[0,e],[n,r.shape[1]-e]);if(0===e)r=PS(b,Gw(Gw(b,o),y));else{let t=PS(b,Gw(Gw(b,o),y));r=Hw([Kw(r,[0,0],[n,e]),t],1)}return[o,s,r]}),Qv([t,l,c])}return!t&&n>a&&(r=Kw(r,[0,0],[n,a]),s=Kw(s,[0,0],[a,a])),[r,s]})}var qC,KC=Ov({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Hh(e.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)),2===e.rank)return GC(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),a=VI(Ww(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],s=[];return a.forEach(e=>{let[n,a]=GC(e,t);r.push(n),s.push(a)}),[Ww(SI(r,0),e.shape),Ww(SI(s,0),e.shape)]}}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(qC||(qC={}));var XC=Ov({computeWeightedLoss_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qC.SUM_BY_NONZERO_WEIGHTS,a=Fv(e,"losses","computeWeightedLoss"),r=null;null!=t&&(r=Fv(t,"weights","computeWeightedLoss"));let s=null==r?a:pw(a,r);if(n===qC.NONE)return s;if(n===qC.SUM)return nS(s);if(n===qC.MEAN){if(null==r)return QS(s);{let e=a.size/r.size,t=dw(nS(s),nS(r));return e>1?dw(t,$k(e)):t}}if(n===qC.SUM_BY_NONZERO_WEIGHTS){if(null==r)return dw(nS(s),$k(a.size));{let e=pw(r,ZS(a.shape)),t=iw(nS(iN(e,$k(0))),"float32");return dw(nS(s),t)}}throw Error("Unknown reduction: ".concat(n))}});var YC=Ov({absoluteDifference_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qC.SUM_BY_NONZERO_WEIGHTS,r=Fv(e,"labels","absoluteDifference"),s=Fv(t,"predictions","absoluteDifference"),i=null;null!=n&&(i=Fv(n,"weights","absoluteDifference")),Gh(r.shape,s.shape,"Error in absoluteDifference: ");let o=hw(PS(r,s));return XC(o,i,a)}});var QC=Ov({cosineDistance_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qC.SUM_BY_NONZERO_WEIGHTS,s=Fv(e,"labels","cosineDistance"),i=Fv(t,"predictions","cosineDistance"),o=null;null!=a&&(o=Fv(a,"weights","cosineDistance")),Gh(s.shape,i.shape,"Error in cosineDistance: ");let l=$k(1),c=PS(l,nS(pw(s,i),n,!0));return XC(c,o,r)}});var JC=Ov({hingeLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qC.SUM_BY_NONZERO_WEIGHTS,r=Fv(e,"labels","hingeLoss"),s=Fv(t,"predictions","hingeLoss"),i=null;null!=n&&(i=Fv(n,"weights","hingeLoss")),Gh(r.shape,s.shape,"Error in hingeLoss: ");let o=$k(1);r=PS(pw($k(2),r),o);let l=QN(PS(o,pw(r,s)));return XC(l,i,a)}});var ZC=Ov({huberLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qC.SUM_BY_NONZERO_WEIGHTS,s=Fv(e,"labels","huberLoss"),i=Fv(t,"predictions","huberLoss"),o=null;null!=n&&(o=Fv(n,"weights","huberLoss")),Gh(s.shape,i.shape,"Error in huberLoss: ");let l=$k(a),c=hw(PS(i,s)),u=eN(c,l),d=PS(c,u),p=cw(pw($k(.5),tS(u)),pw(l,d));return XC(p,o,r)}});var $C=Ov({logLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qC.SUM_BY_NONZERO_WEIGHTS,s=Fv(e,"labels","logLoss"),i=Fv(t,"predictions","logLoss"),o=null;null!=n&&(o=Fv(n,"weights","logLoss")),Gh(s.shape,i.shape,"Error in logLoss: ");let l=$k(1),c=$k(a),u=DS(pw(s,NS(cw(i,c)))),d=pw(PS(l,s),NS(cw(PS(l,i),c))),p=PS(u,d);return XC(p,o,r)}});var eT=Ov({meanSquaredError_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qC.SUM_BY_NONZERO_WEIGHTS,r=Fv(e,"labels","meanSquaredError"),s=Fv(t,"predictions","meanSquaredError"),i=null;null!=n&&(i=Fv(n,"weights","meanSquaredError")),Gh(r.shape,s.shape,"Error in meanSquaredError: ");let o=wI(r,s);return XC(o,i,a)}});var tT=Ov({sigmoidCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qC.SUM_BY_NONZERO_WEIGHTS,s=Fv(e,"multiClassLabels","sigmoidCrossEntropy"),i=Fv(t,"logits","sigmoidCrossEntropy"),o=null;if(null!=n&&(o=Fv(n,"weights","sigmoidCrossEntropy")),Gh(s.shape,i.shape,"Error in sigmoidCrossEntropy: "),a>0){let e=$k(a),t=$k(1),n=$k(.5);s=cw(pw(s,PS(t,e)),pw(n,e))}let l=function(e,t){let n=Fv(e,"labels","sigmoidCrossEntropyWithLogits"),a=Fv(t,"logits","sigmoidCrossEntropyWithLogits");Gh(n.shape,a.shape,"Error in sigmoidCrossEntropyWithLogits: ");let r=QN(a),s=pw(a,n),i=IS(iS(DS(hw(a))));return cw(PS(r,s),i)}(s,i);return XC(l,o,r)}});var nT=Ov({softmaxCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qC.SUM_BY_NONZERO_WEIGHTS,s=Fv(e,"onehotLabels","softmaxCrossEntropy"),i=Fv(t,"logits","softmaxCrossEntropy"),o=null;if(null!=n&&(o=Fv(n,"weights","softmaxCrossEntropy")),Gh(s.shape,i.shape,"Error in softmaxCrossEntropy: "),a>0){let e=$k(a),t=$k(1),n=$k(s.shape[1]);s=cw(pw(s,PS(t,e)),dw(e,n))}let l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ".concat(t.rank," and dim was ").concat(n));return RS((e,t,a)=>{let r=zS(t,[n],!0),s=PS(iw(t,"float32"),r);a([e,s]);let i=DS(pw(s,e));return{value:nS(i,[n]),gradFunc:(e,t)=>{let[a,r]=t,s=Gk(e.shape,[n]);return[pw(Ww(e,s),PS(iw(a,"float32"),iS(r))),pw(Ww(e,s),PS(iS(r),iw(a,"float32")))]}}})(e,t)}(s,i);return XC(l,o,r)}});var aT=Ov({sparseFillEmptyRows_:function(e,t,n,a){let r=Fv(e,"indices","sparseFillEmptyRows","int32"),s=Fv(t,"values","sparseFillEmptyRows"),i=Fv(n,"denseShape","sparseFillEmptyRows","int32"),o=Fv(a,"defaultValue","sparseFillEmptyRows",s.dtype);if(2!==r.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==s.rank)throw new Error("Values should be Tensor1D but received shape ".concat(s.shape));if(1!==i.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(i.shape));if(0!==o.rank)throw new Error("Default value should be a scalar but received shape ".concat(o.shape));let l={indices:r,values:s,denseShape:i,defaultValue:o},c=wv.runKernel(Ty,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});var rT=Ov({sparseReshape_:function(e,t,n){let a=Fv(e,"inputIndices","sparseReshape","int32"),r=Fv(t,"inputShape","sparseReshape","int32"),s=Fv(n,"newShape","sparseReshape","int32");if(2!==a.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==r.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(r.shape));if(1!==s.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(s.shape));let i={inputIndices:a,inputShape:r,newShape:s},o=wv.runKernel(Ey,i);return{outputIndices:o[0],outputShape:o[1]}}});var sT=Ov({sparseSegmentMean_:function(e,t,n){let a=Fv(e,"data","sparseSegmentMean"),r=Fv(t,"indices","sparseSegmentMean","int32"),s=Fv(n,"segmentIds","sparseSegmentMean","int32");if(a.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(r.shape));if(1!==s.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(s.shape));let i={data:a,indices:r,segmentIds:s};return wv.runKernel(_y,i)}});var iT=Ov({sparseSegmentSum_:function(e,t,n){let a=Fv(e,"data","sparseSegmentSum"),r=Fv(t,"indices","sparseSegmentSum","int32"),s=Fv(n,"segmentIds","sparseSegmentSum","int32");if(a.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(r.shape));if(1!==s.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(s.shape));let i={data:a,indices:r,segmentIds:s};return wv.runKernel(Ay,i)}});var oT=Ov({stringNGrams_:function(e,t,n,a,r,s,i,o){let l=Fv(e,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error("Data must be a vector, saw: ".concat(l.shape));let c=Fv(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");let u={separator:n,nGramWidths:a,leftPad:r,rightPad:s,padWidth:i,preserveShortSequences:o},d={data:l,dataSplits:c},p=wv.runKernel(Py,d,u);return{nGrams:p[0],nGramsSplits:p[1]}}});var lT=Ov({stringSplit_:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Fv(e,"input","stringSplit","string"),r=Fv(t,"delimiter","stringSplit","string");if(1!==a.rank)throw new Error("Input should be Tensor1D but received shape ".concat(a.shape));if(0!==r.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(r.shape));let s={skipEmpty:n},i={input:a,delimiter:r},o=wv.runKernel(Ly,i,s);return{indices:o[0],values:o[1],shape:o[2]}}});var cT=Ov({stringToHashBucketFast_:function(e,t){let n=Fv(e,"input","stringToHashBucketFast","string"),a={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let r={input:n};return wv.runKernel(zy,r,a)}});var uT=Ov({staticRegexReplace_:function(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=Fv(e,"input","staticRegexReplace","string"),s={pattern:t,rewrite:n,replaceGlobal:a};return wv.runKernel(My,{x:r},s)}}),dT={fft:gI,ifft:yI,rfft:xI,irfft:bI},pT={hammingWindow:fC,hannWindow:mC,frame:gC,stft:yC},hT={flipLeftRight:vC,grayscaleToRGB:xC,resizeNearestNeighbor:BC,resizeBilinear:jC,rgbToGrayscale:wC,rotateWithOffset:kC,cropAndResize:bC,nonMaxSuppression:NC,nonMaxSuppressionAsync:MC,nonMaxSuppressionWithScore:OC,nonMaxSuppressionWithScoreAsync:PC,nonMaxSuppressionPadded:LC,nonMaxSuppressionPaddedAsync:zC,threshold:WC,transform:VC},fT={bandPart:UC,gramSchmidt:HC,qr:KC},mT={absoluteDifference:YC,computeWeightedLoss:XC,cosineDistance:QC,hingeLoss:JC,huberLoss:ZC,logLoss:$C,meanSquaredError:eT,sigmoidCrossEntropy:tT,softmaxCrossEntropy:nT},gT={sparseFillEmptyRows:aT,sparseReshape:rT,sparseSegmentMean:sT,sparseSegmentSum:iT},yT={stringNGrams:oT,stringSplit:lT,stringToHashBucketFast:cT,staticRegexReplace:uT},bT={};uh(bT,{Serializable:()=>wT,SerializationMap:()=>kT,getRegisteredName:()=>NT,registerClass:()=>ST});var vT=new Map,xT=new Map,wT=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},kT=class e{constructor(){this.classNameMap={}}static getMap(){return null==e.instance&&(e.instance=new e),e.instance}static register(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}};function ST(e,t,n){Hh(null!=e.className,()=>"Class being registered does not have the static className property defined."),Hh("string"==typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),Hh(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),"undefined"==typeof t&&(t="Custom"),"undefined"==typeof n&&(n=e.className);let a=t+">"+n;return kT.register(e),vT.set(a,e),xT.set(e,a),e}function NT(e){return xT.has(e)?xT.get(e):e.className}var IT=class extends wT{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,{value:a,grads:r}=this.computeGradients(e,n);if(null!=n){let e=n.map(e=>({name:e.name,tensor:r[e.name]}));this.applyGradients(e)}else this.applyGradients(r);return Qv(r),t?a:(a.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return AS(e,t)}dispose(){null!=this.iterations_&&Qv(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:$k(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class ".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(IT,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});var CT=class extends IT{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=wv.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=wv.registeredVariables[t],r=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:Yv(()=>Ok(a).variable(r))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:Yv(()=>Ok(a).variable(r))});let s=Array.isArray(e)?e[n].tensor:e[t];if(null==s)return;let i=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;Yv(()=>{let e=cw(pw(i,this.rho),pw(tS(s),1-this.rho)),t=pw(dw(eS(cw(o,this.epsilon)),eS(cw(i,this.epsilon))),s),n=cw(pw(o,this.rho),pw(tS(t),1-this.rho));i.assign(e),o.assign(n);let r=cw(pw(t,-this.learningRate),a);a.assign(r)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Qv(this.accumulatedGrads.map(e=>e.variable)),Qv(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){let t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},TT=class extends IT{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=wv.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:Yv(()=>ok(a.shape,this.initialAccumulatorValue).variable(!1))});let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let s=this.accumulatedGrads[n].variable;Yv(()=>{let e=cw(s,tS(r));s.assign(e);let t=cw(pw(dw(r,eS(cw(e,wv.backend.epsilon()))),-this.learningRate),a);a.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Qv(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},ET=class extends IT{static get className(){return"Adam"}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Yv(()=>{this.accBeta1=$k(t).variable(),this.accBeta2=$k(n).variable()}),null==a&&(this.epsilon=wv.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);Yv(()=>{let n=PS(1,this.accBeta1),a=PS(1,this.accBeta2);t.forEach((t,r)=>{let s=wv.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(t,"/m"),variable:Yv(()=>Ok(s).variable(i))}),null==this.accumulatedSecondMoment[r]&&(this.accumulatedSecondMoment[r]={originalName:"".concat(t,"/v"),variable:Yv(()=>Ok(s).variable(i))});let o=Array.isArray(e)?e[r].tensor:e[t];if(null==o)return;let l=this.accumulatedFirstMoment[r].variable,c=this.accumulatedSecondMoment[r].variable,u=cw(pw(l,this.beta1),pw(o,1-this.beta1)),d=cw(pw(c,this.beta2),pw(tS(o),1-this.beta2)),p=dw(u,n),h=dw(d,a);l.assign(u),c.assign(d);let f=cw(pw(dw(p,cw(eS(h),this.epsilon)),-this.learningRate),s);s.assign(f)}),this.accBeta1.assign(pw(this.accBeta1,this.beta1)),this.accBeta2.assign(pw(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Qv(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&Qv(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),Yv(()=>{this.accBeta1.assign(Zk(this.beta1,this.iterations_+1)),this.accBeta2.assign(Zk(this.beta2,this.iterations_+1))});let t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},_T=class extends IT{static get className(){return"Adamax"}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Yv(()=>{this.iteration=$k(0).variable(),this.accBeta1=$k(t).variable()}),null==a&&(this.epsilon=wv.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);Yv(()=>{let n=PS(1,this.accBeta1),a=dw(-this.learningRate,cw(pw(this.iteration,this.decay),1));t.forEach((t,r)=>{let s=wv.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(t,"/m"),variable:Ok(s).variable(i)}),null==this.accumulatedWeightedInfNorm[r]&&(this.accumulatedWeightedInfNorm[r]={originalName:"".concat(t,"/v"),variable:Ok(s).variable(i)});let o=Array.isArray(e)?e[r].tensor:e[t];if(null==o)return;let l=this.accumulatedFirstMoment[r].variable,c=this.accumulatedWeightedInfNorm[r].variable,u=cw(pw(l,this.beta1),pw(o,1-this.beta1)),d=pw(c,this.beta2),p=hw(o),h=YS(d,p);l.assign(u),c.assign(h);let f=cw(pw(dw(a,n),dw(u,cw(h,this.epsilon))),s);s.assign(f)}),this.iteration.assign(cw(this.iteration,1)),this.accBeta1.assign(pw(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Qv(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&Qv(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},AT=class extends IT{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let r=wv.registeredVariables[t];Yv(()=>{let e=cw(pw(this.c,a),r);r.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Jv($k(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},RT=class extends AT{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=$k(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=wv.registeredVariables[t];null==this.accumulations[n]&&(this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:Yv(()=>Ok(a).variable(!1))});let r=this.accumulations[n].variable,s=Array.isArray(e)?e[n].tensor:e[t];null!=s&&Yv(()=>{let e,t=cw(pw(this.m,r),s);e=this.useNesterov?cw(pw(this.c,cw(s,pw(t,this.m))),a):cw(pw(this.c,t),a),r.assign(t),a.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Qv(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},FT=class extends IT{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,null==a&&(this.epsilon=wv.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=wv.registeredVariables[t],r=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:Yv(()=>Ok(a).variable(r))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:Yv(()=>Ok(a).variable(r))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:Yv(()=>Ok(a).variable(r))});let s=Array.isArray(e)?e[n].tensor:e[t];if(null==s)return;let i=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;Yv(()=>{let e=cw(pw(i,this.decay),pw(tS(s),1-this.decay));if(this.centered){let t=this.accumulatedMeanGrads[n].variable,r=cw(pw(t,this.decay),pw(s,1-this.decay)),l=dw(pw(s,this.learningRate),eS(PS(e,cw(tS(r),this.epsilon)))),c=cw(pw(o,this.momentum),l);i.assign(e),t.assign(r),o.assign(c);let u=PS(a,c);a.assign(u)}else{let e=cw(pw(i,this.decay),pw(tS(s),1-this.decay)),t=cw(pw(o,this.momentum),dw(pw(s,this.learningRate),eS(cw(e,this.epsilon))));i.assign(e),o.assign(t);let n=PS(a,t);a.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Qv(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&Qv(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&Qv(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},DT=[CT,TT,ET,_T,RT,FT,AT];var MT={};uh(MT,{CompositeArrayBuffer:()=>Bv,browserFiles:()=>zT,browserHTTPRequest:()=>KT,concatenateArrayBuffers:()=>bx,copyModel:()=>tw,decodeWeights:()=>cx,decodeWeightsStream:()=>fx,encodeWeights:()=>lx,fromMemory:()=>JT,fromMemorySync:()=>ZT,getLoadHandlers:()=>_x,getModelArtifactsForJSON:()=>kx,getModelArtifactsForJSONSync:()=>wx,getModelArtifactsInfoForJSON:()=>Sx,getSaveHandlers:()=>Ex,getWeightSpecs:()=>Nx,http:()=>qT,isHTTPScheme:()=>HT,listModels:()=>$x,loadWeights:()=>WT,moveModel:()=>nw,registerLoadRouter:()=>Tx,registerSaveRouter:()=>Cx,removeModel:()=>ew,weightsLoaderFactory:()=>VT,withSaveHandler:()=>$T,withSaveHandlerSync:()=>eE});function OT(e){return new Promise(e=>setTimeout(e)).then(e)}var PT=class e{constructor(t){if(!Mf().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),(null==t||0===t.length)&&(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(e){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");let t=Bv.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let t=xx(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),a=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),r=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(r.download=this.modelJsonFileName,r.href=a,await OT(()=>r.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){let e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await OT(()=>e.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Sx(e)}}}};PT.URL_SCHEME="downloads://";var LT=class{constructor(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=n=>{let a=JSON.parse(n.target.result),r=a.modelTopology;if(null==r)return void t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==a.weightsManifest)return void t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void e({modelTopology:r});let s=kx(a,e=>this.loadWeights(e));e(s)},n.onerror=e=>t("Failed to read model topology and weights manifest JSON from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let s of e)t.push(...s.weights),n.push(...s.paths);let a=this.checkManifestAndWeightFiles(e),r=n.map(e=>this.loadWeightsFile(e,a[e]));return Promise.all(r).then(e=>[t,e])}loadWeightsFile(e,t){return new Promise((n,a)=>{let r=new FileReader;r.onload=e=>{let t=e.target.result;n(t)},r.onerror=t=>a("Failed to weights data from file of path '".concat(e,"'.")),r.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(e=>vx(e.name)),a={};for(let r of e)r.paths.forEach(e=>{let r=vx(e);if(-1!==t.indexOf(r))throw new Error("Duplicate file basename found in weights manifest: '".concat(r,"'"));if(t.push(r),-1===n.indexOf(r))throw new Error("Weight file with basename '".concat(r,"' is not provided."));a[e]=this.weightsFiles[n.indexOf(r)]});if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest (".concat(t.length,") and the number of weight files provided (").concat(this.weightsFiles.length,")."));return a}};function zT(e){return new LT(e)}function jT(e,t,n,a){var r;Hh(null!=(r=e)&&Array.isArray(r)&&r.length>0,()=>"promises must be a none empty array"),function(e,t){Hh(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction ".concat(e)),Hh(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction ".concat(t)),Hh(t>=e,()=>"startFraction must be no more than endFraction, but got startFraction ".concat(e," and endFraction ").concat(t))}(n=null==n?0:n,a=null==a?1:a);let s=0;return Promise.all(e.map(r=>(r.then(r=>{let i=n+ ++s/e.length*(a-n);return t(i),r}),r)))}async function BT(e,t){null==t&&(t={});let n=null==t.fetchFunc?Mf().platform.fetch:t.fetchFunc,a=e.map(e=>n(e,t.requestInit,{isBinary:!0})),r=(null==t.onProgress?await Promise.all(a):await jT(a,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return null==t.onProgress?await Promise.all(r):await jT(r,t.onProgress,.5,1)}async function WT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return VT(e=>BT(e,{requestInit:a}))(e,t,n)}function VT(e){return async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0,r=t.map(()=>!1),s={},i=null!=a?a.map(()=>!1):[],o=[];if(t.forEach((e,t)=>{let n=0;e.weights.forEach(e=>{let l="quantization"in e?e.quantization.dtype:e.dtype,c=jv[l]*Kh(e.shape),u=()=>{r[t]=!0,null==s[t]&&(s[t]=[]),s[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((t,n)=>{t===e.name&&(u(),i[n]=!0)}):u(),o.push(e.name),n+=c})}),!i.every(e=>e)){let e=a.filter((e,t)=>!i[t]);throw new Error("Could not find weights in manifest with names: ".concat(e.join(", "),". \nManifest JSON has weights with names: ").concat(o.join(", "),"."))}let l=r.reduce((e,t,n)=>(t&&e.push(n),e),[]),c=[];l.forEach(e=>{t[e].paths.forEach(e=>{let t=n+(n.endsWith("/")?"":"/")+e;c.push(t)})});let u=await e(c),d={},p=0;return l.forEach(e=>{let n=t[e].paths.length,a=new Bv(u.slice(p,p+n));s[e].forEach(e=>{let t=cx(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(let n in t)d[n]=t[n]}),p+=n}),d}}Ix.registerSaveRouter(e=>Mf().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(PT.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new PT(e)}(e.slice(PT.URL_SCHEME.length)):null);var UT=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(Hh("function"==typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Mf().platform.fetch,Hh(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Hh(2===e.length,()=>"URL paths for http must have a length of 2, (actual length is ".concat(e.length,").")),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=xx(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){let n=Bv.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}let a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:Sx(e),responses:[a]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status ".concat(a.status,"."))}async loadModelJSON(){let e,t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ").concat(t.status,". Please verify this URL points to the model JSON of the model to load."));try{e=await t.json()}catch($t){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}let n=e.modelTopology,a=e.weightsManifest;if(null==n&&null==a)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model topology or manifest for weights."));return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return kx(await this.loadModelJSON(),e=>this.loadWeights(e))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=Nx(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;let a,r=null==t.fetchFunc?Mf().platform.fetch:t.fetchFunc,s=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var i;s<e.length;){a||(a=(await r(e[s],t.requestInit,{isBinary:!0})).body.getReader());let{done:o,value:l}=await a.read();if(!o)return void n.enqueue(l);s++,a=void 0,null===(i=t.onProgress)||void 0===i||i.call(t,s/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,a]=function(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),a=e.substring(0,t),r=n>t?e.substring(n):"";return[a+"/",r]}(t),r=this.weightPathPrefix||n,s=[],i=[];for(let o of e)for(let e of o.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):s.push(r+e+a);return this.weightUrlConverter&&s.push(...await Promise.all(i)),s}async loadWeights(e){let t=await this.getWeightUrls(e);return[Nx(e),await BT(t,this.loadOptions)]}};function HT(e){return null!=e.match(UT.URL_SCHEME_REGEX)}UT.URL_SCHEME_REGEX=/^https?:\/\//;var GT=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every(e=>HT(e)):HT(e),n)return qT(e,t)}return null};function qT(e,t){return new UT(e,t)}function KT(e,t){return qT(e,t)}Ix.registerSaveRouter(GT),Ix.registerLoadRouter(GT);var XT=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},YT=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},QT=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function JT(e,t,n,a){return new QT(ZT(...arguments))}function ZT(e,t,n,a){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new XT(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new XT({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new XT({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:a}))}function $T(e){return new YT(e)}function eE(e){return new YT(e)}var tE={};uh(tE,{confusionMatrix:()=>nE});var nE=Ov({confusionMatrix_:function(e,t,n){let a=Fv(e,"labels","confusionMatrix"),r=Fv(t,"predictions","confusionMatrix");Hh(null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, but got ".concat(n)),Hh(1===a.rank,()=>"Expected the rank of labels to be 1, but got ".concat(a.rank)),Hh(1===r.rank,()=>"Expected the rank of predictions to be 1, but got ".concat(r.rank)),Hh(a.shape[0]===r.shape[0],()=>"Mismatch in the number of examples: ".concat(a.shape[0]," vs. ").concat(r.shape[0],". Labels and predictions should have the same number of elements.")),Hh(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got ".concat(n));let s=oN(iw(a,"int32"),n),i=oN(iw(r,"int32"),n),o=XI(s),l=Gw(o,i);return iw(l,"int32")}}),aE={};uh(aE,{draw:()=>dE,fromPixels:()=>pE,fromPixelsAsync:()=>lE,toPixels:()=>uE});var rE,sE=!1;function iE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,a=!1,r=!1,s=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)a=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)r=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)s=!0;else if(null!=e.getContext)i=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ".concat(e.constructor.name));o=!0}if(null!=ob(Zy,wv.backendName)){let n={pixels:e},a={numChannels:t};return wv.runKernel(Zy,n,a)}let l,c,[u,d]=r?[e.videoWidth,e.videoHeight]:[e.width,e.height];if(i)l=e.getContext("2d").getImageData(0,0,u,d).data;else if(a||n)l=e.data;else if(s||r||o){if(null==rE)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");rE=new OffscreenCanvas(1,1).getContext("2d")}else rE=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});rE.canvas.width=u,rE.canvas.height=d,rE.drawImage(e,0,0,u,d),l=rE.getImageData(0,0,u,d).data}if(4===t)c=new Int32Array(l);else{let e=u*d;c=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)c[n*t+e]=l[4*n+e]}return _I(c,[d,u,t],"int32")}function oE(e){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}async function lE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=null;if(Mf().getBool("WRAP_TO_IMAGEBITMAP")&&oE(e)){let t;try{t=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch($t){t=null}n=null!=t&&t.width===e.width&&t.height===e.height?t:e}else n=e;return iE(n,t)}function cE(e){if(2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));let t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got ".concat(t));if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error("Unsupported type for toPixels: ".concat(e.dtype,". Please use float32 or int32 tensors."))}async function uE(e,t){let n=Fv(e,"img","toPixels");if(!(e instanceof Jb)){let e=n;n=iw(e,"int32"),e.dispose()}cE(n);let[a,r]=n.shape.slice(0,2),s=2===n.rank?1:n.shape[2],i=await n.data(),o="float32"===n.dtype?255:1,l=new Uint8ClampedArray(r*a*4);for(let c=0;c<a*r;++c){let e=[0,0,0,255];for(let a=0;a<s;a++){let t=i[c*s+a];if("float32"===n.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===n.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ".concat(t,"."));1===s?(e[0]=t*o,e[1]=t*o,e[2]=t*o):e[a]=t*o}let t=4*c;l[t+0]=Math.round(e[0]),l[t+1]=Math.round(e[1]),l[t+2]=Math.round(e[2]),l[t+3]=Math.round(e[3])}if(null!=t){sE||null!=ob(Om,wv.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),sE=!0),t.width=r,t.height=a;let e=t.getContext("2d"),n=new ImageData(l,r,a);e.putImageData(n,0,0)}return n!==e&&n.dispose(),l}function dE(e,t,n){let a=Fv(e,"img","draw");if(!(e instanceof Jb)){let e=a;a=iw(e,"int32"),e.dispose()}cE(a),function(e){let t=(null==e?void 0:e.alpha)||1;if(t>1||t<0)throw new Error("Alpha value ".concat(t," is suppoed to be in range [0 - 1]."))}(null==n?void 0:n.imageOptions);let r={image:a},s={canvas:t,options:n};wv.runKernel(Om,r,s)}var pE=Ov({fromPixels_:iE}),hE={};function fE(e,t){let n=e.shape.length,a=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was ".concat(n,"."));if(a<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ".concat(a,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was ".concat(t.dtype,"."));if(t.shape[a-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: ".concat(t.shape[a-1]," vs. ").concat(n));if(0===Kh(e.shape))throw new Error("Requested more than 0 entries, but input is empty. Input shape: ".concat(e.shape,"."));let r=t.shape,s=r[r.length-1],i=1;for(let d=0;d<r.length-1;++d)i*=r[d];let o=e.shape,l=r.slice();l.pop();let c=1;for(let d=s;d<n;++d)c*=o[d],l.push(o[d]);let u=[...xf(e.shape).map(e=>e/c),1].slice(0,s);return[l,i,c,u]}uh(hE,{prepareAndValidate:()=>fE});var mE={};uh(mE,{assertParamsValid:()=>bE,computeFlatOffset:()=>RE,computeOutShape:()=>xE,getNormalizedAxes:()=>NE,isSliceContinous:()=>AE,maskToAxes:()=>vE,parseSliceParams:()=>FE,sliceInfo:()=>DE,startForAxis:()=>EE,startIndicesWithElidedDims:()=>IE,stopForAxis:()=>_E,stopIndicesWithElidedDims:()=>CE,stridesForAxis:()=>TE,stridesWithElidedDims:()=>wE});var gE=-2,yE=-1;function bE(e,t,n){let a=e.shape.length;Hh(a===t.length,()=>"Error in slice".concat(a,"D: Length of begin ").concat(t," must match the rank of the array (").concat(a,").")),Hh(a===n.length,()=>"Error in slice".concat(a,"D: Length of size ").concat(n," must match the rank of the array (").concat(a,")."));for(let r=0;r<a;++r)Hh(t[r]+n[r]<=e.shape[r],()=>"Error in slice".concat(a,"D: begin[").concat(r,"] + size[").concat(r,"] (").concat(t[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(e.shape[r],")"))}function vE(e){let t=[],n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function xE(e,t,n){let a=[];for(let r=0;r<e.length;r++)a[r]=Math.ceil((t[r]-e[r])/n[r]);return a}function wE(e,t,n,a){let r=[...e];for(let s=r.length;s<a.length;s++)r.push(1);for(let s=0;s<n;s++)0===s?r[t]=1:(r.splice(t,0,1),r.pop());return r}function kE(e,t,n){return n<=e?n:n-(t-1)}function SE(e,t){let n=[];for(let a=0;a<e;a++)n.push(t+a);return n}function NE(e,t,n,a,r,s,i,o,l){let c=e.length,u=new Array(c),d=new Array(c),p=new Array(c);if(t.length&&n>0){let l=t[0],c=n+1;u=IE(i,l,c,a,e),d=CE(o,l,c,r,e),p=wE(s,l,c,e)}else for(let h=0;h<c;h++)u[h]=EE(i,a,s,e,h,l),d[h]=_E(o,r,s,e,h,l),p[h]=TE(s,h,l);return{begin:u,end:d,strides:p}}function IE(e,t,n,a,r){let s=[...r],i=SE(n,t);for(let o=0;o<s.length;o++)if(i.indexOf(o)>-1)s[o]=0;else{let r=kE(t,n,o),i=a[r];e&1<<r&&(i=0),s[o]=i}return s}function CE(e,t,n,a,r){let s=[...r],i=SE(n,t);for(let o=0;o<s.length;o++)if(i.indexOf(o)>-1)s[o]=Number.MAX_SAFE_INTEGER;else{let r=kE(t,n,o),i=a[r];e&1<<r&&(i=Number.MAX_SAFE_INTEGER),s[o]=i}for(let o=0;o<s.length;o++){let e=r[o];s[o]<0&&(s[o]+=e),s[o]=zh(0,s[o],r[o])}return s}function TE(e,t,n){let a=e[t];return(n&1<<t||null==a)&&(a=1),a}function EE(e,t,n,a,r,s){let i=t[r],o=n[r]||1;(e&1<<r||s&1<<r||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);let l=a[r];return i<0&&(i+=l),i=zh(0,i,l-1),i}function _E(e,t,n,a,r,s){let i=t[r],o=n[r]||1;(e&1<<r||s&1<<r||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);let l=a[r];return i<0&&(i+=l),i=o>0?zh(0,i,l):zh(-1,i,l-1),i}function AE(e,t,n){let a=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){a=r;break}for(let r=a+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function RE(e,t){let n=e.length>0?e[e.length-1]:1;for(let a=0;a<e.length-1;a++)n+=e[a]*t[a];return n}function FE(e,t,n){let a,r,s=e.shape.length;return a="number"==typeof t?[t,...new Array(s-1).fill(0)]:t.length<s?t.concat(new Array(s-t.length).fill(0)):t.slice(),a.forEach(e=>{Hh(-1!==e,()=>"slice() does not support negative begin indexing.")}),r=null==n?new Array(s).fill(-1):"number"==typeof n?[n,...new Array(s-1).fill(-1)]:n.length<s?n.concat(new Array(s-n.length).fill(-1)):n,r=r.map((t,n)=>t>=0?t:(Hh(-1===t,()=>"Negative size values should be exactly -1 but got ".concat(t," for the slice() size at index ").concat(n,".")),e.shape[n]-a[n])),[a,r]}function DE(e,t,n,a,r,s,i,o,l){let c;if(null==a?(c=new Array(t.length),c.fill(1)):c=a,null!=i&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1,d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:s,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&o&&d.numAddAxisAfterEllipsis++,1<<b&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let a=0;a<e.dims;a++)if(1<<a&e.ellipsisMask){let r=Math.min(t.dims-(e.dims-a)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<r;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=a}else if(1<<a&e.newAxisMask)t.finalShapeGatherIndices.push(gE),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input has only ").concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[a]),null!=e.end&&(t.end[n]=e.end[a]),t.strides[n]=e.strides[a],e.beginMask&1<<a&&(t.beginMask|=1<<n),e.endMask&1<<a&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<a?(t.finalShapeGatherIndices.push(yE),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(a)),t.inputShapeGatherIndicesSparse[n]=a,n++}}(d,p);let h=!0,f=!0,m=!0,g=[],y=[];for(let b=0;b<e.length;++b){if(0===p.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));let t=!!(p.shrinkAxisMask&1<<b),n=e[b];if(-1===n){g.push(t?1:-1);continue}let a=[p.beginMask&1<<b,p.endMask&1<<b],r=[p.strides[b]>0?0:-1,p.strides[b]>0?n:n-1];if(t&&p.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===p.strides[b];let s=!!(p.beginMask&1<<b&&p.endMask&1<<b);if(p.beginValid&&p.endValid){if(t){let e=p.begin[b]<0?n+p.begin[b]:p.begin[b];if(p.begin[b]=e,p.end[b]=p.begin[b]+1,e<0||e>=n)throw Error("slice index ".concat(p.begin[b]," of dimension ").concat(b," out of bounds."))}else p.begin[b]=ME(p.begin[b],0,p.strides[b],n,a,r),p.end[b]=ME(p.end[b],1,p.strides[b],n,a,r);let e=1===p.strides[b]&&0===p.begin[b]&&p.end[b]===n;h=h&&e,f=f&&(0===b&&1===p.strides[b]||e)}else h=h&&1===p.strides[b]&&s,f=f&&(0===b&&1===p.strides[b]||s);let i,o=!1;if(p.beginValid&&p.endValid?(i=p.end[b]-p.begin[b],o=!0):t?(i=1,o=!0):s&&n>=0&&(i=p.strides[b]<0?-n:n,o=!0),o){let e;e=0===i||i<0!=p.strides[b]<0?0:Math.trunc(i/p.strides[b])+(i%p.strides[b]!==0?1:0),g.push(e)}else g.push(-1)}for(let b=0;b<p.finalShapeGatherIndices.length;++b){let e=p.finalShapeGatherIndices[b];e>=0?y.push(g[e]):e===gE&&y.push(1)}return{finalShapeSparse:y.filter((e,t)=>p.finalShapeGatherIndices[t]!==gE),finalShape:y,isIdentity:h,sliceDim0:f,isSimpleSlice:m,begin:p.begin,end:p.end,strides:p.strides}}function ME(e,t,n,a,r,s){if(r[t])return n>0?s[t]:s[t+1&1];{let t=e<0?a+e:e;return t<s[0]?s[0]:t>s[1]?s[1]:t}}var OE="4.22.0",PE=class{static sgd(e){return new AT(e)}static momentum(e,t){return new RT(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new FT(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new ET(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new CT(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new _T(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new TT(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}},LE=PE,zE="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function jE(){return new Promise(e=>zE(()=>e()))}var BE,WE={};function VE(e,t){let n=e[0].length;e.forEach((e,t)=>{Hh(e.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same as the rank of the rest (").concat(n,")"))}),Hh(t>=0&&t<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));let a=e[0];e.forEach((e,r)=>{for(let s=0;s<n;s++)Hh(s===t||e[s]===a[s],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(r,"] (").concat(e,") does not match the shape of the rest (").concat(a,") along the non-concatenated axis ").concat(r,"."))})}function UE(e,t){let n=e[0].slice();for(let a=1;a<e.length;a++)n[t]+=e[a][t];return n}function HE(e,t,n){let a=new Array;if(null==n&&null==t)return a;if(null==t)for(;a.length<e+n.length;)a.push(-1);else a=t.slice();if(null==n)return a;if(e+n.length!==a.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(a.length));for(let r=1;r<n.length;++r){let s=n[r],i=a[a.length-n.length+r],o=a[i];if(s>=0)if(o>=0){if(o!==s)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(r+e,"] = ").concat(s," but shape[").concat(r+e,"] = ").concat(o))}else a[i]=s}return a}function GE(e){let t={FIRST_DIM_SIZE:BE.FIRST_DIM_SIZE,VALUE_ROWIDS:BE.VALUE_ROWIDS,ROW_LENGTHS:BE.ROW_LENGTHS,ROW_SPLITS:BE.ROW_SPLITS,ROW_LIMITS:BE.ROW_LIMITS,ROW_STARTS:BE.ROW_STARTS},n=[];for(let a of e){if(!(a in t))break;n.push(t[a])}return n}function qE(e){return 0===e.length?0:e[0]===BE.FIRST_DIM_SIZE?e.length-1:e.length}function KE(e,t){if(null==e||null==t)return;let n=e.length,a=t.length;if(n>=a)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(a,")"));for(let r=0;r<Math.min(n,a-1);++r){let n=e[r],a=t[r+1];if(n>=0&&a>=0&&1!==n&&n!==a)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(r-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(r-e.length,"] = ").concat(a))}}uh(WE,{ERF_A1:()=>s_,ERF_A2:()=>i_,ERF_A3:()=>o_,ERF_A4:()=>l_,ERF_A5:()=>c_,ERF_P:()=>r_,PARALLELIZE_THRESHOLD:()=>XE,RowPartitionType:()=>BE,SELU_SCALE:()=>a_,SELU_SCALEALPHA:()=>n_,applyActivation:()=>oC,assertAndGetBroadcastShape:()=>Fk,assertAxesAreInnerMostDims:()=>qk,assertParamsConsistent:()=>VE,assignToTypedArray:()=>m_,axesAreInnerMostDims:()=>Vk,calculateShapes:()=>PI,checkEinsumDimSizes:()=>N_,checkPadOnDimRoundingMode:()=>Bw,combineLocations:()=>Uk,combineRaggedTensorToTensorShapes:()=>HE,complexWithEvenIndex:()=>p_,complexWithOddIndex:()=>h_,computeConv2DInfo:()=>_w,computeConv3DInfo:()=>Aw,computeDefaultPad:()=>Rw,computeDilation2DInfo:()=>Cw,computeOptimalWindowSize:()=>YE,computeOutAndReduceShapes:()=>Hk,computeOutShape:()=>UE,computePool2DInfo:()=>Tw,computePool3DInfo:()=>Ew,convertConv2DDataFormat:()=>jw,decodeEinsumEquation:()=>k_,eitherStridesOrDilationsAreOne:()=>Lw,expandShapeToKeepDim:()=>Gk,exponent:()=>y_,exponents:()=>g_,fromStringArrayToUint8:()=>q_,fromUint8ToStringArray:()=>G_,getAxesPermutation:()=>Kk,getBroadcastDims:()=>Ak,getComplexWithIndex:()=>f_,getEinsumComputePath:()=>I_,getEinsumPermutation:()=>S_,getFusedBiasGradient:()=>iC,getFusedDyActivation:()=>sC,getImageCenter:()=>QE,getInnerMostAxes:()=>Yk,getPermuted:()=>ZE,getRaggedRank:()=>qE,getReductionAxes:()=>Rk,getReshaped:()=>JE,getReshapedPermuted:()=>$E,getRowPartitionTypesHelper:()=>GE,getSliceBeginCoords:()=>e_,getSliceSize:()=>t_,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>__,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>A_,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>R_,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>M_,getSparseReshapeInputOutputMismatchErrorMessage:()=>P_,getSparseReshapeInputOutputMultipleErrorMessage:()=>O_,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>F_,getSparseReshapeNegativeOutputDimErrorMessage:()=>D_,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>B_,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>L_,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>z_,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>j_,getUndoAxesPermutation:()=>Xk,isIdentityPermutation:()=>C_,log:()=>rb,mergeRealAndImagArrays:()=>u_,prepareAndValidate:()=>fE,prepareSplitSize:()=>E_,segment_util:()=>W_,shouldFuse:()=>lC,slice_util:()=>mE,splitRealAndImagArrays:()=>d_,stridesOrDilationsArePositive:()=>zw,tupleValuesAreOne:()=>Pw,upcastType:()=>lv,validateDefaultValueShape:()=>KE,validateInput:()=>OI,validateUpdateShape:()=>MI,warn:()=>ab}),function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(BE||(BE={}));var XE=30;function YE(e){return e<=XE?e:vf(e,Math.floor(Math.sqrt(e)))}function QE(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}function JE(e,t,n){let a=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let n=t.length;for(let r=0;r<n;++r)a=a.concat([e[r+1]/t[r],t[r]]);a=a.concat(e.slice(n+1))}return a}function ZE(e,t){let n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let a=t+1;a<e;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{let a=[],r=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?r.push(n):a.push(n);n.push(...a),n.push(0),n.push(...r)}return n}function $E(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=[];a?r.push(e[0]/n):r.push(e[0]*n);for(let s=1;s<e.length;++s)s<=t.length?a?r.push(t[s-1]*e[s]):r.push(e[s]/t[s-1]):r.push(e[s]);return r}function e_(e,t){let n=[0];for(let a=0;a<t;++a)n.push(e[a][0]);return n}function t_(e,t,n){let a=e.slice(0,1);for(let r=0;r<n;++r)a.push(e[r+1]-t[r][0]-t[r][1]);return a}var n_=1.7580993408473768,a_=1.0507009873554805,r_=.3275911,s_=.254829592,i_=-.284496736,o_=1.421413741,l_=-1.453152027,c_=1.061405429;function u_(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:".concat(e.length,", imag: ").concat(t.length,"."));let n=new Float32Array(2*e.length);for(let a=0;a<n.length;a+=2)n[a]=e[a/2],n[a+1]=t[a/2];return n}function d_(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let a=0;a<e.length;a+=2)t[a/2]=e[a],n[a/2]=e[a+1];return{real:t,imag:n}}function p_(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let r=0;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],a[Math.floor(r/4)]=e[r+1];return{real:n,imag:a}}function h_(e){let t=Math.floor(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let r=2;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],a[Math.floor(r/4)]=e[r+1];return{real:n,imag:a}}function f_(e,t){return{real:e[2*t],imag:e[2*t+1]}}function m_(e,t,n,a){e[2*a]=t,e[2*a+1]=n}function g_(e,t){let n=new Float32Array(e/2),a=new Float32Array(e/2);for(let r=0;r<Math.ceil(e/2);r++){let s=(t?2:-2)*Math.PI*(r/e);n[r]=Math.cos(s),a[r]=Math.sin(s)}return{real:n,imag:a}}function y_(e,t,n){let a=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(a),imag:Math.sin(a)}}var b_="->",v_=/->/g,x_=",",w_="...";function k_(e,t){let n=((e=e.replace(/\s/g,"")).length-e.replace(v_,"").length)/b_.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(b_,'").'));let[a,r]=e.split(b_);Hh(-1===a.indexOf(w_),()=>'The ellipsis notation ("'.concat(w_,'") is not supported yet.'));let s=a.split(x_),i=s.length;if(t!==i)throw new Error("Expected ".concat(i," input tensors, received ").concat(t));if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let d=0;d<r.length;++d){let e=r[d];if(!s.some(t=>-1!==t.indexOf(e)))throw new Error("Output subscripts contain the label ".concat(e," not present in the input subscripts."));-1===o.indexOf(e)&&o.push(e)}for(let d=0;d<a.length;++d){let e=a[d];-1===o.indexOf(e)&&e!==x_&&o.push(e)}let l=new Array(s.length);for(let d=0;d<i;++d){if(new Set(s[d].split("")).size!==s[d].length)throw new Error("Found duplicate axes in input component ".concat(s[d],". Support for duplicate axes in input is not implemented yet."));l[d]=[];for(let e=0;e<s[d].length;++e)l[d].push(o.indexOf(s[d][e]))}let c=o.length,u=[];for(let d=r.length;d<c;++d)u.push(d);return{allDims:o,summedDims:u,idDims:l}}function S_(e,t){let n=new Array(e);n.fill(-1);for(let r=0;r<t.length;++r)n[t[r]]=r;let a=[];for(let r=0;r<e;++r)-1===n[r]&&a.push(r);return n=n.filter(e=>-1!==e),{permutationIndices:n,expandDims:a}}function N_(e,t,n){let a=new Array(e);for(let r=0;r<n.length;++r){let e=n[r].shape;for(let n=0;n<t[r].length;++n)void 0===a[t[r][n]]?a[t[r][n]]=e[n]:Hh(a[t[r][n]]===e[n],()=>"Expected dimension ".concat(a[t[r][n]]," at axis ").concat(n," of input shaped ").concat(JSON.stringify(e),", but got dimension ").concat(e[n]))}}function I_(e,t){let n=e,a=[],r=0;0===e.length&&n.push(-1),r=e.length+1;for(let i=0;i<r;++i)a.push([]);let s=[];for(let i=0;i<n.length;++i){let e=T_(t,n[i]);for(let t of e)-1===s.indexOf(t)&&(a[i].push(t),s.push(t))}return{path:n,steps:a}}function C_(e){return e.every((e,t)=>e===t)}function T_(e,t){let n=[];for(let a=0;a<e.length;++a)(0===e[a].length||-1!==e[a].indexOf(t)||-1===t)&&n.push(a);return n}function E_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=[];if("number"==typeof t)Hh(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),a=new Array(t).fill(e.shape[n]/t);else{Hh(t.reduce((e,t)=>(-1===t&&(e+=1),e),0)<=1,()=>"There should be only one negative value in split array.");let r=t.indexOf(-1);if(-1!==r){let a=t.reduce((e,t)=>t>0?e+t:e);t[r]=e.shape[n]-a}Hh(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),a=t}return a}function __(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function A_(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function R_(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function F_(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function D_(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function M_(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function O_(e,t){let n=Kh(e),a=Kh(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(a,". inputShape=").concat(e," outputShape= ").concat(t)}function P_(e,t){let n=Kh(e),a=Kh(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(a,". inputShape=").concat(e," outputShape=").concat(t)}function L_(){return"segment ids must be >= 0"}function z_(){return"segment ids are not increasing"}function j_(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function B_(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}var W_={};function V_(e,t){let n,a=!1;for(e<=XE?(n=e,a=!0):n=vf(e,Math.floor(Math.sqrt(e)));!a;)n>t||n===e?a=!0:n=vf(e,n+1);return n}function U_(e,t,n){let a=[],r=e.length;for(let s=0;s<r;s++)s!==t?a.push(e[s]):a.push(n);return a}function H_(e,t,n,a){let r=t.shape.length,s=e.shape.length;if(0!==a&&(a<-r||a>r))throw new Error("Expect batchDims in the range of [-".concat(r,", ").concat(r,"], but got ").concat(a));if(a<0&&(a+=r),a>s)throw new Error("batchDims (".concat(a,") must be less than rank(x) (\n    ").concat(s,")."));if(n<a)throw new Error("batchDims (".concat(a,") must be less than or equal to axis (").concat(n,")."));for(let d=0;d<a;++d)if(e.shape[d]!==t.shape[d])throw new Error("x.shape[".concat(d,"]: ").concat(e.shape[d]," should be equal to indices.shape[").concat(d,"]: ").concat(t.shape[d],"."));let i=e.shape[n],o=[],l=1,c=1,u=1;for(let d=0;d<a;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=a;d<n;d++)o.push(e.shape[d]),c*=e.shape[d];for(let d=a;d<r;d++)o.push(t.shape[d]);for(let d=n+1;d<s;d++)o.push(e.shape[d]),u*=e.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:o}}function G_(e){try{return e.map(e=>Lb(e))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(t))}}function q_(e){return e.map(e=>Pb(e))}uh(W_,{collectGatherOpShapeInfo:()=>H_,computeOutShape:()=>U_,segOpComputeOptimalWindowSize:()=>V_});var K_={};uh(K_,{nonMaxSuppressionV3Impl:()=>TC,nonMaxSuppressionV4Impl:()=>EC,nonMaxSuppressionV5Impl:()=>_C,whereImpl:()=>GI}),function(){for(let e of DT)ST(e)}();var X_={kernelName:jf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(e,NI(iw(n,"float32"),-1))}}},Y_={kernelName:Bf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=tS(iw(n,"float32")),a=eS(PS($k(1),t));return DS(dw(e,a))}}}},Q_={kernelName:Wf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=eS(PS(tS(iw(n,"float32")),1));return dw(e,t)}}}},J_={kernelName:Vf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Fk(n.shape,a.shape);return{a:()=>{let t=e,a=Rk(n.shape,r);return a.length>0&&(t=nS(t,a)),Ww(t,n.shape)},b:()=>{let t=e,n=Rk(a.shape,r);return n.length>0&&(t=nS(t,n)),Ww(t,a.shape)}}}},Z_={kernelName:Uf,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((t,a)=>{n[a]=()=>e.clone()}),n}},$_={kernelName:qf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ok(n)}}},eA={kernelName:Kf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ok(n)}}},tA={kernelName:Xf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,eS(PS($k(1),tS(iw(n,"float32")))))}}},nA={kernelName:Yf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=eS(cw($k(1),tS(iw(n,"float32"))));return dw(e,t)}}}},aA={kernelName:Zf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Fk(n.shape,a.shape);return{a:()=>{let t=cw(tS(n),tS(a)),s=pw(e,dw(a,t)),i=Rk(n.shape,r);return i.length>0&&(s=nS(s,i)),Ww(s,n.shape)},b:()=>{let t=cw(tS(n),tS(a)),s=DS(pw(e,dw(n,t))),i=Rk(a.shape,r);return i.length>0&&(s=nS(s,i)),Ww(s,a.shape)}}}},rA={kernelName:Qf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,cw(tS(iw(n,"float32")),1))}}},sA={kernelName:Jf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,PS($k(1),tS(iw(n,"float32"))))}}};var iA=Ov({avgPool3dGrad_:function(e,t,n,a,r,s){let i=Fv(e,"dy","avgPool3dGrad"),o=Fv(t,"input","avgPool3dGrad"),l=i,c=o,u=!1;4===o.rank&&(u=!0,l=Ww(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=Ww(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Hh(5===l.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank ".concat(l.rank,".")),Hh(5===c.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank ".concat(c.rank,".")),Bw("avgPool3dGrad",r,s);let d={dy:l,input:c},p={filterSize:n,strides:a,pad:r,dimRoundingMode:s},h=wv.runKernel(nm,d,p);return u?Ww(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),oA={kernelName:tm,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{filterSize:r,strides:s,pad:i,dimRoundingMode:o}=n;return{x:()=>iA(e,a,r,s,i,o)}}};var lA=Ov({avgPoolGrad_:function(e,t,n,a,r){let s=Fv(e,"dy","avgPoolGrad"),i=Fv(t,"input","avgPoolGrad");Hh(i.rank===s.rank,()=>"Rank of input (".concat(i.rank,") does not match rank of dy (").concat(s.rank,")"));let o=i,l=s,c=!1;3===i.rank&&(c=!0,o=Ww(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=Ww(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Hh(4===l.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank ".concat(l.rank,".")),Hh(4===o.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank ".concat(o.rank,"."));let u={dy:l,input:o},d={filterSize:n,strides:a,pad:r},p=wv.runKernel(em,u,d);return c?Ww(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),cA={kernelName:$f,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{filterSize:r,strides:s,pad:i}=n;return{x:()=>lA(e,a,r,s,i)}}},uA={kernelName:am,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[a,r]=t,{transposeA:s,transposeB:i}=n;return s||i?!s&&i?{a:()=>Gw(e,r,!1,!1),b:()=>Gw(e,a,!0,!1)}:s&&!i?{a:()=>Gw(r,e,!1,!0),b:()=>Gw(a,e,!1,!1)}:{a:()=>Gw(r,e,!0,!0),b:()=>Gw(e,a,!0,!0)}:{a:()=>Gw(e,r,!1,!0),b:()=>Gw(a,e,!0,!1)}}},dA={kernelName:rm,gradFunc:(e,t,n)=>{let{blockShape:a,crops:r}=n;return{x:()=>mN(e,a,r)}}},pA={kernelName:om,gradFunc:(e,t,n)=>{let a=n,r=a.inputShape,s=a.shape,i=Array.from(s);for(let l=r.length-1;l>=0;l--)if(r[l]===s[l])i[l]=1;else if(1!==r[l])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(s,"]."));let o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>nS(e,o,!0)}}},hA={kernelName:cm,gradFunc:e=>({x:()=>e.clone()})},fA={kernelName:um,gradFunc:e=>({x:()=>Ok(e)})},mA={kernelName:dm,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{clipValueMin:r,clipValueMax:s}=n;return{x:()=>Mk(jS(fS(a,r),wS(a,s)),e,Ok(e))}}},gA={kernelName:hm,inputsToSave:["x"],gradFunc:X_.gradFunc},yA={kernelName:fm,saveAllInputs:!0,gradFunc:(e,t,n)=>{let a=t.map(e=>e.shape),{axis:r}=n,s=rf(r,t[0].shape)[0],i=a.map(e=>e[s]);return vI(e,i,s).map(e=>()=>e)}},bA={kernelName:mm,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,{dilations:s,strides:i,pad:o,dataFormat:l}=n;return Hh(Pw(s),()=>"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(s,"'")),{x:()=>mk(a.shape,e,r,i,o,l),filter:()=>rC(a,e,r.shape,i,o,l)}}},vA={kernelName:ym,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,{strides:s,pad:i,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>hk(e,r,s,i,o,1,l),filter:()=>rC(e,a,r.shape,s,i,o,l)}}};var xA=Ov({conv3DBackpropFilter_:function(e,t,n,a,r){let s=e;4===e.rank&&(s=Ww(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let i=t;4===i.rank&&(i=Ww(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Hh(5===s.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape ".concat(s.shape,".")),Hh(5===i.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape ".concat(i.shape,".")),Hh(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got ".concat(n,".")),Hh(s.shape[4]===n[3],()=>"Error in conv3dDerFilter: depth of input ".concat(s.shape[4],") must match input depth in filter (").concat(n[3],".")),Hh(i.shape[4]===n[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(i.shape[4],") must match output depth for filter (").concat(n[4],")."));let o={x:s,dy:i},l={strides:a,pad:r,filterShape:n};return wv.runKernel(vm,o,l)}}),wA={kernelName:bm,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:a,strides:r,pad:s}=n;Hh(Pw(a),()=>"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(a,"'"));let[i,o]=t;return{x:()=>bk(i.shape,e,o,r,s),filter:()=>xA(i,e,o.shape,r,s)}}},kA={kernelName:wm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(DS(cI(iw(n,"float32"))),e)}}},SA={kernelName:km,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(uI(iw(n,"float32")),e)}}},NA={kernelName:Nm,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r,exclusive:s,reverse:i}=n;return{x:()=>{let t=Kk([r],a.rank),n=Sk(e,r,s,!i);return null!=t&&(n=XI(n,t)),n}}}},IA={kernelName:Em,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:a,strides:r,pad:s,dimRoundingMode:i}=n,o=null==a?[1,1]:a;Hh(Pw(o),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '".concat(o,"'"));let[l,c]=t;return Hh(4===l.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ".concat(l.rank,".")),Hh(4===c.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ".concat(c.rank,".")),Hh(l.shape[3]===c.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input channels (".concat(l.shape[3],") must match the inChannels dimension in filter ").concat(c.shape[2],".")),Hh(Lw(r,o),()=>"Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ".concat(r," and dilations '").concat(o,"'.")),Bw("depthwiseConv2d",s,i),{x:()=>dC(l.shape,e,c,r,s,o,i),filter:()=>uC(l,e,c.shape,r,s,o,i)}}},CA={kernelName:Fm,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,s={x:a,filter:r,dy:e},i={x:a,filter:r,dy:e};return{x:()=>wv.runKernel(Dm,s,n),filter:()=>wv.runKernel(Mm,i,n)}}},TA={kernelName:zm,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,a={dy:e,y:n};return{x:()=>wv.runKernel(jm,a)}}},EA={kernelName:Bm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,a=pw(iS(DS(tS(n))),2/Math.sqrt(Math.PI));return{x:()=>pw(e,a)}}},_A={kernelName:Vm,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(e,n)}}},AA={kernelName:Um,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>Ww(e,n.shape)}}},RA={kernelName:Hm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(e,iS(n))}}},FA={kernelName:Xm,gradFunc:e=>({x:()=>Ok(e)})},DA={kernelName:Ym,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Fk(n.shape,a.shape);return{a:()=>{let t=dw(e,iw(a,"float32")),s=Rk(n.shape,r);return s.length>0?Ww(nS(t,s),n.shape):t},b:()=>{let t=pw(e,iw(n,"float32")),s=Rk(a.shape,r);s.length>0&&(t=Ww(nS(t,s),a.shape));let i=tS(a);return DS(dw(t,iw(i,"float32")))}}}},MA={kernelName:Qm,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:a}=n,[r,s,i,o]=t,l=null==o?$k(1):o,c=Rk(s.shape,r.shape),u=[];if(1===s.rank){for(let e=0;e<r.shape.length-1;++e)u.push(r.shape[e]);u.push(1)}let d=PS(r,s),p=pw(e,l),h=rI(cw(i,$k(a))),f=pw(pw(pw(h,h),h),$k(-.5));return{x:()=>1===s.rank?Ww(pw(pw(e,cS(Ww(h,[1,1,1,s.shape[0]]),u)),l),r.shape):Ww(pw(pw(e,h),l),r.shape),mean:()=>{let e=pw(pw(h,$k(-1)),p);return 1===s.rank&&(e=nS(e,c)),Ww(e,s.shape)},variance:()=>{let e=pw(pw(f,d),p);return 1===s.rank&&(e=nS(e,c)),Ww(e,s.shape)},scale:()=>{let t=pw(d,h),n=pw(e,t);return 1===s.rank&&(n=nS(n,c)),Ww(n,s.shape)},offset:()=>{let t=e;return 1===s.rank&&(t=nS(t,c)),Ww(t,s.shape)}}}},OA={kernelName:Jm,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[a,r]=t,{axis:s,batchDims:i}=n,o=rf(s,a.shape)[0],l=(e,t,n)=>()=>{let a=e.shape,r=t.size,i=a.slice(0,o),l=i.length,c=a.slice(s,a.length).slice(1),u=c.length,d=PA(0,l),p=PA(l+1,l+1+u),h=LA([i,[r],c]),f=Ww(n,h),m=Ww(t,[r]),g=LA([[l],d,p]),y=XI(f,g),b=WI(y,m,e.shape[o]),v=Xk(g);return b=XI(b,v),b};if(1===i){let t=a.shape[0],n=a.split(t,0);return{x:()=>SI(n.map((t,n)=>l(t,r.slice(n,1),e.slice(n,1))())).reshape(a.shape),indices:()=>r}}return{x:l(a,r,e),indices:()=>r}}};function PA(e,t){let n=[];for(let a=e;a<t;++a)n.push(a);return n}function LA(e){let t=[];for(let n=0;n<e.length;++n)for(let a=0;a<e[n].length;++a)t.push(e[n][a]);return t}var zA={kernelName:eg,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>Ok(n),b:()=>Ok(a)}}},jA={kernelName:tg,gradFunc:e=>({x:()=>iw(e,"float32")})},BA={kernelName:rg,gradFunc:e=>({x:()=>Ok(e)})},WA={kernelName:sg,gradFunc:e=>({x:()=>Ok(e)})},VA={kernelName:ig,gradFunc:e=>({x:()=>Ok(e)})},UA={kernelName:og,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{alpha:r}=n,s=hS(a,0);return{x:()=>Mk(s,e,pw(e,r))}}},HA={kernelName:pg,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,cw(n,1))}}},GA={kernelName:dg,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,iw(n,"float32"))}}},qA={kernelName:yg,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n;return{logits:()=>{let t=iS(a);return PS(e,pw(nS(e,r,!0),t))}}}};var KA=Ov({localResponseNormalizationBackprop_:function(e,t,n){let a={x:e,y:t,dy:n},r={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return wv.runKernel(xg,a,r)}}),XA={kernelName:vg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{depthRadius:s,bias:i,alpha:o,beta:l}=n;return{x:()=>KA(a,r,e,s,i,o,l)}}};function YA(e,t,n,a){return t.rank<n.rank&&(t=Ww(t,Gk(t.shape,a))),e.rank<n.rank&&(e=Ww(e,Gk(e.shape,a))),{x:()=>pw(e,iw(Dk(n,t),e.dtype))}}var QA={kernelName:kg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let a=n,{reductionIndices:r}=a,s=t[0],i=YA(e,t[1],s,rf(r,s.shape));return{x:()=>i.x()}}},JA={kernelName:Sg,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>pw(e,iw(fS(n,a),"float32")),b:()=>pw(e,iw(xS(n,a),"float32"))}}};var ZA=Ov({maxPool3dGrad_:function(e,t,n,a,r,s,i){let o=Fv(e,"dy","maxPool3dGrad"),l=Fv(t,"input","maxPool3dGrad"),c=Fv(n,"output","maxPool3dGrad"),u=o,d=l,p=c,h=!1;4===l.rank&&(h=!0,u=Ww(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=Ww(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=Ww(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),Hh(5===u.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank ".concat(u.rank,".")),Hh(5===d.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank ".concat(d.rank,".")),Hh(5===p.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank ".concat(p.rank,".")),Bw("maxPool3dGrad",s,i);let f={dy:u,input:d,output:p},m={filterSize:a,strides:r,pad:s,dimRoundingMode:i},g=wv.runKernel(Tg,f,m);return h?Ww(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),$A={kernelName:Cg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=n;return{x:()=>ZA(e,a,r,s,i,o,l)}}};var eR=Ov({maxPoolGrad_:function(e,t,n,a,r,s,i){let o=Fv(e,"dy","maxPoolGrad"),l=Fv(t,"input","maxPoolGrad"),c=Fv(n,"output","maxPoolGrad");Hh(l.rank===o.rank,()=>"Rank of input (".concat(l.rank,") does not match rank of dy (").concat(o.rank,")")),Hh(4===o.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank ".concat(o.rank,".")),Hh(4===l.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank ".concat(l.rank,".")),Bw("maxPoolGrad",s,i);let u={dy:o,input:l,output:c},d={filterSize:a,strides:r,pad:s,dimRoundingMode:i};return wv.runKernel(Ig,u,d)}}),tR={kernelName:Ng,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{filterSize:s,strides:i,pad:o}=n;return{x:()=>eR(e,a,r,s,i,o)}}},nR={kernelName:_g,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n,s=rf(r,a.shape),i=Kh(Hk(a.shape,s)[1]);return{x:()=>{let t=a.shape.slice();s.forEach(e=>{t[e]=1});let n=Ww(e,t);return dw(pw(n,ZS(a.shape,"float32")),i)}}}},aR={kernelName:Ag,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let a=n,{axis:r}=a,[s,i]=t,o=YA(e,i,s,rf(r,s.shape));return{x:()=>o.x()}}},rR={kernelName:Rg,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>pw(e,iw(wS(n,a),"float32")),b:()=>pw(e,iw(hS(n,a),"float32"))}}},sR={kernelName:Fg,inputsToSave:["x"],gradFunc:(e,t,n)=>{let a=t[0],{paddings:r}=n,s=r.map(e=>e[0]);return{x:()=>Kw(e,s,a.shape)}}},iR={kernelName:Dg,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Fk(n.shape,a.shape);return{a:()=>{let t=Rk(n.shape,r);return t.length>0?Ww(nS(e,t),n.shape):e},b:()=>{let t=pw(e,DS(dS(dw(n,a)))),s=Rk(a.shape,r);return s.length>0?Ww(nS(t,s),a.shape):t}}}},oR={kernelName:Og,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Fk(n.shape,a.shape);return{a:()=>{let t=pw(e,iw(a,"float32")),s=Rk(n.shape,r);return s.length>0?Ww(nS(t,s),n.shape):t},b:()=>{let t=pw(e,iw(n,"float32")),s=Rk(a.shape,r);return s.length>0?Ww(nS(t,s),a.shape):t}}}},lR={kernelName:Pg,gradFunc:e=>({x:()=>DS(e)})},cR={kernelName:Vg,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>JS(n.shape,"float32")}}},uR={kernelName:Wg,gradFunc:e=>({x:()=>Ok(e)})},dR={kernelName:Ug,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:a}=n;return VI(e,a).map(e=>()=>e)}},pR={kernelName:Hg,inputsToSave:["x"],gradFunc:(e,t,n)=>{let a=t[0],{paddings:r}=n,s=r.map(e=>e[0]);return{x:()=>Kw(e,s,a.shape)}}},hR={kernelName:qg,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,a,r]=t,s=n,i=a,o=Fk(s.shape,i.shape);return{a:()=>{let t=iw(i,"float32"),n=pw(e,pw(t,Zk(s,PS(t,$k(1))))),a=Rk(s.shape,o);return a.length>0&&(n=nS(n,a)),Ww(n,s.shape)},b:()=>{let t=hS(s,0),n=Mk(t,NS(s),Ok(s)),a=pw(e,pw(r,n)),l=Rk(i.shape,o);return l.length>0&&(a=nS(a,l)),Ww(a,i.shape)}}}},fR={kernelName:Kg,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,a]=t,r=hS(n,0);return{x:()=>Mk(r,e,pw(e,a)),alpha:()=>{let t=Mk(r,Ok(e),pw(e,n)),s=Rk(a.shape,e.shape);return s.length>0&&(t=nS(t,s)),Ww(t,a.shape)}}}};function mR(e,t,n){let a=e.shape.length,r=a-n.length,s=WE.getAxesPermutation(n,a),i=e;null!=s&&(i=XI(e,s));let o=i.shape.slice(),l=o.splice(a-n.length,n.length).reduce((e,t)=>e*t,1);o.push(l);let c=function(e,t,n){let a=e.shape.slice();a[n]=1;let r=Ww(t,a),s=kk(e,n,!0,!1),i=kk(e,n,!0,!0),o=pw(s,i);return pw(r,o)}(i.reshape(o),t,r);if(c=c.reshape(i.shape),null!=s){let e=WE.getUndoAxesPermutation(s);c=XI(c,e)}return c}var gR={kernelName:Xg,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n,s=[];return s=null==r?a.shape.map((e,t)=>t):"number"==typeof r?[r]:r,{x:()=>mR(a,e,s)}}},yR={kernelName:Pm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Fk(n.shape,a.shape);return{a:()=>{let t=dw(e,iw(a,"float32")),s=Rk(n.shape,r);return s.length>0?Ww(nS(t,s),n.shape):t},b:()=>{let t=pw(e,iw(n,"float32")),s=Rk(a.shape,r);s.length>0&&(t=Ww(nS(t,s),a.shape));let i=tS(a);return DS(dw(t,iw(i,"float32")))}}}},bR={kernelName:ey,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,DS(tS(n)))}}},vR={kernelName:oy,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,a=pw(wS(n,6),NI(n));return{x:()=>pw(e,iw(a,"float32"))}}},xR={kernelName:ty,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(e,iw(NI(n),"float32"))}}},wR={kernelName:ny,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ww(e,n.shape)}}},kR={kernelName:sy,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[a]=t,r={dy:e,images:a};return{images:()=>wv.runKernel(iy,r,n)}}},SR={kernelName:ay,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[a]=t,r={dy:e,images:a};return{images:()=>wv.runKernel(ry,r,n)}}},NR={kernelName:ly,gradFunc:(e,t,n)=>{let{dims:a}=n,r=rf(a,e.shape);return{x:()=>ZN(e,r)}}},IR={kernelName:cy,gradFunc:e=>({x:()=>Ok(e)})},CR={kernelName:uy,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>DS(dw(e,pw(Zk(n,1.5),2)))}}},TR={kernelName:fy,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>iw(Ok(n),"float32"),t:()=>pw(e,iw(n,e.dtype)),e:()=>pw(e,iw(BS(n),e.dtype))}}},ER={kernelName:my,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=hS(n,$k(0)),a=$k(n_),r=$k(a_),s=pw(e,r),i=pw(pw(e,a),iS(iw(n,"float32")));return Mk(t,s,i)}}}},_R={kernelName:xy,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(e,pw(n,PS($k(1),n)))}}},AR={kernelName:vy,gradFunc:e=>({x:()=>Ok(e)})},RR={kernelName:yy,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(xk(iw(n,"float32")),e)}}},FR={kernelName:by,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(wk(iw(n,"float32")),e)}}},DR={kernelName:gy,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{begin:r,size:s}=n,i=a.shape,[o,l]=FE(a,r,s),c=[];for(let u=0;u<e.rank;u++)c.push([o[u],i[u]-o[u]-l[u]]);return{x:()=>uN(e,c)}}},MR={kernelName:Cy,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a]=t,{dim:r}=n,s=pw(e,a);return{logits:()=>PS(s,pw(nS(s,[r],true),a))}}},OR={kernelName:wy,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(e,qw(n))}}},PR={kernelName:Ny,gradFunc:(e,t,n)=>{let{blockShape:a,paddings:r}=n;return{x:()=>Qw(e,a,r)}}},LR={kernelName:Iy,gradFunc:(e,t,n)=>{let{axis:a}=n;return{x:()=>Hw(e,a)}}},zR={kernelName:ky,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,pw(eS(iw(n,"float32")),2))}}},jR={kernelName:Dy,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(e,pw(iw(n,"float32"),2))}}},BR={kernelName:Fy,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=$k(2);return{a:()=>pw(e,pw(r,PS(n,a))),b:()=>pw(e,pw(r,PS(a,n)))}}},WR={kernelName:Jy,gradFunc:e=>({x:()=>Ok(e)})},VR={kernelName:jy,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Fk(n.shape,a.shape);return{a:()=>{let t=e,a=Rk(n.shape,r);return a.length>0&&(t=nS(t,a)),Ww(t,n.shape)},b:()=>{let t=e,n=Rk(a.shape,r);return n.length>0&&(t=nS(t,n)),Ww(DS(t),a.shape)}}}},UR={kernelName:Sy,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,r=a.shape.slice(),{axis:s}=n;rf(s,a.shape).forEach(e=>{r[e]=1});let i=Ww(e,r),o=pw(i,ZS(a.shape,"float32"));return{x:()=>o}}},HR={kernelName:By,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>dw(e,tS(xk(n)))}}},GR={kernelName:Wy,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>pw(PS($k(1),tS(n)),e)}}},qR={kernelName:Vy,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{reps:r}=n;return{x:()=>{let t=Ok(a);if(1===a.rank)for(let n=0;n<r[0];++n)t=cw(t,Kw(e,[n*a.shape[0]],[a.shape[0]]));else if(2===a.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)t=cw(t,Kw(e,[n*a.shape[0],s*a.shape[1]],[a.shape[0],a.shape[1]]));else if(3===a.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let i=0;i<r[2];++i)t=cw(t,Kw(e,[n*a.shape[0],s*a.shape[1],i*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(4!==a.rank)throw new Error("Gradient for tile operation is not implemented for rank-".concat(a.rank," tensors yet."));for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let i=0;i<r[2];++i)for(let o=0;o<r[3];++o)t=cw(t,Kw(e,[n*a.shape[0],s*a.shape[1],i*a.shape[2],o*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return t}}}},KR={kernelName:Gy,gradFunc:(e,t,n)=>{let a=n,{perm:r}=a,s=Xk(r);return{x:()=>XI(e,s)}}},XR={kernelName:Ky,gradFunc:(e,t,n)=>{let a=n,{axis:r}=a;return{value:()=>SI(e,r)}}},YR={kernelName:Xy,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>function(e,t){let n=YS(t,Ok(t)),a=pS(e,n),r=fS(t,$k(0,"int32")),s=a.rank-r.rank;for(let o=0;o<s;++o)r=oS(r,o+1);r=jS(r,ZS(a.shape,"bool"));let i=Ok(a);return Mk(r,a,i)}(e,n)}}};var QR={kernelName:Qy,gradFunc:e=>({x:()=>Ok(e)})},JR=[X_,Y_,Q_,J_,Z_,$_,eA,tA,nA,aA,rA,sA,oA,cA,uA,dA,pA,hA,fA,mA,gA,yA,vA,bA,wA,kA,SA,NA,IA,CA,yR,TA,EA,_A,AA,RA,DA,FA,MA,OA,zA,jA,BA,WA,VA,UA,HA,GA,qA,XA,QA,QA,JA,$A,tR,nR,aR,rR,sR,iR,oR,lR,cR,uR,dR,pR,pR,hR,fR,gR,bR,vR,xR,wR,kR,SR,NR,IR,CR,TR,ER,_R,AR,RR,FR,DR,MR,OR,PR,PR,LR,LR,zR,BR,jR,WR,VR,UR,HR,GR,qR,KR,XR,YR,QR];for(let n of JR)db(n);Zb().prototype.abs=function(){return this.throwIfDisposed(),hw(this)},Zb().prototype.acos=function(){return this.throwIfDisposed(),fw(this)},Zb().prototype.acosh=function(){return this.throwIfDisposed(),mw(this)},Zb().prototype.add=function(e){return this.throwIfDisposed(),cw(this,e)},Zb().prototype.all=function(e,t){return this.throwIfDisposed(),yw(this,e,t)},Zb().prototype.any=function(e,t){return this.throwIfDisposed(),bw(this,e,t)},Zb().prototype.argMax=function(e){return this.throwIfDisposed(),vw(this,e)},Zb().prototype.argMin=function(e){return this.throwIfDisposed(),xw(this,e)},Zb().prototype.asScalar=function(){return this.throwIfDisposed(),Hh(1===this.size,()=>"The array must have only 1 element."),Ww(this,[])},Zb().prototype.asType=function(e){return this.throwIfDisposed(),iw(this,e)},Zb().prototype.as1D=function(){return this.throwIfDisposed(),Ww(this,[this.size])},Zb().prototype.as2D=function(e,t){return this.throwIfDisposed(),Ww(this,[e,t])},Zb().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Ww(this,[e,t,n])},Zb().prototype.as4D=function(e,t,n,a){return this.throwIfDisposed(),Ww(this,[e,t,n,a])},Zb().prototype.as5D=function(e,t,n,a,r){return this.throwIfDisposed(),Ww(this,[e,t,n,a,r])},Zb().prototype.asin=function(){return this.throwIfDisposed(),ww(this)},Zb().prototype.asinh=function(){return this.throwIfDisposed(),kw(this)},Zb().prototype.atan=function(){return this.throwIfDisposed(),Sw(this)},Zb().prototype.atan2=function(e){return this.throwIfDisposed(),Nw(this,e)},Zb().prototype.atanh=function(){return this.throwIfDisposed(),Iw(this)},Zb().prototype.avgPool=function(e,t,n,a){return this.throwIfDisposed(),Vw(this,e,t,n,a)},Zb().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Qw(this,e,t)},Zb().prototype.batchNorm=function(e,t,n,a,r){return this.throwIfDisposed(),Zw(this,e,t,n,a,r)},Zb().prototype.broadcastTo=function(e){return this.throwIfDisposed(),sk(this,e)},Zb().prototype.cast=function(e){return this.throwIfDisposed(),iw(this,e)},Zb().prototype.ceil=function(){return this.throwIfDisposed(),ik(this)},Zb().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),lk(this,e,t)},Zb().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Jb&&(e=[e]),Hw([this,...e],t)},Zb().prototype.conv1d=function(e,t,n,a,r,s){return this.throwIfDisposed(),fk(this,e,t,n,a,r,s)},Zb().prototype.conv2dTranspose=function(e,t,n,a,r){return this.throwIfDisposed(),gk(this,e,t,n,a,r)},Zb().prototype.conv2d=function(e,t,n,a,r,s){return this.throwIfDisposed(),hk(this,e,t,n,a,r,s)},Zb().prototype.cos=function(){return this.throwIfDisposed(),xk(this)},Zb().prototype.cosh=function(){return this.throwIfDisposed(),wk(this)},Zb().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),kk(this,e,t,n)},Zb().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Sk(this,e,t,n)},Zb().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Ik(this,e,t)},Zb().prototype.depthwiseConv2d=function(e,t,n,a,r,s){return this.throwIfDisposed(),Ck(this,e,t,n,a,r,s)},Zb().prototype.dilation2d=function(e,t,n,a,r){return this.throwIfDisposed(),Ek(this,e,t,n,a,r)},Zb().prototype.divNoNan=function(e){return this.throwIfDisposed(),Pk(this,e)},Zb().prototype.div=function(e){return this.throwIfDisposed(),dw(this,e)},Zb().prototype.dot=function(e){return this.throwIfDisposed(),Lk(this,e)},Zb().prototype.elu=function(){return this.throwIfDisposed(),jk(this)},Zb().prototype.equal=function(e){return this.throwIfDisposed(),Dk(this,e)},Zb().prototype.erf=function(){return this.throwIfDisposed(),Wk(this)},Zb().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),sS(this,e,t)},Zb().prototype.exp=function(){return this.throwIfDisposed(),iS(this)},Zb().prototype.expandDims=function(e){return this.throwIfDisposed(),oS(this,e)},Zb().prototype.expm1=function(){return this.throwIfDisposed(),lS(this)},Zb().prototype.fft=function(){return this.throwIfDisposed(),gI(this)},Zb().prototype.flatten=function(){return this.throwIfDisposed(),Ww(this,[this.size])},Zb().prototype.floor=function(){return this.throwIfDisposed(),dS(this)},Zb().prototype.floorDiv=function(e){return this.throwIfDisposed(),uw(this,e)},Zb().prototype.gather=function(e,t,n){return this.throwIfDisposed(),pS(this,e,t,n)},Zb().prototype.greaterEqual=function(e){return this.throwIfDisposed(),fS(this,e)},Zb().prototype.greater=function(e){return this.throwIfDisposed(),hS(this,e)},Zb().prototype.ifft=function(){return this.throwIfDisposed(),yI(this)},Zb().prototype.irfft=function(){return this.throwIfDisposed(),bI(this)},Zb().prototype.isFinite=function(){return this.throwIfDisposed(),gS(this)},Zb().prototype.isInf=function(){return this.throwIfDisposed(),yS(this)},Zb().prototype.isNaN=function(){return this.throwIfDisposed(),bS(this)},Zb().prototype.leakyRelu=function(e){return this.throwIfDisposed(),vS(this,e)},Zb().prototype.lessEqual=function(e){return this.throwIfDisposed(),wS(this,e)},Zb().prototype.less=function(e){return this.throwIfDisposed(),xS(this,e)},Zb().prototype.localResponseNormalization=function(e,t,n,a){return this.throwIfDisposed(),SS(this,e,t,n,a)},Zb().prototype.logSigmoid=function(){return this.throwIfDisposed(),OS(this)},Zb().prototype.logSoftmax=function(e){return this.throwIfDisposed(),LS(this,e)},Zb().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),zS(this,e,t)},Zb().prototype.log=function(){return this.throwIfDisposed(),NS(this)},Zb().prototype.log1p=function(){return this.throwIfDisposed(),IS(this)},Zb().prototype.logicalAnd=function(e){return this.throwIfDisposed(),jS(this,e)},Zb().prototype.logicalNot=function(){return this.throwIfDisposed(),BS(this)},Zb().prototype.logicalOr=function(e){return this.throwIfDisposed(),WS(this,e)},Zb().prototype.logicalXor=function(e){return this.throwIfDisposed(),VS(this,e)},Zb().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Gw(this,e,t,n)},Zb().prototype.maxPool=function(e,t,n,a){return this.throwIfDisposed(),qS(this,e,t,n,a)},Zb().prototype.max=function(e,t){return this.throwIfDisposed(),Qk(this,e,t)},Zb().prototype.maximum=function(e){return this.throwIfDisposed(),YS(this,e)},Zb().prototype.mean=function(e,t){return this.throwIfDisposed(),QS(this,e,t)},Zb().prototype.min=function(e,t){return this.throwIfDisposed(),Jk(this,e,t)},Zb().prototype.minimum=function(e){return this.throwIfDisposed(),eN(this,e)},Zb().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),tN(this,e,t)},Zb().prototype.mod=function(e){return this.throwIfDisposed(),nN(this,e)},Zb().prototype.mul=function(e){return this.throwIfDisposed(),pw(this,e)},Zb().prototype.neg=function(){return this.throwIfDisposed(),DS(this)},Zb().prototype.norm=function(e,t,n){return this.throwIfDisposed(),rS(this,e,t,n)},Zb().prototype.notEqual=function(e){return this.throwIfDisposed(),iN(this,e)},Zb().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),oN(this,e,t,n)},Zb().prototype.onesLike=function(){return this.throwIfDisposed(),lN(this)},Zb().prototype.pad=function(e,t){return this.throwIfDisposed(),uN(this,e,t)},Zb().prototype.pool=function(e,t,n,a,r,s){return this.throwIfDisposed(),gN(this,e,t,n,a,r,s)},Zb().prototype.pow=function(e){return this.throwIfDisposed(),Zk(this,e)},Zb().prototype.prelu=function(e){return this.throwIfDisposed(),yN(this,e)},Zb().prototype.prod=function(e,t){return this.throwIfDisposed(),bN(this,e,t)},Zb().prototype.reciprocal=function(){return this.throwIfDisposed(),YN(this)},Zb().prototype.relu=function(){return this.throwIfDisposed(),QN(this)},Zb().prototype.relu6=function(){return this.throwIfDisposed(),JN(this)},Zb().prototype.reshapeAs=function(e){return this.throwIfDisposed(),Ww(this,e.shape)},Zb().prototype.reshape=function(e){return this.throwIfDisposed(),Ww(this,e)},Zb().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),jC(this,e,t,n)},Zb().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),BC(this,e,t,n)},Zb().prototype.reverse=function(e){return this.throwIfDisposed(),ZN(this,e)},Zb().prototype.rfft=function(){return this.throwIfDisposed(),xI(this)},Zb().prototype.round=function(){return this.throwIfDisposed(),aI(this)},Zb().prototype.rsqrt=function(){return this.throwIfDisposed(),rI(this)},Zb().prototype.selu=function(){return this.throwIfDisposed(),sI(this)},Zb().prototype.separableConv2d=function(e,t,n,a,r,s){return this.throwIfDisposed(),iI(this,e,t,n,a,r,s)},Zb().prototype.sigmoid=function(){return this.throwIfDisposed(),qw(this)},Zb().prototype.sign=function(){return this.throwIfDisposed(),lI(this)},Zb().prototype.sin=function(){return this.throwIfDisposed(),cI(this)},Zb().prototype.sinh=function(){return this.throwIfDisposed(),uI(this)},Zb().prototype.slice=function(e,t){return this.throwIfDisposed(),Kw(this,e,t)},Zb().prototype.softmax=function(e){return this.throwIfDisposed(),mI(this,e)},Zb().prototype.softplus=function(){return this.throwIfDisposed(),MS(this)},Zb().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),mN(this,e,t)},Zb().prototype.split=function(e,t){return this.throwIfDisposed(),vI(this,e,t)},Zb().prototype.sqrt=function(){return this.throwIfDisposed(),eS(this)},Zb().prototype.square=function(){return this.throwIfDisposed(),tS(this)},Zb().prototype.squaredDifference=function(e){return this.throwIfDisposed(),wI(this,e)},Zb().prototype.squeeze=function(e){return this.throwIfDisposed(),kI(this,e)},Zb().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof Jb?[this,e]:[this,...e];return SI(n,t)},Zb().prototype.step=function(e){return this.throwIfDisposed(),NI(this,e)},Zb().prototype.stridedSlice=function(e,t,n,a,r,s,i,o){return this.throwIfDisposed(),II(this,e,t,n,a,r,s,i,o)},Zb().prototype.sub=function(e){return this.throwIfDisposed(),PS(this,e)},Zb().prototype.sum=function(e,t){return this.throwIfDisposed(),nS(this,e,t)},Zb().prototype.tan=function(){return this.throwIfDisposed(),CI(this)},Zb().prototype.tanh=function(){return this.throwIfDisposed(),Xw(this)},Zb().prototype.tile=function(e){return this.throwIfDisposed(),cS(this,e)},Zb().prototype.toBool=function(){return this.throwIfDisposed(),iw(this,"bool")},Zb().prototype.toFloat=function(){return this.throwIfDisposed(),iw(this,"float32")},Zb().prototype.toInt=function(){return this.throwIfDisposed(),iw(this,"int32")},Zb().prototype.topk=function(e,t){return this.throwIfDisposed(),zI(this,e,t)},Zb().prototype.transpose=function(e){return this.throwIfDisposed(),XI(this,e)},Zb().prototype.unique=function(e){return this.throwIfDisposed(),BI(this,e)},Zb().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),WI(this,e,t)},Zb().prototype.unstack=function(e){return this.throwIfDisposed(),VI(this,e)},Zb().prototype.where=function(e,t){return this.throwIfDisposed(),Mk(e,this,t)},Zb().prototype.zerosLike=function(){return this.throwIfDisposed(),Ok(this)};var ZR=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},$R=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},eF=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},tF=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},nF=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},aF=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}};function rF(e,t){if(Array.isArray(e)){let n=[];for(let a=0;a<t;a++)n=n.concat(e);return n}{let n=new Array(t);return n.fill(e),n}}function sF(e,t){if(!e)throw new nF(t)}function iF(e,t){let n=0;for(let a of e)a===t&&n++;return n}function oF(e){return 1===e.length?e[0]:e}function lF(e){return Array.isArray(e)?e:[e]}function cF(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function uF(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}var dF={};function pF(e){if(null==e)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function hF(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach(e=>hF(e));else{let t=Object.keys(e);for(let n of t){let t=e[n];null!=t&&"object"==typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!=typeof t.value?hF(t):e[n]=t.value)}}}function fF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof e){let r,s=e;if(s in n)r=n[s];else if(s in dF)r=dF[s];else if(r=t[s],null==r)throw new eF("Unknown ".concat(a,": ").concat(e,". This may be due to one of the following reasons:\n1. The ").concat(a," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(a," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));return r}{let s=e;if(null==s.className||null==s.config)throw new eF("".concat(a,": Improper config format: ").concat(JSON.stringify(s),".\n'className' and 'config' must set."));let i,o,l=s.className;if(l in n?[i,o]=n[l]:l in dF?[i,o]=dF.className:l in t&&([i,o]=t[l]),null==i)throw new eF("Unknown ".concat(a,": ").concat(l,". This may be due to one of the following reasons:\n1. The ").concat(a," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(a," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));if(null!=o){let e={};for(let n of Object.keys(dF))e[n]=dF[n];for(let r of Object.keys(n))e[r]=n[r];s.config.customObjects=e;let t=Object.assign({},dF);for(let r of Object.keys(n))dF[r]=n[r];hF(s.config);let a=o(i,s.config,n,r);return dF=Object.assign({},t),a}{let e=Object.assign({},dF);for(let a of Object.keys(n))dF[a]=n[a];let t=new i(s.config);return dF=Object.assign({},e),t}}}function mF(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function gF(e){if(null==e)return e;let t=[];for(let n of e)-1===t.indexOf(n)&&t.push(n);return t}function yF(e){if(null==e)throw new eF("Invalid value in obj: ".concat(JSON.stringify(e)));for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function bF(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new eF("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function vF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return sF(n>=0),sF(a>=n),Array.isArray(e)&&e.length>=n&&e.length<=a&&e.every(e=>typeof e===t)}function xF(e,t){Array.isArray(e)?(gb.assert(e.length>0,()=>"".concat(t," is unexpectedly an empty array.")),e.forEach((e,n)=>xF(e,"element ".concat(n+1," of ").concat(t)))):gb.assert(Number.isInteger(e)&&e>0,()=>"Expected ".concat(t," to be a positive integer, but got ").concat(wF(e),"."))}function wF(e){return null===e?"null":Array.isArray(e)?"["+e.map(e=>wF(e)).join(",")+"]":"string"==typeof e?'"'.concat(e,'"'):"".concat(e)}function kF(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var SF=0;function NF(){return SF++}var IF={};function CF(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in IF||(IF[e]=0),IF[e]+=1,e+IF[e].toString()}var TF=["channelsFirst","channelsLast"],EF=["nearest","bilinear"],_F=["valid","same","causal"],AF=["max","avg"],RF=["sum","mul","concat","ave"],FF=new Map;function DF(e){bF(TF,"DataFormat",e)}function MF(e){bF(_F,"PaddingMode",e)}function OF(e){bF(AF,"PoolMode",e)}var PF=[];function LF(e,t){PF.push(e);try{let e=t();return PF.pop(),e}catch(uae){throw PF.pop(),uae}}function zF(e){if(!VF(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===PF.length?"":PF.join("/")+"/")+e}function jF(e){if(!VF(e))throw new Error("Not a valid tensor name: '"+e+"'");FF.has(e)||FF.set(e,0);let t=FF.get(e);if(FF.set(e,FF.get(e)+1),t>0){let n="".concat(e,"_").concat(t);return FF.set(n,1),n}return e}var BF,WF=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function VF(e){return!!e.match(WF)}function UF(e){return e===parseInt(e.toString(),10)}function HF(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let a=1;for(let r=t;r<n;++r)a*=e[r];return a}function GF(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let a=e[n];a<t&&(t=a)}return t}function qF(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let a=e[n];a>t&&(t=a)}return t}function KF(e,t){if(t<e)throw new eF("end (".concat(t,") < begin (").concat(e,") is forbidden."));let n=[];for(let a=e;a<t;++a)n.push(a);return n}function XF(){return null==BF&&(BF=ix().epsilon()),BF}function YF(e,t){return iw(e,t)}function QF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),Ww(e,n)}function JF(e,t,n){return Yv(()=>{switch(e.rank){case 1:return dI(e,t,n);case 2:return pI(e,[t,0],[n,e.shape[1]]);case 3:return hI(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return fI(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Kw(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Kw(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new eF("sliceAlongFirstAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function ZF(e,t,n){return Yv(()=>{switch(e.rank){case 1:return dI(e,t,n);case 2:return pI(e,[0,t],[e.shape[0],n]);case 3:return hI(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return fI(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new eF("sliceAlongLastAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function $F(e,t,n,a){return Yv(()=>{switch(e.rank){case 1:return dI(e,t,n);case 2:switch(a){case 1:return JF(e,t,n);case 2:return ZF(e,t,n);default:throw new eF("The axis is not within the rank of the tensor ".concat(a))}case 3:switch(a){case 1:return JF(e,t,n);case 2:return hI(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return ZF(e,t,n);default:throw new eF("The axis is not within the rank of the tensor ".concat(a))}case 4:switch(a){case 1:return JF(e,t,n);case 2:return fI(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return fI(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return ZF(e,t,n);default:throw new eF("The axis is not within the rank of the tensor ".concat(a))}default:throw new eF("sliceAlongLastAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function eD(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),Hw(e,n)}function tD(e,t){switch(e.rank){case 1:return ck([e,t]);case 2:return uk([e,t],0);case 3:return dk([e,t],0);case 4:return pk([e,t],0);default:throw new eF("concatAlongFirstAxis() received an unsupported tensor rank: ".concat(e.rank))}}function nD(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new eF("The length of input n (".concat(t.length,") does not match the number of dimensions in input x (").concat(e.rank,")"));return cS(e,t)}function aD(e){return UN(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function rD(e,t,n,a){if(e.rank<2||t.rank<2)throw new tF("dot requires both inputs to be rank >= 2 but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new tF("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ".concat(e.shape," and  y shape = ").concat(t.shape))}if(2===e.rank&&2===t.rank)return aC.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?oD(e.rank,a,"channelsLast"):null,activation:n});{let r=e.shape.slice(),s=r.pop();e=Ww(e,[-1,s]);let i=t.shape.slice(),o=i.pop(),l=i.pop(),c=[...i,o],u=Array.from({length:t.rank},(e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n);t=Ww(XI(t,u),[l,-1]);let d=[...r,...c];return Ww(aC.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?oD(e.rank,a,"channelsLast"):null,activation:n}),d)}}function sD(e,t,n){return Yv(()=>(t=Array.isArray(t)?TI(t,"int32"):iw(t,"int32"),pS(e,t,n)))}function iD(e){return pw(e,e)}function oD(e,t,n){let a=t.shape;if(1!==t.rank&&t.rank!==e)throw new eF("Unexpected bias dimensions: ".concat(t.rank,"; expected it to be 1 or ").concat(e));if(5===e){if("channelsFirst"===n)return 1===a.length?Ww(t,[1,a[0],1,1,1]):Ww(t,[1,a[3],a[0],a[1],a[2]]);if("channelsLast"===n)return 1===a.length?Ww(t,[1,1,1,1,a[0]]):Ww(t,[1].concat(a))}else if(4===e){if("channelsFirst"===n)return 1===a.length?Ww(t,[1,a[0],1,1]):Ww(t,[1,a[2],a[0],a[1]]);if("channelsLast"===n)return 1===a.length?Ww(t,[1,1,1,a[0]]):Ww(t,[1].concat(a))}else if(3===e){if("channelsFirst"===n)return 1===a.length?Ww(t,[1,a[0],1]):Ww(t,[1,a[1],a[0]]);if("channelsLast"===n)return 1===a.length?Ww(t,[1,1,a[0]]):Ww(t,[1].concat(a))}else if(e<3)return t;throw new eF("Unsupported input rank by biasAdd: ".concat(t.rank))}function lD(e,t,n){return Yv(()=>(null==n&&(n="channelsLast"),DF(n),cw(e,oD(e.rank,t,n))))}function cD(e,t,n,a){return Yv(()=>$I(e,t,n,a))}function uD(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}var dD=["fanIn","fanOut","fanAvg"],pD=["normal","uniform","truncatedNormal"];var hD=class extends bT.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},fD=class extends hD{apply(e,t){return JS(e,t)}};fD.className="Zeros",bT.registerClass(fD);var mD=class extends hD{apply(e,t){return ZS(e,t)}};mD.className="Ones",bT.registerClass(mD);var gD=class extends hD{constructor(e){if(super(),"object"!=typeof e)throw new eF("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new eF("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return Yv(()=>pw($k(this.value),ZS(e,t)))}getConfig(){return{value:this.value}}};gD.className="Constant",bT.registerClass(gD);var yD=class extends hD{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return GN(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};yD.className="RandomUniform",bT.registerClass(yD);var bD=class extends hD{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new tF("randomNormal does not support dType ".concat(t,"."));return aD(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};bD.className="RandomNormal",bT.registerClass(bD);var vD=class extends hD{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new tF("truncatedNormal does not support dType ".concat(t,"."));return jI(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};vD.className="TruncatedNormal",bT.registerClass(vD);var xD=class extends hD{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return Yv(()=>{if(2!==e.length||e[0]!==e[1])throw new eF("Identity matrix initializer can only be used for 2D square matrices.");return pw(this.gain,uS(e[0]))})}getConfig(){return{gain:this.gain}}};xD.className="Identity",bT.registerClass(xD);var wD=class extends hD{constructor(e){if(super(),e.scale<0)throw new eF("scale must be a positive float. Got: ".concat(e.scale));this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,function(e){bF(dD,"FanMode",e)}(this.mode),this.distribution=null==e.distribution?"normal":e.distribution,function(e){bF(pD,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){let n=function(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(DF(a),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===a){let a=HF(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===a){let a=HF(e,0,e.length-2);t=e[e.length-2]*a,n=e[e.length-1]*a}}else{let a=HF(e);t=Math.sqrt(a),n=Math.sqrt(a)}return[t,n]}(e),a=n[0],r=n[1],s=this.scale;if("fanIn"===this.mode?s/=Math.max(1,a):"fanOut"===this.mode?s/=Math.max(1,r):s/=Math.max(1,(a+r)/2),"normal"===this.distribution){let n=Math.sqrt(s);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new tF("".concat(this.getClassName()," does not support dType ").concat(t,"."));return jI(e,0,n,t,this.seed)}{let n=Math.sqrt(3*s);return GN(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};wD.className="VarianceScaling",bT.registerClass(wD);var kD=class extends wD{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return wD.className}};kD.className="GlorotUniform",bT.registerClass(kD);var SD=class extends wD{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return wD.className}};SD.className="GlorotNormal",bT.registerClass(SD);var ND=class extends wD{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return wD.className}};ND.className="HeNormal",bT.registerClass(ND);var ID=class extends wD{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return wD.className}};ID.className="HeUniform",bT.registerClass(ID);var CD=class extends wD{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return wD.className}};CD.className="LeCunNormal",bT.registerClass(CD);var TD=class extends wD{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return wD.className}};TD.className="LeCunUniform",bT.registerClass(TD);var ED=class extends hD{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return Yv(()=>{if(e.length<2)throw new tF("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));let n=gb.sizeFromShape(e.slice(0,-1)),a=e[e.length-1],r=n*a;r>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(r,") elements: Slowness may result."));let s=aD([Math.max(a,n),Math.min(a,n)],0,1,t,this.seed),i=fT.qr(s,!1),o=i[0],l=i[1].flatten().stridedSlice([0],[Math.min(a,n)*Math.min(a,n)],[Math.min(a,n)+1]);return o=pw(o,l.sign()),n<a&&(o=o.transpose()),pw($k(this.gain),o.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};ED.className="Orthogonal",bT.registerClass(ED);var _D={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function AD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fF(e,bT.SerializationMap.getMap().classNameMap,t,"initializer")}function RD(e){return pF(e)}function FD(e){if("string"==typeof e){let t=e in _D?_D[e]:e;if("GlorotNormal"===t)return new SD;if("GlorotUniform"===t)return new kD;if("HeNormal"===t)return new ND;if("HeUniform"===t)return new ID;if("LeCunNormal"===t)return new CD;if("LeCunUniform"===t)return new TD;{let e={};return e.className=t,e.config={},AD(e)}}return e instanceof hD?e:AD(e)}function DD(e){return Array.isArray(e)&&Array.isArray(e[0])}function MD(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function OD(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new eF("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function PD(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new eF("Expected exactly 1 Shape; got ".concat(e.length))}return e}function LD(e){let t=0;for(let n of e)0===n.shape.length?t+=1:t+=n.shape.reduce((e,t)=>e*t);return t}var zD="Variable",jD=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zD,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=NF(),n=null==n?zD:n,this.originalName=zF(n),this.name=jF(this.originalName),this.trainable_=a,this.constraint=r,this.val=HI(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function BD(e){return e.map(e=>e.read())}function WD(e){e.forEach(e=>{e[0].write(e[1])})}var VD=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},UD=class{constructor(e,t,n,a,r,s,i){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=a,this.callArgs=r,this.outputTensorIndex=i,this.id=NF(),null!=s&&(this.originalName=zF(s),this.name=jF(this.originalName)),this.rank=t.length}},HD=0,GD=class{constructor(e,t){this.callArgs=t,this.id=HD++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},qD=0,KD=class extends bT.Serializable{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=qD++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let e=this.getClassName();t=cF(e)+"_"+CF(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new $R("The layer has never been called and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new eF("Asked to get ".concat(t," at node ").concat(e,", but the layer has only ").concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return oF(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return oF(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ZR("Layer ".concat(this.name,' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.'));if(0===this.inboundNodes.length)throw new ZR("Layer ".concat(this.name," is not connected, no input to return."));return oF(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new ZR("Layer ".concat(this.name," has no inbound nodes."));if(this.inboundNodes.length>1)throw new ZR("Layer ".concat(this.name,' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.'));return oF(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){let t=lF(e);if(null==this.inputSpec||0===this.inputSpec.length)return;let n=lF(this.inputSpec);if(t.length!==n.length)throw new eF("Layer ".concat(this.name," expects ").concat(n.length," inputs, but it received ").concat(t.length," input tensors. Input received: ").concat(e));for(let a=0;a<t.length;a++){let e=t[a],r=n[a];if(null==r)continue;let s=e.rank;if(null!=r.ndim&&s!==r.ndim)throw new eF("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected ndim=").concat(r.ndim,", found ndim=").concat(s));if(null!=r.maxNDim&&s>r.maxNDim)throw new eF("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected max_ndim=").concat(r.maxNDim,", found ndim=").concat(s));if(null!=r.minNDim&&s<r.minNDim)throw new eF("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected min_ndim=").concat(r.minNDim,", found ndim=").concat(s,"."));if(null!=r.dtype&&e.dtype!==r.dtype)throw new eF("Input ".concat(a," is incompatible with layer ").concat(this.name," : expected dtype=").concat(r.dtype,", found dtype=").concat(e.dtype,"."));if(r.axes){let t=e.shape;for(let e in r.axes){let n=Number(e),s=r.axes[e],i=n>=0?t[n]:t[t.length+n];if(null!=s&&-1===[s,null].indexOf(i))throw new eF("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected axis ").concat(n," of input shape to have value ").concat(s," but got shape ").concat(t,"."))}}if(null!=r.shape)for(let t=0;t<r.shape.length;++t){let n=r.shape[t],s=e.shape[t];if(null!=n&&null!=s&&n!==s)throw new eF("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected shape=").concat(r.shape,", found shape=").concat(e.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=lF(e),a=function(e){let t=!0;for(let n of lF(e))if(!(n instanceof UD)){t=!1;break}return t}(e),r=function(e){let t=!0;for(let n of lF(e))if(n instanceof UD){t=!1;break}return t}(e);if(a===r)throw new eF("Arguments to apply() must be all SymbolicTensors or all Tensors");return LF(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let t=[];for(let n of lF(e))t.push(n.shape);this.build(oF(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);let r=lF(a),s=[];for(let e of r)-1!==n.indexOf(e)&&(e=e.clone()),s.push(e);if(a=oF(s),null!=this.activityRegularizer)throw new tF("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}{let n,a=function(e){e=lF(e);let t=[];for(let n of e)t.push(n.shape);return oF(t)}(e),r=this.computeOutputShape(a),s="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),n=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,a)=>new UD(s,n,this,lF(e),t,this.name,a)):new UD(s,r,this,lF(e),t,this.name),this.addInboundNode(e,n,null,null,a,r,t),this._refCount++,null!=this.activityRegularizer)throw new tF("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return n}})}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: ".concat(JSON.stringify(e),") does not match that of the batchInputShape (").concat(JSON.stringify(this.batchInputShape),") of the layer ").concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,a)=>{null!=n&&null!=e[a]&&e[a]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor (".concat(JSON.stringify(e),") does not match the expectation of layer ").concat(this.name,": ").concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new ZR("The layer ".concat(this.name," has never been called and thus has no defined output shape."));let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new ZR("The layer ".concat(this.name,' has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.'))}countParams(){if(!this.built)throw new $R("You tried to call countParams() on ".concat(this.name,", but the layer is not built yet. Build it first by calling build(batchInputShape)."));return LD(this.weights)}build(e){this.built=!0}getWeights(){return BD(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){Yv(()=>{let t=this.weights;if(t.length!==e.length)throw new eF('You called setWeights(weights) on layer "'.concat(this.name,'" with a weight list of length ').concat(e.length,", but the layer was expecting ").concat(t.length," weights. Provided weights: ").concat(e,"..."));if(0===t.length)return;let n=[],a=BD(t);for(let r=0;r<a.length;++r){let s=a[r],i=t[r],o=e[r];if(!gb.arraysEqual(s.shape,o.shape))throw new eF("Layer weight shape ".concat(s.shape," not compatible with provided weight shape ").concat(o.shape));n.push([i,o])}WD(n)})}addWeight(e,t,n,a,r,s,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new eF("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(a=null!=o?o():FD("zeros"));let l=a.apply(t,n),c=new jD(l,n,e,s,i);return l.dispose(),null!=r&&this.addLoss(()=>r.apply(c.read())),null==s&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=lF(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, but was passed an inputMask."));t.forEach(e=>{if(null!=e)throw new TypeError("Layer ".concat(this.name," does not support masking, but was passed an inputMask."))})}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;let a=this.computeMask(e,n),r=lF(t),s=lF(a);if(r.length!==s.length)throw new Error("".concat(this.name," outputs ").concat(r.length," tensors but ").concat(r.length," masks for those tensors"));for(let i=0;i<r.length;i++)r[i].kerasMask=s[i]}addInboundNode(e,t,n,a,r,s){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=lF(e);t=lF(t),n=lF(n),a=lF(a),r=MD(r),s=MD(s);let l=[],c=[],u=[];for(let d of o)l.push(d.sourceLayer),c.push(d.nodeIndex),u.push(d.tensorIndex);new GD({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:u,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:a,inputShapes:r,outputShapes:s},i);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){let e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been built yet."));if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used yet."));this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function XD(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{let e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{let t=[];for(let n=0;n<e.inboundLayers.length;n++){let a=XD(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(let e of a)-1===t.indexOf(e)&&t.push(e)}return t}}}var YD=class extends KD{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:CF("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new eF("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new eF("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new eF("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let a=new UD(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new GD({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new eF("Cannot pass any input to an InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};function QD(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new eF("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new YD({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}YD.className="InputLayer",bT.registerClass(YD);var JD=class e{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(let e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(let e of t)this.add(e.key,e.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new eF("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,n){if(null==e.dtype||e.dtype===n.dtype)return n;try{return iw(n,e.dtype)}catch(t){throw new eF("The dtype of the feed (".concat(n.dtype,") can not be cast to the dtype of the key '").concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof UD){if(null==this.id2Value[e.id])throw new eF("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}{let t=this.name2Id[e];if(null==t)throw new eF("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof UD){if(null==this.id2Value[e.id])throw new eF("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}{let t=this.name2Id[e];if(null==t)throw new eF("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&Qv(this.id2Mask)}},ZD=new aF,$D=new aF;function eM(e,t,n,a){let r=null!=n&&n.training,s=Array.isArray(e),i=s?e:[e],o=i.map(e=>e.name),l=[],c=t.names();for(let f of o)-1!==c.indexOf(f)?l.push(t.getValue(f)):l.push(null);null!=a&&(a.maxNumTensors=-1/0,a.minNumTensors=1/0);let u,d=o.join(",")+"|"+t.names().sort().join(","),p=ZD.get(d);if(null==p){let e=function(e,t){gb.assert(null!=e&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],a={};if(1===e.length){let r=nM(e[0],t);n=r.sorted,a=r.recipientMap}else{let r=new Set;for(let s of e){let{sorted:e,recipientMap:i}=nM(s,t);for(let t of e)r.has(t.name)||(n.push(t),r.add(t.name));for(let t in i)null==a[t]&&(a[t]=new Set),i[t].forEach(e=>a[t].add(e))}}return{sorted:n,recipientCounts:tM(a)}}(i,t);p=e.sorted,u=e.recipientCounts,ZD.put(d,p),$D.put(d,u)}u={},r||Object.assign(u,$D.get(d));let h=new JD(t);for(let f=0;f<p.length;++f){if(null!=a){let e=Kv().numTensors;e>a.maxNumTensors&&(a.maxNumTensors=e),e<a.minNumTensors&&(a.minNumTensors=e)}let e=p[f],s=e.sourceLayer;if(s instanceof YD)continue;let i=[],c=[],d=[],m=!1;for(let n of e.inputs){let e=h.getValue(n),a=h.getMask(n);i.push(e),c.push(a),null!=a&&(m=!0),r||(u[n.name]--,0===u[n.name]&&!t.hasKey(n)&&-1===o.indexOf(n.name)&&!e.isDisposed&&!0!==n.sourceLayer.stateful&&d.push(e))}m&&((n=n||{}).mask=c[0]);let g=lF(s.apply(i,n)),y=null;s.supportsMasking&&(y=s.computeMask(i,c));let b=aM(e),v=Array.isArray(b)?b:[b];for(let t=0;t<v.length;++t){h.hasKey(v[t])||h.add(v[t],g[t],Array.isArray(y)?y[0]:y);let e=o.indexOf(v[t].name);-1!==e&&(l[e]=g[t])}r||Qv(d)}return h.disposeMasks(),s?l:l[0]}function tM(e){let t={};for(let n in e)t[n]=e[n].size;return t}function nM(e,t){let n=new Set,a=[],r={};for(let o of t.names())n.add(o);let s=[],i=[];for(s.push(e);s.length>0;){let e=s[s.length-1];if(n.has(e.name)){s.pop();continue}let t=i[i.length-1]===s.length-1;if(0===e.inputs.length||t)s.pop(),a.push(e),n.add(e.name),t&&i.pop();else{i.push(s.length-1);for(let t of e.inputs)null==r[t.name]&&(r[t.name]=new Set),r[t.name].add(e.name),!n.has(t.name)&&s.push(t)}}return{sorted:a,recipientMap:r}}function aM(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(let a of e.sourceLayer.inboundNodes[t].outputTensors)if(a.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}Mf().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function(e){null!=ZD&&ZD.setMaxEntries(e),null!=$D&&$D.setMaxEntries(e)});var rM={};function sM(e,t){return Yv(()=>eS(nS(pw(e,e),t,!0)))}uh(rM,{maxNorm:()=>mM,minMaxNorm:()=>bM,nonNeg:()=>yM,unitNorm:()=>gM});var iM=class extends bT.Serializable{getConfig(){return{}}},oM=class extends iM{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Yv(()=>{let t=sM(e,this.axis),n=lk(t,0,this.maxValue);return pw(e,dw(n,cw(XF(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};oM.className="MaxNorm",bT.registerClass(oM);var lM=class extends iM{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Yv(()=>dw(e,cw(XF(),sM(e,this.axis))))}getConfig(){return{axis:this.axis}}};lM.className="UnitNorm",bT.registerClass(lM);var cM=class extends iM{apply(e){return QN(e)}};cM.className="NonNeg",bT.registerClass(cM);var uM=class extends iM{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Yv(()=>{let t=sM(e,this.axis),n=cw(pw(this.rate,lk(t,this.minValue,this.maxValue)),pw(1-this.rate,t));return pw(e,dw(n,cw(XF(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};uM.className="MinMaxNorm",bT.registerClass(uM);var dM={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function pM(e){return pF(e)}function hM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fF(e,bT.SerializationMap.getMap().classNameMap,t,"constraint")}function fM(e){if(null==e)return null;if("string"==typeof e){return hM({className:e in dM?dM[e]:e,config:{}})}return e instanceof iM?e:hM(e)}function mM(e){return new oM(e)}function gM(e){return new lM(e)}function yM(){return new cM}function bM(e){return new uM(e)}var vM={};function xM(){return new fD}function wM(){return new mD}function kM(e){return new gD(e)}function SM(e){return new yD(e)}function NM(e){return new bD(e)}function IM(e){return new vD(e)}function CM(e){return new xD(e)}function TM(e){return new wD(e)}function EM(e){return new kD(e)}function _M(e){return new SD(e)}function AM(e){return new ND(e)}function RM(e){return new ID(e)}function FM(e){return new CD(e)}function DM(e){return new TD(e)}function MM(e){return new ED(e)}uh(vM,{constant:()=>kM,glorotNormal:()=>_M,glorotUniform:()=>EM,heNormal:()=>AM,heUniform:()=>RM,identity:()=>CM,leCunNormal:()=>FM,leCunUniform:()=>DM,ones:()=>wM,orthogonal:()=>MM,randomNormal:()=>NM,randomUniform:()=>SM,truncatedNormal:()=>IM,varianceScaling:()=>TM,zeros:()=>xM});var OM,PM={};async function LM(e){if(null==e)return;let t=[],n=[],a=[];for(let r in e){let s=e[r];if("number"!=typeof s){let e=s;t.push(e.data()),n.push(r),a.push(e)}}if(t.length>0){let r=await Promise.all(t);for(let t=0;t<r.length;++t)e[n[t]]=r[t][0];Qv(a)}}function zM(e){if(null!=e)for(let t in e){let n=e[t];"number"!=typeof n&&n.dispose()}}uh(PM,{Layer:()=>KD,RNN:()=>ZP,RNNCell:()=>$P,activation:()=>Rz,add:()=>Bz,alphaDropout:()=>Aj,average:()=>Wz,averagePooling1d:()=>Qz,averagePooling2d:()=>$z,averagePooling3d:()=>nj,avgPool1d:()=>Jz,avgPool2d:()=>ej,avgPool3d:()=>aj,avgPooling1d:()=>Zz,avgPooling2d:()=>tj,avgPooling3d:()=>rj,batchNormalization:()=>Kz,bidirectional:()=>kj,categoryEncoding:()=>Oj,centerCrop:()=>Dj,concatenate:()=>Vz,conv1d:()=>kz,conv2d:()=>Sz,conv2dTranspose:()=>Nz,conv3d:()=>Iz,conv3dTranspose:()=>Cz,convLstm2d:()=>bj,convLstm2dCell:()=>vj,cropping2D:()=>Ez,dense:()=>Fz,depthwiseConv2d:()=>Az,dot:()=>qz,dropout:()=>Dz,elu:()=>gz,embedding:()=>jz,flatten:()=>Oz,gaussianDropout:()=>_j,gaussianNoise:()=>Ej,globalAveragePooling1d:()=>sj,globalAveragePooling2d:()=>ij,globalMaxPool1d:()=>Nj,globalMaxPool2d:()=>Ij,globalMaxPooling1d:()=>oj,globalMaxPooling2d:()=>lj,gru:()=>pj,gruCell:()=>hj,input:()=>JO,inputLayer:()=>mz,layerNormalization:()=>Xz,leakyReLU:()=>bz,lstm:()=>fj,lstmCell:()=>mj,masking:()=>Rj,maxPool1d:()=>Cj,maxPool2d:()=>Tj,maxPooling1d:()=>cj,maxPooling2d:()=>uj,maxPooling3d:()=>dj,maximum:()=>Uz,minimum:()=>Hz,multiply:()=>Gz,permute:()=>zz,prelu:()=>vz,randomWidth:()=>Pj,reLU:()=>yz,repeatVector:()=>Pz,rescaling:()=>Fj,reshape:()=>Lz,resizing:()=>Mj,rnn:()=>xj,separableConv2d:()=>Tz,simpleRNN:()=>gj,simpleRNNCell:()=>yj,softmax:()=>xz,spatialDropout1d:()=>Mz,stackedRNNCells:()=>wj,thresholdedReLU:()=>wz,timeDistributed:()=>Sj,upSampling2d:()=>_z,zeroPadding2d:()=>Yz}),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(OM||(OM={}));var jM=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},BM=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},WM=class extends jM{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});let n=null==t.size?0:t.size;this.seen+=n;for(let a in t){let e=t[a];if("number"==typeof e)this.totals.hasOwnProperty(a)||(this.totals[a]=0),this.totals[a]=this.totals[a]+e*n;else{let t;a in this.totals?t=this.totals[a]:this.totals[a]=0;let r=Yv(()=>cw(this.totals[a],pw(e,n)));this.totals[a]=r,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(let n of this.params.metrics)null!=this.totals[n]&&("number"==typeof this.totals[n]?t[n]=this.totals[n]/this.seen:Yv(()=>{let e=pw(dw(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),Jv(t[n])}))}},VM=class extends jM{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(let n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let r in this.history){let a=this.history[r];for(let s=0;s<a.length;++s)if("number"!=typeof a[s]){let i=a[s];e.push(i.data()),t.push(r),n.push(s)}}let a=await Promise.all(e);for(let r=0;r<a.length;++r)this.history[t[r]][n[r]].dispose(),this.history[t[r]][n[r]]=a[r][0]}},UM=class extends jM{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||jE,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");gb.isNumber(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let a,r=null!=n?n():gb.now();return function(){let s=null!=n?n():gb.now();return s-r<t||(r=s,a=e(...arguments)),a}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let a=[];null!=this.yield&&(await LM(n),a.push(this.yield(e,t,n))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await LM(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];null!=this.epochEnd&&(await LM(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await LM(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];null!=this.batchEnd&&(await LM(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):gb.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await LM(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await LM(e),await this.trainEnd(e))}};function HM(e,t){return null==e&&(e={}),e instanceof jM?[e]:Array.isArray(e)&&e[0]instanceof jM?e:lF(e).map(e=>new UM(e,t))}var GM=class e{constructor(){}static registerCallbackConstructor(t,n){gb.assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, but got ".concat(t)),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}static checkForDuplicate(t){for(let n in e.constructors)e.constructors[+n].forEach(e=>{if(e===t)throw new eF("Duplicate callback constructor.")})}static clear(){e.constructors={}}static createCallbacks(t){let n=[];for(let a in e.constructors){let r=+a;t>=r&&n.push(...e.constructors[r])}return n.map(e=>new e)}};function qM(e,t,n,a,r,s,i,o,l){let c=new VM,u=[new WM,...GM.createCallbacks(t)];null!=e&&u.push(...e),u.push(c);let d=new BM(u);return d.setParams({epochs:n,initialEpoch:a,samples:r,steps:s,batchSize:i,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:c}}function KM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return fF(e,bT.SerializationMap.getMap().classNameMap,t,"layer",n)}function XM(e,t){return Yv(()=>{"float32"!==e.dtype&&(e=iw(e,"float32"));let n=nS(iD(e),t,!0),a=ok(n.shape,XF()),r=eS(YS(n,a));return dw(e,r)})}function YM(e,t){return Yv(()=>QS(iD(PS(t,e)),-1))}function QM(e,t){return Yv(()=>QS(hw(PS(t,e)),-1))}function JM(e,t){return Yv(()=>{let n=PS(e,t),a=lk(hw(e),XF(),Number.MAX_VALUE),r=hw(dw(n,a));return pw(100,QS(r,-1))})}function ZM(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Yv(()=>{if(n)t=mI(t);else{let e=nS(t,t.shape.length-1,!0);t=dw(t,e)}return t=lk(t,XF(),1-XF()),DS(nS(pw(iw(e,"float32"),NS(t)),t.shape.length-1))})}function $M(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Yv(()=>{let a=iw(dS(function(e){let t=[HF(e.shape)];return Ww(e,t)}(e)),"int32"),r=(t=lk(t,XF(),1-XF())).shape;return ZM(Ww(oN(a,r[r.length-1]),r),t,n)})}function eO(e,t){return Yv(()=>{let n;return n=lk(t,XF(),1-XF()),n=NS(dw(n,PS(1,n))),QS(function(e,t){if(!gb.arraysEqual(e.shape,t.shape))throw new eF("logits and labels must have the same shape, but got shapes ".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Yv(()=>{let n=QN(t),a=DS(hw(t));return cw(PS(n,pw(t,e)),IS(iS(a)))})}(e,n),-1)})}function tO(e,t){return Yv(()=>{let n=XM(e,-1),a=XM(t,-1),r=pw(n,a);return DS(nS(r,-1))})}GM.constructors={};var nO={meanSquaredError:YM,meanAbsoluteError:QM,meanAbsolutePercentageError:JM,meanSquaredLogarithmicError:function(e,t){return Yv(()=>{let n=lk(t,XF(),Number.MAX_VALUE),a=NS(cw(1,n)),r=lk(e,XF(),Number.MAX_VALUE),s=NS(cw(1,r));return QS(iD(PS(a,s)),-1)})},squaredHinge:function(e,t){return Yv(()=>{let n=YS(0,PS(1,pw(e,t)));return QS(iD(n),-1)})},hinge:function(e,t){return Yv(()=>{let n=YS(0,PS(1,pw(e,t)));return QS(n,-1)})},categoricalHinge:function(e,t){return Yv(()=>{let n=nS(pw(e,t),-1),a=Qk(pw(PS(1,e),t),-1);return YS(0,cw(1,PS(a,n)))})},logcosh:function(e,t){return Yv(()=>{let n=Math.log(2),a=PS(t,e),r=PS(cw(a,MS(pw(-2,a))),n);return QS(r,-1)})},categoricalCrossentropy:ZM,sparseCategoricalCrossentropy:$M,binaryCrossentropy:eO,kullbackLeiblerDivergence:function(e,t){return Yv(()=>{let n=lk(e,XF(),1),a=lk(t,XF(),1);return nS(pw(e,NS(dw(n,a))),-1)})},poisson:function(e,t){return Yv(()=>{let n=NS(cw(XF(),t));return QS(PS(t,pw(e,n)),-1)})},cosineProximity:tO};function aO(e){if("string"==typeof e){if(e in nO)return nO[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy')),new eF(t)}return e}function rO(e,t){return Yv(()=>{let n=pw(.5,lN(t)),a=YF(hS(t,n),e.dtype);return QS(Dk(e,a),-1)})}function sO(e,t){return Yv(()=>YF(Dk(vw(e,-1),vw(t,-1)),"float32"))}function iO(e,t){return Yv(()=>iw(nS(jS(Dk(e,1),Dk(t,1))),"float32"))}function oO(e,t){return Yv(()=>{let n=iO(e,t),a=function(e,t){return Yv(()=>iw(nS(jS(Dk(e,0),Dk(t,1))),"float32"))}(e,t),r=cw(n,a);return iw(Mk(hS(r,0),dw(n,r),0),"float32")})}function lO(e,t){return Yv(()=>{let n=iO(e,t),a=function(e,t){return Yv(()=>iw(nS(jS(Dk(e,1),Dk(t,0))),"float32"))}(e,t),r=cw(n,a);return iw(Mk(hS(r,0),dw(n,r),0),"float32")})}function cO(e,t){return eO(e,t)}function uO(e,t){return e.rank===t.rank&&(e=kI(e,[e.rank-1])),(t=vw(t,-1)).dtype!==e.dtype&&(t=iw(t,e.dtype)),iw(Dk(e,t),"float32")}var dO=ZM,pO=$M,hO={binaryAccuracy:rO,categoricalAccuracy:sO,precision:oO,categoricalCrossentropy:dO,sparseCategoricalCrossentropy:pO,mse:YM,MSE:YM,mae:QM,MAE:QM,mape:JM,MAPE:JM,cosine:tO};function fO(e){if("string"==typeof e&&e in hO)return hO[e];if("string"!=typeof e&&null!=e)return e;throw new eF("Unknown metric ".concat(e))}function mO(e){if(sF(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"==typeof e)return e;{let t;for(let n of Object.keys(nO))if(nO[n]===e){t=n;break}if(void 0!==t)return t;for(let n of Object.keys(hO))if(hO[n]===e){t=n;break}return void 0!==t?t:e.name}}function gO(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!yO(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let n=JSON.stringify(e);n.length>1048576&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in size (length=').concat(n.length," when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576."))}}function yO(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if("string"!=typeof n||!yO(e[n]))return!1;return!0}if(Array.isArray(e)){for(let t of e)if(!yO(t))return!1;return!0}return!1}{let t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function bO(e,t,n){let a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,s=function(e){let t=!0,n=[],a=[];for(let r in e.nodesByDepth)n.push(e.nodesByDepth[r]);for(let r of n){if(r.length>1||1===r.length&&r[0].inboundLayers.length>1){t=!1;break}a.push(...r)}if(t)for(let r of e.layers){let e=!1;for(let n of r.inboundNodes)if(-1!==a.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),i=["Layer (type)","Input Shape","Output shape","Param #"];if(s?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(e=>Math.floor(t*e))),!s){i.push("Receives inputs"),a=[];for(let t in e.nodesByDepth)a.push(...e.nodesByDepth[t])}r("_".repeat(t)),vO(i,n,r),r("=".repeat(t));let o=e.layers;for(let u=0;u<o.length;++u)s?xO(o[u],n,r):wO(o[u],n,a,r),r((u===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=function(e){let t;return t=null!=e.collectedTrainableWeights?LD(e.collectedTrainableWeights):LD(e.trainableWeights),t}(e),c=LD(e.nonTrainableWeights);r("Total params: ".concat(l+c)),r("Trainable params: ".concat(l)),r("Non-trainable params: ".concat(c)),r("_".repeat(t))}function vO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,a="";for(let r=0;r<e.length;++r)r>0&&(a=a.slice(0,a.length-1)+" "),a+=e[r],a=a.slice(0,t[r]),a+=" ".repeat(t[r]-a.length);n(a)}function xO(e,t,n){let a,r;try{r=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(o){r="multiple"}try{a=JSON.stringify(e.outputShape)}catch(o){a="multiple"}let s=e.name,i=e.getClassName();vO(["".concat(s," (").concat(i,")"),r,a,e.countParams().toString()],t,n)}function wO(e,t,n,a){let r,s;try{s=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(u){s="multiple"}try{r=JSON.stringify(e.outputShape)}catch(u){r="multiple"}let i=[];for(let d of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(d)))for(let e=0;e<d.inboundLayers.length;++e){let t=d.inboundLayers[e].name,n=d.nodeIndices[e],a=d.tensorIndices[e];i.push("".concat(t,"[").concat(n,"][").concat(a,"]"))}let o=e.name,l=e.getClassName(),c=0===i.length?"":i[0];vO(["".concat(o," (").concat(l,")"),s,r,e.countParams().toString(),c],t,a);for(let d=1;d<i.length;++d)vO(["","","","",i[d]],t,a)}function kO(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}function SO(e,t){if(null===e)return null;if("string"==typeof e)return uF(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){let n=[],a=e.length;for(let r=0;r<a;++r){let a=e[r];kO(t,r,a)?n.push(a):n.push(SO(a,t))}return n}{let t={};for(let n of Object.keys(e)){let a=e[n];if("name"===n&&"string"==typeof a)t[n]=a;else{let e=uF(n);t[e]=SO(a,e)}}return t}}function NO(e,t){if(null==e)return null;if("string"==typeof e)return cF(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){let n=[],a=e.length;for(let r=0;r<a;++r){let a=e[r];kO(t,r,a)?n.push(a):n.push(NO(a,t))}return n}{let t={};for(let n of Object.keys(e)){let a=e[n],r=cF(n);t[r]="name"!==n&&"className"!==n||"string"!=typeof a?NO(a,n):a}return t}}var IO="4.22.0",CO=class e extends KD{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){let e=this.getClassName().toLowerCase();this.name=CF(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],gF(this.inputs).length!==this.inputs.length)throw new eF("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ".concat(this.inputs.map(e=>e.name)));gF(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ".concat(this.outputs.map(e=>e.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let e of this.outputs){let t=e.sourceLayer,n=e.nodeIndex,a=e.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(n),this.outputLayersTensorIndices.push(a)}for(let e of this.inputs){let t=e.sourceLayer,n=e.nodeIndex,a=e.tensorIndex;sF(0===n,"input layer has >1 nodes"),sF(0===a,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(n),this.inputLayersTensorIndices.push(a)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let e=0;e<this.inputLayers.length;e++){let n=this.inputLayers[e];if(!(n instanceof YD))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: ".concat(t.inputs,". Input ").concat(e," (0-based) originates from layer type ").concat(n.getClassName(),"."));this.inputNames.push(n.name),this.feedInputShapes.push(n.batchInputShape),this.feedInputNames.push(n.name)}for(let e of this.outputLayers)this.outputNames.push(e.name);this.internalInputShapes=this.inputs.map(e=>e.shape),this.internalOutputShapes=this.outputs.map(e=>e.shape);let n={},a={},r={},s={},i={},o=[],l=(t,n,a,r,s,c)=>{(null==r||null==s||null==c)&&(r=t.sourceLayer,s=t.nodeIndex,c=t.tensorIndex);let u=r.inboundNodes[s];if(-1!==a.indexOf(u))throw new $R("The tensor ".concat(t.name,' at layer "').concat(r.name,'" is part of a cycle.'));if(-1!==n.indexOf(u))return;this.containerNodes.add(e.nodeKey(r,s)),r.id in i||(i[r.id]=Object.keys(i).length),-1===a.indexOf(u)&&a.push(u);let d=u.inboundLayers.length;for(let e=0;e<d;e++){let t=u.inputTensors[e],r=u.inboundLayers[e],s=u.nodeIndices[e],i=u.tensorIndices[e];l(t,n,a,r,s,i)}for(n.push(u);a.indexOf(u)>=0;)a.splice(a.indexOf(u),1);o.push(u)},c=[],u=[];for(let e of this.outputs)l(e,c,u);let d=o.slice().reverse();for(let e of d){a[e.id]=e,e.id in n||(n[e.id]=0);let t=n[e.id],i=null==r[e.outboundLayer.id]?0:r[e.outboundLayer.id];t=Math.max(t,i),r[e.outboundLayer.id]=t,s[e.outboundLayer.id]=e.outboundLayer,n[e.id]=t;for(let r=0;r<e.inboundLayers.length;r++){let s=e.inboundLayers[r],i=e.nodeIndices[r],o=s.inboundNodes[i],l=null==n[o.id]?0:n[o.id];n[o.id]=Math.max(t+1,l),a[o.id]=o}}let p={};for(let e in n){let t=n[e];t in p||(p[t]=[]),p[t].push(a[e])}let h={};for(let e in r){let t=r[e];t in h||(h[t]=[]),h[t].push(s[e])}let f=Object.keys(h).map(e=>parseInt(e,10)).sort(mF);this.layers=[];for(let b of f){let t=h[b];t.sort((e,t)=>{let n=i[e.id],a=i[t.id];return n<a?-1:n>a?1:0});for(let n of t)n instanceof e&&this.internalContainerRefs.push(n),this.layers.push(n)}this.layersByDepth=h,f=Object.keys(p).map(e=>parseInt(e,10)).sort(mF);let m=this.inputs.slice(),g=[];for(let e of f)for(let t of p[e]){let e=t.outboundLayer;if(null!=e){for(let n of t.inputTensors)if(-1===m.indexOf(n))throw new $R("Graph disconnected: cannot obtain value for tensor ".concat(n,' at layer "').concat(e.name,'". The following previous layers were accessed without issue: ').concat(g));for(let e of t.outputTensors)m.push(e);g.push(e.name)}}this.nodesByDepth=p;let y=this.layers.map(e=>e.name);for(let e of y){let t=y.filter(t=>t===e).length;if(1!==t)throw new $R('The name "'.concat(e,'" is used ').concat(t," times in the model. All layer names should be unique. Layer names: ")+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new GD({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(e=>null),outputMasks:this.outputs.map(e=>null),inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs.map(e=>e.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();let e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(let t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(let t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(t=>t.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new eF("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(let t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={},a=0,r=(e=>{let t=Object.keys(e);if(0===t.length)return!1;let n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);r&&this.parseWeights(e);for(let i of this.layers)for(let[e,t]of i.weights.entries()){let s=r?"".concat(t.name.split("/").slice(0,-1).join("/")+"/").concat(e):t.originalName;if(null!=n[s])throw new eF("Duplicate weight name: ".concat(s));n[s]=t,a++}let s=[];for(let i in e){let a=i;if(null==n[i]){let e=i.split("/");a=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[a])s.push([n[a],e[i]]);else if(t)throw new eF("Provided weight data has no target variable: ".concat(i));delete n[a]}if(t){let e=[];for(let t in n)e.push(t);if(e.length>0)throw new eF("".concat(e.length," of ").concat(a," weights are not set: ").concat(e))}WD(s)}parseWeights(e){for(let t in Object.keys(e)){let n=t.split("/"),a=["vars","layer_checkpoint_dependencies"],r=n.map(e=>e.startsWith("_")?e.slice(1):e).filter(e=>!a.includes(e)).join("/");r!==t&&(e[r]=e[t],delete e[t])}}updatedConfig(){let e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(IO),t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=NO(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return Yv(()=>{e=lF(e);let n=new JD;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return eM(this.outputs,n,t)})}computeMask(e,t){return Yv(()=>{let n;return e=lF(e),n=null==t?rF(null,e.length):lF(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){let t=MD(e);if(t.length!==this.inputLayers.length)throw new eF("Invalid inputShape argument ".concat(e,": model has ").concat(this.inputLayers.length," tensor inputs."));let n={};for(let i=0;i<t.length;i++){let e=this.inputLayers[i],a=t[i];n[e.name+"_0_0"]=a}let a=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(mF);if(a.length>1)for(let i of a){let e=this.nodesByDepth[i];for(let t of e){let e=t.outboundLayer;if(-1!==this.inputLayers.map(e=>e.id).indexOf(e.id))continue;let a=[];for(let i=0;i<t.inboundLayers.length;i++){let e=t.inboundLayers[i],r=t.nodeIndices[i],s=t.tensorIndices[i],o=n["".concat(e.name,"_").concat(r,"_").concat(s)];a.push(o)}let r=MD(e.computeOutputShape(oF(a))),s=e.inboundNodes.indexOf(t);for(let t=0;t<r.length;t++){n["".concat(e.name,"_").concat(s,"_").concat(t)]=r[t]}}}let r=[],s=[];for(let i=0;i<this.outputLayers.length;i++){let e=this.outputLayers[i],t=this.outputLayersNodeIndices[i],n=this.outputLayersTensorIndices[i],a="".concat(e.name,"_").concat(t,"_").concat(n);s.push(a)}for(let i=0;i<s.length;i++){let e=s[i];sF(e in n),r.push(n[e])}return oF(r)}runInternalGraph(e,t){null==t&&(t=rF(null,e.length));let n={};for(let o=0;o<this.inputs.length;++o){let a=this.inputs[o],r=e[o],s=t[o];n[a.id]=[r,s]}let a=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(mF);for(let o of a){let e=this.nodesByDepth[o];for(let t of e){let e=t.outboundLayer,a=t.inputTensors,r=t.outputTensors,s=new Array;for(let t of a)t.id in n&&s.push(n[t.id]);if(s.length===a.length){let a,i,o,l,c={};if(null!=t.callArgs&&(c=t.callArgs),1===s.length){let[t,n]=s[0];null==c.mask&&(c.mask=n),o=lF(e.call(t,c)),l=lF(e.computeMask(t,n)),a=[t],i=[n]}else a=s.map(e=>e[0]),i=s.map(e=>e[1]),null==c.mask&&(c.mask=i),o=lF(e.call(a,c)),l=lF(e.computeMask(a,i));if(e.activityRegularizer)throw new tF("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<r.length;++e){let t=r[e],a=o[e],s=l[e];n[t.id]=[a,s]}}}}let r=[],s=[],i=[];for(let o of this.outputs){sF(o.id in n,"Could not compute output ".concat(o.name," : ").concat(o.id));let[e,t]=n[o.id];i.push(e.shape),r.push(e),s.push(t)}return[r,s,i]}buildNodeConversionMap(t){let n,a={};for(let r of this.layers){n=r instanceof e?1:0;for(let t=0;t<r.inboundNodes.length;t++){let s=e.nodeKey(r,t);this.containerNodes.has(s)&&(a[s]=n,n+=1)}}return a}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new eF("Provide either a layer name or layer index");if("number"==typeof e)return this.findLayer(e);for(let n of this.layers)if(n.name===e)return n;throw new eF("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new eF("Was asked to retrieve layer at index ".concat(e,", but model only has ").concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return Yv(()=>{let t=[];for(let n of this.layers)for(let a=0;a<n.inboundNodes.length;++a){let r=e.nodeKey(n,a);this.containerNodes.has(r)&&t.push(...n.calculateLosses())}return t})}getConfig(){let t={name:this.name},n=this.buildNodeConversionMap(this.layers),a=[];for(let o of this.layers){let t=o.getClassName(),r=o.getConfig(),s=[];for(let a=0;a<o.inboundNodes.length;a++){let t=o.inboundNodes[a],r=e.nodeKey(o,a),l={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),l=t.callArgs}catch(i){console.warn("Layer ".concat(o.name," was passed non-serializable keyword arguments: ").concat(t.callArgs,". They will not be included in the serialized model (and thus will be missing at deserialization time).")),l={}}if(t.inboundLayers.length>0){let a=[];for(let r=0;r<t.inboundLayers.length;r++){let s=t.inboundLayers[r],i=t.nodeIndices[r],o=t.tensorIndices[r],c=n[e.nodeKey(s,i)];null==c&&(c=0),a.push([s.name,c,o,l])}s.push(a)}}}let l={};l.name=o.name,l.className=t,l.config=r,l.inboundNodes=s,a.push(l)}t.layers=a;let r=[];for(let o=0;o<this.inputLayers.length;o++){let t=this.inputLayers[o],a=this.inputLayersNodeIndices[o],s=e.nodeKey(t,a);if(!this.containerNodes.has(s))continue;let i=n[s];null==i&&(i=0);let l=this.inputLayersTensorIndices[o];r.push([t.name,i,l])}t.inputLayers=r;let s=[];for(let o=0;o<this.outputLayers.length;o++){let t=this.outputLayers[o],a=this.outputLayersNodeIndices[o],r=e.nodeKey(t,a);if(!this.containerNodes.has(r))continue;let i=n[r];null==i&&(i=0);let l=this.outputLayersTensorIndices[o];s.push([t.name,i,l])}return t.outputLayers=s,t}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={},r={};function s(e,t){e.name in r?r[e.name].push(t):r[e.name]=[t]}function i(e,t){let n,r=[];for(let i of t){let o=i[0],l=i[1],c=i[2];if(n=null==i[3]?{}:i[3],!(o in a))return void s(e,t);let u=a[o];if(u.inboundNodes.length<=l)return void s(e,t);let d=u.inboundNodes[l];r.push(d.outputTensors[c])}r.length>0&&e.apply(oF(r),n)}function o(e){let r=e.name,i=KM(e,null!=t.customObjects?t.customObjects:{});i.setFastWeightInitDuringBuild(n),a[r]=i,e.inboundNodes.forEach(e=>{if(!(e instanceof Array))throw new eF("Corrupted configuration, expected array for nodeData: ".concat(e));s(i,e)})}let l=t.name,c=t.layers;for(let f of c)o(f);for(;!yF(r);)for(let e of c){let t=a[e.name];if(t.name in r){let e=r[t.name];delete r[t.name];for(let n of e)i(t,n)}}let u=[],d=[],p=t.inputLayers;for(let f of p){let e=f[0],t=f[1],n=f[2];sF(e in a);let r=a[e].inboundNodes[t].outputTensors;u.push(r[n])}let h=t.outputLayers;for(let f of h){let e=f[0],t=f[1],n=f[2];sF(e in a);let r=a[e].inboundNodes[t].outputTensors;d.push(r[n])}return new e({inputs:u,outputs:d,name:l})}get stateful(){if(this._stateful)throw new eF("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Yv(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}};function TO(e,t){return function(e,t,n){let a=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>null);if(1===a)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==a)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," element(s), but the model has ").concat(a," outputs. Make sure a set of weights is provided for each model output."));return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){let n=[];return t.forEach(t=>{t in e?n.push(e[t]):n.push(null)}),n}throw new Error("The model has multiple (".concat(a,") outputs, so ").concat(n," must be either an array with ").concat(a," elements or an object with ").concat(t," keys. Provided ").concat(n," not understood: ").concat(JSON.stringify(e)))}(e,t,"classWeight")}async function EO(e,t,n,a){if(null!=t||null!=a)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){let t=Yv(()=>{if(1===e.shape.length)return ow(e);if(2===e.shape.length){if(e.shape[1]>1)return vw(e,1);if(1===e.shape[1])return Ww(e,[e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") during handling of class weights. The size is expected to be >= 1."))}throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during handling of class weights. The rank is expected to be 1 or 2."))}),a=Array.from(await t.data());Qv(t);let r=[];return a.forEach(e=>{if(null==n[e])throw new Error("classWeight must contain all classes in the training data. The class ".concat(e," exists in the data but not in classWeight"));r.push(n[e])}),TI(r,"float32")}return null}function _O(e,t){return pw(e,t)}function AO(e,t){let n,a,r=t;n=r.xs,a=r.ys,gb.assert(null!=n&&null!=a,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ".concat(t));let s=RO("input",e.inputNames,n),i=RO("output",e.outputNames,a),o=s[0].shape[0];gb.assert(s.length===e.inputs.length,()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset provides ").concat(s.length," inputs.  (Expected input keys: ").concat(JSON.stringify(e.inputNames),")")),gb.assert(i.length===e.outputs.length,()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset provides ").concat(i.length," outputs.  (Expected output keys: ").concat(JSON.stringify(e.outputNames),")"));for(let l=0;l<s.length;l++)gb.assert(s[l].shape[0]===o,()=>"Batch size mismatch: input ".concat(e.inputNames[l]," has ").concat(s[l].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],"."));for(let l=0;l<i.length;l++)gb.assert(i[l].shape[0]===o,()=>"Batch size mismatch: output ".concat(e.outputNames[l]," has ").concat(i[l].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],"."));return{xs:s,ys:i}}function RO(e,t,n){if(n instanceof Jb)return[n];if(Array.isArray(n))return gb.assert(n.length===t.length,()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")),n;{let a=[];for(let r of t){if(null==n[r])throw new eF("The feature data generated by the dataset lacks the required ".concat(e," key '").concat(r,"'."));a.push(n[r])}return a}}async function FO(e,t,n){let a=null!=n.batchesPerEpoch;if(gb.assert(null!=e.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),gb.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),gb.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive integer, but got ".concat(n.epochs)),gb.assert(!a||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ".concat(n.batchesPerEpoch)),gb.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let r,s,i=null!=n.validationData;if(i)if(DO(n.validationData))gb.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ".concat(n.validationBatches));else{let e=function(e){if(3===e.length)throw new tF("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);r=e.xs,s=e.ys}let o,l=e.makeTrainFunction(),c=e.getDedupedMetricsNames();o=i?c.slice().concat(c.map(e=>"val_"+e)):c.slice();let u=HM(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:p,history:h}=qM(u,d,n.epochs,null,null,function(e,t){let n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}(t,n),null,i,o);p.setModel(e),e.history=h,await p.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){let o={};await p.onEpochBegin(f);let u=0,d=0;for(a||(m=await t.iterator());!a||u<n.batchesPerEpoch;){let t=await m.next();if(a&&t.done){console.warn("You provided `batchesPerEpoch` as ".concat(n.batchesPerEpoch,", but your dataset iterator ran out of data after ").concat(u," batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, ").concat(n.batchesPerEpoch*n.epochs," batches). You may need to use the repeat() function when building your dataset."));break}if(null!=t.value){let{xs:a,ys:r}=AO(e,t.value),s={};s.batch=d,s.size=a[0].shape[0],await p.onBatchBegin(d,s);let i=[];if(null!=n.classWeight){let t=TO(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)i.push(await EO(r[e],null,t[e]))}let o=a.concat(r).concat(i),h=l(o);Qv(o);for(let e=0;e<c.length;++e){let t=c[e],n=h[e];s[t]=n,Jv(n)}await p.onBatchEnd(d,s),zM(s),d++,u++}if(a?u>=n.batchesPerEpoch:t.done){if(i){let t;t=DO(n.validationData)?lF(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):lF(e.evaluate(r,s,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)o["val_".concat(e.metricsNames[n])]=t[n]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(f,o),f++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function DO(e){return"function"==typeof e.iterator}function MO(e){gb.assert(e>0&&Number.isInteger(e),()=>"batchSize is required to be a positive integer, but got ".concat(e))}function OO(e,t,n){return null==e?[null]:Array.isArray(e)?e.map(e=>JF(e,t,n-t)):JF(e,t,n-t)}function PO(e,t){return Yv(()=>null==e?null:Array.isArray(e)?e.map(e=>PO(e,t)):sD(e,"int32"===t.dtype?t:iw(t,"int32")))}function LO(e,t){let n=[],a=0,r=null;for(;a<e;)r=a+t,r>=e&&(r=e),n.push([a,r]),a=r;return n}function zO(e){let t=[];e instanceof Jb&&(e=[e]);for(let n=0;n<e.length;++n){let a=e[n];if(1===a.rank)t.push(QF(a,1));else{if(0===a.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(a)}}return t}function jO(e,t){if(null==e)return;let n=[];if(t instanceof Jb)n.push(t.id);else if(Array.isArray(t))t.forEach(e=>n.push(e.id));else if(null!=t)for(let r in t){let e=t[r];n.push(e.id)}let a=[];if(e instanceof Jb)-1===n.indexOf(e.id)&&a.push(e);else if(Array.isArray(e))e.forEach(e=>{-1===n.indexOf(e.id)&&a.push(e)});else if(null!=e)for(let r in e){let t=e[r];-1===n.indexOf(t.id)&&a.push(t)}a.forEach(e=>{e.isDisposed||e.dispose()})}function BO(e){return Array.isArray(e)}function WO(e){return!function(e){return e instanceof Jb}(e)&&!BO(e)}function VO(e,t,n){let a,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(BO(e)&&e.length>0)t=!0;else if(WO(e)){for(let n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new eF("Error when checking model ".concat(s," expected no data, but got ").concat(e))}return[]}if(null==e)return t.map(e=>null);if(WO(e)){a=[];for(let n of t){if(null==e[n])throw new eF('No data provided for "'.concat(n,'". Need data for each key in: ').concat(t));a.push(e[n])}}else if(BO(e)){if(e.length!==t.length)throw new eF("Error when checking model ".concat(s,": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got the following list of Tensor(s): ").concat(e));a=e}else{if(t.length>1)throw new eF("The model ".concat(s," expects ").concat(t.length," Tensor(s), but only received one Tensor. Found: Tensor with shape ").concat(e.shape));a=[e]}if(a=zO(a),null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;let e=a[i];if(e.shape.length!==n[i].length)throw new eF("Error when checking ".concat(s,": expected ").concat(t[i]," to have ").concat(n[i].length," dimension(s). but got array with shape ").concat(e.shape));for(let t=0;t<n[i].length;++t){if(0===t&&!r)continue;let a=e.shape[t],o=n[i][t];if(null!=o&&o>=0&&a!==o)throw new eF("".concat(s," expected a batch of elements where each example has shape [").concat(n[i].slice(1,n[i].length),"] (i.e.,tensor shape [*,").concat(n[i].slice(1,n[i].length),"]) but the ").concat(s," received an input with ").concat(e.shape[0]," examples, each with shape [").concat(e.shape.slice(1,e.shape.length),"] (tensor shape [").concat(e.shape,"])"))}}return a}function UO(e,t,n){let a,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new eF("Error when checking model ".concat(s,": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got ").concat(e.length," Tensors(s)."));a=e}else{if(t.length>1)throw new eF("The model expects ".concat(t.length," ").concat(s," Tensors, but only received one Tensor. Found: array with shape ").concat(JSON.stringify(e.shape),"."));a=[e]}if(null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;let e=a[i];if(e.shape.length!==n[i].length)throw new eF("Error when checking ".concat(s,": expected ").concat(t[i]," to have ").concat(n[i].length," dimension(s), but got array with shape ").concat(JSON.stringify(e.shape)));for(let a=0;a<n[i].length;++a){if(0===a&&!r)continue;let o=e.shape[a],l=n[i][a];if(null!=l&&l!==o)throw new eF("Error when checking ".concat(s,": expected ").concat(t[i]," to have shape ").concat(JSON.stringify(n[i])," but got array with shape ").concat(JSON.stringify(e.shape),"."))}}}var HO=class extends CO{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new eF("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");bO(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){let t={Adagrad:()=>LE.adagrad(.01),Adadelta:()=>LE.adadelta(1,.95,XF()),Adam:()=>LE.adam(.001,.9,.999,XF()),Adamax:()=>LE.adamax(.002,.9,.999,XF(),0),RMSProp:()=>LE.rmsprop(.001,.9,0,XF()),SGD:()=>LE.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new eF("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof IT))throw new eF("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new eF("When passing an Array as loss, it should have one entry per model output. The model has ".concat(this.outputs.length," output(s), but you passed loss=").concat(e.loss,"."));t=e.loss.map(e=>aO(e))}else{let n=aO(e.loss);this.outputs.forEach(e=>{t.push(n)})}else{e.loss=e.loss;for(let t in e.loss)if(-1===this.outputNames.indexOf(t))throw new eF('Unknown entry in loss dictionary: "'.concat(t,'". Only expected the following keys: ').concat(this.outputNames));for(let n of this.outputNames)null==e.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ').concat(n," during training")),t.push(aO(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){let e=this.internalOutputShapes[s],t=this.outputNames[s];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[s])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],LF("loss",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;let t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}});let a=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>[]);let n;if("string"==typeof e||"function"==typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!=typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map(e=>n);{let e=[];for(let a of t){let t=n.hasOwnProperty(a)?n[a]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),r=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};LF("metric",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,a,s;for(let i of t){if("string"==typeof i&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(i)){let t,r=this.internalOutputShapes[e];1===r[r.length-1]||this.lossFunctions[e]===eO?-1!==["accuracy","acc"].indexOf(i)?a=rO:-1!==["crossentropy","ce"].indexOf(i)&&(a=cO):this.lossFunctions[e]===$M?-1!==["accuracy","acc"].indexOf(i)?a=uO:-1!==["crossentropy","ce"].indexOf(i)&&(a=pO):-1!==["accuracy","acc"].indexOf(i)?a=sO:-1!==["crossentropy","ce"].indexOf(i)&&(a=dO),-1!==["accuracy","acc"].indexOf(i)?t="acc":-1!==["crossentropy","ce"].indexOf(i)&&(t="ce"),s=a,n=""+t}else s=fO(i),n=""+mO(i);let t;LF(n,()=>{t=s}),r(e,n,t)}})(a[e])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=null==n.batchSize?32:n.batchSize;MO(a);let r=this.standardizeUserDataXY(e,t,!0,a);try{let e=r[0].concat(r[1]);this.makeTestFunction();let t=this.testFunction;return oF(this.testLoop(t,e,a,n.verbose,n.steps))}finally{jO(r[0],e),jO(r[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){let a=null!=(n=n||{}).batches,r=e.testFunction,s=[];if(n.verbose>0)throw new tF("Verbose mode is not implemented yet.");gb.assert(!a||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but received ".concat(JSON.stringify(n.batches)));let i=function(e){return"function"==typeof e.next}(t)?t:await t.iterator(),o=0,l=0;for(;!a||l<n.batches;){let t=await i.next();if(s=Yv(()=>{if(t.value){let{xs:n,ys:a}=AO(e,t.value),i=n.concat(a),c=Yv(()=>r(i));if(Qv(i),0===l)for(let e=0;e<c.length;++e)s.push($k(0));let u=i[0].shape[0];for(let e=0;e<c.length;++e){let t=c[e],n=s[e];s[e]=Yv(()=>cw(s[e],pw(u,t))),l>0&&Qv(n)}Qv(c),o+=u,++l}return s}),t.done){a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, ".concat(n.batches," batches). You may need to use the repeat() function when building your dataset."));break}}for(let c=0;c<s.length;++c){let e=s[c];s[c]=dw(s[c],o),Qv(e)}return oF(s)}(this,e,t)}checkNumSamples(e,t,n){let a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(a=null,null!=t)throw new eF("If ".concat(r," is set, batchSize must be null or undefined.Got batchSize = ").concat(t))}else{if(null==e)throw new eF("Either the input data should have a defined shape, or ".concat(r," shoud be specified."));a=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return a}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new eF("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),a=n?t:[t],r=this.retrieveSymbolicTensors(a),s=new JD;if(e instanceof Jb&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new eF("The number of inputs provided (".concat(e.length,") does not match the number of inputs of this model (").concat(this.inputs.length,")."));for(let t=0;t<this.inputs.length;++t)s.add(this.inputs[t],e[t])}else for(let o of this.inputs){let t=e[o.name];if(null==t)throw new eF("No value is provided for the model's input ".concat(o.name));s.add(o,t)}let i=eM(r,s);return n?i:i[0]}retrieveSymbolicTensors(e){let t=rF(null,e.length),n=e.length;for(let a of this.layers){let r=Array.isArray(a.output)?a.output:[a.output],s=r.map(e=>e.name);for(let a=0;a<e.length;++a){let i=s.indexOf(e[a]);if(-1!==i&&(t[a]=r[i],n--),0===n)break}if(0===n)break}if(n>0){let n=[];throw t.forEach((t,a)=>{null==t&&n.push(e[a])}),new eF("Cannot find SymbolicTensors for output name(s): ".concat(JSON.stringify(n)))}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Yv(()=>{let a=this.checkNumSamples(e);if(n)throw new tF("Verbose predictLoop() is not implemented yet.");let r=LO(a,t),s=this.outputs.map(e=>[]);for(let t=0;t<r.length;++t)Yv(()=>{let n=r[t][0],a=r[t][1],s=OO(e,n,a),i=[];if(Array.isArray(s))for(let e=0;e<s.length;++e)i.push({key:this.inputs[e],value:s[e]});else i.push({key:this.inputs[0],value:s});let o=new JD(i);return eM(this.outputs,o)}).forEach((e,t)=>s[t].push(e));return oF(s.map(e=>Hw(e,0)))})}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=zO(e);UO(n,this.inputNames,this.feedInputShapes,!1);try{let e=null==t.batchSize?32:t.batchSize;return MO(e),this.predictLoop(n,e)}finally{jO(n,e)}}predictOnBatch(e){UO(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new $R("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let r=0;r<this.feedOutputShapes.length;++r){let e=this.feedOutputShapes[r];this.feedLossFns[r]===$M?a.push(e.slice(0,e.length-1).concat([1])):a.push(e)}if(function(e,t){let n=gF(e.map(e=>e.shape[0]));n.sort();let a=gF(t.map(e=>e.shape[0]));if(a.sort(),n.length>1)throw new eF("All input Tensors (x) should have the same number of samples. Got array shapes: ".concat(JSON.stringify(e.map(e=>e.shape))));if(a.length>1)throw new eF("All target Tensors (y) should have the same number of samples. Got array shapes: ".concat(JSON.stringify(t.map(e=>e.shape))));if(n.length>0&&a.length>0&&!gb.arraysEqual(n,a))throw new eF("Input Tensors should have the same number of samples as target Tensors. Found ".concat(n[0]," input sample(s) and ").concat(a[0]," target sample(s)."))}(e=VO(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=VO(t,this.feedOutputNames,a,!1,"target")),function(e,t,n){let a=[YM,eO,ZM];for(let r=0;r<e.length;++r){let s=e[r],i=t[r],o=n[r];if(null!=i){if(i===ZM&&1===s.shape[s.shape.length-1])throw new eF("You are passing a target array of shape ".concat(s.shape," while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes]."));if(-1!==a.indexOf(i)){let e=s.shape.slice(1),t=o.slice(1);for(let n=0;n<e.length;++n){let a=e[n],r=t[n];if(null!=r&&a!==r)throw new eF("A target Tensor with shape ".concat(s.shape," was passed for an output of shape ").concat(o,", while using a loss function that expects targets to have the same shape as the output."))}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new eF("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,a){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0,[i,o]=this.standardizeUserDataXY(e,t,r,s);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=a){let e=TO(a,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await EO(o[t],null,e[t]))}return[i,o,l]}testLoop(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;return Yv(()=>{let s=this.checkNumSamples(t,n,r,"steps"),i=[];if(a>0)throw new tF("Verbose mode is not implemented yet.");if(null!=r)throw new tF("steps mode in testLoop() is not implemented yet");{let a=LO(s,n),r=TI(KF(0,s));for(let n=0;n<a.length;++n){let s=a[n][0],o=a[n][1],l=JF(r,s,o-s),c=PO(t,l),u=e(c);if(0===n)for(let e=0;e<u.length;++e)i.push($k(0));for(let e=0;e<u.length;++e){let t=u[e];i[e]=cw(i[e],pw(o-s,t))}}for(let e=0;e<i.length;++e)i[e]=dw(i[e],s)}return i})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let a=e[n],r=a;if(iF(e,a)>1){let t=iF(e.slice(0,n),a);r+="_".concat(t)}t.push(r)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),s=[],i=this.collectedTrainableWeights.map(e=>e.read());return[this.optimizer_.minimize(()=>{let e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});let i,o=new JD(e),l=eM(this.outputs,o,{training:!0});for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(a[n],l[n]);null!=r[n]&&(e=_O(e,r[n]));let s=QS(e);t.push(s),i=0===n?e:cw(i,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{let t=this.metricsTensors[n][0],r=this.metricsTensors[n][1];e=QS(t(a[r],l[r]))}Jv(e),s.push(e)}return i=QS(i),this.calculateLosses().forEach(e=>{i=cw(i,e)}),i},!0,i)].concat(s)}}makeTestFunction(){this.testFunction=e=>Yv(()=>{let t,n=[],a=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let e=0;e<this.inputs.length;++e)s.push({key:this.inputs[e],value:a[e]});let i=new JD(s),o=eM(this.outputs,i);for(let e=0;e<this.lossFunctions.length;++e){let a=this.lossFunctions[e],s=QS(a(r[e],o[e]));t=0===e?s:cw(t,s),n.push(t)}for(let e=0;e<this.metricsTensors.length;++e){let t=this.metricsTensors[e][0],a=this.metricsTensors[e][1],s=QS(t(r[a],o[a]));n.push(s)}return n})}async fit(e,t){let n,a,r,s,i,o,l,c,u,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{let p=null==d.batchSize?32:d.batchSize;MO(p);let h=await this.standardizeUserData(e,t,d.sampleWeight,d.classWeight,!1,p);n=h[0],a=h[1],u=h[2];let f,m=!1;if(null!=d.validationData&&d.validationData.length>0){if(m=!0,2!==d.validationData.length)throw 3===d.validationData.length?new tF("validationData including sample weights is not supported yet."):new eF("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ".concat(d.validationData," is invalid."));i=d.validationData[0],o=d.validationData[1];let e=await this.standardizeUserData(i,o,null,null,!0,p);l=e[0],c=e[1],f=l.concat(c)}else if(null!=d.validationSplit&&d.validationSplit>0&&d.validationSplit<1){m=!0;let e=Math.floor(n[0].shape[0]*(1-d.validationSplit)),t=n[0].shape[0];l=OO(n,e,t),r=n,n=OO(n,0,e),c=OO(a,e,t),s=a,a=OO(a,0,e),f=l.concat(c)}else null!=d.validationSteps&&(m=!0);let g=n.concat(a).concat(u);this.checkTrainableWeightsConsistency();let y,b,v=this.makeTrainFunction(),x=this.getDedupedMetricsNames();m?(this.makeTestFunction(),y=this.testFunction,b=x.slice().concat(x.map(e=>"val_"+e))):(y=null,f=[],b=x.slice());let w=HM(d.callbacks,d.yieldEvery);return await this.fitLoop(v,g,x,p,d.epochs,d.verbose,w,y,f,d.shuffle,b,d.initialEpoch,null,null)}finally{this.isTraining=!1,jO(n,e),jO(a,t),jO(r,e),jO(s,t),jO(l,i),jO(c,o),null!=u&&Qv(u)}}async fitLoop(e,t,n,a,r,s,i,o,l,c,u,d,p,h){null==a&&(a=32),null==r&&(r=1),null==c&&(c=!0),null==d&&(d=0);let f=!1;if(null!=o&&null!=l&&(f=!0),null!=h&&(f=!0,null==p))throw new eF("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let m,g=this.checkNumSamples(t,a,p,"steps_per_epoch");null!=g&&(m=KF(0,g)),null==s&&(s=1);let{callbackList:y,history:b}=qM(i,s,r,d,g,p,a,f,u);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let v=d;v<r;++v){await y.onEpochBegin(v);let r={};if(null!=p)throw new tF("stepsPerEpoch mode is not implemented yet.");{if("batch"===c)throw new tF("batch shuffling is not implemneted yet");c&&gb.shuffle(m);let s=TI(m),i=LO(g,a);for(let c=0;c<i.length;++c){let u={};if(await y.onBatchBegin(c,u),Yv(()=>{let d=i[c][0],p=i[c][1],h=JF(s,d,p-d);u.batch=c,u.size=p-d;let m=PO(t,h),g=e(m);for(let e=0;e<n.length;++e){let t=n[e],a=g[e];u[t]=a,Jv(a)}if(c===i.length-1&&f){let e=this.testLoop(o,l,a);for(let t=0;t<n.length;++t){let a=n[t],s=e[t];Jv(s),r["val_"+a]=s}}}),await y.onBatchEnd(c,u),zM(u),this.stopTraining_)break}s.dispose()}if(await y.onEpochEnd(v,r),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return FO(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),a=n[0],r=n[1],s=this.makeTrainFunction()(a.concat(r)),i=[];for(let o of s){let e=await o.data();i.push(e[0])}return Qv(s),jO(n[0],e),jO(n[1],t),oF(i)}getNamedWeights(e){let t=[],n=null!=e&&e.trainableOnly,a=n?this.trainableWeights:this.weights,r=this.getWeights(n);for(let s=0;s<a.length;++s)n&&!a[s].trainable||t.push({name:a[s].originalName,tensor:r[s]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){let t=Kv().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Kv().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=cF(this.loss);else if(Array.isArray(this.loss)){for(let e of this.loss)if("string"!=typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(e=>cF(e))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let a of t){if("string"!=typeof n[a])throw new Error("Serialization of non-string loss is not supported.");e[a]=cF(n[a])}}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[cF(mO(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>cF(mO(e)));{let e={};for(let t in this.metrics)e[t]=cF(mO(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");let t,n,a=KM(SO(e.optimizer_config));if("string"==typeof e.loss)t=uF(e.loss);else if(Array.isArray(e.loss))t=e.loss.map(e=>uF(e));else if(null!=e.loss){t={};for(let n in e.loss)t[n]=uF(e.loss[n])}if(Array.isArray(e.metrics))n=e.metrics.map(e=>uF(e));else if(null!=e.metrics){n={};for(let t in e.metrics)n[t]=uF(e.metrics[t])}this.compile({loss:t,metrics:n,optimizer:a})}async save(e,t){if("string"==typeof e){let t=MT.getSaveHandlers(e);if(0===t.length)throw new eF("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new eF("Found more than one (".concat(t.length,") save handlers for URL '").concat(e,"'"));e=t[0]}if(null==e.save)throw new eF("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await MT.encodeWeights(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(IO),convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){a.trainingConfig=this.getTrainingConfig();let e="optimizer",{data:t,specs:r}=await MT.encodeWeights(await this.optimizer.getWeights(),e);n.specs.push(...r),n.data=MT.concatenateArrayBuffers([n.data,t])}return null!=this.userDefinedMetadata&&(gO(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=n.data,a.weightSpecs=n.specs,e.save(a)}setUserDefinedMetadata(e){gO(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};HO.className="Model",bT.registerClass(HO);var GO=class extends HO{};async function qO(e,t){"modelTopology"in e||(e={modelTopology:e});let n=e.modelTopology;null!=n.model_config&&(n=n.model_config);let a=KM(SO(n),t);if(null!=e.weightsManifest){let t=await MT.loadWeights(e.weightsManifest,e.pathPrefix,a.weights.map(e=>e.originalName)),n={};for(let e of a.weights)n[e.originalName]=t[e.originalName];a.loadWeights(n),Qv(t)}return a}async function KO(e,t){if(null==t&&(t={}),"string"==typeof e){let n=MT.getLoadHandlers(e,t);if(0===n.length)n.push(MT.browserHTTPRequest(e,t));else if(n.length>1)throw new eF("Found more than one (".concat(n.length,") load handlers for URL '").concat(e,"'"));e=n[0]}return async function(e,t,n){if(null==n&&(n={}),null==e.load)throw new eF("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let a=await e.load(),r=a.modelTopology;null!=r.model_config&&(r=r.model_config);let s=null==n.strict||n.strict,i=null!=a.weightData&&null!=a.weightSpecs&&s,o=KM(SO(r),t,i),l=a.trainingConfig;if(null!=l&&o.loadTrainingConfig(l),null!=a.userDefinedMetadata&&o.setUserDefinedMetadata(a.userDefinedMetadata),null!=a.weightData){if(null==a.weightSpecs)throw new eF("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:e,optimizerWeights:t}=function(e,t){let n=MT.decodeWeights(e,t),a={},r=[];return t.forEach(e=>{"optimizer"===e.group?r.push({name:e.name,tensor:n[e.name]}):a[e.name]=n[e.name]}),{modelWeights:a,optimizerWeights:r}}(a.weightData,a.weightSpecs);o.loadWeights(e,s),null!=o.optimizer&&t.length>0&&await o.optimizer.setWeights(t),Qv(e),Qv(t.map(e=>e.tensor))}return o}(e,void 0,t)}GO.className="Functional",bT.registerClass(GO);var XO=class e extends HO{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:CF("sequential_"),null!=e.layers)for(let t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(e=>e<0))throw new eF("Negative dimension size caused by adding layer ".concat(e.name," with input shape [").concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(t){let n,a=t instanceof e||t instanceof HO;if(a){if(n=t,1!==n.outputs.length)throw new eF("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new eF("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new eF("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let e=QD({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(a)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new eF("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ".concat(t.name," which has ").concat(t.inboundNodes.length," pre-existing inbound connections."));if(1!==t.inboundNodes[0].outputTensors.length)throw new eF("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=XD(this.outputs[0])}this.inboundNodes=[],new GD({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:rF(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs[0].shape})}else{let e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(PD(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new HO({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new $R("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new $R("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new $R("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new $R("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(t,n){let a,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new eF("Legacy serialization format not supported yet.");a=n}else gb.assert(null!=n.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,s=n;let i=new t(s);if(!(i instanceof e))throw new tF("Sequential.fromConfig called on non-Sequential input: ".concat(i));for(let e of a){let t=KM(e,void 0,r);r&&t.setFastWeightInitDuringBuild(!0),i.add(t)}return i}set stopTraining(e){if(null==this.model)throw new eF("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new eF("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}};function YO(e){return new HO(e)}function QO(e){return new XO(e)}function JO(e){return QD(e)}function ZO(e,t){GM.registerCallbackConstructor(e,t)}XO.className="Sequential",bT.registerClass(XO);var $O=class extends bT.Serializable{getConfig(){return{}}},eP=class extends $O{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new tF("Support for alpha values other than 1 (".concat(t,") is not implemented yet."));return jk(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}};eP.className="elu",bT.registerClass(eP);var tP=class extends $O{apply(e){return sI(e)}};tP.className="selu",bT.registerClass(tP);var nP=class extends $O{apply(e){return QN(e)}};nP.className="relu",bT.registerClass(nP);var aP=class extends $O{apply(e){return Yv(()=>eN(6,QN(e)))}};aP.className="relu6",bT.registerClass(aP);var rP=class extends $O{apply(e){return e}};rP.className="linear",bT.registerClass(rP);var sP=class extends $O{apply(e){return qw(e)}};sP.className="sigmoid",bT.registerClass(sP);var iP=class extends $O{apply(e){return function(e){return Yv(()=>{let t=cw(.5,pw(.2,e));return lk(t,0,1)})}(e)}};iP.className="hardSigmoid",bT.registerClass(iP);var oP=class extends $O{apply(e){return MS(e)}};oP.className="softplus",bT.registerClass(oP);var lP=class extends $O{apply(e){return function(e){return Yv(()=>dw(e,cw(hw(e),1)))}(e)}};lP.className="softsign",bT.registerClass(lP);var cP=class extends $O{apply(e){return Xw(e)}};cP.className="tanh",bT.registerClass(cP);var uP=class extends $O{apply(e){return mI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}};uP.className="softmax",bT.registerClass(uP);var dP=class extends $O{apply(e){return LS(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}};dP.className="logSoftmax",bT.registerClass(dP);var pP=class extends $O{apply(e){return Yv(()=>Yv(()=>{let t=Math.sqrt(2),n=pw(.5,cw(1,Wk(dw(e,t))));return pw(e,n)}))}};pP.className="gelu",bT.registerClass(pP);var hP=class extends $O{apply(e){return Yv(()=>pw(.5,pw(e,cw(1,Xw(pw(eS(dw(2,Math.PI)),cw(e,pw(.044715,Zk(e,3)))))))))}};hP.className="gelu_new",bT.registerClass(hP);var fP=class extends $O{apply(e){return Yv(()=>pw(e,Xw(MS(e))))}};fP.className="mish",bT.registerClass(fP);var mP=class extends $O{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Yv(()=>pw(qw(pw(e,t)),e))}};function gP(e){return e.getClassName()}function yP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fF(e,bT.SerializationMap.getMap().classNameMap,t,"activation")}function bP(e){if(null==e){let e={className:"linear",config:{}};return yP(e)}if("string"==typeof e){let t={};return t.className=e,t.config={},yP(t)}return e instanceof $O?e:yP(e)}function vP(e){if(null!=e&&"object"!=typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: ".concat(e))}mP.className="swish",bT.registerClass(mP);var xP=class extends bT.Serializable{},wP=class extends xP{constructor(e){super(),vP(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return Yv(()=>{let t=JS([1]);return this.hasL1&&(t=cw(t,nS(pw(this.l1,hw(e))))),this.hasL2&&(t=cw(t,nS(pw(this.l2,iD(e))))),Ww(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};wP.className="L1L2",bT.registerClass(wP);var kP={l1l2:"L1L2"};function SP(e){return pF(e)}function NP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fF(e,bT.SerializationMap.getMap().classNameMap,t,"regularizer")}function IP(e){if(null==e)return null;if("string"==typeof e){return NP({className:e in kP?kP[e]:e,config:{}})}return e instanceof xP?e:NP(e)}var CP=class extends KD{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=OD(e);let n=QN(e);return null!=this.maxValue&&(n=lk(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};CP.className="ReLU",bT.registerClass(CP);var TP=class extends KD{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=OD(e);return vS(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};TP.className="LeakyReLU",bT.registerClass(TP);var EP=class extends KD{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=FD(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=IP(e.alphaRegularizer),this.alphaConstraint=fM(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new eF("Expected sharedAxes to be a number or an array of numbers, but got ".concat(e.sharedAxes));this.sharedAxes=[e.sharedAxes]}}build(e){let t=(e=PD(e)).slice(1);if(null!=this.sharedAxes)for(let a of this.sharedAxes)t[a-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(null!=this.sharedAxes)for(let a=1;a<e.length;++a)n[a]=e[a];this.inputSpec=[new VD({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=OD(e),yN(e,this.alpha.read())}getConfig(){let e={alphaInitializer:RD(this.alphaInitializer),alphaRegularizer:SP(this.alphaRegularizer),alphaConstraint:pM(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};EP.className="PReLU",bT.registerClass(EP);var _P=class extends KD{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new tF("Non-default alpha value (".concat(e.alpha,") is not supported by the ELU layer yet."));this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=OD(e);return jk(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};_P.className="ELU",bT.registerClass(_P);var AP=class extends KD{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){let n=OD(e);return pw(n,iw(hS(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};AP.className="ThresholdedReLU",bT.registerClass(AP);var RP=class extends KD{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new uP).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return Yv(()=>{let n=OD(e),a=t.mask;if(null!=a){let e=pw(PS(ZS(n.shape),iw(a,n.dtype)),$k(-1e9));n=cw(n,e)}return this.axis instanceof Array?this.axis.length>1?iS(PS(n,zS(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};function FP(e,t,n){if("number"==typeof e)return rF(e,t);if(e.length!==t)throw new eF("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(e.length," elements."));for(let a=0;a<t;++a){let r=e[a];if(!UF(r))throw new eF("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(JSON.stringify(e)," including a non-integer number ").concat(r))}return e}function DP(e,t,n,a){let r;return null==e?e:(r="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((r+a-1)/a))}function MP(e,t,n,a){if(null==e)return null;if("valid"===a)e=e*t+qF([n-t,0]);else{if("same"!==a)throw new eF("Unsupport padding mode: ".concat(a,"."));e*=t}return e}function OP(e,t){return Yv(()=>(DF(t),"channelsFirst"===t?XI(e,[0,2,3,1]):e))}function PP(e,t){return Yv(()=>(DF(t),"channelsFirst"===t?XI(e,[0,2,3,4,1]):e))}function LP(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Yv(()=>{if(null==s&&(s="channelsLast"),DF(s),3!==e.rank&&4!==e.rank)throw new eF("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new eF("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ".concat(e.rank,"."));let l=OP(e,s);if("causal"===r)throw new tF("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=aC.conv2d({x:l,filter:t,strides:a,pad:"same"===r?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===s&&(l=XI(l,[0,3,1,2])),l})}RP.className="Softmax",bT.registerClass(RP);var zP=class e extends KD{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(n),this.rank=t,xF(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new tF("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is not implemented yet."));if(this.kernelSize=FP(n.kernelSize,t,"kernelSize"),this.strides=FP(null==n.strides?1:n.strides,t,"strides"),this.padding=null==n.padding?"valid":n.padding,MF(this.padding),this.dataFormat=null==n.dataFormat?"channelsLast":n.dataFormat,DF(this.dataFormat),this.activation=bP(n.activation),this.useBias=null==n.useBias||n.useBias,this.biasInitializer=FD(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=fM(n.biasConstraint),this.biasRegularizer=IP(n.biasRegularizer),this.activityRegularizer=IP(n.activityRegularizer),this.dilationRate=FP(null==n.dilationRate?1:n.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new eF("dilationRate must be a number or an array of a single number for 1D convolution, but received ".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new eF("dilationRate must be a number or array of two numbers for 2D convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new eF("dilationRate must be a number or array of three numbers for 3D convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(e){if(sF("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!vF(e.kernelSize,"number",1,3))throw new eF("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){let e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:gP(this.activation),useBias:this.useBias,biasInitializer:RD(this.biasInitializer),biasRegularizer:SP(this.biasRegularizer),activityRegularizer:SP(this.activityRegularizer),biasConstraint:pM(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}},jP=class e extends zP{constructor(t,n){super(t,n),this.kernel=null,e.verifyArgs(n),this.filters=n.filters,xF(this.filters,"filters"),this.kernelInitializer=FD(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=fM(n.kernelConstraint),this.kernelRegularizer=IP(n.kernelRegularizer)}build(e){e=PD(e);let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new eF("The channel dimension of the input should be defined. Found ".concat(e[t]));let n=e[t],a=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return Yv(()=>{e=OD(e);let t,n=null==this.bias?null:this.bias.read(),a=kF(this.activation.getClassName());if(null!=a&&2===this.rank)t=LP(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(1===this.rank)t=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Yv(()=>{if(null==s&&(s="channelsLast"),DF(s),3!==e.shape.length)throw new eF("The input of a conv1dWithBias operation should be 3, but is ".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new eF("The kernel for a conv1dWithBias operation should be 3, but is ".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new eF("The bias for a conv1dWithBias operation should be 1, but is ".concat(n.shape.length," instead"));if("channelsFirst"===s&&(e=XI(e,[0,2,1])),"causal"===r)throw new tF("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=fk(e,t,a,"same"===r?"same":"valid","NWC",i);return null!=n&&(o=lD(o,n)),o})}(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=LP(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new tF("convolutions greater than 3D are not implemented yet.");t=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;return Yv(()=>{if(null==s&&(s="channelsLast"),DF(s),4!==e.rank&&5!==e.rank)throw new eF("conv3dWithBias expects input to be of rank 4 or 5, but received ".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new eF("conv3dWithBias expects kernel to be of rank 4 or 5, but received ".concat(e.rank,"."));let o=PP(e,s);if("causal"===r)throw new tF("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=yk(o,t,a,"same"===r?"same":"valid","NDHWC",i),null!=n&&(o=lD(o,n)),"channelsFirst"===s&&(o=XI(o,[0,4,1,2,3])),o})}(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t})}computeOutputShape(e){e=PD(e);let t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let r=0;r<n.length;++r){let e=DP(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(e)}let a=[e[0]];return"channelsLast"===this.dataFormat?(a=a.concat(t),a.push(this.filters)):(a.push(this.filters),a=a.concat(t)),a}getConfig(){let e={filters:this.filters,kernelInitializer:RD(this.kernelInitializer),kernelRegularizer:SP(this.kernelRegularizer),kernelConstraint:pM(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new eF("Convolution layer expected config.filters to be a 'number' > 0 but got ".concat(JSON.stringify(e.filters)))}},BP=class e extends jP{constructor(t){super(2,t),e.verifyArgs(t)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!vF(e.kernelSize,"number",1,2))throw new eF("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}};BP.className="Conv2D",bT.registerClass(BP);var WP=class e extends jP{constructor(t){super(3,t),e.verifyArgs(t)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new eF("Conv3D expects config.kernelSize to be number or [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}};WP.className="Conv3D",bT.registerClass(WP);var VP=class extends BP{constructor(e){if(super(e),this.inputSpec=[new VD({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new eF("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ".concat(this.padding))}build(e){if(4!==(e=PD(e)).length)throw new eF("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new eF("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new VD({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return Yv(()=>{let t=OD(e);if(4!==t.shape.length)throw new eF("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-".concat(t.shape.length));let n,a,r=t.shape,s=r[0];"channelsFirst"===this.dataFormat?(n=2,a=3):(n=1,a=2);let i=r[n],o=r[a],l=this.kernelSize[0],c=this.kernelSize[1],u=this.strides[0],d=this.strides[1],p=[s,MP(i,u,l,this.padding),MP(o,d,c,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=XI(t,[0,2,3,1]));let h=gk(t,this.kernel.read(),p,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(h=XI(h,[0,3,1,2])),null!=this.bias&&(h=lD(h,this.bias.read(),this.dataFormat)),null!=this.activation&&(h=this.activation.apply(h)),h})}computeOutputShape(e){let t,n,a,r=(e=PD(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,a=3):(t=3,n=1,a=2);let s=this.kernelSize[0],i=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return r[t]=this.filters,r[n]=MP(r[n],o,s,this.padding),r[a]=MP(r[a],l,i,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};VP.className="Conv2DTranspose",bT.registerClass(VP);var UP=class extends WP{constructor(e){if(super(e),this.inputSpec=[new VD({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new eF("Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ".concat(this.padding))}build(e){if(5!==(e=PD(e)).length)throw new eF("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new eF("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new VD({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return Yv(()=>{let t=OD(e);if(5!==t.shape.length)throw new eF("Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-".concat(t.shape.length));let n,a,r,s=t.shape,i=s[0];"channelsFirst"===this.dataFormat?(r=2,n=3,a=4):(r=1,n=2,a=3);let o=s[r],l=s[n],c=s[a],u=this.kernelSize[0],d=this.kernelSize[1],p=this.kernelSize[2],h=this.strides[0],f=this.strides[1],m=this.strides[2],g=[i,MP(o,h,u,this.padding),MP(l,f,d,this.padding),MP(c,m,p,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=XI(t,[0,2,3,4,1]));let y=vk(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=XI(y,[0,4,1,2,3])),null!==this.bias&&(y=lD(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y})}computeOutputShape(e){let t,n,a,r,s=(e=PD(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,a=3,r=4):(t=4,n=1,a=2,r=3);let i=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],u=this.strides[1],d=this.strides[2];return s[t]=this.filters,s[n]=MP(s[n],c,i,this.padding),s[a]=MP(s[a],u,o,this.padding),s[r]=MP(s[r],d,l,this.padding),s}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};UP.className="Conv3DTranspose",bT.registerClass(UP);var HP=class extends jP{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new eF("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new eF("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new eF("SeparableConv".concat(this.rank,"D supports only padding modes: 'same' and 'valid', but received ").concat(JSON.stringify(t.padding)));this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=FD(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=IP(t.depthwiseRegularizer),this.depthwiseConstraint=fM(t.depthwiseConstraint),this.pointwiseInitializer=FD(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=IP(t.pointwiseRegularizer),this.pointwiseConstraint=fM(t.pointwiseConstraint)}build(e){if((e=PD(e)).length<this.rank+2)throw new eF("Inputs to SeparableConv".concat(this.rank,"D should have rank ").concat(this.rank+2,", but received input shape: ").concat(JSON.stringify(e)));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new eF("The channel dimension of the inputs should be defined, but found ".concat(JSON.stringify(e[t])));let n=e[t],a=this.kernelSize.concat([n,this.depthMultiplier]),r=[];for(let i=0;i<this.rank;++i)r.push(1);r.push(n*this.depthMultiplier,this.filters);let s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new VD({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return Yv(()=>{let t;if(e=OD(e),1===this.rank)throw new tF("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=XI(e,[0,2,3,1])),t=iI(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=lD(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=XI(t,[0,3,1,2])),t})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=RD(this.depthwiseInitializer),e.pointwiseInitializer=RD(this.pointwiseInitializer),e.depthwiseRegularizer=SP(this.depthwiseRegularizer),e.pointwiseRegularizer=SP(this.pointwiseRegularizer),e.depthwiseConstraint=pM(this.depthwiseConstraint),e.pointwiseConstraint=pM(this.pointwiseConstraint),e}};HP.className="SeparableConv";var GP=class extends HP{constructor(e){super(2,e)}};GP.className="SeparableConv2D",bT.registerClass(GP);var qP=class e extends jP{constructor(t){super(1,t),e.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!vF(e.kernelSize,"number",1,1))throw new eF("Conv1D expects config.kernelSize to be number or number[] with length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}};qP.className="Conv1D",bT.registerClass(qP);var KP=class extends KD{constructor(e){super(e),"number"==typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return Yv(()=>{if(e=OD(e),"channelsLast"===this.dataFormat){let t=$F(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return $F(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{let t=$F(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return $F(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};KP.className="Cropping2D",bT.registerClass(KP);var XP=class extends KD{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,DF(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,function(e){bF(EF,"InterpolationFormat",e)}(this.interpolation)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){let t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{let t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return Yv(()=>{let t=OD(e),n=t.shape;if("channelsFirst"===this.dataFormat){t=XI(t,[0,2,3,1]);let e=this.size[0]*n[2],a=this.size[1]*n[3],r="nearest"===this.interpolation?hT.resizeNearestNeighbor(t,[e,a]):hT.resizeBilinear(t,[e,a]);return XI(r,[0,3,1,2])}{let e=this.size[0]*n[1],a=this.size[1]*n[2];return"nearest"===this.interpolation?hT.resizeNearestNeighbor(t,[e,a]):hT.resizeBilinear(t,[e,a])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};XP.className="UpSampling2D",bT.registerClass(XP);var YP=class extends zP{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=FD(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=fM(e.depthwiseConstraint),this.depthwiseRegularizer=IP(e.depthwiseRegularizer)}build(e){if((e=PD(e)).length<4)throw new eF("Inputs to DepthwiseConv2D should have rank 4. Received input shape: ".concat(JSON.stringify(e),"."));let t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new eF("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (".concat(e[t],")."));let n=e[t],a=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Yv(()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return Yv(()=>{null==r&&(r="channelsLast"),DF(r);let i=OP(e,r);if(4!==e.rank)throw new eF("Input for depthwiseConv2d is required to be 4-D, but is instead ".concat(e.rank,"-D"));if(4!==t.rank)throw new eF("depthwiseKernel is required to be 4-D, but is instead ".concat(t.rank,"-D"));return i=Ck(i,t,n,"same"===a?"same":"valid","NHWC",s),"channelsFirst"===r&&(i=XI(i,[0,3,1,2])),i})}(e=OD(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=lD(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t})}computeOutputShape(e){e=PD(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=DP(t,this.kernelSize[0],this.padding,this.strides[0]),s=DP(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],a,r,s]:[e[0],r,s,a]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=RD(this.depthwiseInitializer),e.depthwiseRegularizer=SP(this.depthwiseRegularizer),e.depthwiseConstraint=pM(this.depthwiseRegularizer),e}};function QP(e,t,n,a){if(Array.isArray(e)){if(null!=t||null!=n)throw new eF("When inputs is an array, neither initialState or constants should be provided");null!=a&&(n=e.slice(e.length-a,e.length),e=e.slice(0,e.length-a)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function r(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=r(t),constants:n=r(n)}}function JP(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return Yv(()=>{let l=t.shape.length;if(l<3)throw new eF("Input should be at least 3D, but is ".concat(l,"D."));let c=[1,0].concat(KF(2,l));if(t=XI(t,c),null!=s)throw new tF("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=r&&(r=iw(iw(r,"bool"),"float32"),r.rank===l-1&&(r=oS(r,-1)),r=XI(r,c)),a&&(t=ZN(t,0),null!=r&&(r=ZN(r,0)));let u,d,p,h=[],f=n,m=t.shape[0],g=VI(t);null!=r&&(d=VI(r));for(let t=0;t<m;++t){let n=g[t],a=Yv(()=>e(n,f));if(null==r)u=a[0],f=a[1];else{let e=Yv(()=>{let e=d[t],n=PS(lN(e),e);return{output:cw(pw(a[0],e),pw(f[0],n)),newStates:f.map((t,r)=>cw(pw(a[1][r],e),pw(t,n)))}});u=e.output,f=e.newStates}o&&h.push(u)}return o&&(p=SI(h,1)),[u,p,f]})}YP.className="DepthwiseConv2D",bT.registerClass(YP);var ZP=class e extends KD{constructor(e){let t;if(super(e),null==e.cell)throw new eF("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new iL({cells:e.cell}):e.cell,null==t.stateSize)throw new eF("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new VD({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return KF(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(e=>null)}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){DD(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);let n,a=t[0];if(n=this.returnSequences?[e[0],e[1],a]:[e[0],a],this.returnState){let a=[];for(let n of t)a.push([e[0],n]);return[n].concat(a)}return n}computeMask(e,t){return Yv(()=>{Array.isArray(t)&&(t=t[0]);let e=this.returnSequences?t:null;if(this.returnState){let t=this.states.map(e=>null);return[e].concat(t)}return e})}get states(){if(null==this.states_){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new tF("Constants support is not implemented in RNN yet.");DD(e)&&(e=e[0]);let t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new VD({shape:[t,null,...n]});let a,r=[e[0]].concat(e.slice(2));if(this.cell.build(r),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!gb.arraysEqual(this.stateSpec.map(e=>e.shape[e.shape.length-1]),a))throw new eF("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; However cell.stateSize is ").concat(this.cell.stateSize))}else this.stateSpec=a.map(e=>new VD({shape:[null,e]}));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Yv(()=>{if(!this.stateful)throw new ZR("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape[0];if(null==n)throw new eF("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>JS([n,e])):this.states_=[JS([n,this.cell.stateSize])];else if(null==e)Qv(this.states_),null!=this.keptStates&&(Qv(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>JS([n,e])):this.states_[0]=JS([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new eF("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ").concat(e));!0===t?this.keptStates.push(this.states_.slice()):Qv(this.states_);for(let t=0;t<this.states_.length;++t){let a=e[t],r=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,s=[n,r];if(!gb.arraysEqual(a.shape,s))throw new eF("State ".concat(t," is incompatible with layer ").concat(this.name,": expected shape=").concat(s,", received shape=").concat(a.shape));this.states_[t]=a}}this.states_=this.states_.map(e=>Jv(e.clone()))})}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});let r=QP(e,n,a,this.numConstants);e=r.inputs,n=r.initialState,a=r.constants;let s=[],i=[];if(null!=n){t.initialState=n,s=s.concat(n),this.stateSpec=[];for(let e of n)this.stateSpec.push(new VD({shape:e.shape}));i=i.concat(this.stateSpec)}if(null!=a&&(t.constants=a,s=s.concat(a),this.numConstants=a.length),s[0]instanceof UD){let n=[e].concat(s),a=this.inputSpec.concat(i),r=this.inputSpec;this.inputSpec=a;let o=super.apply(n,t);return this.inputSpec=r,o}return super.apply(e,t)}call(e,t){return Yv(()=>{let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;e=OD(e),null==r&&(r=this.stateful?this.states_:this.getInitialState(e));let s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==s)throw new eF("RNN Layer has ".concat(s," state(s) but was passed ").concat(r.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let i={training:a},o=JP((e,t)=>{let n=this.cell.call([e].concat(t),i);return[n[0],n.slice(1)]},e,r,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],c=o[1],u=o[2];this.stateful&&this.resetStates(u,a);let d=this.returnSequences?c:l;return this.returnState?[d].concat(u):d})}getInitialState(e){return Yv(()=>{let t=JS(e.shape);return t=nS(t,[1,2]),t=QF(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(e=>e>1?nD(t,[1,e]):t):this.cell.stateSize>1?[nD(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(n.numConstants=this.numConstants);let a=this.cell.getConfig();return this.getClassName()===e.className&&(n.cell={className:this.cell.getClassName(),config:a}),Object.assign(Object.assign(Object.assign({},a),t),n)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=KM(t.cell,n);return new e(Object.assign(t,{cell:a}))}};ZP.className="RNN",bT.registerClass(ZP);var $P=class extends KD{},eL=class extends $P{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,xF(this.units,"units"),this.activation=bP(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=FD(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=FD(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=FD(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=IP(e.kernelRegularizer),this.recurrentRegularizer=IP(e.recurrentRegularizer),this.biasRegularizer=IP(e.biasRegularizer),this.kernelConstraint=fM(e.kernelConstraint),this.recurrentConstraint=fM(e.recurrentConstraint),this.biasConstraint=fM(e.biasConstraint),this.dropout=GF([1,qF([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=GF([1,qF([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=PD(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Yv(()=>{if(2!==e.length)throw new eF("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];let a=null!=t.training&&t.training;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oL({ones:()=>lN(e),rate:this.dropout,training:a,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oL({ones:()=>lN(n),rate:this.recurrentDropout,training:a,dropoutFunc:this.dropoutFunc}));let r,s=this.dropoutMask,i=this.recurrentDropoutMask;r=rD(null!=s?pw(e,s):e,this.kernel.read()),null!=this.bias&&(r=lD(r,this.bias.read())),null!=i&&(n=pw(n,i));let o=cw(r,rD(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:gP(this.activation),useBias:this.useBias,kernelInitializer:RD(this.kernelInitializer),recurrentInitializer:RD(this.recurrentInitializer),biasInitializer:RD(this.biasInitializer),kernelRegularizer:SP(this.kernelRegularizer),recurrentRegularizer:SP(this.recurrentRegularizer),biasRegularizer:SP(this.biasRegularizer),activityRegularizer:SP(this.activityRegularizer),kernelConstraint:pM(this.kernelConstraint),recurrentConstraint:pM(this.recurrentConstraint),biasConstraint:pM(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};eL.className="SimpleRNNCell",bT.registerClass(eL);var tL=class extends ZP{constructor(e){e.cell=new eL(e),super(e)}call(e,t){return Yv(()=>{null!=this.cell.dropoutMask&&(Qv(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qv(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return new e(t)}};tL.className="SimpleRNN",bT.registerClass(tL);var nL=class extends $P{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new eF("GRUCell does not support reset_after parameter set to true.");this.units=e.units,xF(this.units,"units"),this.activation=bP(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=bP(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=FD(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=FD(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=FD(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=IP(e.kernelRegularizer),this.recurrentRegularizer=IP(e.recurrentRegularizer),this.biasRegularizer=IP(e.biasRegularizer),this.kernelConstraint=fM(e.kernelConstraint),this.recurrentConstraint=fM(e.recurrentConstraint),this.biasConstraint=fM(e.biasConstraint),this.dropout=GF([1,qF([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=GF([1,qF([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){let t=(e=PD(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Yv(()=>{if(2!==e.length)throw new eF("GRUCell expects 2 input Tensors (inputs, h, c), got ".concat(e.length,"."));let n=null!=t.training&&t.training,a=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oL({ones:()=>lN(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oL({ones:()=>lN(a),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let r,s,i,o=this.dropoutMask,l=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=pw(e,o[0]));let c=rD(e,this.kernel.read());this.useBias&&(c=lD(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(a=pw(a,l[0]));let u=this.recurrentKernel.read(),[d,p]=vI(u,[2*this.units,this.units],u.rank-1),h=rD(a,d),[f,m,g]=vI(c,3,c.rank-1),[y,b]=vI(h,2,h.rank-1);r=this.recurrentActivation.apply(cw(f,y)),s=this.recurrentActivation.apply(cw(m,b));let v=rD(pw(s,a),p);i=this.activation.apply(cw(g,v));let x=cw(pw(r,a),pw(cw(1,DS(r)),i));return[x,x]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:gP(this.activation),recurrentActivation:gP(this.recurrentActivation),useBias:this.useBias,kernelInitializer:RD(this.kernelInitializer),recurrentInitializer:RD(this.recurrentInitializer),biasInitializer:RD(this.biasInitializer),kernelRegularizer:SP(this.kernelRegularizer),recurrentRegularizer:SP(this.recurrentRegularizer),biasRegularizer:SP(this.biasRegularizer),activityRegularizer:SP(this.activityRegularizer),kernelConstraint:pM(this.kernelConstraint),recurrentConstraint:pM(this.recurrentConstraint),biasConstraint:pM(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};nL.className="GRUCell",bT.registerClass(nL);var aL=class extends ZP{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new nL(e),super(e)}call(e,t){return Yv(()=>{null!=this.cell.dropoutMask&&(Qv(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qv(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}};aL.className="GRU",bT.registerClass(aL);var rL=class extends $P{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,xF(this.units,"units"),this.activation=bP(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=bP(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=FD(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=FD(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=FD(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=IP(e.kernelRegularizer),this.recurrentRegularizer=IP(e.recurrentRegularizer),this.biasRegularizer=IP(e.biasRegularizer),this.kernelConstraint=fM(e.kernelConstraint),this.recurrentConstraint=fM(e.recurrentConstraint),this.biasConstraint=fM(e.biasConstraint),this.dropout=GF([1,qF([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=GF([1,qF([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;let n,a=(e=PD(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){let e=this.biasInitializer,a=this.units;n=new((t=class extends hD{apply(t,n){let r=e.apply([a]),s=(new mD).apply([a]),i=e.apply([2*a]);return tD(tD(r,s),i)}}).className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return Yv(()=>{let n=null!=t.training&&t.training;if(3!==e.length)throw new eF("LSTMCell expects 3 input Tensors (inputs, h, c), got ".concat(e.length,"."));let a=e[1],r=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oL({ones:()=>lN(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oL({ones:()=>lN(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let s,i,o,l,c=this.dropoutMask,u=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=pw(e,c[0]));let d=rD(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(a=pw(a,u[0])),d=cw(d,rD(a,this.recurrentKernel.read())),this.useBias&&(d=lD(d,this.bias.read()));let[p,h,f,m]=vI(d,4,d.rank-1);s=this.recurrentActivation.apply(p),i=this.recurrentActivation.apply(h),o=cw(pw(i,r),pw(s,this.activation.apply(f))),l=this.recurrentActivation.apply(m);let g=pw(l,this.activation.apply(o));return[g,g,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:gP(this.activation),recurrentActivation:gP(this.recurrentActivation),useBias:this.useBias,kernelInitializer:RD(this.kernelInitializer),recurrentInitializer:RD(this.recurrentInitializer),biasInitializer:RD(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:SP(this.kernelRegularizer),recurrentRegularizer:SP(this.recurrentRegularizer),biasRegularizer:SP(this.biasRegularizer),activityRegularizer:SP(this.activityRegularizer),kernelConstraint:pM(this.kernelConstraint),recurrentConstraint:pM(this.recurrentConstraint),biasConstraint:pM(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};rL.className="LSTMCell",bT.registerClass(rL);var sL=class extends ZP{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new rL(e),super(e)}call(e,t){return Yv(()=>{null!=this.cell.dropoutMask&&(Qv(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qv(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}};sL.className="LSTM",bT.registerClass(sL);var iL=class extends $P{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return Yv(()=>{let n=e.slice(1),a=[];for(let e of this.cells.slice().reverse())Array.isArray(e.stateSize)?a.push(n.splice(0,e.stateSize.length)):a.push(n.splice(0,1));a.reverse();let r,s=[];for(let i=0;i<this.cells.length;++i){let o=this.cells[i];n=a[i],r=0===i?[e[0]].concat(n):[r[0]].concat(n),r=o.call(r,t),s.push(r.slice(1))}n=[];for(let e of s.slice().reverse())n.push(...e);return[r[0]].concat(n)})}build(e){let t;DD(e)&&(e=e[0]),this.cells.forEach((n,a)=>{LF("RNNCell_".concat(a),()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t={cells:this.cells.map(e=>({className:e.getClassName(),config:e.getConfig()}))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[];for(let r of t.cells)a.push(KM(r,n));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return BD(e)}setWeights(e){let t=[];for(let n of this.cells){let a=n.weights.length,r=e.splice(a);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],r[e]])}WD(t)}};function oL(e){let{ones:t,rate:n,training:a=!1,count:r=1,dropoutFunc:s}=e,i=()=>null!=s?s(t(),n):cD(t(),n),o=()=>uD(i,t,a);return!r||r<=1?Jv(o().clone()):Array(r).fill(void 0).map(o).map(e=>Jv(e.clone()))}iL.className="StackedRNNCells",bT.registerClass(iL);var lL=class extends ZP{constructor(e){if(e.unroll)throw new tF("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new tF("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new VD({ndim:5})]}call(e,t){return Yv(()=>{if(null!=this.cell.dropoutMask&&(Qv(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qv(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new eF("ConvRNN2D cell does not support constants");let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return Yv(()=>{let{stateSize:t}=this.cell,n=e.shape,a=this.computeSingleOutputShape(n),r=JS([a[0],...a.slice(2)]);return Array.isArray(t)?Array(t.length).fill(r):[r]})}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Yv(()=>{if(!this.stateful)throw new ZR("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,a=this.computeSingleOutputShape(n),r=[a[0],...a.slice(2)];if(null==n[0])throw new eF("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>JS(r)):this.states_=[JS(r)];else if(null==e)Qv(this.states_),null!=this.keptStates&&(Qv(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>JS(r)):this.states_[0]=JS(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new eF("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ").concat(e));t?this.keptStates.push(this.states_.slice()):Qv(this.states_);for(let t=0;t<this.states_.length;++t){let n=e[t],a=r;if(!gb.arraysEqual(n.shape,a))throw new eF("State ".concat(t," is incompatible with layer ").concat(this.name,": expected shape=").concat(a,", received shape=").concat(n.shape));this.states_[t]=n}}this.states_=this.states_.map(e=>Jv(e.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:a,padding:r,strides:s,dilationRate:i}=this.cell,o="channelsFirst"===t,l=e[o?3:2],c=e[o?4:3],u=DP(l,a[0],r,s[0],i[0]),d=DP(c,a[1],r,s[1],i[1]);return[...e.slice(0,2),...o?[n,u,d]:[u,d,n]]}};lL.className="ConvRNN2D";var cL=class extends rL{constructor(e){let{filters:t,kernelSize:n,strides:a,padding:r,dataFormat:s,dilationRate:i}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,xF(this.filters,"filters"),this.kernelSize=FP(n,2,"kernelSize"),this.kernelSize.forEach(e=>xF(e,"kernelSize")),this.strides=FP(a||1,2,"strides"),this.strides.forEach(e=>xF(e,"strides")),this.padding=r||"valid",MF(this.padding),this.dataFormat=s||"channelsLast",DF(this.dataFormat),this.dilationRate=FP(i||1,2,"dilationRate"),this.dilationRate.forEach(e=>xF(e,"dilationRate"))}build(e){var t;e=PD(e);let n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new eF("The channel dimension of the input should be defined. Found ".concat(e[n]));let a=e[n],r=this.kernelSize.concat([a,4*this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let s=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){let n=this.biasInitializer,a=this.filters;e=new((t=class extends hD{apply(e,t){return eD([n.apply([a]),ZS([a]),n.apply([2*a])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return Yv(()=>{if(3!==e.length)throw new eF("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ".concat(e.length,"."));let n=t.training||!1,a=e[0],r=e[1],s=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oL({ones:()=>lN(a),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,o=(e,t,n)=>t&&t[n]?pw(t[n],e):e,l=o(a,i,0),c=o(a,i,1),u=o(a,i,2),d=o(a,i,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oL({ones:()=>lN(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let p=this.recurrentDropoutMask,h=o(r,p,0),f=o(r,p,1),m=o(r,p,2),g=o(r,p,3),[y,b,v,x]=vI(this.kernel.read(),4,3),[w,k,S,N]=this.useBias?vI(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,y,w,this.padding),c=this.inputConv(c,b,k,this.padding),u=this.inputConv(u,v,S,this.padding),d=this.inputConv(d,x,N,this.padding);let[I,C,T,E]=vI(this.recurrentKernel.read(),4,3);h=this.recurrentConv(h,I),f=this.recurrentConv(f,C),m=this.recurrentConv(m,T),g=this.recurrentConv(g,E);let _=this.recurrentActivation.apply(cw(l,h)),A=this.recurrentActivation.apply(cw(c,f)),R=cw(pw(A,s),pw(_,this.activation.apply(cw(u,m)))),F=pw(this.recurrentActivation.apply(cw(d,g)),this.activation.apply(R));return[F,F,R]})}getConfig(){let e=super.getConfig(),{units:t}=e,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(e,["units"]),a={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),a)}inputConv(e,t,n,a){let r=hk(e,t,this.strides,a||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?lD(r,n,this.dataFormat):r}recurrentConv(e,t){return hk(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}};cL.className="ConvLSTM2DCell",bT.registerClass(cL);var uL=class extends lL{constructor(e){let t=new cL(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};uL.className="ConvLSTM2D",bT.registerClass(uL);var dL=class extends KD{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;let t=e.shape,n=[];for(let a=0;a<this.noiseShape.length;++a)n.push(null==this.noiseShape[a]?t[a]:this.noiseShape[a]);return n}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e);if(0<this.rate&&this.rate<1){let e=null!=t.training&&t.training,a=this.getNoiseShape(n);return uD(()=>cD(n,this.rate,a,this.seed),()=>n,e)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};dL.className="Dropout",bT.registerClass(dL);var pL=class extends dL{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};pL.className="SpatialDropout1D",bT.registerClass(pL);var hL=class extends KD{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,xF(this.units,"units"),this.activation=bP(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=FD(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=FD(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=fM(e.kernelConstraint),this.biasConstraint=fM(e.biasConstraint),this.kernelRegularizer=IP(e.kernelRegularizer),this.biasRegularizer=IP(e.biasRegularizer),this.activityRegularizer=IP(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){let t=(e=PD(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){let t=(e=PD(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n,a=OD(e),r=kF(this.activation.getClassName());return null!=r?n=rD(a,this.kernel.read(),r,this.bias?this.bias.read():null):(n=rD(a,this.kernel.read()),null!=this.bias&&(n=lD(n,this.bias.read())),null!=this.activation&&(n=this.activation.apply(n))),n})}getConfig(){let e={units:this.units,activation:gP(this.activation),useBias:this.useBias,kernelInitializer:RD(this.kernelInitializer),biasInitializer:RD(this.biasInitializer),kernelRegularizer:SP(this.kernelRegularizer),biasRegularizer:SP(this.biasRegularizer),activityRegularizer:SP(this.activityRegularizer),kernelConstraint:pM(this.kernelConstraint),biasConstraint:pM(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};hL.className="Dense",bT.registerClass(hL);var fL=class extends KD{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=PD(e);for(let t of e.slice(1))if(null==t)throw new eF('The shape of the input to "Flatten" is not fully defined (got '.concat(e.slice(1),'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.'));return[e[0],HF(e,1)]}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e);if("channelsFirst"===this.dataFormat&&n.rank>1){let e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=XI(n,e)}return function(e){if(e.rank<=1)throw new eF("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));let t=[e.shape[0],HF(e.shape,1)];return Ww(e,t)}(n)})}getConfig(){let e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};fL.className="Flatten",bT.registerClass(fL);var mL=class extends KD{constructor(e){super(e),this.supportsMasking=!0,this.activation=bP(e.activation)}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e);return this.activation.apply(n)})}getConfig(){let e={activation:gP(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};mL.className="Activation",bT.registerClass(mL);var gL=class extends KD{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return Yv(()=>function(e,t){return Yv(()=>{if(2!==e.shape.length)throw new eF("repeat() expects a rank-2 tensor, but received a rank-".concat(e.shape.length," tensor."));return nD(QF(e,1),[1,t,1])})}(e=OD(e),this.n))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};gL.className="RepeatVector",bT.registerClass(gL);var yL=class extends KD{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",a=t.slice(),r=1,s=null;for(let o=0;o<a.length;++o){let e=a[o];if(this.isUnknown(e)){if(null!==s)throw new eF("Can only specifiy one unknown dimension.");s=o}else r*=e}let i=HF(e);if(null!==s){if(0===r||i%r!==0)throw new eF(n);a[s]=i/r}else if(i!==r)throw new eF(n);return a}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e),a=n.shape,r=a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape));return Ww(n,r)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};yL.className="Reshape",bT.registerClass(yL);var bL=class extends KD{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received ".concat(e.dims," instead."));let t=KF(1,e.dims.length+1);if(!gb.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new VD({ndim:this.dims.length+1})]}computeOutputShape(e){let t=(e=PD(e)).slice();return this.dims.forEach((n,a)=>{t[a+1]=e[n]}),t}call(e,t){return XI(OD(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};bL.className="Permute",bT.registerClass(bL);var vL=class extends KD{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=OD(e);return bw(iN(n,this.maskValue),-1)}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e),a=bw(iN(n,this.maskValue),-1,!0);return pw(n,iw(a,n.dtype))})}};vL.className="Masking",bT.registerClass(vL);var xL=class extends KD{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(lF(e.inputLength))}this.inputDim=e.inputDim,xF(this.inputDim,"inputDim"),this.outputDim=e.outputDim,xF(this.outputDim,"outputDim"),this.embeddingsInitializer=FD(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=IP(e.embeddingsRegularizer),this.activityRegularizer=IP(e.activityRegularizer),this.embeddingsConstraint=fM(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return Yv(()=>this.maskZero?(e=OD(e),iN(e,Ok(e))):null)}computeOutputShape(e){if(e=PD(e),null==this.inputLength)return[...e,this.outputDim];let t=lF(this.inputLength);if(t.length!==e.length-1)throw new eF('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ").concat(e));{let n=0;for(let a=0;a<t.length;++a){let r=t[a],s=e[a+1];if(null!=r&&null!=s&&r!==s)throw new eF('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ").concat(e));null==r&&(t[n]=s),n++}}return[e[0],...t,this.outputDim]}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e);"int32"!==n.dtype&&(n=YF(n,"int32"));let a=sD(this.embeddings.read(),Ww(n,[n.size]));return Ww(a,PD(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:RD(this.embeddingsInitializer),embeddingsRegularizer:SP(this.embeddingsRegularizer),activityRegularizer:SP(this.activityRegularizer),embeddingsConstraint:pM(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};xL.className="Embedding",bT.registerClass(xL);var wL=class extends KD{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new tF}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;let n=e.slice(0,e.length-t.length);for(let a=0;a<t.length;++a){let r=e[e.length-t.length+a],s=t[a];if(null==r||null==s||r<0||s<0)n.push(null);else if(1===r)n.push(s);else if(1===s)n.push(r);else{if(r!==s)throw new eF("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(r)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[PD(e)]),e.length<2)throw new eF("A merge layer should be called on an Array of at least 2 inputs. Got ".concat(e.length," input(s)."));let t=[];for(let r of e)null!=r&&null!==r[0]&&t.push(r[0]);if(t=gF(t),t.length>1)throw new eF("Can not merge tensors with different batch sizes. Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){let t=null==e[r]?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}let a=e.map(e=>e.length);-1===e.indexOf(null)&&1===gF(a).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return Yv(()=>{if(this.reshapeRequired){let t=[],n=e.map(e=>e.rank);if(-1===n.indexOf(null)){let a=qF(n);for(let n of e){let e=n.rank;for(let t=0;t<a-e;++t)n=QF(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(let s of e){let e=s.rank;if(null==e){let e=s.shape,a=e[0],r=e.slice(1).concat([a]),i=Ww(s,[a].concat(HF(e.slice(1))));i=XI(i,[1,0]),i=Ww(i,r),t.push(i),n=!0}else if(e>1){let a=KF(1,e).concat([0]);t.push(XI(s,a)),n=!0}else t.push(s)}let a=this.mergeFunction(t),r=a.rank;if(n)if(null==r){let e=a.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));a=Ww(XI(Ww(a,[-1,t]),[1,0]),n)}else if(r>1){let e=[r-1].concat(KF(0,r-1));a=XI(a,e)}return a}}return this.mergeFunction(e)})}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let a=1;a<e.length;++a){let n=null==e[a]?null:e[a].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(let a of e)null!=a&&null!==a[0]&&n.push(a[0]);return n=gF(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return Yv(()=>{if(null==t)return null;if(!Array.isArray(t))throw new eF("`mask` should be an Array");if(!Array.isArray(e))throw new eF("`inputs` should be an Array");if(t.length!==e.length)throw new eF("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (".concat(e.length," vs ").concat(t.length,")"));if(t.every(e=>null==e))return null;let n=(t=t.map(e=>null==e?e:oS(e,0)))[0];for(let e=1;e<t.length-1;++e)n=jS(n,t[e]);return n})}},kL=class extends wL{constructor(e){super(e)}mergeFunction(e){return Yv(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=cw(t,e[n]);return t})}};kL.className="Add",bT.registerClass(kL);var SL=class extends wL{constructor(e){super(e)}mergeFunction(e){return Yv(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=pw(t,e[n]);return t})}};SL.className="Multiply",bT.registerClass(SL);var NL=class extends wL{constructor(e){super(e)}mergeFunction(e){return Yv(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=cw(t,e[n]);return pw(1/e.length,t)})}};NL.className="Average",bT.registerClass(NL);var IL=class extends wL{constructor(e){super(e)}mergeFunction(e){return Yv(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=YS(t,e[n]);return t})}};IL.className="Maximum",bT.registerClass(IL);var CL=class extends wL{constructor(e){super(e)}mergeFunction(e){return Yv(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=eN(t,e[n]);return t})}};CL.className="Minimum",bT.registerClass(CL);var TL=class extends wL{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new eF("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(let a of e)if(null!=a){t=!1;break}if(t)return;let n=[];for(let a=0;a<e.length;++a){let t=e[a].slice();t.splice(this.axis,1);let r=!1;for(let e of n)if(gb.arraysEqual(e,t)){r=!0;break}r||n.push(t)}if(n.length>1)throw new eF("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Yv(()=>eD(e,this.axis))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new eF("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),a=this.axis<0?n.length+this.axis:this.axis;for(let r of t.slice(1)){if(null==n[a]||null==r[a]){n[a]=null;break}n[a]+=r[a]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new eF("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new eF("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new eF("Mismatch in the length of mask (".concat(t.length,") and the legnth of inputs (").concat(e.length,")"));return Yv(()=>{let n=!0;if(t.forEach(e=>{null==e||(n=!1)}),n)return null;let a=[];for(let s=0;s<e.length;++s)null==t[s]?a.push(iw(lN(e[s]),"bool")):t[s].rank<e[s].rank?a.push(oS(t[s],-1)):a.push(t[s]);let r=Hw(a,this.axis);return yw(r,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};function EL(e,t){for(;e<0;)e+=t;return e}TL.className="Concatenate",bT.registerClass(TL);var _L=class extends wL{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){gb.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new tF("Dot layer does not support tensors of 4D or higher rank yet.");let a=this.interpretAxes(t,n);if(t[a[0]]!==n[a[1]])throw new eF("Dimension incompatibility: ".concat(t[a[0]]," !== ").concat(n[a[1]]))}mergeFunction(e){if(2!==e.length)throw new eF("A `Dot` layer must be called on exactly 2 inputs, but received ".concat(e.length," input(s)."));let t,n=e[0],a=e[1];return t=Array.isArray(this.axes)?this.axes.map((t,n)=>EL(t,e[n].shape.length)):[EL(this.axes,n.shape.length),EL(this.axes,a.shape.length)],this.normalize&&(n=XM(n,t[0]),a=XM(a,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new tF("batchDot is not implemented for tensors of 4D or higher rank yet");if(gb.assert(e.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, but got ".concat(e.shape.length)),gb.assert(e.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, but got ".concat(t.shape.length)),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new tF("batchDot is not implemented for complex64-type Tensors yet.");let a=e.shape.length,r=t.shape.length;null==n&&(n=[a-1,r-2]);let s=n;return Yv(()=>{let n,i;if(a>r){n=a-r;let e=[];for(let t=0;t<n;++t)e.push(1);t=Ww(t,t.shape.concat(e))}else if(r>a){n=r-a;let t=[];for(let e=0;e<n;++e)t.push(1);e=Ww(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)i=s[0]===s[1]?nS(pw(e,t),s[0]):nS(pw(XI(e,[1,0]),t),s[1]);else{let n=s[0]!==e.shape.length-1,a=s[1]===t.shape.length-1;i=Gw(e,t,n,a)}if(n>0){let e;e=a>r?a+r-3:a-1;let t=[];for(let a=e;a<e+n;++a)t.push(a);i=kI(i,t)}return 1===i.shape.length&&(i=oS(i,1)),i})}(n,a,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[EL(this.axes,e.length),EL(this.axes,t.length)],n}computeOutputShape(e){gb.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new tF("Dot layer does not support tensors of 4D or higher rank yet.");let a=this.interpretAxes(t,n);t.splice(a[0],1),n.splice(a[1],1),n.splice(0,1);let r=t.concat(n);return 1===r.length&&r.push(1),r}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};_L.className="Dot",bT.registerClass(_L);var AL=class extends KD{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e);return uD(()=>cw(aD(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}};AL.className="GaussianNoise",bT.registerClass(AL);var RL=class extends KD{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Yv(()=>{this.invokeCallHook(e,t);let n=OD(e);return this.rate>0&&this.rate<1?uD(()=>{let e=Math.sqrt(this.rate/(1-this.rate));return pw(n,aD(n.shape,1,e))},()=>n,t.training||!1):n})}};RL.className="GaussianDropout",bT.registerClass(RL);var FL=class extends KD{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||OD(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Yv(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return uD(()=>{let t=OD(e),a=-1.7580993408473766,r=fS(GN(n),this.rate);r=YF(r,"float32");let s=((1-this.rate)*(1+this.rate*a**2))**-.5,i=-s*a*this.rate,o=cw(pw(t,r),pw(cw(r,-1),a));return cw(pw(o,s),i)},()=>OD(e),t.training||!1)}return e})}};function DL(e,t,n,a,r){let s,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)s=$w(e,t,n,a,r,i);else if(3===e.rank)s=ek(e,t,n,a,r,i);else{if(4!==e.rank)throw new tF("batchNormalization is not implemented for array of rank ".concat(e.rank," yet"));s=tk(e,t,n,a,r,i)}return s}function ML(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return gb.arraysEqual(a.slice().sort(),KF(0,e.rank-1))?function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Yv(()=>{let s=aN(e,a),i=s.mean,o=s.variance;return[DL(e,i,o,n,t,r),i,o]})}(e,t,n,a,r):function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Yv(()=>{let s=aN(e,a),i=s.mean,o=s.variance,l=[];for(let t of KF(0,e.rank))-1!==a.indexOf(t)?l.push(1):l.push(e.shape[t]);let c=Ww(i,l),u=Ww(o,l),d=null==t?null:Ww(t,l),p=null==n?null:Ww(n,l);return[DL(e,c,u,p,d,r),i,o]})}(e,t,n,a,r)}FL.className="AlphaDropout",bT.registerClass(FL);var OL=class extends KD{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=FD(e.betaInitializer||"zeros"),this.gammaInitializer=FD(e.gammaInitializer||"ones"),this.movingMeanInitializer=FD(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=FD(e.movingVarianceInitializer||"ones"),this.betaConstraint=fM(e.betaConstraint),this.gammaConstraint=fM(e.gammaConstraint),this.betaRegularizer=IP(e.betaRegularizer),this.gammaRegularizer=IP(e.gammaRegularizer)}build(e){e=PD(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new eF("Axis ".concat(t," of input tensor should have a defined dimension but the layer received an input with shape ").concat(JSON.stringify(e),"."));this.inputSpec=[new VD({ndim:e.length,axes:{[t]:n}})];let a=[n];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return Yv(()=>{let n=null!=t.training&&t.training,a=OD(e),r=a.shape,s=r.length,i=KF(0,s),o=this.axis>=0?this.axis:this.axis+s;i.splice(o,1);let l=rF(1,s);l[o]=r[o];let c=i.slice();c.sort();let u=!gb.arraysEqual(c,KF(0,s).slice(0,s-1));if(!n)return(()=>{if(u){let e=Ww(this.movingMean.read(),l),t=Ww(this.movingVariance.read(),l),n=this.center?Ww(this.beta.read(),l):null,r=this.scale?Ww(this.gamma.read(),l):null;return DL(a,e,t,n,r,this.epsilon)}return DL(a,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();let[d,p,h]=ML(a,this.gamma.read(),this.beta.read(),i,this.epsilon),f=(e,t,n)=>{Yv(()=>{let a=1-n,r=e.read(),s=pw(PS(r,t),a);e.write(PS(r,s))})};return f(this.movingMean,p,this.momentum),f(this.movingVariance,h,this.momentum),d})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:RD(this.betaInitializer),gammaInitializer:RD(this.gammaInitializer),movingMeanInitializer:RD(this.movingMeanInitializer),movingVarianceInitializer:RD(this.movingVarianceInitializer),betaRegularizer:SP(this.betaRegularizer),gammaRegularizer:SP(this.gammaRegularizer),betaConstraint:pM(this.betaConstraint),gammaConstraint:pM(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};OL.className="BatchNormalization",bT.registerClass(OL);var PL=class extends KD{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, but received ".concat(JSON.stringify(this.axis)));for(let e of this.axis)if(!Number.isInteger(e))throw new Error("Expected axis to be an array of integers, but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=FD(e.betaInitializer||"zeros"),this.gammaInitializer=FD(e.gammaInitializer||"ones"),this.betaRegularizer=IP(e.betaRegularizer),this.gammaRegularizer=IP(e.gammaRegularizer),this.supportsMasking=!0}build(e){let t=(e=PD(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=t);for(let r of this.axis)if(r<0||r>=t)throw new Error("Invalid axis: ".concat(r));if(this.axis.length!==gF(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));let n=this.axis.map(t=>e[t]),a=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,a):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,a):this.beta=null,this.built=!0}call(e,t){let n=OD(e),a=n.shape,r=a.length;return Yv(()=>{let{mean:e,variance:t}=aN(n,this.axis,!0),s=rF(1,r);for(let n of this.axis)s[n]=a[n];let i=e=>null!=e&&e.shape.length!==r?Ww(e,s):e,o=this.scale?i(this.gamma.read()):null,l=this.center?i(this.beta.read()):null,c=[],u=[];for(let n=0;n<r;++n)-1!==this.axis.indexOf(n)?(c.push(a[n]),u.push(1)):(c.push(1),u.push(a[n]));return e=cS(e,c),t=cS(t,c),null!=o&&(o=cS(o,u)),null!=l&&(l=cS(l,u)),DL(n,e,t,l,o,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:RD(this.betaInitializer),gammaInitializer:RD(this.gammaInitializer),betaRegularizer:SP(this.betaRegularizer),gammaRegularizer:SP(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};PL.className="LayerNormalization",bT.registerClass(PL);var LL=class extends KD{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new eF("ZeroPadding2D expects padding to be a length-2 array, but received a length-".concat(e.padding.length," array."));let t,n;if("number"==typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new eF("ZeroPadding2D expects height padding to be a length-2 array, but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],2!==e.padding[1].length)throw new eF("ZeroPadding2D expects width padding to be a length-2 array, but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new VD({ndim:4})]}computeOutputShape(e){let t,n;return e=PD(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return Yv(()=>function(e,t,n){return Yv(()=>{if(4!==e.rank)throw new eF("temporalPadding expects input tensor to be 4-D, but received a ".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new eF("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new eF("Unknown data format: ".concat(n,". Supported data formats are 'channelsLast' and 'channelsFirst."));let a;return a="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],uN(e,a)})}(OD(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};function zL(e,t,n,a,r,s){return Yv(()=>{DF(r),OF(s),MF(a),null==n&&(n=[1,1]),null==a&&(a="valid"),null==r&&(r="channelsLast"),null==s&&(s="max"),e=OP(e,r);let i,o="same"===a?"same":"valid";return i="max"===s?qS(e,t,n,o):Vw(e,t,n,o),"channelsFirst"===r&&(i=XI(i,[0,3,1,2])),i})}function jL(e,t,n,a,r,s){return Yv(()=>{DF(r),OF(s),MF(a),null==n&&(n=[1,1,1]),null==a&&(a="valid"),null==r&&(r="channelsLast"),null==s&&(s="max"),e=PP(e,r);let i,o="same"===a?"same":"valid";return i="max"===s?KS(e,t,n,o):Uw(e,t,n,o),"channelsFirst"===r&&(i=XI(i,[0,4,1,2,3])),i})}LL.className="ZeroPadding2D",bT.registerClass(LL);var BL=class extends KD{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"==typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new eF("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ".concat(JSON.stringify(e.poolSize)));this.poolSize=e.poolSize}if(xF(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"==typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new eF("strides for 1D convolutional layer must be a number or an Array of a single number, but received ".concat(JSON.stringify(e.strides)));this.strides=e.strides}xF(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,MF(this.padding),this.inputSpec=[new VD({ndim:3})]}computeOutputShape(e){let t=DP((e=PD(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return Yv(()=>{this.invokeCallHook(e,t),e=QF(OD(e),2);let n=this.poolingFunction(OD(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return kI(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},WL=class extends BL{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return DF(r),MF(a),zL(e,t,n,a,r,"max")}};WL.className="MaxPooling1D",bT.registerClass(WL);var VL=class extends BL{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return DF(r),MF(a),zL(e,t,n,a,r,"avg")}};VL.className="AveragePooling1D",bT.registerClass(VL);var UL=class extends KD{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new eF("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];xF(this.poolSize,"poolSize"),xF(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,DF(this.dataFormat),MF(this.padding),this.inputSpec=[new VD({ndim:4})]}computeOutputShape(e){e=PD(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=DP(t,this.poolSize[0],this.padding,this.strides[0]),n=DP(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return Yv(()=>(this.invokeCallHook(e,t),this.poolingFunction(OD(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},HL=class extends UL{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return DF(r),MF(a),zL(e,t,n,a,r,"max")}};HL.className="MaxPooling2D",bT.registerClass(HL);var GL=class extends UL{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return DF(r),MF(a),zL(e,t,n,a,r,"avg")}};GL.className="AveragePooling2D",bT.registerClass(GL);var qL=class extends KD{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new eF("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];xF(this.poolSize,"poolSize"),xF(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,DF(this.dataFormat),MF(this.padding),this.inputSpec=[new VD({ndim:5})]}computeOutputShape(e){e=PD(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[4]:e[3];return t=DP(t,this.poolSize[0],this.padding,this.strides[0]),n=DP(n,this.poolSize[1],this.padding,this.strides[1]),a=DP(a,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,a]:[e[0],t,n,a,e[4]]}call(e,t){return Yv(()=>(this.invokeCallHook(e,t),this.poolingFunction(OD(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},KL=class extends qL{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return DF(r),MF(a),jL(e,t,n,a,r,"max")}};KL.className="MaxPooling3D",bT.registerClass(KL);var XL=class extends qL{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return DF(r),MF(a),jL(e,t,n,a,r,"avg")}};XL.className="AveragePooling3D",bT.registerClass(XL);var YL=class extends KD{constructor(e){super(e),this.inputSpec=[new VD({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new tF}},QL=class extends YL{constructor(e){super(e||{})}call(e,t){return Yv(()=>{let t=OD(e);return QS(t,1)})}};QL.className="GlobalAveragePooling1D",bT.registerClass(QL);var JL=class extends YL{constructor(e){super(e||{})}call(e,t){return Yv(()=>{let t=OD(e);return Qk(t,1)})}};JL.className="GlobalMaxPooling1D",bT.registerClass(JL);var ZL=class extends KD{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,DF(this.dataFormat),this.inputSpec=[new VD({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new tF}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},$L=class extends ZL{call(e,t){return Yv(()=>{let t=OD(e);return"channelsLast"===this.dataFormat?QS(t,[1,2]):QS(t,[2,3])})}};$L.className="GlobalAveragePooling2D",bT.registerClass($L);var ez=class extends ZL{call(e,t){return Yv(()=>{let t=OD(e);return"channelsLast"===this.dataFormat?Qk(t,[1,2]):Qk(t,[2,3])})}};ez.className="GlobalMaxPooling2D",bT.registerClass(ez);var tz=class extends KD{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=KM(t.layer,n);delete t.layer;let r={layer:a};return Object.assign(r,t),new e(r)}},nz=class extends tz{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=PD(e)).length<3)throw new eF("TimeDistributed layer expects an input shape >= 3D, but received input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){let t=[(e=PD(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),a=e[1];return[n[0],a].concat(n.slice(1))}call(e,t){return Yv(()=>JP((e,n)=>[OD(this.layer.call(e,t)),[]],e=OD(e),[],!1,null,null,!1,!0)[1])}};nz.className="TimeDistributed",bT.registerClass(nz);var az=class extends tz{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=KM(n),t.goBackwards=!0!==t.goBackwards;let a={};if(a.className=e.layer.getClassName(),a.config=t,this.backwardLayer=KM(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(e){bF(RF,"BidirectionalMergeMode",e)}(this.mergeMode),e.weights)throw new tF("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,a,r=this.forwardLayer.computeOutputShape(e);return Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),this.returnState&&(a=r.slice(1)),t=r[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(a).concat(a.slice()):[t].concat(a).concat(a.slice()):oF(n)}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});let r=QP(e,n,a,this.numConstants);if(e=r.inputs,n=r.initialState,a=r.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==a)return super.apply(e,t);let s=[],i=[];if(null!=n){let e=n.length;if(e%2>0)throw new eF("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,s.push(...n);let a=n.map(e=>new VD({shape:e.shape}));this.forwardLayer.stateSpec=a.slice(0,e/2),this.backwardLayer.stateSpec=a.slice(e/2),i.push(...a)}if(null!=a)throw new tF("Support for constants in Bidirectional layers is not implemented yet.");let o=s[0]instanceof UD;for(let l of s)if(l instanceof UD!==o)throw new eF("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let n=[e].concat(s),a=this.inputSpec.concat(i),r=this.inputSpec;this.inputSpec=a;let o=super.apply(n,t);return this.inputSpec=r,o}return super.apply(e,t)}call(e,t){return Yv(()=>{let n,a,r,s,i=t.initialState;if(null==i)n=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{let r=i.slice(0,i.length/2),s=i.slice(i.length/2);n=this.forwardLayer.call(e,Object.assign(t,{initialState:r})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:s}))}return this.returnState&&(Array.isArray(n)&&(r=n.slice(1).concat(a.slice(1))),n=n[0],a=a[0]),this.returnSequences&&(a=ZN(a,1)),"concat"===this.mergeMode?s=eD([n,a]):"sum"===this.mergeMode?s=cw(n,a):"ave"===this.mergeMode?s=pw(.5,cw(n,a)):"mul"===this.mergeMode?s=pw(n,a):null==this.mergeMode&&(s=[n,a]),this.returnState?null==this.mergeMode?s.concat(r):[s].concat(r):s})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){LF(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),LF(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){let e=this.forwardLayer.states.map(e=>null);return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=KM(t.layer);if(delete t.layer,null!=t.numConstants)throw new tF("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let a=t;return a.layer=n,new e(a)}};az.className="Bidirectional",bT.registerClass(az);var rz=class extends KD{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Yv(()=>("float32"!==(e=OD(e)).dtype&&(e=YF(e,"float32")),cw(pw(e,this.scale),this.offset)))}};rz.className="Rescaling",bT.registerClass(rz);var{resizeBilinear:sz,cropAndResize:iz}=hT,oz=class extends KD{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,a,r,s,i,o){return Yv(()=>{let l,c=!1,u=[t/s,n/i,(a+t)/s,(r+n)/i],d=[];3===e.rank?(c=!0,l=SI([e])):l=e;for(let e=0;e<l.shape[0];e++)d.push(u);let p=zv(d,[d.length,4]),h=KN(0,d.length,1,"int32"),f=iz(l,p,h,[a,r],"nearest");return YF(c?OD(VI(f)):f,o)})}upsize(e,t,n,a){return Yv(()=>YF(sz(e,[t,n]),a))}call(e,t){return Yv(()=>{let t=OD(e),n=t.dtype,a=t.shape,r=a[a.length-3],s=a[a.length-2],i=0;r!==this.height&&(i=Math.floor((r-this.height)/2));let o=0;return s!==this.width&&(o=Math.floor((s-this.width)/2),0===o&&(o=1)),i>=0&&o>=0?this.centerCrop(t,i,o,this.height,this.width,r,s,n):this.upsize(e,this.height,this.width,n)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){let t=(e=PD(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};oz.className="CenterCrop",bT.registerClass(oz);var lz=class extends KD{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=PD(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return Yv(()=>{let n;if("int32"!==(e=OD(e)).dtype&&(e=YF(e,"int32")),"undefined"!=typeof t.countWeights){if("count"!==this.outputMode)throw new eF("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=OD(t.countWeights)}let a=Qk(e),r=Jk(e),s=hS(this.numTokens,a).bufferSync().get(0),i=fS(r,0).bufferSync().get(0);if(!s||!i)throw new eF("Input values must be between 0 < values <= numTokens with numTokens=".concat(this.numTokens));return function(e,t,n,a){let r=OD(e);if("int32"!==r.dtype&&(r=YF(r,"int32")),"int"===t)return r;let s=r.shape;if(0===r.rank&&(r=oS(r,-1)),"oneHot"===t&&1!==r.shape[r.shape.length-1]&&(r=oS(r,-1)),r.rank>2)throw new eF("When outputMode is not int, maximum output rank is 2 Received outputMode ".concat(t," and input shape ").concat(s," which would result in output rank ").concat(r.rank,"."));let i,o=["multiHot","oneHot"].includes(t),l=r;if(i=Nk(l,"undefined"!=typeof a&&"count"===t?a:[],n,o),"tfIdf"!==t)return i;if(a)return pw(i,a);throw new eF("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)})}};lz.className="CategoryEncoding",bT.registerClass(lz);var cz=new Set(["bilinear","nearest"]),uz=class extends KD{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!cz.has(e.interpolation))throw new eF("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){let t=(e=PD(e))[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Yv(()=>{let t=[this.height,this.width];if("bilinear"===this.interpolation)return hT.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return hT.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...cz]," are supported"))})}};uz.className="Resizing",bT.registerClass(uz);var dz=class{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}};dz.className="RandomSeed";var pz=class extends KD{constructor(e){super(e),this.randomGenerator=new dz(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};pz.className="BaseRandomLayer";var hz=new Set(["bilinear","nearest"]),fz=class extends pz{constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new eF("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new eF("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new eF("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!hz.has(n))throw new eF("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){let t=(e=PD(e))[2];return[this.imgHeight,-1,t]}call(e,t){return Yv(()=>{let t=OD(e);this.imgHeight=t.shape[t.shape.length-3];let n=t.shape[t.shape.length-2];this.widthFactor=GN([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*n;a=Math.round(a);let r=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return hT.resizeBilinear(e,r);case"nearest":return hT.resizeNearestNeighbor(e,r);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...hz]," are supported"))}})}};function mz(e){return new YD(e)}function gz(e){return new _P(e)}function yz(e){return new CP(e)}function bz(e){return new TP(e)}function vz(e){return new EP(e)}function xz(e){return new RP(e)}function wz(e){return new AP(e)}function kz(e){return new qP(e)}function Sz(e){return new BP(e)}function Nz(e){return new VP(e)}function Iz(e){return new WP(e)}function Cz(e){return new UP(e)}function Tz(e){return new GP(e)}function Ez(e){return new KP(e)}function _z(e){return new XP(e)}function Az(e){return new YP(e)}function Rz(e){return new mL(e)}function Fz(e){return new hL(e)}function Dz(e){return new dL(e)}function Mz(e){return new pL(e)}function Oz(e){return new fL(e)}function Pz(e){return new gL(e)}function Lz(e){return new yL(e)}function zz(e){return new bL(e)}function jz(e){return new xL(e)}function Bz(e){return new kL(e)}function Wz(e){return new NL(e)}function Vz(e){return new TL(e)}function Uz(e){return new IL(e)}function Hz(e){return new CL(e)}function Gz(e){return new SL(e)}function qz(e){return new _L(e)}function Kz(e){return new OL(e)}function Xz(e){return new PL(e)}function Yz(e){return new LL(e)}function Qz(e){return new VL(e)}function Jz(e){return Qz(e)}function Zz(e){return Qz(e)}function $z(e){return new GL(e)}function ej(e){return $z(e)}function tj(e){return $z(e)}function nj(e){return new XL(e)}function aj(e){return nj(e)}function rj(e){return nj(e)}function sj(e){return new QL(e)}function ij(e){return new $L(e)}function oj(e){return new JL(e)}function lj(e){return new ez(e)}function cj(e){return new WL(e)}function uj(e){return new HL(e)}function dj(e){return new KL(e)}function pj(e){return new aL(e)}function hj(e){return new nL(e)}function fj(e){return new sL(e)}function mj(e){return new rL(e)}function gj(e){return new tL(e)}function yj(e){return new eL(e)}function bj(e){return new uL(e)}function vj(e){return new cL(e)}function xj(e){return new ZP(e)}function wj(e){return new iL(e)}function kj(e){return new az(e)}function Sj(e){return new nz(e)}fz.className="RandomWidth",bT.registerClass(fz);var Nj=oj,Ij=lj,Cj=cj,Tj=uj;function Ej(e){return new AL(e)}function _j(e){return new RL(e)}function Aj(e){return new FL(e)}function Rj(e){return new vL(e)}function Fj(e){return new rz(e)}function Dj(e){return new oz(e)}function Mj(e){return new uz(e)}function Oj(e){return new lz(e)}function Pj(e){return new fz(e)}var Lj={};function zj(e,t){return rO(e,t)}function jj(e,t){return cO(e,t)}function Bj(e,t){return uO(e,t)}function Wj(e,t){return sO(e,t)}function Vj(e,t){return dO(e,t)}function Uj(e,t){return oO(e,t)}function Hj(e,t){return lO(e,t)}function Gj(e,t){return tO(e,t)}function qj(e,t){return QM(e,t)}function Kj(e,t){return JM(e,t)}function Xj(e,t){return JM(e,t)}function Yj(e,t){return JM(e,t)}function Qj(e,t){return YM(e,t)}function Jj(e,t){return YM(e,t)}function Zj(e,t){return YM(e,t)}function $j(e,t){return function(e,t){return Yv(()=>{let n=e.sub(t).square().sum(),a=e.sub(e.mean()).square().sum();return $k(1).sub(n.div(a))})}(e,t)}uh(Lj,{MAPE:()=>Xj,MSE:()=>Jj,binaryAccuracy:()=>zj,binaryCrossentropy:()=>jj,categoricalAccuracy:()=>Wj,categoricalCrossentropy:()=>Vj,cosineProximity:()=>Gj,mape:()=>Yj,meanAbsoluteError:()=>qj,meanAbsolutePercentageError:()=>Kj,meanSquaredError:()=>Qj,mse:()=>Zj,precision:()=>Uj,r2Score:()=>$j,recall:()=>Hj,sparseCategoricalAccuracy:()=>Bj});var eB={};uh(eB,{modelFromJSON:()=>qO});var tB={};function nB(e){return new wP(e)}function aB(e){return function(e){return vP(e),new wP({l1:null!=e?e.l1:null,l2:0})}(e)}function rB(e){return function(e){return vP(e),new wP({l2:null!=e?e.l2:null,l1:0})}(e)}uh(tB,{l1:()=>aB,l1l2:()=>nB,l2:()=>rB});var sB=class extends jM{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof HO))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function iB(e,t){return e<t}function oB(e,t){return e>t}var lB=class extends sB{constructor(e){if(super(),null==e&&(e={}),e.restoreBestWeights)throw new tF("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn("EarlyStopping mode '".concat(this.mode,"' is invalid. Falling back to mode 'auto'.")),this.mode="auto"),"min"===this.mode?this.monitorFunc=iB:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=oB:this.monitorFunc=iB,this.monitorFunc===iB&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===iB?1/0:-1/0}async onEpochEnd(e,t){await LM(t);let n=this.getMonitorValue(t);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log("Epoch ".concat(this.stoppedEpoch,": early stopping."))}getMonitorValue(e){null==e&&(e={});let t=e[this.monitor];return null==t&&console.warn("Metric for EarlyStopping ".concat(this.monitor," is not available. Available metrics are: ").concat(Object.keys(e))),t}};var cB,uB,dB={earlyStopping:function(e){return new lB(e)}};Mf().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(cB||(cB={})),function(e){let t;var n;(n=t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))[n.LEGACY=0]="LEGACY",n[n.V1=1]="V1",n[n.V2=2]="V2"}(uB||(uB={}));var pB={};function hB(e,t){let n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};pB[e]=n}function fB(e){return pB[e]}function mB(e){delete pB[e]}function gB(e,t,n,a,r){let s=t.inputParams[e];if(s&&void 0!==s.inputIndexStart){let e=s.inputIndexStart,i=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?e+1:s.inputIndexEnd,o=e<0?t.inputNames.length+e:e;if("tensor"===s.type)return yB(t.inputNames[o],n,a,r);if("tensors"===s.type){let s=t.inputs.slice(e,i);return t.inputNames.slice(e,i).filter((e,t)=>{var n;return"NoOp"!==(null===(n=s[t])||void 0===n?void 0:n.op)}).map(e=>yB(e,n,a,r))}let l=yB(t.inputNames[o],n,a,r),c=l.dataSync();return"number"===s.type?c[0]:gb.toNestedArray(l.shape,c)}let i=t.attrParams[e];return i&&i.value}function yB(e,t,n,a){let[r,s]=wB(e,n);if(null!=a){let e=a.getHashTableHandleByName(r);if(null!=e)return e}let i=n.currentContextIds.find(e=>!!t[xB(r,e)]);return void 0!==i?t[xB(r,i)][s]:void 0}function bB(e,t,n){return t[xB(e,n.currentContextId)]}function vB(e,t){let[n,a,r]=wB(e,t);return[xB(n,t&&t.currentContextId),a,r]}function xB(e,t){return t?"".concat(e,"-").concat(t):e}function wB(e,t){if(""===e)return["",0,void 0];let n=null!=t&&null!=t.parseNodeNameCache;if(n){let n=t.parseNodeNameCache.get(e);if(null!=n)return n}let a,r=e.split(":");if(1===r.length)a=[e,0,void 0];else{let e=r[0],t=3===r.length?r[1]:void 0;a=[e,Number(r[r.length-1]),t]}return n&&t.parseNodeNameCache.set(e,a),a}function kB(e,t,n){let a=gB("pad",e,t,n);if("explicit"===a){a=gB("explicitPaddings",e,t,n);let r=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)r[e][0]=a[2*e],r[e][1]=a[2*e+1];return r}return a}function SB(e){return e.kept?e:ow(e)}var NB={};uh(NB,{json:()=>IB});var IB=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],CB={};uh(CB,{json:()=>TB});var TB=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],EB={};uh(EB,{json:()=>_B});var _B=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],AB={};uh(AB,{json:()=>RB});var RB=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],FB={};uh(FB,{json:()=>DB});var DB=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],MB={};uh(MB,{json:()=>OB});var OB=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],PB={};uh(PB,{json:()=>LB});var LB=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],zB={};uh(zB,{json:()=>jB});var jB=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],BB={};uh(BB,{json:()=>WB});var WB=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],VB={};uh(VB,{json:()=>UB});var UB=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],HB={};uh(HB,{json:()=>GB});var GB=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],qB={};uh(qB,{json:()=>KB});var KB=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],XB={};uh(XB,{json:()=>YB});var YB=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],QB={};uh(QB,{json:()=>JB});var JB=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],ZB={};uh(ZB,{json:()=>$B});var $B=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],eW={};uh(eW,{json:()=>tW});var tW=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],nW={};uh(nW,{json:()=>aW});var aW=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],rW={};uh(rW,{json:()=>sW});var sW=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],iW={};uh(iW,{json:()=>oW});var oW=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],lW=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[].concat(...[NB,CB,EB,AB,FB,MB,PB,zB,BB,VB,HB,qB,XB,QB,ZB,eW,nW,rW,iW].map(e=>e.json));this.opMappers=e.reduce((e,t)=>(e[t.tfOpName]=t,e),{})}transformGraph(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.node,a=[],r=[],s=[],i=n.reduce((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?a.push(e[t.name]):"Const"===t.op?r.push(e[t.name]):(null==t.input||0===t.input.length)&&s.push(e[t.name]),e),{}),o=[],l=[],c={},u={};null!=t&&(c=this.mapSignatureEntries(t.inputs),u=this.mapSignatureEntries(t.outputs));let d=Object.keys(i);d.forEach(e=>{let t=i[e];t.inputNames.forEach((e,n)=>{let[a,,r]=vB(e),s=i[a];if(null!=s.outputs){let e=s.outputs.indexOf(r);if(-1!==e){let r="".concat(a,":").concat(e);t.inputNames[n]=r}}t.inputs.push(s),s.children.push(t)})}),0===Object.keys(u).length?d.forEach(e=>{let t=i[e];0===t.children.length&&l.push(t)}):Object.keys(u).forEach(e=>{let[t]=vB(e),n=i[t];null!=n&&(n.signatureKey=u[e],l.push(n))}),Object.keys(c).length>0?Object.keys(c).forEach(e=>{let[t]=vB(e),n=i[t];n&&(n.signatureKey=c[e],o.push(n))}):o=a;let p={};null!=e.library&&null!=e.library.function&&(p=e.library.function.reduce((e,t)=>(e[t.signature.name]=this.mapFunction(t),e),{}));let h={nodes:i,inputs:o,outputs:l,weights:r,placeholders:a,signature:t,functions:p};return s.length>0&&(h.initNodes=s),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){let t=fB(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});let n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(e=>e.startsWith("^")?e.slice(1):e),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((t,n)=>{let a,r=n.type;switch(n.type){case"string":a=uW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=uW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":a=xW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=xW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":a=pW(e.attr,n.tfName,n.defaultValue||0),void 0===a&&n.tfDeprecatedName&&(a=pW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":a=vW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=vW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":a=dW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=dW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":a=kW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=kW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":a=bW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=bW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":a=wW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=wW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":a=mW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=mW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":a=gW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=gW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":a=fW(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=fW(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t},{})),n}mapFunction(e){let t=e.nodeDef,n=[],a={};null!=t&&(a=t.reduce((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e),{}));let r=[],s=[];e.signature.inputArg.forEach(e=>{let[t]=vB(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:hW(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,r.push(n),a[t]=n}),Object.keys(a).forEach(e=>{let t=a[e];t.inputNames.forEach((e,n)=>{let[r,,s]=vB(e),i=a[r];if(null!=i.outputs){let e=i.outputs.indexOf(s);if(-1!==e){let a="".concat(r,":").concat(e);t.inputNames[n]=a}}t.inputs.push(i),i.children.push(t)})});let i=e.ret;e.signature.outputArg.forEach(e=>{let[t,n]=vB(i[e.name]),r=a[t];null!=r&&(r.defaultOutput=n,s.push(r))});let o=this.mapArgsToSignature(e);return{nodes:a,inputs:r,outputs:s,weights:n,placeholders:[],signature:o}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}};function cW(e,t){let n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){let t=Mf().global;if("undefined"!=typeof t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function uW(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e[t];return null!=r?cW(r.s,a):n}function dW(e,t,n){let a=e[t];return a?a.b:n}function pW(e,t,n){let a=e[t]||{},r=null!=a.i?a.i:null!=a.f?a.f:n;return"number"==typeof r?r:parseInt(r,10)}function hW(e){switch("string"==typeof e&&(e=cB[e]),e){case cB.DT_FLOAT:case cB.DT_HALF:return"float32";case cB.DT_INT32:case cB.DT_INT64:case cB.DT_INT8:case cB.DT_UINT8:return"int32";case cB.DT_BOOL:return"bool";case cB.DT_DOUBLE:return"float32";case cB.DT_STRING:return"string";case cB.DT_COMPLEX64:case cB.DT_COMPLEX128:return"complex64";default:return null}}function fW(e,t,n){let a=e[t];return a&&a.func?a.func.name:n}function mW(e,t,n){let a=e[t];return a&&a.type?hW(a.type):n}function gW(e,t,n){let a=e[t];return a&&a.list&&a.list.type?a.list.type.map(e=>hW(e)):n}function yW(e){if(!e.unknownRank)return null!=e.dim?e.dim.map(e=>"number"==typeof e.size?e.size:parseInt(e.size,10)):[]}function bW(e,t,n){let a=e[t];return a&&a.shape?yW(a.shape):n}function vW(e,t,n){let a=e[t];return a?((a.list.f&&a.list.f.length?a.list.f:a.list.i)||[]).map(e=>"number"==typeof e?e:parseInt(e,10)):n}function xW(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e[t];return r&&r.list&&r.list.s?r.list.s.map(e=>cW(e,a)):n}function wW(e,t,n){let a=e[t];return a&&a.list&&a.list.shape?a.list.shape.map(e=>yW(e)):n}function kW(e,t,n){let a=e[t];return a&&a.list&&a.list.b?a.list.b:n}var SW=class{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(e=>this.getInput(e)),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((e,t)=>(e[t]=this.getAttr(t),e),{}))}getInput(e){return yB(e,this.tensorMap,this.context)}getAttr(e,t){let n=this.node.rawAttrs[e];if(null!=n.tensor)return yB(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return pW(this.node.rawAttrs,e,t);if(null!=n.s)return uW(this.node.rawAttrs,e,t);if(null!=n.b)return dW(this.node.rawAttrs,e,t);if(null!=n.shape)return bW(this.node.rawAttrs,e,t);if(null!=n.type)return mW(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return vW(this.node.rawAttrs,e,t);if(null!=n.list.s)return xW(this.node.rawAttrs,e,t);if(null!=n.list.shape)return wW(this.node.rawAttrs,e,t);if(null!=n.list.b)return kW(this.node.rawAttrs,e,t);if(null!=n.list.type)return gW(this.node.rawAttrs,e,t)}return t}},NW={};uh(NW,{OP_SCOPE_SUFFIX:()=>Mv,abs:()=>hw,acos:()=>fw,acosh:()=>mw,add:()=>cw,addN:()=>gw,all:()=>yw,any:()=>bw,argMax:()=>vw,argMin:()=>xw,asin:()=>ww,asinh:()=>kw,atan:()=>Sw,atan2:()=>Nw,atanh:()=>Iw,avgPool:()=>Vw,avgPool3d:()=>Uw,basicLSTMCell:()=>Yw,batchNorm:()=>Zw,batchNorm2d:()=>$w,batchNorm3d:()=>ek,batchNorm4d:()=>tk,batchToSpaceND:()=>Qw,bincount:()=>nk,bitwiseAnd:()=>ak,booleanMaskAsync:()=>KI,broadcastArgs:()=>rk,broadcastTo:()=>sk,buffer:()=>sw,cast:()=>iw,ceil:()=>ik,clipByValue:()=>lk,clone:()=>ow,complex:()=>Pv,concat:()=>Hw,concat1d:()=>ck,concat2d:()=>uk,concat3d:()=>dk,concat4d:()=>pk,conv1d:()=>fk,conv2d:()=>hk,conv2dTranspose:()=>gk,conv3d:()=>yk,conv3dTranspose:()=>vk,cos:()=>xk,cosh:()=>wk,cosineWindow:()=>tC,cumprod:()=>kk,cumsum:()=>Sk,denseBincount:()=>Nk,depthToSpace:()=>Ik,depthwiseConv2d:()=>Ck,diag:()=>Tk,dilation2d:()=>Ek,div:()=>dw,divNoNan:()=>Pk,dot:()=>Lk,dropout:()=>$I,einsum:()=>zk,elu:()=>jk,enclosingPowerOfTwo:()=>eC,ensureShape:()=>Bk,equal:()=>Dk,erf:()=>Wk,euclideanNorm:()=>sS,exp:()=>iS,expandDims:()=>oS,expm1:()=>lS,eye:()=>uS,fft:()=>gI,fill:()=>ok,floor:()=>dS,floorDiv:()=>uw,fused:()=>aC,gather:()=>pS,gatherND:()=>ZI,greater:()=>hS,greaterEqual:()=>fS,ifft:()=>yI,imag:()=>mS,image:()=>hT,inTopKAsync:()=>nC,irfft:()=>bI,isFinite:()=>gS,isInf:()=>yS,isNaN:()=>bS,leakyRelu:()=>vS,less:()=>xS,lessEqual:()=>wS,linalg:()=>fT,linspace:()=>kS,localResponseNormalization:()=>SS,log:()=>NS,log1p:()=>IS,logSigmoid:()=>OS,logSoftmax:()=>LS,logSumExp:()=>zS,logicalAnd:()=>jS,logicalNot:()=>BS,logicalOr:()=>WS,logicalXor:()=>VS,losses:()=>mT,lowerBound:()=>GS,matMul:()=>Gw,max:()=>Qk,maxPool:()=>qS,maxPool3d:()=>KS,maxPoolWithArgmax:()=>XS,maximum:()=>YS,mean:()=>QS,meshgrid:()=>$S,min:()=>Jk,minimum:()=>eN,mirrorPad:()=>tN,mod:()=>nN,moments:()=>aN,movingAverage:()=>YI,mul:()=>pw,multiRNNCell:()=>rN,multinomial:()=>sN,neg:()=>DS,norm:()=>rS,notEqual:()=>iN,oneHot:()=>oN,ones:()=>ZS,onesLike:()=>lN,op:()=>Ov,outerProduct:()=>cN,pad:()=>uN,pad1d:()=>dN,pad2d:()=>pN,pad3d:()=>hN,pad4d:()=>fN,pool:()=>gN,pow:()=>Zk,prelu:()=>yN,print:()=>lw,prod:()=>bN,raggedGather:()=>vN,raggedRange:()=>xN,raggedTensorToTensor:()=>wN,rand:()=>kN,randomGamma:()=>VN,randomNormal:()=>UN,randomStandardNormal:()=>HN,randomUniform:()=>GN,randomUniformInt:()=>qN,range:()=>KN,real:()=>XN,reciprocal:()=>YN,relu:()=>QN,relu6:()=>JN,reshape:()=>Ww,reverse:()=>ZN,reverse1d:()=>$N,reverse2d:()=>eI,reverse3d:()=>tI,reverse4d:()=>nI,rfft:()=>xI,round:()=>aI,rsqrt:()=>rI,scalar:()=>$k,scatterND:()=>QI,searchSorted:()=>HS,selu:()=>sI,separableConv2d:()=>iI,setdiff1dAsync:()=>oI,sigmoid:()=>qw,sign:()=>lI,signal:()=>pT,sin:()=>cI,sinh:()=>uI,slice:()=>Kw,slice1d:()=>dI,slice2d:()=>pI,slice3d:()=>hI,slice4d:()=>fI,softmax:()=>mI,softplus:()=>MS,spaceToBatchND:()=>mN,sparse:()=>gT,sparseToDense:()=>JI,spectral:()=>dT,split:()=>vI,sqrt:()=>eS,square:()=>tS,squaredDifference:()=>wI,squeeze:()=>kI,stack:()=>SI,step:()=>NI,stridedSlice:()=>II,string:()=>yT,sub:()=>PS,sum:()=>nS,tan:()=>CI,tanh:()=>Xw,tensor:()=>zv,tensor1d:()=>TI,tensor2d:()=>EI,tensor3d:()=>_I,tensor4d:()=>AI,tensor5d:()=>RI,tensor6d:()=>FI,tensorScatterUpdate:()=>LI,tile:()=>cS,topk:()=>zI,transpose:()=>XI,truncatedNormal:()=>jI,unique:()=>BI,unsortedSegmentSum:()=>WI,unstack:()=>VI,upperBound:()=>UI,variable:()=>HI,where:()=>Mk,whereAsync:()=>qI,zeros:()=>JS,zerosLike:()=>Ok});function IW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!=typeof e&&"number"!=typeof t){gb.assert(e.length===t.length,()=>n+" Shapes ".concat(e," and ").concat(t," must match"));for(let a=0;a<e.length;a++){let r=e[a],s=t[a];gb.assert(r<0||s<0||r===s,()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}}}function CW(e){return!("number"==typeof e||e.some(e=>e<0))}function TW(e,t,n){let a=EW(e,n),r=!CW(a);if(r&&0===t.length)throw new Error("Tried to calculate elements of an empty list with non-fully-defined elementShape: ".concat(a));if(r&&t.forEach(e=>{a=EW(e.shape,a)}),!CW(a))throw new Error("Non-fully-defined elementShape: ".concat(a));return a}function EW(e,t){if("number"==typeof e)return t;if("number"==typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));let n=[];for(let a=0;a<e.length;++a){let r=e[a],s=t[a];if(r>=0&&s>=0&&r!==s)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[a]=r>=0?r:s}return n}var _W=class{constructor(e,t,n,a,r,s,i){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=a,this.identicalElementShapes=r,this.dynamicSize=s,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=$k(0),Jv(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(null==e||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));let t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?)."));return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(e=>this.read(e))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));let n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0===this.size()&&(null==this.elementShape||0===this.elementShape.length)&&(this.elementShape=t.shape),IW(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,Jv(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,because the index size: ").concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((e,n)=>this.write(e,t[n]))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return zv([],[0].concat(this.elementShape));let n=this.readMany(e);return IW(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),SI(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return zv([],[0].concat(this.elementShape));let t=[];for(let a=0;a<this.size();a++)t.push(a);let n=this.readMany(t);return IW(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),Hw(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));let n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,VI(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0,a=e.map(e=>(n+=e,n));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), and the TensorArray is not marked as dynamically resizeable"));let r=0===n?0:t.size/n,s=[];Yv(()=>{t=Ww(t,[1,n,r]);for(let n=0;n<e.length;++n){let i=[0,0===n?0:a[n-1],0],o=[1,e[n],r];s[n]=Ww(Kw(t,i,o),this.elementShape)}return s});let i=[];for(let o=0;o<e.length;o++)i[o]=o;this.writeMany(i,s)}},AW=class e{get id(){return this.idTensor.id}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach(e=>{if(n!==e.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(e.dtype));IW(t,e.shape,"TensorList shape mismatch: "),Jv(e)}),this.idTensor=$k(0),this.maxNumElements=a,Jv(this.idTensor)}copy(){return new e([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(null==e||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));IW(e,this.elementShape,"TensorList shape mismatch: ");let a=TW(this.elementShape,this.tensors,e);return Yv(()=>{let e=this.tensors.map(e=>Ww(e,a));return SI(e,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");let n=TW(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,IW(a.shape,e,"TensorList shape mismatch: "),Ww(a,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(IW(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Jv(e),this.tensors.push(e)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));let n=new e([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let e=0;e<Math.min(this.tensors.length,t);++e)n.tensors[e]=this.tensors[e];return n}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));IW(this.tensors[e].shape,t,"TensorList shape mismatch: ");let a=TW(this.elementShape,this.tensors,t);return Ww(this.tensors[e],a)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));IW(this.elementShape,t.shape,"TensorList shape mismatch: "),Jv(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));IW(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());let a=TW(this.elementShape,this.tensors,n);return 0===e.length?zv([],[0].concat(a)):Yv(()=>{let t=e.map(e=>Ww(this.tensors[e],a));return SI(t,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));IW(this.elementShape,t,"TensorList shape mismatch: ");let n=TW(this.elementShape,this.tensors,t);return 0===this.size()?zv([],[0].concat(n)):Yv(()=>{let e=this.tensors.map(e=>Ww(e,n));return Hw(e,0)})}};var RW=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{let a=gB("thenBranch",e,t,n),r=gB("elseBranch",e,t,n),s=gB("cond",e,t,n),i=gB("args",e,t,n);return(await s.data())[0]?n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{let a=gB("body",e,t,n),r=gB("cond",e,t,n),s=gB("args",e,t,n),i=await n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap),o=s.map(e=>e.id),l=await i[0].data();i.forEach(e=>{!e.kept&&-1===o.indexOf(e.id)&&e.dispose()});let c=s;for(;l[0];){let e=c;c=await n.functionMap[a].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);let t=c.map(e=>e.id);e.forEach(e=>{!e.kept&&-1===o.indexOf(e.id)&&-1===t.indexOf(e.id)&&e.dispose()});let s=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await s[0].data(),s.forEach(e=>{!e.kept&&-1===o.indexOf(e.id)&&-1===t.indexOf(e.id)&&e.dispose()})}return c}case"LoopCond":return[SB(gB("pred",e,t,n))];case"Switch":{let a=gB("pred",e,t,n),r=gB("data",e,t,n);return r.kept||(r=SB(r)),(await a.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{let a=e.inputNames.find(e=>void 0!==yB(e,t,n));if(a){return[SB(yB(a,t,n))]}return}case"Enter":{let a=gB("frameName",e,t,n),r=gB("tensor",e,t,n);return n.enterFrame(a),[SB(r)]}case"Exit":{let a=gB("tensor",e,t,n);return n.exitFrame(),[SB(a)]}case"NextIteration":{let a=gB("tensor",e,t,n);return n.nextIteration(),[SB(a)]}case"TensorArrayV3":{let a=gB("size",e,t,n),r=gB("dtype",e,t,n),s=gB("elementShape",e,t,n),i=gB("dynamicSize",e,t,n),o=gB("clearAfterRead",e,t,n),l=gB("identicalElementShapes",e,t,n),c=gB("name",e,t,n),u=new _W(c,r,a,s,l,i,o);return n.addTensorArray(u),[u.idTensor,$k(1)]}case"TensorArrayWriteV3":{let a=gB("tensorArrayId",e,t,n),r=gB("index",e,t,n),s=gB("tensor",e,t,n),i=n.getTensorArray(a.id);return i.write(r,s),[i.idTensor]}case"TensorArrayReadV3":{let a=gB("tensorArrayId",e,t,n),r=gB("index",e,t,n);return[n.getTensorArray(a.id).read(r)]}case"TensorArrayGatherV3":{let a=gB("tensorArrayId",e,t,n),r=gB("indices",e,t,n),s=gB("dtype",e,t,n);return[n.getTensorArray(a.id).gather(r,s)]}case"TensorArrayScatterV3":{let a=gB("tensorArrayId",e,t,n),r=gB("indices",e,t,n),s=gB("tensor",e,t,n),i=n.getTensorArray(a.id);return i.scatter(r,s),[i.idTensor]}case"TensorArrayConcatV3":{let a=gB("tensorArrayId",e,t,n),r=n.getTensorArray(a.id),s=gB("dtype",e,t,n);return[r.concat(s)]}case"TensorArraySplitV3":{let a=gB("tensorArrayId",e,t,n),r=gB("tensor",e,t,n),s=gB("lengths",e,t,n),i=n.getTensorArray(a.id);return i.split(s,r),[i.idTensor]}case"TensorArraySizeV3":{let a=gB("tensorArrayId",e,t,n);return[$k(n.getTensorArray(a.id).size(),"int32")]}case"TensorArrayCloseV3":{let a=gB("tensorArrayId",e,t,n),r=n.getTensorArray(a.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{let a=gB("tensorListId",e,t,n),r=gB("index",e,t,n),s=gB("tensor",e,t,n),i=n.getTensorList(a.id);return i.setItem(r,s),[i.idTensor]}case"TensorListGetItem":{let a=gB("tensorListId",e,t,n),r=gB("index",e,t,n),s=gB("elementShape",e,t,n),i=gB("elementDType",e,t,n);return[n.getTensorList(a.id).getItem(r,s,i)]}case"TensorListScatterV2":case"TensorListScatter":{let a=gB("indices",e,t,n),r=function(e,t,n,a){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));let r=Math.max(...t);if(null!=a&&-1!==a&&r>=a)throw new Error("Max index must be < array size (".concat(r,"  vs. ").concat(a,")"));let s=new AW([],n,e.dtype,a),i=VI(e,0);return t.forEach((e,t)=>{s.setItem(e,i[t])}),s}(gB("tensor",e,t,n),a,gB("elementShape",e,t,n),gB("numElements",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let a,r=gB("elementShape",e,t,n),s=gB("elementDType",e,t,n);a="TensorListReserve"===e.op?"numElements":"maxNumElements";let i=gB(a,e,t,n),o=function(e,t,n,a){return new AW([],e,t,a)}(r,s,0,"TensorListReserve"===e.op?-1:i);return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{let a=gB("tensorListId",e,t,n),r=gB("indices",e,t,n),s=gB("elementShape",e,t,n),i=gB("elementDType",e,t,n);return[n.getTensorList(a.id).gather(r,i,s)]}case"TensorListStack":{let a=gB("tensorListId",e,t,n),r=gB("elementShape",e,t,n),s=gB("elementDType",e,t,n),i=gB("numElements",e,t,n);return[n.getTensorList(a.id).stack(r,s,i)]}case"TensorListFromTensor":{let a=function(e,t,n){let a=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));IW(e.shape.slice(1),t,"TensorList shape mismatch: ");let r=VI(e);return new AW(r,t,a)}(gB("tensor",e,t,n),gB("elementShape",e,t,n),gB("elementDType",e,t,n));return n.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let a=gB("tensorListId",e,t,n),r=n.getTensorList(a.id),s=gB("dtype",e,t,n),i=gB("elementShape",e,t,n);return[r.concat(s,i)]}case"TensorListPushBack":{let a=gB("tensorListId",e,t,n),r=gB("tensor",e,t,n),s=n.getTensorList(a.id);return s.pushBack(r),[s.idTensor]}case"TensorListPopBack":{let a=gB("tensorListId",e,t,n),r=gB("elementShape",e,t,n),s=gB("elementDType",e,t,n);return[n.getTensorList(a.id).popBack(r,s)]}case"TensorListSplit":{let a=gB("tensor",e,t,n),r=gB("elementShape",e,t,n),s=function(e,t,n){let a=0,r=t.map(e=>(a+=e,a));if(a!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(a,", and tensor's shape is: ").concat(e.shape));let s=EW(e.shape.slice(1),n),i=0===a?0:e.size/a,o=Yv(()=>{let n=[];e=Ww(e,[1,a,i]);for(let a=0;a<t.length;++a){let o=[0,0===a?0:r[a-1],0],l=[1,t[a],i];n[a]=Ww(Kw(e,o,l),s)}return e.dispose(),n}),l=new AW([],n,e.dtype,t.length);for(let c=0;c<o.length;c++)l.setItem(c,o[c]);return l}(a,gB("lengths",e,t,n),r);return n.addTensorList(s),[s.idTensor]}case"TensorListLength":{let a=gB("tensorListId",e,t,n);return[$k(n.getTensorList(a.id).size(),"int32")]}case"TensorListResize":{let a=gB("tensorListId",e,t,n),r=gB("size",e,t,n),s=n.getTensorList(a.id).resize(r);return n.addTensorList(s),[s.idTensor]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function FW(e,t,n){let[a,r]=gB("fusedOps",e,t,n),s="biasadd"===a,i=!s,o="prelu"===r,l="fusedbatchnorm"===a,c=gB("numArgs",e,t,n);if(s){if(o&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&s&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let u=gB("strides",e,t,n),d=kB(e,t,n),p=gB("dataFormat",e,t,n).toUpperCase(),h=gB("dilations",e,t,n),[f,m]=gB("args",e,t,n);return i&&(m=f,f=void 0),{stride:u,pad:d,dataFormat:p,dilations:h,biasArg:f,preluArg:m,activationFunc:r,leakyreluAlpha:gB("leakyreluAlpha",e,t,n)}}function DW(e,t,n){return{boxes:gB("boxes",e,t,n),scores:gB("scores",e,t,n),maxOutputSize:gB("maxOutputSize",e,t,n),iouThreshold:gB("iouThreshold",e,t,n),scoreThreshold:gB("scoreThreshold",e,t,n),softNmsSigma:gB("softNmsSigma",e,t,n)}}var MW=class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=$k(0),this.tensorMap=new Map,Jv(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return $k(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),Yv(()=>{let e=VI(t),a=n.length,r=e.length;gb.assert(a===r,()=>"The number of elements doesn't match, keys has ".concat(a," elements, the values has ").concat(r," elements."));for(let t=0;t<a;t++){let a=n[t],r=e[t];Jv(r),this.tensorMap.set(a,r)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return Yv(()=>{let e=[];for(let a=0;a<n.length;a++){let r=n[a],s=this.findWithDefault(r,t);e.push(s)}return SI(e)})}findWithDefault(e,t){let n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ").concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ").concat(t.dtype))}};function OW(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Yv,s=((e,t,n)=>{switch(e.category){case"arithmetic":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[a.add(gB("a",e,t,n),gB("b",e,t,n))];case"AddN":return[a.addN(gB("tensors",e,t,n))];case"FloorMod":case"Mod":return[a.mod(gB("a",e,t,n),gB("b",e,t,n))];case"Mul":return[a.mul(gB("a",e,t,n),gB("b",e,t,n))];case"RealDiv":case"Div":return[a.div(gB("a",e,t,n),gB("b",e,t,n))];case"DivNoNan":return[a.divNoNan(gB("a",e,t,n),gB("b",e,t,n))];case"FloorDiv":return[a.floorDiv(gB("a",e,t,n),gB("b",e,t,n))];case"Sub":return[a.sub(gB("a",e,t,n),gB("b",e,t,n))];case"Minimum":return[a.minimum(gB("a",e,t,n),gB("b",e,t,n))];case"Maximum":return[a.maximum(gB("a",e,t,n),gB("b",e,t,n))];case"Pow":return[a.pow(gB("a",e,t,n),gB("b",e,t,n))];case"SquaredDifference":return[a.squaredDifference(gB("a",e,t,n),gB("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"basic_math":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"Abs":case"ComplexAbs":return[a.abs(gB("x",e,t,n))];case"Acos":return[a.acos(gB("x",e,t,n))];case"Acosh":return[a.acosh(gB("x",e,t,n))];case"Asin":return[a.asin(gB("x",e,t,n))];case"Asinh":return[a.asinh(gB("x",e,t,n))];case"Atan":return[a.atan(gB("x",e,t,n))];case"Atan2":return[a.atan2(gB("x",e,t,n),gB("y",e,t,n))];case"Atanh":return[a.atanh(gB("x",e,t,n))];case"Ceil":return[a.ceil(gB("x",e,t,n))];case"Complex":return[a.complex(gB("real",e,t,n),gB("imag",e,t,n))];case"Cos":return[a.cos(gB("x",e,t,n))];case"Cosh":return[a.cosh(gB("x",e,t,n))];case"Elu":return[a.elu(gB("x",e,t,n))];case"Erf":return[a.erf(gB("x",e,t,n))];case"Exp":return[a.exp(gB("x",e,t,n))];case"Expm1":return[a.expm1(gB("x",e,t,n))];case"Floor":return[a.floor(gB("x",e,t,n))];case"Log":return[a.log(gB("x",e,t,n))];case"Log1p":return[a.log1p(gB("x",e,t,n))];case"Imag":return[a.imag(gB("x",e,t,n))];case"Neg":return[a.neg(gB("x",e,t,n))];case"Reciprocal":return[a.reciprocal(gB("x",e,t,n))];case"Real":return[a.real(gB("x",e,t,n))];case"Relu":return[a.relu(gB("x",e,t,n))];case"Round":return[a.round(gB("x",e,t,n))];case"Selu":return[a.selu(gB("x",e,t,n))];case"Sigmoid":return[a.sigmoid(gB("x",e,t,n))];case"Sin":return[a.sin(gB("x",e,t,n))];case"Sign":return[a.sign(gB("x",e,t,n))];case"Sinh":return[a.sinh(gB("x",e,t,n))];case"Softplus":return[a.softplus(gB("x",e,t,n))];case"Sqrt":return[a.sqrt(gB("x",e,t,n))];case"Square":return[a.square(gB("x",e,t,n))];case"Tanh":return[a.tanh(gB("x",e,t,n))];case"Tan":return[a.tan(gB("x",e,t,n))];case"ClipByValue":return[a.clipByValue(gB("x",e,t,n),gB("clipValueMin",e,t,n),gB("clipValueMax",e,t,n))];case"Relu6":return[a.relu6(gB("x",e,t,n))];case"Rsqrt":return[a.rsqrt(yB(e.inputNames[0],t,n))];case"LeakyRelu":return[a.leakyRelu(gB("x",e,t,n),gB("alpha",e,t,n))];case"Prelu":return[a.prelu(gB("x",e,t,n),gB("alpha",e,t,n))];case"IsNan":return[a.isNaN(yB(e.inputNames[0],t,n))];case"IsInf":return[a.isInf(yB(e.inputNames[0],t,n))];case"IsFinite":return[a.isFinite(yB(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"control":return RW(e,t,n);case"convolution":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"Conv1D":{let r=gB("stride",e,t,n),s=gB("pad",e,t,n),i=gB("dataFormat",e,t,n).toUpperCase(),o=gB("dilation",e,t,n);return[a.conv1d(gB("x",e,t,n),gB("filter",e,t,n),r,s,i,o)]}case"Conv2D":{let r=gB("strides",e,t,n),s=kB(e,t,n),i=gB("dataFormat",e,t,n).toUpperCase(),o=gB("dilations",e,t,n);return[a.conv2d(gB("x",e,t,n),gB("filter",e,t,n),[r[1],r[2]],s,i,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:r,pad:s,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=FW(e,t,n);return[a.fused.conv2d({x:gB("x",e,t,n),filter:gB("filter",e,t,n),strides:[r[1],r[2]],pad:s,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{let{stride:r,pad:s,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=FW(e,t,n);return[a.fused.depthwiseConv2d({x:gB("x",e,t,n),filter:gB("filter",e,t,n),strides:[r[1],r[2]],pad:s,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let r=gB("outputShape",e,t,n),s=gB("strides",e,t,n),i=kB(e,t,n);return[a.conv2dTranspose(gB("x",e,t,n),gB("filter",e,t,n),r,[s[1],s[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let r=gB("strides",e,t,n),s=kB(e,t,n),i=gB("dilations",e,t,n),o=gB("dataFormat",e,t,n).toUpperCase();return[a.depthwiseConv2d(gB("input",e,t,n),gB("filter",e,t,n),[r[1],r[2]],s,o,[i[1],i[2]])]}case"Conv3D":{let r=gB("strides",e,t,n),s=gB("pad",e,t,n),i=gB("dataFormat",e,t,n).toUpperCase(),o=gB("dilations",e,t,n);return[a.conv3d(gB("x",e,t,n),gB("filter",e,t,n),[r[1],r[2],r[3]],s,i,[o[1],o[2],o[3]])]}case"AvgPool":{let r=gB("strides",e,t,n),s=gB("pad",e,t,n),i=gB("kernelSize",e,t,n);return[a.avgPool(gB("x",e,t,n),[i[1],i[2]],[r[1],r[2]],s)]}case"MaxPool":{let r=gB("strides",e,t,n),s=gB("pad",e,t,n),i=gB("kernelSize",e,t,n);return[a.maxPool(gB("x",e,t,n),[i[1],i[2]],[r[1],r[2]],s)]}case"MaxPoolWithArgmax":{let r=gB("strides",e,t,n),s=gB("pad",e,t,n),i=gB("kernelSize",e,t,n),o=gB("includeBatchInIndex",e,t,n),{result:l,indexes:c}=a.maxPoolWithArgmax(gB("x",e,t,n),[i[1],i[2]],[r[1],r[2]],s,o);return[l,c]}case"AvgPool3D":{let r=gB("strides",e,t,n),s=gB("pad",e,t,n),i=gB("kernelSize",e,t,n);return[a.avgPool3d(gB("x",e,t,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],s)]}case"MaxPool3D":{let r=gB("strides",e,t,n),s=gB("pad",e,t,n),i=gB("kernelSize",e,t,n);return[a.maxPool3d(gB("x",e,t,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],s)]}case"Dilation2D":{let r=gB("strides",e,t,n),s=gB("pad",e,t,n),i=gB("dilations",e,t,n),o=r[1],l=r[2],c=i[1],u=i[2];return[a.dilation2d(gB("x",e,t,n),gB("filter",e,t,n),[o,l],s,[c,u],"NHWC")]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"creation":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"Fill":{let r=gB("shape",e,t,n),s=gB("dtype",e,t,n),i=gB("value",e,t,n);return[a.fill(r,i,s)]}case"LinSpace":{let r=gB("start",e,t,n),s=gB("stop",e,t,n),i=gB("num",e,t,n);return[a.linspace(r,s,i)]}case"Multinomial":{let r=gB("logits",e,t,n),s=gB("numSamples",e,t,n),i=gB("seed",e,t,n);return[a.multinomial(r,s,i)]}case"OneHot":{let r=gB("indices",e,t,n),s=gB("depth",e,t,n),i=gB("onValue",e,t,n),o=gB("offValue",e,t,n),l=gB("dtype",e,t,n);return[a.oneHot(r,s,i,o,l)]}case"Ones":return[a.ones(gB("shape",e,t,n),gB("dtype",e,t,n))];case"OnesLike":return[a.onesLike(gB("x",e,t,n))];case"RandomStandardNormal":return[a.randomStandardNormal(gB("shape",e,t,n),gB("dtype",e,t,n),gB("seed",e,t,n))];case"RandomUniform":return[a.randomUniform(gB("shape",e,t,n),gB("minval",e,t,n),gB("maxval",e,t,n),gB("dtype",e,t,n))];case"RandomUniformInt":return[a.randomUniformInt(gB("shape",e,t,n),gB("minval",e,t,n),gB("maxval",e,t,n),gB("seed",e,t,n))];case"Range":{let r=gB("start",e,t,n),s=gB("stop",e,t,n),i=gB("step",e,t,n);return[a.range(r,s,i,gB("dtype",e,t,n))]}case"TruncatedNormal":{let r=gB("shape",e,t,n),s=gB("mean",e,t,n),i=gB("stdDev",e,t,n),o=gB("seed",e,t,n);return[a.truncatedNormal(r,s,i,gB("dtype",e,t,n),o)]}case"Zeros":return[a.zeros(gB("shape",e,t,n),gB("dtype",e,t,n))];case"ZerosLike":return[a.zerosLike(gB("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"dynamic":return async function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:NW;switch(e.op){case"NonMaxSuppressionV5":{let{boxes:a,scores:s,maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=DW(e,t,n),u=await r.image.nonMaxSuppressionWithScoreAsync(a,s,i,o,l,c);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:a,scores:s,maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=DW(e,t,n),c=gB("padToMaxOutputSize",e,t,n),u=await r.image.nonMaxSuppressionPaddedAsync(a,s,i,o,l,c);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:a,scores:s,maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=DW(e,t,n);return[await r.image.nonMaxSuppressionAsync(a,s,i,o,l)]}case"Where":{let a=r.cast(gB("condition",e,t,n),"bool"),s=[await r.whereAsync(a)];return a.dispose(),s}case"ListDiff":return r.setdiff1dAsync(gB("x",e,t,n),gB("y",e,t,n));default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n);case"evaluation":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"LowerBound":{let r=gB("sortedSequence",e,t,n),s=gB("values",e,t,n);return[a.lowerBound(r,s)]}case"TopKV2":{let r=gB("x",e,t,n),s=gB("k",e,t,n),i=gB("sorted",e,t,n),o=a.topk(r,s,i);return[o.values,o.indices]}case"UpperBound":{let r=gB("sortedSequence",e,t,n),s=gB("values",e,t,n);return[a.upperBound(r,s)]}case"Unique":{let r=gB("x",e,t,n),s=a.unique(r);return[s.values,s.indices]}case"UniqueV2":{let r=gB("x",e,t,n),s=gB("axis",e,t,n),i=a.unique(r,s);return[i.values,i.indices]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"image":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"ResizeBilinear":{let r=gB("images",e,t,n),s=gB("size",e,t,n),i=gB("alignCorners",e,t,n),o=gB("halfPixelCenters",e,t,n);return[a.image.resizeBilinear(r,[s[0],s[1]],i,o)]}case"ResizeNearestNeighbor":{let r=gB("images",e,t,n),s=gB("size",e,t,n),i=gB("alignCorners",e,t,n),o=gB("halfPixelCenters",e,t,n);return[a.image.resizeNearestNeighbor(r,[s[0],s[1]],i,o)]}case"CropAndResize":{let r=gB("image",e,t,n),s=gB("boxes",e,t,n),i=gB("boxInd",e,t,n),o=gB("cropSize",e,t,n),l=gB("method",e,t,n),c=gB("extrapolationValue",e,t,n);return[a.image.cropAndResize(r,s,i,o,l,c)]}case"ImageProjectiveTransformV3":{let r=gB("images",e,t,n),s=gB("transforms",e,t,n),i=gB("outputShape",e,t,n),o=gB("fillValue",e,t,n),l=gB("interpolation",e,t,n),c=gB("fillMode",e,t,n);return[a.image.transform(r,s,l.toLowerCase(),c.toLowerCase(),o,i)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"graph":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let r=gB("default",e,t,n);return[yB(e.name,t,n)||r];case"Placeholder":return[yB(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[SB(gB("x",e,t,n))];case"IdentityN":return gB("x",e,t,n).map(e=>SB(e));case"Shape":return[a.tensor1d(gB("x",e,t,n).shape,"int32")];case"ShapeN":return gB("x",e,t,n).map(e=>a.tensor1d(e.shape));case"Size":return[a.scalar(gB("x",e,t,n).size,"int32")];case"Rank":return[a.scalar(gB("x",e,t,n).rank,"int32")];case"NoOp":return[a.scalar(1)];case"Print":let s=gB("x",e,t,n),i=gB("data",e,t,n),o=gB("message",e,t,n),l=gB("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(let e=0;e<i.length;e++)console.log(Array.prototype.slice.call(i[e].dataSync()).slice(0,l));return[s];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"logical":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"Equal":return[a.equal(gB("a",e,t,n),gB("b",e,t,n))];case"NotEqual":return[a.notEqual(gB("a",e,t,n),gB("b",e,t,n))];case"Greater":return[a.greater(gB("a",e,t,n),gB("b",e,t,n))];case"GreaterEqual":return[a.greaterEqual(gB("a",e,t,n),gB("b",e,t,n))];case"Less":return[a.less(gB("a",e,t,n),gB("b",e,t,n))];case"LessEqual":return[a.lessEqual(gB("a",e,t,n),gB("b",e,t,n))];case"LogicalAnd":return[a.logicalAnd(gB("a",e,t,n),gB("b",e,t,n))];case"LogicalNot":return[a.logicalNot(gB("a",e,t,n))];case"LogicalOr":return[a.logicalOr(gB("a",e,t,n),gB("b",e,t,n))];case"Select":case"SelectV2":return[a.where(gB("condition",e,t,n),gB("a",e,t,n),gB("b",e,t,n))];case"BitwiseAnd":return[a.bitwiseAnd(gB("a",e,t,n),gB("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"matrices":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[a.matMul(gB("a",e,t,n),gB("b",e,t,n),gB("transposeA",e,t,n),gB("transposeB",e,t,n))];case"Einsum":return[a.einsum(gB("equation",e,t,n),...gB("tensors",e,t,n))];case"Transpose":return[a.transpose(gB("x",e,t,n),gB("perm",e,t,n))];case"_FusedMatMul":let[r,s]=gB("fusedOps",e,t,n),i="biasadd"===r,o="prelu"===s,l=gB("numArgs",e,t,n),c=gB("leakyreluAlpha",e,t,n);if(i){if(o&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[u,d]=gB("args",e,t,n);return[a.fused.matMul({a:gB("a",e,t,n),b:gB("b",e,t,n),transposeA:gB("transposeA",e,t,n),transposeB:gB("transposeB",e,t,n),bias:u,activation:s,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[a.linalg.bandPart(gB("a",e,t,n),gB("numLower",e,t,n),gB("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"normalization":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"EuclideanNorm":return[a.euclideanNorm(gB("x",e,t,n),gB("axis",e,t,n),gB("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[a.batchNorm(gB("x",e,t,n),gB("mean",e,t,n),gB("variance",e,t,n),gB("offset",e,t,n),gB("scale",e,t,n),gB("epsilon",e,t,n))];case"LRN":return[a.localResponseNormalization(gB("x",e,t,n),gB("radius",e,t,n),gB("bias",e,t,n),gB("alpha",e,t,n),gB("beta",e,t,n))];case"Softmax":return[a.softmax(gB("x",e,t,n))];case"LogSoftmax":return[a.logSoftmax(gB("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"ragged":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"RaggedGather":{let{outputNestedSplits:r,outputDenseValues:s}=a.raggedGather(gB("paramsNestedSplits",e,t,n),gB("paramsDenseValues",e,t,n),gB("indices",e,t,n),gB("outputRaggedRank",e,t,n));return r.concat(s)}case"RaggedRange":{let{rtNestedSplits:r,rtDenseValues:s}=a.raggedRange(gB("starts",e,t,n),gB("limits",e,t,n),gB("splits",e,t,n));return[r,s]}case"RaggedTensorToTensor":return[a.raggedTensorToTensor(gB("shape",e,t,n),gB("values",e,t,n),gB("defaultValue",e,t,n),gB("rowPartitionTensors",e,t,n),gB("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"reduction":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"Max":{let r=gB("axis",e,t,n),s=gB("keepDims",e,t,n);return[a.max(gB("x",e,t,n),r,s)]}case"Mean":{let r=gB("axis",e,t,n),s=gB("keepDims",e,t,n);return[a.mean(gB("x",e,t,n),r,s)]}case"Min":{let r=gB("axis",e,t,n),s=gB("keepDims",e,t,n);return[a.min(gB("x",e,t,n),r,s)]}case"Sum":{let r=gB("axis",e,t,n),s=gB("keepDims",e,t,n);return[a.sum(gB("x",e,t,n),r,s)]}case"All":{let r=gB("axis",e,t,n),s=gB("keepDims",e,t,n);return[a.all(gB("x",e,t,n),r,s)]}case"Any":{let r=gB("axis",e,t,n),s=gB("keepDims",e,t,n);return[a.any(gB("x",e,t,n),r,s)]}case"ArgMax":{let r=gB("axis",e,t,n);return[a.argMax(gB("x",e,t,n),r)]}case"ArgMin":{let r=gB("axis",e,t,n);return[a.argMin(gB("x",e,t,n),r)]}case"Prod":{let r=gB("axis",e,t,n),s=gB("keepDims",e,t,n);return[a.prod(gB("x",e,t,n),r,s)]}case"Cumprod":{let r=gB("axis",e,t,n),s=gB("exclusive",e,t,n),i=gB("reverse",e,t,n);return[a.cumprod(gB("x",e,t,n),r,s,i)]}case"Cumsum":{let r=gB("axis",e,t,n),s=gB("exclusive",e,t,n),i=gB("reverse",e,t,n);return[a.cumsum(gB("x",e,t,n),r,s,i)]}case"Bincount":let r=gB("x",e,t,n),s=gB("weights",e,t,n),i=gB("size",e,t,n);return[a.bincount(r,s,i)];case"DenseBincount":{let r=gB("x",e,t,n),s=gB("weights",e,t,n),i=gB("size",e,t,n),o=gB("binaryOutput",e,t,n);return[a.denseBincount(r,s,i,o)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"slice_join":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"ConcatV2":case"Concat":{let r=gB("n",e,t,n),s=gB("axis",e,t,n),i=gB("tensors",e,t,n);return i=i.slice(0,r),[a.concat(i,s)]}case"Gather":{let r=gB("x",e,t,n),s=gB("indices",e,t,n);return[a.gather(r,a.cast(s,"int32"),0)]}case"GatherV2":{let r=gB("axis",e,t,n),s=gB("batchDims",e,t,n),i=gB("x",e,t,n),o=gB("indices",e,t,n);return[a.gather(i,a.cast(o,"int32"),r,s)]}case"Reverse":{let r=gB("dims",e,t,n),s=[];for(let e=0;e<r.length;e++)r[e]&&s.push(e);let i=gB("x",e,t,n);return[a.reverse(i,s)]}case"ReverseV2":{let r=gB("axis",e,t,n),s=gB("x",e,t,n);return[a.reverse(s,r)]}case"Slice":{let r=gB("begin",e,t,n),s=gB("size",e,t,n);return[a.slice(gB("x",e,t,n),r,s)]}case"StridedSlice":{let r=gB("begin",e,t,n),s=gB("end",e,t,n),i=gB("strides",e,t,n),o=gB("beginMask",e,t,n),l=gB("endMask",e,t,n),c=gB("ellipsisMask",e,t,n),u=gB("newAxisMask",e,t,n),d=gB("shrinkAxisMask",e,t,n),p=gB("x",e,t,n);return[a.stridedSlice(p,r,s,i,o,l,c,u,d)]}case"Pack":return Yv(()=>{let r=gB("axis",e,t,n),s=gB("tensors",e,t,n),i=s[0].shape,o=a.squeeze(s[0]).shape,l=s.map(e=>{let t=gb.arraysEqual(e.shape,i);if(!t&&!gb.arraysEqual(a.squeeze(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:a.reshape(e,i)});return[a.stack(l,r)]});case"Unpack":{let r=gB("axis",e,t,n),s=gB("tensor",e,t,n);return a.unstack(s,r)}case"Tile":{let r=gB("reps",e,t,n);return[a.tile(gB("x",e,t,n),r)]}case"Split":case"SplitV":{let r=gB("axis",e,t,n),s=gB("numOrSizeSplits",e,t,n),i=gB("x",e,t,n);return a.split(i,s,r)}case"ScatterNd":{let r=gB("indices",e,t,n),s=gB("values",e,t,n),i=gB("shape",e,t,n);return[a.scatterND(r,s,i)]}case"GatherNd":{let r=gB("x",e,t,n),s=gB("indices",e,t,n);return[a.gatherND(r,s)]}case"SparseToDense":{let r=gB("sparseIndices",e,t,n),s=gB("outputShape",e,t,n),i=gB("sparseValues",e,t,n),o=gB("defaultValue",e,t,n);return[a.sparseToDense(r,i,s,i.dtype===o.dtype?o:a.cast(o,i.dtype))]}case"TensorScatterUpdate":{let r=gB("indices",e,t,n),s=gB("values",e,t,n),i=gB("tensor",e,t,n);return[a.tensorScatterUpdate(i,r,s)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"sparse":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:r,outputValues:s,emptyRowIndicator:i,reverseIndexMap:o}=a.sparse.sparseFillEmptyRows(gB("indices",e,t,n),gB("values",e,t,n),gB("denseShape",e,t,n),gB("defaultValue",e,t,n));return[r,s,i,o]}case"SparseReshape":{let{outputIndices:r,outputShape:s}=a.sparse.sparseReshape(gB("inputIndices",e,t,n),gB("inputShape",e,t,n),gB("newShape",e,t,n));return[r,s]}case"SparseSegmentMean":return[a.sparse.sparseSegmentMean(gB("data",e,t,n),gB("indices",e,t,n),gB("segmentIds",e,t,n))];case"SparseSegmentSum":return[a.sparse.sparseSegmentSum(gB("data",e,t,n),gB("indices",e,t,n),gB("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"spectral":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"FFT":return[a.fft(gB("x",e,t,n))];case"IFFT":return[a.ifft(gB("x",e,t,n))];case"RFFT":return[a.rfft(gB("x",e,t,n))];case"IRFFT":return[a.irfft(gB("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"string":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"StaticRegexReplace":return[a.string.staticRegexReplace(gB("input",e,t,n),gB("pattern",e,t,n),gB("rewrite",e,t,n),gB("replaceGlobal",e,t,n))];case"StringNGrams":{let{nGrams:r,nGramsSplits:s}=a.string.stringNGrams(gB("data",e,t,n),gB("dataSplits",e,t,n),gB("separator",e,t,n),gB("nGramWidths",e,t,n),gB("leftPad",e,t,n),gB("rightPad",e,t,n),gB("padWidth",e,t,n),gB("preserveShortSequences",e,t,n));return[r,s]}case"StringSplit":{let{indices:r,values:s,shape:i}=a.string.stringSplit(gB("input",e,t,n),gB("delimiter",e,t,n),gB("skipEmpty",e,t,n));return[r,s,i]}case"StringToHashBucketFast":return[a.string.stringToHashBucketFast(gB("input",e,t,n),gB("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"transformation":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NW;switch(e.op){case"Cast":return[a.cast(gB("x",e,t,n),gB("dtype",e,t,n))];case"ExpandDims":{let r=gB("axis",e,t,n);return[a.expandDims(gB("x",e,t,n),r)]}case"Squeeze":{let r=gB("axis",e,t,n);return[a.squeeze(gB("x",e,t,n),r)]}case"Reshape":return[a.reshape(gB("x",e,t,n),gB("shape",e,t,n))];case"EnsureShape":return[a.ensureShape(gB("x",e,t,n),gB("shape",e,t,n))];case"MirrorPad":return[a.mirrorPad(gB("x",e,t,n),gB("padding",e,t,n),gB("mode",e,t,n))];case"PadV2":case"Pad":return[a.pad(gB("x",e,t,n),gB("padding",e,t,n),gB("constantValue",e,t,n))];case"SpaceToBatchND":{let r=gB("blockShape",e,t,n),s=gB("paddings",e,t,n);return[a.spaceToBatchND(gB("x",e,t,n),r,s)]}case"BatchToSpaceND":{let r=gB("blockShape",e,t,n),s=gB("crops",e,t,n);return[a.batchToSpaceND(gB("x",e,t,n),r,s)]}case"DepthToSpace":{let r=gB("blockSize",e,t,n),s=gB("dataFormat",e,t,n).toUpperCase();return[a.depthToSpace(gB("x",e,t,n),r,s)]}case"BroadcastTo":return[a.broadcastTo(gB("x",e,t,n),gB("shape",e,t,n))];case"BroadcastArgs":return[a.broadcastArgs(gB("s0",e,t,n),gB("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"hash_table":return(async(e,t,n,a)=>{switch(e.op){case"HashTable":case"HashTableV2":{let r=a.getHashTableHandleByName(e.name);if(null!=r)return[r];{let r=gB("keyDType",e,t,n),s=gB("valueDType",e,t,n),i=new MW(r,s);return a.addHashTable(e.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let r=gB("tableHandle",e,t,n,a),s=gB("keys",e,t,n),i=gB("values",e,t,n);return[await a.getHashTableById(r.id).import(s,i)]}case"LookupTableFind":case"LookupTableFindV2":{let r=gB("tableHandle",e,t,n,a),s=gB("keys",e,t,n),i=gB("defaultValue",e,t,n);return[await a.getHashTableById(r.id).find(s,i)]}case"LookupTableSize":case"LookupTableSizeV2":{let r=gB("tableHandle",e,t,n,a);return[a.getHashTableById(r.id).tensorSize()]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}})(e,t,n,a);case"custom":let s=fB(e.op);if(s&&s.customExecutor)return s.customExecutor(new SW(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()"))}})(e,t,n);return gb.isPromise(s)?s.then(e=>[].concat(e)):[].concat(s)}var PW=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=a,this.parseNodeNameCache=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(e=>0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function LW(e,t,n,a){let r=new Set,s=[],i=null,o=null,l=new Set,c=new Set(Object.keys(e).map(e=>wB(e)[0]));a=a||[];let u=new Set(a.map(e=>wB(e.name)[0])),d=[...t];for(;d.length>0;){let e=d.pop();if((UW(e)||HW(e)||GW(e))&&null==i&&(i=e,o=i.children.map(e=>e.name).filter(e=>r.has(e))),r.add(e.name),null==n[e.name]&&!c.has(e.name)&&!u.has(e.name)){if(0===e.inputs.length){s.push(e.name);continue}e.inputs.forEach(e=>{l.has(e.name)||(l.add(e.name),d.push(e))})}}return{inputs:e,outputs:t,usedNodes:r,missingInputs:s,dynamicNode:i,syncInputs:o}}function zW(e,t){let{usedNodes:n,inputs:a}=t,r=Object.keys(a).map(e=>wB(e)[0]).map(t=>e.nodes[t]),s=e.initNodes||[],i=e=>n.has("string"==typeof e?e:e.name);function o(e){return[...new Map(e.map(e=>[e.name,e])).values()]}let l=o([...r,...e.weights,...s]).filter(i),c=o([...l,...Object.values(e.nodes)]).filter(i),u=new Map(c.map(e=>[e.name,e])),d={};for(let m of c){d[m.name]=d[m.name]||0;for(let e of m.children)i(e)||(d[e.name]=Number.POSITIVE_INFINITY),d[e.name]=(d[e.name]||0)+1}let p=Object.entries(d).filter(e=>{let[,t]=e;return 0===t}).map(e=>{let[t]=e;return t}),h=[...p];for(;p.length>0;){let e=p.pop(),t=u.get(e);for(let n of t.children.filter(i))0===--d[n.name]&&(h.push(n.name),p.push(n.name))}let f=function(e,t){let n=new Map(e.map(e=>[e.name,e])),a=t.map(e=>e.name),r=new Set(a);for(;a.length>0;){let e=a.pop(),t=n.get(e);for(let s of t.children)!n.has(s.name)||r.has(s.name)||(r.add(s.name),a.push(s.name))}return e.filter(e=>r.has(e.name))}(h.map(e=>u.get(e)),l);return function(e,t){let n=new Map(e.map((e,t)=>[e.name,t])),a=new Set(t.map(e=>e.name)),r=e=>a.has("string"==typeof e?e:e.name),s=new Set(e.map(e=>e.name)),i=e=>s.has("string"==typeof e?e:e.name);for(let o of e){for(let e of o.children.filter(i)){if(!n.has(e.name))throw new jW("Child ".concat(e.name," of node ").concat(o.name," is unreachable."));if(n.get(o.name)>n.get(e.name))throw new jW("Node ".concat(o.name," is scheduled to run after its child ").concat(e.name,"."))}if(!r(o))for(let e of o.inputs){if(!n.has(e.name))throw new jW("Input ".concat(e.name," of node ").concat(o.name," is unreachable."));if(n.get(e.name)>n.get(o.name))throw new jW("Node ".concat(o.name," is scheduled to run before its input ").concat(e.name,"."))}}}(f,l),f}var jW=class extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}};var BW=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),WW=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),VW=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function UW(e){return BW.has(e.op)}function HW(e){return WW.has(e.op)}function GW(e){return VW.has(e.op)}var qW=class e{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){let t=Object.keys(e).map(t=>e[t].map(e=>e.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{let t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(n=>{this._functionExecutorMap[n]=new e(t.functions[n],this)})}getCompilationKey(e,t){let n=e.map(e=>e.name).sort(),a=t.map(e=>e.name).sort();return n.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,t){let n=LW(e,t,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:r,syncInputs:s}=n;if(null!=r)throw new Error("This execution contains the node '".concat(r.name,"', which has the dynamic op '").concat(r.op,"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [").concat(s,"]"));if(a.length>0){let n=t.map(e=>e.name),r=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs [").concat(r,"]. Missing the following inputs: [").concat(a,"]"))}let i=zW(this.graph,n),o=function(e){let t=new Map(e.map((e,t)=>[e.name,t])),n=Number.MAX_SAFE_INTEGER,a=e.map((e,t)=>UW(e)?n:t),r=e=>{let n=a[t.get(e.name)];return null==n?-1:n},s=e.map((e,t)=>e.children.map(r).reduce((e,t)=>Math.max(e,t),a[t])),i=new Map;for(let o=0;o<e.length;++o){let t=s[o];if(t===n)continue;let a=e[o],r=e[t];i.has(r.name)||i.set(r.name,[]),i.get(r.name).push(a)}return i}(i);return{orderedNodes:i,nodeLiveUntilMap:o}}cloneAndKeepTensor(e){if(null==e)return null;let t=e.clone();return Jv(t),t}cloneTensorList(e){return e?e.map(e=>this.cloneAndKeepTensor(e)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,this.cloneTensorList(n)]}))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);let n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);let a=n.map(e=>this.graph.nodes[wB(e)[0]]),r=t.map(e=>wB(e)[0]),s=new Set(r),i=r.map(e=>this.graph.nodes[e]);0===i.length&&(i=this._outputs);let o=this.getCompilationKey(a,i),l=this.compiledMap.get(o);null==l&&(l=this.compile(e,i),this.compiledMap.set(o,l));try{this.keepIntermediateTensors=Mf().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let c={},u={};return Yv(()=>{let n=new PW(this.weightMap,c,u,this.functionExecutorMap,this.parseNodeNameCache),a=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(t=>{let[r,s]=wB(t,n),i=[];i[s]=e[t],a[r]=i,this.keepIntermediateTensors&&(this.clonedTensorsMap[r]=this.cloneTensorList(i))});let r=this.getFrozenTensorIds(a),{orderedNodes:i,nodeLiveUntilMap:o}=l;for(let e of i){if(a[e.name])continue;let t=OW(e,a,n,this._resourceManager);if(gb.isPromise(t))throw new Error("The execution of the op '".concat(e.op,"' returned a promise. Please use model.executeAsync() instead."));a[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,a,n,r,s,o.get(e.name))}return null==this.parent&&n.dispose(r),t.map(e=>yB(e,a,n))})}getFrozenTensorIds(e){let t=[].concat.apply([],Object.keys(e).map(t=>e[t]).map(e=>e.map(e=>e.id)));return new Set(t)}checkTensorForDisposal(e,t,n,a,r,s,i){if(!UW(t)&&!s.has(e)){for(let a of n[e])null!=a&&(i[a.id]=(i[a.id]||0)+t.children.length);for(let e of t.inputs){if(UW(e))continue;let t=bB(e.name,n,a);if(null!=t)for(let e of t){if(!e||e.kept||r.has(e.id))continue;let t=i[e.id];1===t?(e.dispose(),delete i[e.id]):null!=t&&i[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,a,r,s){function i(e){return UW(e)||r.has(e.name)}if(!UW(e)&&null!=s)for(let o of s){if(i(o))continue;let e=bB(o.name,t,n);for(let t of e)!t||t.kept||a.has(t.id)||t.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(let t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Mf().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let s=new PW(this.weightMap,a,r,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let i=await this.executeWithControlFlow(e,s,t,n),o=t.map(e=>yB(e,i,s)),l=o.map(e=>e.id),c=Object.keys(e).map(t=>e[t].id),u=new Set([...l,...c,...this.weightIds]);return Object.values(i).forEach(e=>{e.forEach(e=>{e&&!e.isDisposed&&!u.has(e.id)&&e.dispose()})}),null==this.parent&&s.dispose(u),o}async executeFunctionAsync(e,t,n){let a=e.reduce((e,t,n)=>(e[this.inputs[n].name]=t,e),{});return this._executeAsync(a,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,a){let r=Object.keys(e),s=r.map(e=>this.graph.nodes[wB(e)[0]]),i=n.map(e=>wB(e)[0]),o=new Set(i),l=i.map(e=>this.graph.nodes[e]);0===l.length&&(l=this._outputs);let{usedNodes:c,missingInputs:u,dynamicNode:d,syncInputs:p}=LW(e,l,this.weightMap,this._initNodes),h=[...s,...this.graph.weights,...this._initNodes||[]].map(e=>({node:e,contexts:t.currentContext})),f=Object.assign({},this.weightMap);Object.keys(e).forEach(t=>{let[n,a]=wB(t),r=[];r[a]=e[t],f[n]=r});let m={},g=this.getFrozenTensorIds(f),y={};for(;h.length>0;){let e=this.processStack(s,h,t,f,y,g,o,m,c);await Promise.all(e)}null==d&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let b=l.filter(e=>!UW(e)&&!yB(e.name,f,t)).map(e=>e.name);if(b.length>0){let e="";throw null!=d&&(e="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [".concat(p,"]")),new Error("Cannot compute the outputs [".concat(b,"] from the provided inputs [").concat(r,"]. Consider providing the following inputs: [").concat(u,"]. ").concat(e))}return f}processStack(e,t,n,a,r,s,i,o,l){let c=[];for(;t.length>0;){let e=t.pop();n.currentContext=e.contexts;let u="";if("Enter"===e.node.op&&gB("isConstant",e.node,a,n)&&([u]=vB(e.node.name,n)),null==a[e.node.name]){let d=OW(e.node,a,n,this._resourceManager);u||([u]=vB(e.node.name,n));let p=n.currentContext;gb.isPromise(d)?c.push(d.then(c=>(a[u]=c,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(c)),n.currentContext=p,this.checkTensorForDisposal(u,e.node,a,n,s,i,o),this.processChildNodes(e.node,t,n,a,r,l),c))):(a[u]=d,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(d)),this.checkTensorForDisposal(u,e.node,a,n,s,i,o),this.processChildNodes(e.node,t,n,a,r,l))}else this.processChildNodes(e.node,t,n,a,r,l)}return c}processChildNodes(e,t,n,a,r,s){e.children.forEach(e=>{let[i]=vB(e.name,n);r[i]||!s.has(e.name)||("Merge"===e.op?e.inputNames.some(e=>!!yB(e,a,n))&&(r[i]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every(e=>!!yB(e,a,n))&&(r[i]=!0,t.push({contexts:n.currentContext,node:e})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(e=>e.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{let n=e[t],[a]=wB(t),r=this.graph.nodes[a];if(r.attrParams.shape&&r.attrParams.shape.value){let e=r.attrParams.shape.value,t=e.length===n.shape.length&&n.shape.every((t,n)=>-1===e[n]||e[n]===t);gb.assert(t,()=>"The shape of dict['".concat(r.name,"'] provided in model.execute(dict) must be [").concat(e,"], but was [").concat(n.shape,"]"))}r.attrParams.dtype&&r.attrParams.dtype.value&&gb.assert(n.dtype===r.attrParams.dtype.value,()=>"The dtype of dict['".concat(r.name,"'] provided in model.execute(dict) must be ").concat(r.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(e){var t,n;let a={};for(let r in e){let s=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[r];null!=s?a[s.name]=e[r]:a[r]=e[r]}return a}checkInputs(e){let t=Object.keys(e).filter(e=>{let[t]=wB(e);return null==this.graph.nodes[t]});if(t.length>0)throw new Error("The dict provided in model.execute(dict) has keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map(e=>{var t,n;let a=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=a?a.name:e},{})}checkOutputs(e){e.forEach(e=>{let[t]=wB(e);if(!this.graph.nodes[t])throw new Error("The output '".concat(e,"' is not found in the graph"))})}},KW=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}},XW="?tfjs-format=file",YW="model.json",QW=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MT;this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,null==t&&(this.loadOptions={}),this.resourceManager=new KW}findIOHandler(){let e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for URL '").concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return gb.isPromise(e)?e.then(e=>null==e.getWeightStream?this.loadSync(e):this.loadStreaming(e)):this.loadSync(e)}loadSync(e){let t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(null==e.getWeightStream)throw new Error("Model artifacts missing streamWeights function");let t=await fx(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;let n=this.artifacts.modelTopology,a=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){let e=this.artifacts.userDefinedMetadata;null!=e.signature&&(a=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}if(this.signature=a,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new qW(lW.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){let t=lW.Instance.transformGraph(e.modelInitializer);this.initializer=new qW(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"==typeof e){let t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new Error("Found more than one (".concat(t.length,") save handlers for URL '").concat(e,"'"));e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t={};return(e instanceof Jb?[e]:e).forEach((e,n)=>t[this.structuredOutputKeys[n]]=e),t}return e}predict(e,t){let n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){let n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof Jb)&&!Array.isArray(e)){let n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(let t in n){let a=n[t];null!=a.resourceId&&(e[t]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];let n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let a=0;return this.inputNodes.reduce((t,n)=>{var r,s,i;let o=null===(i=null===(s=null===(r=this.signature)||void 0===r?void 0:r.inputs)||void 0===s?void 0:s[n])||void 0===i?void 0:i.resourceId;return t[n]=null!=o?this.resourceIdToCapturedInput[o]:e[a++],t},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,n=Object.keys(t);for(let a=0;a<n.length;a++){let r=t[n[a]];this.resourceIdToCapturedInput[r.resourceId]=e[a]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Qv(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function JW(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MT;if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"==typeof e&&(e=function(e){return e.endsWith("/")||(e+="/"),"".concat(e).concat(YW).concat(XW)}(e));let a=new QW(e,t,n);return await a.load(),a}function ZW(e){if(null==e)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[n,a]=e;if(!n)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in n))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in n))throw new Error("Model JSON is missing 'weightsManifest'");let r=MT.getWeightSpecs(n.weightsManifest),s=MT.getModelArtifactsForJSONSync(n,r,a);t=MT.fromMemorySync(s)}else if("load"in e)t=e;else{if(!("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e))throw new Error("Unknown model format");t=MT.fromMemorySync(e)}let n=new QW(t);return n.load(),n}var $W="4.22.0",eV={};uh(eV,{CSVDataset:()=>qV,Dataset:()=>DV,FileDataSource:()=>sU,TextLineDataset:()=>jV,URLDataSource:()=>iU,array:()=>OV,csv:()=>oU,func:()=>lU,generator:()=>cU,microphone:()=>dU,version_data:()=>pU,webcam:()=>uU,zip:()=>PV});var tV=dh(Sh()),nV=dh(Sh());function aV(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"==typeof Blob&&e instanceof Blob)return e.slice();if(a.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);let r=t(e);if(r.recurse&&null!==r.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse){if(lV(e)){let r=Array.isArray(e)?[]:{};a.add(e);for(let s in e){let i=aV(e[s],t,n,a);r[s]=i}return a.delete(e),e.__proto__&&(r.__proto__=e.__proto__),r}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,r.value),r.value}function rV(e){return sV(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:iV)}function sV(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,a=e[0];if(n.has(a))throw new Error("Circular references are not supported.");let r=t(e);if(r.recurse&&null!==r.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse){if(lV(a)){let r=Array.isArray(a)?[]:{};n.add(a);for(let s in a){let a=sV(e.map(e=>e[s]),t,n);r[s]=a}return n.delete(a),r}throw new Error("Can't recurse into non-iterable type: ".concat(a))}return r.value}function iV(e){return null===e?null:lV(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function oV(e,t){let n=new Map;aV(e,t,n);for(let a of Array.from(n.keys())){let e=n.get(a);if(gb.isPromise(e)){let t=await e;n.set(a,t)}}return aV(e,t,n)}function lV(e){let t=!1;if(Mf().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}=Nh();t=e instanceof n}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof Jb)&&!(e instanceof Promise)&&!t)}function cV(e){return function(e,t){return aV(e,t)}(e,uV)}function uV(e){return e instanceof Jb?{value:e.clone(),recurse:!1}:lV(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var dV=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},pV=class e extends dV{constructor(){super(e.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=2*this.capacity,t=new Array(e),n=this.length();for(let a=0;a<n;a++)t[a]=this.get(this.wrap(this.begin+a));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}};function hV(e){return new yV(e)}function fV(e){return new bV(e)}pV.INITIAL_CAPACITY=32;var mV,gV=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new IV(this,e)}filter(e){return new SV(this,e)}map(e){return new NV(this,e)}mapAsync(e){return new CV(this,e)}serialMapAsync(e){return new CV(this,e).serial()}flatmap(e){return new EV(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(e=>!0===e)}rowMajorBatch(e){return new kV(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iV;return this.rowMajorBatch(e,t).map(e=>rV(e,n))}concatenate(e,t){return new _V(hV([this,e]),t)}take(e){return e<0||null==e?this:new wV(this,e)}skip(e){return e<0||null==e?this:new xV(this,e)}prefetch(e){return new RV(this,e)}shuffle(e,t){return new FV(this,e,t)}serial(){return new vV(this)}},yV=class extends gV{constructor(e){super(),this.items=e,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:cV(e),done:!1}}},bV=class extends gV{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(tv){throw tv.message="Error thrown while iterating through a dataset: ".concat(tv.message),tv}}},vV=class extends gV{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},xV=class extends gV{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;Qv(e.value)}return this.upstream.next()}},wV=class extends gV{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},kV=class extends gV{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},SV=class extends gV{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Qv(e.value)}}},NV=class extends gV{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=iv.getTensorsInContainer(e.value),n=this.transform(e.value),a=iv.getTensorsInContainer(n);for(let r of t)iv.isTensorInList(r,a)||r.dispose();return{value:n,done:!1}}},IV=class extends gV{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(tv){if(!this.handler(tv))return{value:null,done:!0}}}},CV=class extends gV{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=iv.getTensorsInContainer(e.value),n=await this.transform(e.value),a=iv.getTensorsInContainer(n);for(let r of t)iv.isTensorInList(r,a)||r.dispose();return{value:n,done:!1}}},TV=class extends gV{constructor(){super(),this.outputQueue=new pV,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},EV=class extends TV{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=iv.getTensorsInContainer(e.value),n=this.transform(e.value),a=iv.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(let r of t)iv.isTensorInList(r,a)||r.dispose();return!0}},_V=class extends gV{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){let e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}};!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(mV||(mV={}));var AV=class extends gV{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mV.FAIL;super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0;let a=await oV(this.iterators,function(e){return e instanceof gV?{value:e.next().then(e=>(t++,e.done&&n++,e.value)),recurse:!1}:{value:null,recurse:!0}});if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case mV.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element ".concat(this.count,"."));case mV.SHORTEST:return{value:null,done:!0};case mV.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},RV=class extends gV{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new dV(t)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},FV=class extends RV{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=nV.alea(n||gb.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}},DV=class{constructor(){this.size=null}batch(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this;return gb.assert(e>0,()=>"batchSize needs to be positive, but it is\n      ".concat(e)),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),MV(async()=>(await a.iterator()).columnMajorBatch(e,n,LV),t)}concatenate(e){let t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,MV(async()=>(await n.iterator()).concatenate(await e.iterator()),t)}filter(e){let t,n=this;return t=this.size===1/0?1/0:null,MV(async()=>(await n.iterator()).filter(t=>Yv(()=>e(t))),t)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return MV(async()=>(await t.iterator()).map(t=>Yv(()=>e(t))),this.size)}mapAsync(e){let t=this;return MV(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return MV(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,MV(async()=>function(e,t){return new _V(e,t)}(fV(async()=>({value:await n.iterator(),done:!1})).take(e)),t)}skip(e){let t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,MV(async()=>(await n.iterator()).skip(e),t)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size (".concat(this.size," elements)"));let a=this,r=tV.alea(t||gb.now().toString());return MV(async()=>{let t=r.int32();return n&&(t+=r.int32()),(await a.iterator()).shuffle(e,t.toString())},this.size)}take(e){let t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,MV(async()=>(await n.iterator()).take(e),t)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};function MV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends DV{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function OV(e){return MV(async()=>hV(e),e.length)}function PV(e){if(!lV(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=null==t?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=null==t?e[n].size:Math.min(t,e[n].size);return MV(async()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mV.FAIL;return new AV(e,t)}(await oV(e,e=>{if(e instanceof DV)return{value:e.iterator(),recurse:!1};if(lV(e))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}),mV.SHORTEST),t)}function LV(e){if(null===e)return null;return function(e){return null==e||function(e){return null===e||"object"!=typeof e&&"function"!=typeof e}(e)||Array.isArray(e)||"object"==typeof e&&e instanceof Jb||gb.isTypedArray(e)}(e[0])?{value:zV(e),recurse:!1}:{value:null,recurse:!0}}function zV(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Jb?SI(e):zv(e)}DV.MAX_BUFFER_SIZE=1e4;var jV=class extends DV{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}},BV='"',WV=Symbol("out"),VV=Symbol("field"),UV=Symbol("quote"),HV=Symbol("quoteafterquote"),GV=Symbol("quoteinquote"),qV=class extends DV{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&gb.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((e,t)=>(e[t]=e[t]+1||1,e),{}),n=Object.keys(t).filter(e=>t[e]>1);if(gb.assert(0===n.length,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs)for(let a of Object.keys(this.columnConfigs))if(-1===this.fullColumnNames.indexOf(a))throw new Error('The key "'+a+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new jV(e),t||(t={}),this.hasHeader=!1!==t.hasHeader,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(gb.assert(null==t.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(e=>this.makeDataElement(e))}makeDataElement(e){let t=this.parseRow(e),n={},a={};for(let r=0;r<this.fullColumnNames.length;r++){let s=this.fullColumnNames[r],i=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||i){let o=t[r],l=null;if(""===o)if(i&&void 0!==i.default)l=i.default;else{if(i&&(i.required||i.isLabel))throw new Error("Required column ".concat(s," is empty in this line: ").concat(e));l=void 0}else{let e=Number(o);if(isNaN(e))l=i&&"bool"===i.dtype?this.getBoolean(o):o;else if(i&&i.dtype)switch(i.dtype){case"float32":default:l=e;break;case"int32":l=Math.floor(e);break;case"bool":l=this.getBoolean(o)}else l=e}i&&i.isLabel?a[s]=l:n[s]=l}}return 0===Object.keys(a).length?n:{xs:n,ys:a}}getBoolean(e){return"1"===e||"true"===e.toLowerCase()?1:0}parseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],a=0,r=e.length,s=WV;for(let i=0;i<r;i++)switch(s){case WV:switch(e.charAt(i)){case BV:a=i+1,s=UV;break;case this.delimiter:if(a=i+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),s=WV;break;default:s=VV,a=i}break;case VV:if(e.charAt(i)===this.delimiter)n.push(e.substring(a,i)),s=WV,a=i+1;break;case UV:if(e.charAt(i)===BV)s=HV;break;case HV:switch(e.charAt(i)){case this.delimiter:n.push(e.substring(a,i-1)),s=WV,a=i+1;break;case BV:s=UV;break;default:s=GV}break;case GV:if(e.charAt(i)===BV)s=UV}if(s===HV?n.push(e.substring(a,r-1)):n.push(e.substring(a)),t&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have ".concat(this.fullColumnNames.length," elements in a row, but got ").concat(n));return n}},KV=class e extends gV{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;let t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ".concat(this.fftSize));if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=!1!==e.includeSpectrogram,this.includeWaveform=!0===e.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Mf().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let n=new e(t);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(n){throw new Error("Error thrown while initializing video stream: ".concat(n.message))}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: ".concat(this.sampleRateHz,"; Actual: ").concat(this.audioContext.sampleRate))}else this.sampleRateHz=this.audioContext.sampleRate;let t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,t,n=await this.getAudioData();if(this.includeSpectrogram){let t=this.flattenQueue(n.freqDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let e=this.flattenQueue(n.timeDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let e=[],t=[],n=0;return new Promise(a=>{let r=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&a({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(r),a({freqDataQueue:e,timeDataQueue:t}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){let t=e[0].length,n=new Float32Array(e.length*t);return e.forEach((e,a)=>n.set(e,a*t)),n}getTensorFromAudioDataArray(e,t){let n=new Float32Array(gb.sizeFromShape(t));return n.set(e,n.length-e.length),zv(n,t)}},XV=class e extends gV{constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=TI([0],"int32"),this.webcamConfig.centerCrop){let e=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,t=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-e)/2,a=(1-t)/2,r=n+e,s=t+a;this.cropBox=EI([a,n,s,r],[1,4])}else this.cropBox=EI([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Mf().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}let a=new e(t,n);return await a.start(),a}async start(){this.webcamConfig.facingMode&&gb.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,()=>"Invalid webcam facing mode: ".concat(this.webcamConfig.facingMode,". Please provide 'user' or 'environment'"));try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message="Error thrown while initializing video stream: ".concat(e.message),e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=aE.fromPixels(this.webcamVideoElement)}catch(uae){throw new Error("Error thrown converting video to pixels: ".concat(JSON.stringify(uae)))}if(!this.resize)return{value:e,done:!1};try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(uae){throw new Error("Error thrown cropping the video: ".concat(uae.message))}finally{e.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(e){return Yv(()=>{let t,n=oS(iw(e,"float32"),0);t=hT.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let a=t.shape;return Ww(t,a.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(e=>e.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},YV=class{},QV=class extends gV{split(e){return new JV(this,e)}},JV=class extends QV{constructor(e,t){super(),this.upstream=e,this.impl=new ZV(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},ZV=class extends TV{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}async pump(){let e=await this.upstream.next();if(e.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let n of t.slice(0,-1))this.outputQueue.push(n);return this.carryover=t[t.length-1],!0}},$V=class extends gV{decodeUTF8(){return new eU(this)}},eU=class extends QV{constructor(e){super(),this.upstream=e,this.impl=new tU(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},tU=class extends TV{constructor(e){if(super(),this.upstream=e,Mf().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:e}=Nh();this.decoder=new e("utf8")}}summary(){return"".concat(this.upstream.summary()," -> Utf8")}async pump(){let e,t,n=await this.upstream.next();return!n.done&&(e=n.value,t=Mf().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(t),!0)}},nU=class extends $V{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.file=e,this.options=t,gb.assert(e instanceof Uint8Array||!!Mf().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1048576}summary(){return"FileChunks ".concat(this.file)}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let a=new FileReader;a.onload=n=>{let r=a.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(r)},a.onabort=e=>t(new Error("Aborted")),a.onerror=e=>t(new Error(e.type));let r=this.file.slice(this.offset,n);a.readAsArrayBuffer(r)}this.offset=n}),done:!1}}};var aU=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function rU(e){return"string"==typeof e&&"file://"===e.slice(0,7)}var sU=class extends YV{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.input=e,this.options=t}async iterator(){if(rU(this.input)&&Mf().get("IS_NODE")){let e=Ih();this.input=e.readFileSync(this.input.slice(7))}return new nU(this.input,this.options)}},iU=class extends YV{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.url=e,this.fileOptions=t}async iterator(){return rU(this.url)?new sU(this.url,this.fileOptions).iterator():async function(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;"string"==typeof e?t=e:(t=e.url,n=aU(e));let s=await(r||gb.fetch)(t,n);if(s.ok){let e=new Uint8Array(await s.arrayBuffer());return new nU(e,a)}throw new Error(s.statusText)}(this.url,this.fileOptions)}};function oU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new qV(new iU(e),t)}function lU(e){let t=fV(e);return MV(async()=>t)}function cU(e){return MV(async()=>{let t=await e();return fV(()=>t.next())})}async function uU(e,t){return XV.create(e,t)}async function dU(e){return KV.create(e)}var pU="4.22.0";function hU(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&gb.assert("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the CPU backend."))})}var fU=K_.whereImpl,mU=class e extends Mh{nextDataId(){return e.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Dh(this,qv())}write(e,t,n){this.firstUse&&(this.firstUse=!1,Mf().get("IS_NODE")&&WE.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));let a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:n,refCount:1}),a}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&gb.isString(n[0])){let r=n.map(e=>gb.encodeString(e));a=this.write(r,e,t)}else a=this.write(n,e,t);return{dataId:a,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,a,r){this.data.set(e,{values:t,dtype:a,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){let e=this.readSync(n.real.dataId),t=this.readSync(n.imag.dataId);return WE.mergeRealAndImagArrays(e,t)}return gb.convertBackendValuesAndArrayBuffer(this.data.get(e).values,t)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>gb.decodeString(e));return sw(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return sw(e.shape,e.dtype,t)}makeOutput(e,t,n){return qv().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=gb.now();return e(),{kernelMs:gb.now()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){hU([e],"where");let t=this.readSync(e.dataId);return fU(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};mU.nextDataId=0;var gU={};function yU(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}uh(gU,{addImpl:()=>FU,bincountImpl:()=>PU,bincountReduceImpl:()=>LU,bitwiseAndImpl:()=>zU,castImpl:()=>TU,ceilImpl:()=>HU,concatImpl:()=>KU,equalImpl:()=>XU,expImpl:()=>JU,expm1Impl:()=>eH,floorDivImpl:()=>iH,floorImpl:()=>aH,gatherNdImpl:()=>cH,gatherV2Impl:()=>uH,greaterEqualImpl:()=>fH,greaterImpl:()=>dH,lessEqualImpl:()=>xH,lessImpl:()=>yH,linSpaceImpl:()=>SH,logImpl:()=>NH,maxImpl:()=>TH,maximumImpl:()=>EH,minimumImpl:()=>RH,multiplyImpl:()=>MH,negImpl:()=>zH,notEqualImpl:()=>BH,prodImpl:()=>qH,raggedGatherImpl:()=>JH,raggedRangeImpl:()=>$H,raggedTensorToTensorImpl:()=>rG,rangeImpl:()=>sG,rsqrtImpl:()=>iG,scatterImpl:()=>cG,sigmoidImpl:()=>uG,simpleAbsImpl:()=>yU,sliceImpl:()=>hG,sparseFillEmptyRowsImpl:()=>gG,sparseReshapeImpl:()=>yG,sparseSegmentReductionImpl:()=>bG,sqrtImpl:()=>vG,squaredDifferenceImpl:()=>kG,staticRegexReplaceImpl:()=>IG,stridedSliceImpl:()=>EG,stringNGramsImpl:()=>AG,stringSplitImpl:()=>FG,stringToHashBucketFastImpl:()=>DG,subImpl:()=>MG,tileImpl:()=>zG,topKImpl:()=>WG,transposeImpl:()=>UH,uniqueImpl:()=>VG});var bU={kernelName:jf,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend;hU(t,"abs");let a=new Float32Array(gb.sizeFromShape(t.shape));return a=yU(n.data.get(t.dataId).values),n.makeOutput(a,t.shape,t.dtype)}};function vU(e){return(t,n,a,r,s)=>{let i=WE.assertAndGetBroadcastShape(t,n),o=i.length,l=gb.computeStrides(i),c=gb.sizeFromShape(i),u=gb.getTypedArrayFromDType(s,c),d=t.length,p=n.length,h=gb.computeStrides(t),f=gb.computeStrides(n),m=WE.getBroadcastDims(t,i),g=WE.getBroadcastDims(n,i);if(m.length+g.length===0)for(let y=0;y<u.length;++y)u[y]=e(a[y%a.length],r[y%r.length]);else for(let y=0;y<u.length;++y){let t=gb.indexToLoc(y,o,l),n=t.slice(-d);m.forEach(e=>n[e]=0);let s=gb.locToIndex(n,d,h),i=t.slice(-p);g.forEach(e=>i[e]=0);let c=gb.locToIndex(i,p,f);u[y]=e(a[s],r[c])}return[u,i]}}function xU(e){let{inputs:t,backend:n}=e,{real:a,imag:r}=t,s=n.data.get(a.dataId).values,i=n.data.get(r.dataId).values,o=n.makeTensorInfo(a.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(a.shape,"float32",s),imag:n.makeTensorInfo(r.shape,"float32",i)},o}var wU={kernelName:pm,backendName:"cpu",kernelFunc:xU};function kU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return xU({inputs:{real:kU(e,t,"float32"),imag:kU(e,t,"float32")},backend:e})}let a=gb.makeZerosTypedArray(gb.sizeFromShape(t),n);return e.makeTensorInfo(t,n,a)}function SU(e){let{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}var NU={kernelName:tg,backendName:"cpu",kernelFunc:SU};function IU(e){let{inputs:t,backend:n}=e,{input:a}=t,r=n.data.get(a.dataId).complexTensorInfos.real,s=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,s)}var CU={kernelName:$g,backendName:"cpu",kernelFunc:IU};function TU(e,t,n,a){if("int32"===a){return[t,"int32",Int32Array.from(e)]}if("bool"===a){let a=gb.toTypedArray([0],n),[r,s]=vU((e,t)=>e!==t?1:0)(t,[],e,a,"bool");return[s,"bool",r]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(a))}function EU(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dtype:s}=a;if("complex64"===s){if("complex64"===r.dtype)return SU({inputs:{x:r},backend:n});let e=kU(n,r.shape,r.dtype),t=EU({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),a=xU({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),a}if("complex64"===r.dtype){let e=IU({inputs:{input:r},backend:n}),t=EU({inputs:{x:e},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(e),t}if(!gb.hasEncodingLoss(r.dtype,s)){let e=SU({inputs:{x:r},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:s}}let i=n.data.get(r.dataId).values,[o,l,c]=TU(i,r.shape,r.dtype,s);return n.makeTensorInfo(o,l,c)}var _U={kernelName:cm,backendName:"cpu",kernelFunc:EU};function AU(e,t,n,a){return null==n?n=>{let{inputs:r,backend:s}=n,{a:i,b:o}=r,l=s;hU([i,o],e);let c=l.data.get(i.dataId).values,u=l.data.get(o.dataId).values,d="string"===i.dtype?WE.fromUint8ToStringArray(c):c,p="string"===i.dtype?WE.fromUint8ToStringArray(u):u,h=a||i.dtype,[f,m]=t(i.shape,o.shape,d,p,h);return l.makeTensorInfo(m,h,f)}:e=>{let{inputs:r,backend:s}=e,{a:i,b:o}=r,l=s;if("complex64"===i.dtype||"complex64"===o.dtype){let e=EU({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),t=l.data.get(e.dataId),a=t.complexTensorInfos.real,r=t.complexTensorInfos.imag,s=l.data.get(a.dataId).values,c=l.data.get(r.dataId).values,u=EU({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),d=l.data.get(u.dataId),p=d.complexTensorInfos.real,h=d.complexTensorInfos.imag,f=l.data.get(p.dataId).values,m=l.data.get(h.dataId).values,[g,y,b]=n(i.shape,o.shape,s,c,f,m),v=l.makeTensorInfo(b,"float32",g),x=l.makeTensorInfo(b,"float32",y),w=xU({inputs:{real:v,imag:x},backend:l});return l.disposeIntermediateTensorInfo(e),l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(v),l.disposeIntermediateTensorInfo(x),w}{let e=l.data.get(i.dataId).values,n=l.data.get(o.dataId).values,r=a||i.dtype,[s,c]=t(i.shape,o.shape,e,n,r);return l.makeTensorInfo(c,r,s)}}}function RU(e){return(t,n,a,r,s,i)=>{let o=WE.assertAndGetBroadcastShape(t,n),l=gb.sizeFromShape(o),c=o.length,u=gb.computeStrides(o),d=gb.getTypedArrayFromDType("float32",l),p=gb.getTypedArrayFromDType("float32",l),h=WE.getBroadcastDims(t,o),f=WE.getBroadcastDims(n,o),m=WE.mergeRealAndImagArrays(a,r),g=WE.mergeRealAndImagArrays(s,i),y=t.length,b=gb.computeStrides(t),v=n.length,x=gb.computeStrides(n);if(h.length+f.length===0)for(let w=0;w<d.length;w++){let t=w%m.length,n=w%g.length,a=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);d[w]=a.real,p[w]=a.imag}else for(let w=0;w<d.length;w++){let t=gb.indexToLoc(w,c,u),n=t.slice(-y);h.forEach(e=>n[e]=0);let a=gb.locToIndex(n,y,b),r=t.slice(-v);f.forEach(e=>r[e]=0);let s=gb.locToIndex(r,v,x),i=e(m[2*a],m[2*a+1],g[2*s],g[2*s+1]);d[w]=i.real,p[w]=i.imag}return[d,p,o]}}var FU=vU((e,t)=>e+t),DU=RU((e,t,n,a)=>({real:e+n,imag:t+a})),MU=AU(Vf,FU,DU),OU={kernelName:Vf,backendName:"cpu",kernelFunc:MU};function PU(e,t,n,a,r){let s=gb.sizeFromShape(a),i=gb.makeZerosTypedArray(r,n);for(let o=0;o<e.length;o++){let n=e[o];if(n<0)throw new Error("Input x must be non-negative!");n>=r||(i[n]+=s>0?t[o]:1)}return i}function LU(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.shape[0],s=e.shape[1],i=sw([r,n],t.dtype);for(let o=0;o<r;o++)for(let r=0;r<s;r++){let s=e.get(o,r);if(s<0)throw new Error("Input x must be non-negative!");s>=n||(a?i.set(1,o,s):t.size>0?i.set(i.get(o,s)+t.get(o,r),o,s):i.set(i.get(o,s)+1,o,s))}return i}var zU=vU((e,t)=>e&t),jU=AU(im,zU),BU={kernelName:im,backendName:"cpu",kernelFunc:jU};function WU(e){return(t,n,a)=>{let r=gb.getArrayFromDType(n,t.length);for(let s=0;s<t.length;++s)r[s]=e(t[s],a);return r}}function VU(e,t,n){return UU(e,WU(t),n)}function UU(e,t,n){return a=>{let{inputs:r,attrs:s,backend:i}=a,{x:o}=r;hU(o,e);let l,c=i,u=c.data.get(o.dataId).values;if("string"===o.dtype){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");l=WE.fromUint8ToStringArray(u)}else l=u;let d=n||o.dtype,p=t(l,d,s);return c.makeTensorInfo(o.shape,d,p)}}var HU=WU(e=>Math.ceil(e)),GU=UU(um,HU),qU={kernelName:um,backendName:"cpu",kernelFunc:GU};function KU(e,t,n,a){let r=gb.getArrayFromDType(n,gb.sizeFromShape(t));if(a&&"string"!==n){let t=0;e.forEach(e=>{let n=gb.sizeFromShape(e.shape);r.set(e.vals,t),t+=n})}else{let a=0;e.forEach(e=>{let s="string"===n?WE.fromUint8ToStringArray(e.vals):e.vals,i=0;for(let n=0;n<e.shape[0];++n){let o=n*t[1]+a;for(let t=0;t<e.shape[1];++t)r[o+t]=s[i++]}a+=e.shape[1]})}return r}var XU=vU((e,t)=>e===t?1:0),YU=AU(Wm,XU,null,"bool"),QU={kernelName:Wm,backendName:"cpu",kernelFunc:YU},JU=WU(e=>Math.exp(e)),ZU=UU(Vm,JU,"float32"),$U={kernelName:Vm,backendName:"cpu",kernelFunc:ZU},eH=WU(e=>Math.expm1(e)),tH=UU(Hm,eH),nH={kernelName:Hm,backendName:"cpu",kernelFunc:tH},aH=WU(e=>Math.floor(e)),rH=UU(Xm,aH),sH={kernelName:Xm,backendName:"cpu",kernelFunc:rH},iH=vU((e,t)=>Math.floor(e/t)),oH=AU(Ym,iH,null,"int32"),lH={kernelName:Ym,backendName:"cpu",kernelFunc:oH};function cH(e,t,n,a,r,s,i,o,l){let c=sw([a,s],n);for(let u=0;u<a;u++){let n=[],a=0;for(let t=0;t<r;t++){let s=e[u*r+t];a+=s*i[t],n.push(s)}if(a<0||a>=l/s)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(o));for(let e=0;e<s;e++)c.values[u*s+e]=t.get(...t.indexToLoc(a*s+e))}return c}function uH(e,t,n){let a=sw(n,e.dtype);for(let r=0;r<a.size;++r){let n=a.indexToLoc(r).slice(),s=n[0],i=n[2],o=t.locToIndex([s,i]);n[2]=t.values[o];let l=e.locToIndex(n);0<=l&&l<e.values.length&&(a.values[r]=e.values[l])}return a}var dH=vU((e,t)=>e>t?1:0),pH=AU($m,dH,null,"bool"),hH={kernelName:$m,backendName:"cpu",kernelFunc:pH},fH=vU((e,t)=>e>=t?1:0),mH=AU(eg,fH,null,"bool"),gH={kernelName:eg,backendName:"cpu",kernelFunc:mH},yH=vU((e,t)=>e<t?1:0),bH=AU(lg,yH,null,"bool"),vH={kernelName:lg,backendName:"cpu",kernelFunc:bH},xH=vU((e,t)=>e<=t?1:0),wH=AU(cg,xH,null,"bool"),kH={kernelName:cg,backendName:"cpu",kernelFunc:wH};function SH(e,t,n){let a=(t-e)/(n-1),r=gb.makeZerosTypedArray(n,"float32");r[0]=e;for(let s=1;s<r.length;s++)r[s]=r[s-1]+a;return r}var NH=WU(e=>Math.log(e)),IH=UU(dg,NH),CH={kernelName:dg,backendName:"cpu",kernelFunc:IH};function TH(e,t,n,a){let r=gb.getTypedArrayFromDType(a,gb.sizeFromShape(n));for(let s=0;s<r.length;++s){let n=s*t,a=e[n];for(let r=0;r<t;++r){let t=e[n+r];(Number.isNaN(t)||t>a)&&(a=t)}r[s]=a}return r}var EH=vU((e,t)=>Math.max(e,t)),_H=AU(Sg,EH),AH={kernelName:Sg,backendName:"cpu",kernelFunc:_H},RH=vU((e,t)=>Math.min(e,t)),FH=AU(Rg,RH),DH={kernelName:Rg,backendName:"cpu",kernelFunc:FH},MH=vU((e,t)=>e*t),OH=RU((e,t,n,a)=>({real:e*n-t*a,imag:e*a+t*n})),PH=AU(Og,MH,OH),LH={kernelName:Og,backendName:"cpu",kernelFunc:PH};function zH(e,t,n){let a=gb.createScalarValue(-1,n);return MH([],t,a,e,n)}var jH={kernelName:Pg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t;hU(a,"neg");let r=n.data.get(a.dataId).values,[s,i]=zH(r,a.shape,a.dtype);return n.makeTensorInfo(i,a.dtype,s)}},BH=vU((e,t)=>e!==t?1:0),WH=AU(Lg,BH,null,"bool"),VH={kernelName:Lg,backendName:"cpu",kernelFunc:WH};function UH(e,t,n,a,r){let s=t.length,i=gb.sizeFromShape(t),o=gb.computeStrides(t),l=gb.computeStrides(r),c=gb.getTypedArrayFromDType(n,gb.sizeFromShape(r));for(let u=0;u<i;++u){let t=gb.indexToLoc(u,s,o),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[a[e]];c[gb.locToIndex(n,s,l)]=e[u]}return c}function HH(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{perm:s}=n;hU(r,"transpose");let i=r.shape.length,o=new Array(i);for(let c=0;c<o.length;c++)o[c]=r.shape[s[c]];let l=UH(a.data.get(r.dataId).values,r.shape,r.dtype,s,o);return{dataId:a.write(l,o,r.dtype),shape:o,dtype:r.dtype}}var GH={kernelName:Gy,backendName:"cpu",kernelFunc:HH};function qH(e,t,n,a){let[r,s]=WE.computeOutAndReduceShapes(e,a),i=lv(t,"int32"),o=gb.makeZerosTypedArray(gb.sizeFromShape(r),i),l=gb.sizeFromShape(s);for(let c=0;c<o.length;++c){let e=c*l,t=1;for(let a=0;a<l;++a)t*=n[e+a];o[c]=t}return{outVals:o,outShape:r,outDtype:i}}var KH={kernelName:Xg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a;hU(r,"prod");let o=r.shape.length,l=gb.parseAxisParam(s,r.shape),c=WE.getAxesPermutation(l,o),u=l,d=r,p=[];null!=c&&(d=HH({inputs:{x:r},backend:n,attrs:{perm:c}}),p.push(d),u=WE.getInnerMostAxes(u.length,o));let h=n.data.get(d.dataId).values,{outVals:f,outShape:m,outDtype:g}=qH(d.shape,d.dtype,h,u),y=m;return i&&(y=WE.expandShapeToKeepDim(m,l)),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(y,g,f)}};function XH(e,t,n,a){let r=[],s=0,i=t.length-1+n.length,o=new Array(i).fill(null).map(()=>[0]);!function(e,t){for(let n=0;n<e.length;++n){let a=e[n],r=n===e.length-1?t:e[n+1].length;if(0===a.length)throw new Error("Ragged splits may not be empty");if(a[0]<0)throw new Error("Ragged splits must be non-negative");if(a[a.length-1]>r)throw new Error("Ragged splits must not point past values");for(let e=1;e<a.length;++e)if(a[e-1]>a[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,a);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];let e=t[c+1];for(let t=1;t<l+1;++t)o[c].push(t*e)}for(let c=0;c<e.length;++c){let a=e[c],i=e[c]+1;for(let e=0;e<n.length;++e){let r=n[e],s=e+t.length-1;if(s>=0){let e=o[s],t=e[e.length-1]-r[a];for(let n=a;n<i;++n)o[s].push(r[n+1]+t)}a=r[a],i=r[i]}i!==a&&(r.push([a,i]),s+=i-a)}return{outSplits:o,valueSlices:r,numValues:s}}function YH(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let a=t;a<e.length;a++)n[t-1]*=e[a];return n}function QH(e,t,n,a,r){let s=t.slice();s[0]=r;let i=gb.getArrayFromDType(n,gb.sizeFromShape(s)),o=e.length;return function(e,t,n,a,r,s){let i=YH(t,2)[1],o=YH(s,2)[1],l=0;for(let c of n)for(let t=c[0];t<c[1];++t){for(let n=0;n<a;++n)r[l*o+n]=e[t*i+n];++l}}(e,t,a,0===o?0:o/t[0],i,s),[i,s]}function JH(e,t,n,a,r,s,i,o){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((e,a)=>{if(e<0||e>=n){let r=gb.indexToLoc(a,t.length,gb.computeStrides(t)).join(",");throw new Error("indices[".concat(r,"] = ").concat(e," is not in [0, ").concat(n,")"))}})}(s,i,t[0][0]-1),0===a.length)throw new Error("params.rank must be nonzero");let l=a[0],{outSplits:c,valueSlices:u,numValues:d}=XH(s,i,e,l),p=function(e){let t=[];for(let n=0;n<e.length;++n){let a=e[n].length,r=gb.getArrayFromDType("int32",a);t.push(r),e[n].forEach((e,t)=>r[t]=e)}return t}(c),h=QH(n,a,r,u,d);return[p,h[0],h[1]]}var ZH=2147483647;function $H(e,t,n,a,r,s,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");let o=0===t.length,l=0===r.length,c=0===i.length,u=[];o||u.push(t[0]),l||u.push(r[0]),c||u.push(i[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");let d=0===u.length?1:u[0],p=gb.getArrayFromDType("int32",d+1);p[0]=0;for(let g=0;g<d;++g){let t,n=o?e[0]:e[g],r=l?a[0]:a[g],i=c?s[0]:s[g];if(0===i)throw new Error("Requires delta != 0");if(i>0&&r<n||i<0&&r>n)t=0;else if(t=Math.ceil(Math.abs((r-n)/i)),t>ZH)throw new Error("Requires ((limit - start) / delta) <= ".concat(ZH));p[g+1]=p[g]+t}let h=p[d],f=gb.getArrayFromDType(n,h),m=0;for(let g=0;g<d;++g){let t=p[g+1]-p[g],n=o?e[0]:e[g],a=c?s[0]:s[g];for(let e=0;e<t;++e)f[m++]=n,n+=a}return[p,f]}var eG=WE.RowPartitionType,tG=class e{constructor(e,t,n,a,r,s,i,o,l,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=a,this.valuesDType=r,this.defaultValue=s,this.defaultValueShape=i,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=WE.getRowPartitionTypesHelper(c),this.raggedRank=WE.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===eG.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===eG.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(t){let n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case eG.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case eG.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(eG[this.getRowPartitionTypeByDimension(t-1)]))}}static getMaxWidthRowSplit(e){let t=e.length;if(0===t||1===t)return 0;let n=0;for(let a=0;a<t-1;++a){let t=e[a+1]-e[a];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(0===t)return 0;let n=0,a=e[0],r=0;for(let s=1;s<t;++s){let t=e[s];t!==a&&(a=t,r=Math.max(s-n,r),n=s)}return Math.max(t-n,r)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return aG(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;WE.validateDefaultValueShape(n,t);let a=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=WE.combineRaggedTensorToTensorShapes(this.raggedRank,a,t);r[0]<0&&(r[0]=e);for(let s=1;s<=this.raggedRank;++s)r[s]<0&&(r[s]=this.getMaxWidth(s));return r}calculateFirstParentOutputIndex(e,t,n){let a=Math.min(e,n),r=[],s=0;for(let i=0;i<a;++i,s+=t)r.push(s);for(let i=a;i<e;++i)r.push(-1);return gb.assert(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,t,n,a){let r=e.length,s=[];for(let i=0;i<r-1;++i){let r=e[i+1]-e[i],o=Math.min(a,r),l=t[i];-1===l&&(o=0);for(let e=0;e<o;++e)s.push(l),l+=n;for(let e=0;e<r-o;++e)s.push(-1)}if(r>0&&s.length!==e[r-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(e,t,n,a){let r=e.length,s=[];if(0===r)return[];let i=0,o=e[0];if(o>=t.length)throw new Error("Got currentValueRowId=".concat(o,", which is not less than ").concat(t.length));let l=t[o];s.push(l);for(let c=1;c<r;++c){let r=e[c];if(r===o)l>=0&&(++i,i<a?l+=n:l=-1);else{if(i=0,o=r,r>=t.length)throw new Error("Got nextValueRowId=".concat(r," which is not less than ").concat(t.length));l=t[r]}s.push(l)}if(s.length!==e.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(e,t,n,a){let r=this.getRowPartitionTensor(e),s=this.getRowPartitionTypeByDimension(e);switch(s){case eG.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,t,n,a);case eG.ROW_SPLITS:if(r.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(r.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(r,t,n,a);default:throw new Error("Unsupported partition type: ".concat(eG[s]))}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case eG.FIRST_DIM_SIZE:return e[0];case eG.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case eG.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(eG[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let s=n.length-2;s>=0;--s)n[s]=n[s+1]*t[s+1];let a=aG(t,!1),r=gb.getArrayFromDType(this.valuesDType,gb.sizeFromShape(a));if(n[0]*t[0]>0){let s=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e)s=this.calculateOutputIndex(e-1,s,n[e],t[e]);this.setOutput(this.raggedRank,s,r,a)}return[a,r]}setOutput(e,t,n,a){if(0===n.length)return;let r=this.values,s=n,i=a.slice();i=i.slice(e+1);let o=gb.sizeFromShape(i),l=t.length,c=this.defaultValue;if(c.length!==o&&1!==c.length){let e=this.defaultValueShape;Yv(()=>{let t=Ww(c,e);c=sk(t,i).dataSync()})}let u=0,d=0,p=0;for(let h=0;h<=l;++h){let e=h<l?t[h]:-1;if(e!==p){if(d<p){let e=r.subarray(u*o);nG(s.subarray(d*o),e,(p-d)*o)}if(h>=l){let t=n.length;e=Math.floor(t/o)}if(e>p)if(1===this.defaultValue.length)s.subarray(p*o,e*o).fill(this.defaultValue[0]),p=e;else for(;e>p;){nG(s.slice(p*o),c,o),++p}e<0?(u=h+1,d=p):(u=h,d=p,p=d+1)}else++p}}};function nG(e,t,n){for(let a=0;a<n;a++)e[a]=t[a]}function aG(e,t){let n=[];for(let a of e){if(a<0){if(!t)throw new Error("Dimension ".concat(a," must be >= 0"));if(a<-1)throw new Error("Dimension ".concat(a," must be >= -1"));a=-1}n.push(a)}return n}function rG(e,t,n,a,r,s,i,o,l,c){return new tG(e,t,n,a,r,s,i,o,l,c).compute()}function sG(e,t,n,a){if(e===t||e<t&&n<0||t<e&&n>1)return gb.makeZerosTypedArray(0,a);let r=Math.abs(Math.ceil((t-e)/n)),s=gb.makeZerosTypedArray(r,a);t<e&&1===n&&(n=-1),s[0]=e;for(let i=1;i<s.length;i++)s[i]=s[i-1]+n;return s}var iG=WU(e=>1/Math.sqrt(e)),oG=UU(uy,iG),lG={kernelName:uy,backendName:"cpu",kernelFunc:oG};function cG(e,t,n,a,r,s,i,o,l,c){let u=[a/r,r],d=e.values,p=t.values;if(0===a)return sw(n,t.dtype);let h=l instanceof Xb?l:sw(u,t.dtype);"string"==typeof l||"number"==typeof l?h.values.fill(l):"boolean"==typeof l&&h.values.fill(+l);for(let f=0;f<s;f++){let e=[],s=0;for(let t=0;t<i;t++){let n=d[f*i+t];e.push(n),s+=n*o[t]}if(s<0||s>=a/r)throw new Error("Invalid indices: ".concat(e," does not index into ").concat(n));for(let n=0;n<r;n++)c?h.values[s*r+n]+=p[f*r+n]:h.values[s*r+n]=0===t.rank?p[0]:p[f*r+n]}return h}var uG=WU(e=>1/(1+Math.exp(-e))),dG=VU(xy,e=>1/(1+Math.exp(-e))),pG={kernelName:xy,backendName:"cpu",kernelFunc:dG};function hG(e,t,n,a,r){let s=mE.isSliceContinous(a,t,n),i=gb.sizeFromShape(n),o=gb.computeStrides(a);if(s){let n=mE.computeFlatOffset(t,o);return"string"===r?e.slice(n,n+i):e.subarray(n,n+i)}let l=sw(a,r,"string"===r?WE.fromUint8ToStringArray(e):e),c=sw(n,r);for(let u=0;u<c.size;++u){let e=c.indexToLoc(u),n=e.map((e,n)=>e+t[n]);c.set(l.get(...n),...e)}return"string"===r?WE.fromStringArrayToUint8(c.values):c.values}function fG(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:s,size:i}=a;hU(r,"slice");let[o,l]=mE.parseSliceParams(r,s,i);mE.assertParamsValid(r,o,l);let c=hG(n.data.get(r.dataId).values,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,c)}var mG={kernelName:gy,backendName:"cpu",kernelFunc:fG};function gG(e,t,n,a,r,s,i){let o=t[0],l=s[0],c=new Array(l),u=new Array(o),d=t[1];if(0===l){if(0!==o)throw new Error(WE.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));return[gb.getArrayFromDType(n,0),[0,d],gb.getArrayFromDType(r,0),c,u]}let p=!0,h=0,f=new Array(l).fill(0);for(let g=0;g<o;++g){let t=e[g*d];if(t<0)throw new Error(WE.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,t));if(t>=l)throw new Error(WE.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,t,l));++f[t],p=p&&t>=h,h=t}let m=!0;for(let g=0;g<l;++g){let e=0===f[g];c[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&p){let t=e,n=a;for(let e=0;e<o;++e)u[e]=e;return[t,[o,d],n,c,u]}{let t=f[l-1],s=gb.getArrayFromDType(n,t*d),p=gb.getArrayFromDType(r,t),h=new Array(l).fill(0);for(let n=0;n<o;++n){let t=e[n*d],r=h[t],i=(0===t?0:f[t-1])+r;h[t]++;for(let a=0;a<d;++a)s[i*d+a]=e[n*d+a];p[i]=a[n],u[n]=i}for(let e=0;e<l;++e)if(0===h[e]){let t=0===e?0:f[e-1];s[t*d+0]=e;for(let e=1;e<d;++e)s[t*d+e]=0;p[t]=i}return[s,[t,d],p,c,u]}}function yG(e,t,n,a,r){let s=gb.sizeFromShape(a),i=t[0],o=r.length,l=[],c=1,u=-1;for(let m=0;m<o;++m){let e=r[m];if(-1===e){if(-1!==u)throw new Error(WE.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(u,m));u=m,l.push(1)}else{if(e<0)throw new Error(WE.getSparseReshapeNegativeOutputDimErrorMessage(m,e));c*=e,l.push(e)}}if(-1!==u){if(c<=0)throw new Error(WE.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let e=Math.trunc(s/c);if(c*e!==s)throw new Error(WE.getSparseReshapeInputOutputMultipleErrorMessage(a,l));l[u]=e}if(gb.sizeFromShape(l)!==s)throw new Error(WE.getSparseReshapeInputOutputMismatchErrorMessage(a,l));let d=a.length,p=[];if(d>0){p[d-1]=1;for(let e=d-2;e>=0;--e)p[e]=p[e+1]*a[e+1]}let h=[];if(o>0){h[o-1]=1;for(let e=o-2;e>=0;--e)h[e]=h[e+1]*l[e+1]}let f=gb.getArrayFromDType(n,i*o);for(let m=0;m<i;++m){let t=0;for(let n=0;n<d;++n)t+=e[m*d+n]*p[n];for(let e=0;e<o;++e)f[m*o+e]=Math.trunc(t/h[e]),t%=h[e]}return[f,[i,o],l]}function bG(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=a.length,l=[t[0],e.length/t[0]],c=l[1],u=o>0?r[o-1]+1:0;if(u<0)throw new Error(WE.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=t.slice();d[0]=u;let p=d.reduce((e,t)=>e*t,1),h=gb.getArrayFromDType(n,p);if(0===o)return u>0&&h.fill(i),[h,d];if(u<=0)throw new Error(WE.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,m=1,g=0,y=r[f];for(;;){let t=0;if(m<o){if(t=r[m],y===t){++m;continue}if(y>=t)throw new Error(WE.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=u)throw new Error(WE.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,u));y>g&&h.fill(i,g*c,y*c);for(let n=f;n<m;++n){let t=a[n];if(t<0||t>=l[0])throw new Error(WE.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(n,a[n],l[0]));for(let n=0;n<c;n++)h[y*c+n]+=e[t*c+n]}if(s)for(let e=0;e<c;e++)h[y*c+e]/=m-f;if(f=m,++m,g=y+1,y=t,m>o)break}return g<u&&h.fill(i,g*c,u*c),[h,d]}var vG=WU(e=>Math.sqrt(e)),xG=VU(ky,e=>Math.sqrt(e)),wG={kernelName:ky,backendName:"cpu",kernelFunc:xG},kG=vU((e,t)=>{let n=e-t;return n*n}),SG=AU(Fy,kG),NG={kernelName:Fy,backendName:"cpu",kernelFunc:SG},IG=WU((e,t)=>{let{pattern:n,replaceGlobal:a,rewrite:r}=t;return e.replace(new RegExp(n,a?"g":""),r)}),CG=UU(My,IG),TG={kernelName:My,backendName:"cpu",kernelFunc:CG};function EG(e,t,n,a){let r=sw(e,t.dtype);for(let s=0;s<r.size;s++){let e=r.indexToLoc(s),i=new Array(e.length);for(let t=0;t<i.length;t++)i[t]=e[t]*n[t]+a[t];r.set(t.get(...i),...e)}return r}var _G=class{constructor(e,t,n,a,r,s){this.separator=gb.encodeString(e),this.nGramWidths=t,this.leftPad=gb.encodeString(n),this.rightPad=gb.encodeString(a),this.padWidth=r,this.preserveShort=s}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,a,r,s){for(let i=0;i<r;++i){let o=this.getPadWidth(s),l=Math.max(0,o-i),c=Math.max(0,o-(r-(i+1))),u=s-(l+c),d=t+(l>0?0:i-o),p=0;p+=l*this.leftPad.length;for(let t=0;t<u;++t)p+=e[d+t].length;p+=c*this.rightPad.length,p+=(l+c+u-1)*this.separator.length,n[a+i]=new Uint8Array(p);let h=n[a+i],f=0,m=e=>e.forEach(e=>h[f++]=e);for(let e=0;e<l;++e)m(this.leftPad),m(this.separator);for(let t=0;t<u-1;++t)m(e[d+t]),m(this.separator);if(u>0){m(e[d+u-1]);for(let e=0;e<c;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<c-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){let n=e.length,a=t.length;if(a>0){let e=t[0];if(0!==e)throw new Error("First split value must be 0, got ".concat(e));for(let r=1;r<a;++r){let a=t[r]>=e;if(a=a&&t[r]<=n,!a)throw new Error("Invalid split value ".concat(t[r],", must be in [").concat(e,", ").concat(n,"]"));e=t[r]}if(e!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}let r=a-1,s=gb.getArrayFromDType("int32",a);if(0===n||0===a){let e=new Array(n);for(let t=0;t<=r;++t)s[t]=0;return[e,s]}s[0]=0;for(let o=1;o<=r;++o){let e=t[o]-t[o-1],n=0;this.nGramWidths.forEach(t=>{n+=this.getNumNGrams(e,t)}),this.preserveShort&&e>0&&0===n&&(n=1),s[o]=s[o-1]+n}let i=new Array(s[r]);for(let o=0;o<r;++o){let n=t[o],a=s[o];if(this.nGramWidths.forEach(r=>{let s=t[o+1]-t[o],l=this.getNumNGrams(s,r);this.createNGrams(e,n,i,a,l,r),a+=l}),this.preserveShort&&a===s[o]){let r=t[o+1]-t[o];if(0===r)continue;let s=r+2*this.padWidth;this.createNGrams(e,n,i,a,1,s)}}return[i,s]}};function AG(e,t,n,a,r,s,i,o){return new _G(n,a,r,s,i,o).compute(e,t)}function RG(e,t,n,a){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)a.push(e.subarray(t,t+1));return}if(1===t.length){let r=t[0],s=e.indexOf(r);for(;-1!==s;){let t=e.subarray(0,s);(!n||0!==t.length)&&a.push(t),s=(e=e.subarray(s+1)).indexOf(r)}return void((!n||0!==e.length)&&a.push(e))}let r=0;for(let s=0;s<e.length+1;s++)if(s===e.length||-1!==t.indexOf(e[s])){let t=e.subarray(r,s);(!n||0!==t.length)&&a.push(t),r=s+1}}function FG(e,t,n){let a=e.length,r=[],s=0,i=0,o=new Array(a);for(let p=0;p<a;++p){let a=r.length;RG(e[p],t,n,r);let l=r.length-a;o[p]=l,s+=l,i=Math.max(i,l)}let l=gb.getArrayFromDType("int32",2*s),c=new Array(s),u=[a,i],d=0;for(let p=0;p<a;++p)for(let e=0;e<o[p];++e)l[2*d]=p,l[2*d+1]=e,c[d]=r[d],++d;return[l,c,u]}function DG(e,t){let n=gb.getArrayFromDType("int32",e.length);for(let a=0;a<e.length;++a)n[a]=gb.fingerPrint64(e[a]).modulo(t).getLowBitsUnsigned();return n}var MG=vU((e,t)=>e-t),OG=RU((e,t,n,a)=>({real:e-n,imag:t-a})),PG=AU(jy,MG,OG),LG={kernelName:jy,backendName:"cpu",kernelFunc:PG};function zG(e,t){let n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];let a=sw(n,e.dtype);for(let r=0;r<a.values.length;++r){let t=a.indexToLoc(r),n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=t[a]%e.shape[a];let s=e.locToIndex(n);a.values[r]=e.values[s]}return a}var jG=(e,t)=>{let n=t.value-e.value;return 0===n?e.index-t.index:n};function BG(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;a>n;){if(a-n>600){let r=a-n+1,s=t-n+1,i=Math.log(r),o=.5*Math.exp(2*i/3),l=.5*Math.sqrt(i*o*(r-o)/r)*Math.sign(s-r/2);BG(e,t,Math.max(n,Math.floor(t-s*o/r+l)),Math.min(a,Math.floor(t+(r-s)*o/r+l)))}let r=e[t],s=n,i=a;for(gb.swap(e,n,t),jG(e[a],r)>0&&gb.swap(e,n,a);s<i;){for(gb.swap(e,s,i),s++,i--;jG(e[s],r)<0;)s+=1;for(;jG(e[i],r)>0;)i-=1}0===jG(e[n],r)?gb.swap(e,n,i):(i+=1,gb.swap(e,i,a)),i<=t&&(n=i+1),t<=i&&(a=i-1)}}function WG(e,t,n,a,r){let s=t[t.length-1],[i,o]=[e.length/s,s],l=gb.getTypedArrayFromDType(n,i*a),c=gb.getTypedArrayFromDType("int32",i*a);for(let d=0;d<i;d++){let t=d*o,n=e.subarray(t,t+o),s=new Array(n.length);n.forEach((e,t)=>s[t]={value:e,index:t}),a<s.length&&(BG(s,a),s=s.slice(0,a)),r&&s.sort(jG);let i=d*a,u=l.subarray(i,i+a),p=c.subarray(i,i+a);for(let e=0;e<a;e++)u[e]=s[e].value,p[e]=s[e].index}let u=t.slice();return u[u.length-1]=a,[sw(u,n,l),sw(u,"int32",c)]}function VG(e,t,n,a){let r=gb.parseAxisParam(t,n)[0],s=[1,n[0],1];for(let f=0;f<r;f++)s[0]*=n[f];s[1]=n[r];for(let f=r+1;f<n.length;f++)s[2]*=n[f];let i=new Map,o=new Int32Array(n[r]),l=new Xb(s,a,e),c=[],u=1===s[0]&&1===s[2];for(let f=0;f<n[r];f++){let t;if(u)t=e[f].toString();else{let e=[];for(let t=0;t<s[0];t++)for(let n=0;n<s[2];n++)e.push(l.get(t,f,n));t=e.join(",")}let n=i.get(t);if(null!=n)o[f]=n;else{let e=i.size;i.set(t,e),o[f]=e,c.push(f)}}let d=s.slice();d[1]=i.size;let p=new Xb(d,a);c.forEach((e,t)=>{for(let n=0;n<s[0];n++)for(let a=0;a<s[2];a++)p.set(l.get(n,e,a),n,t,a)});let h=n.slice();return h[r]=d[1],{outputValues:p.values,outputShape:h,indices:o}}var UG="4.22.0";sx("cpu",()=>new mU,1);var HG=VU(zm,e=>e>=0?e:Math.exp(e)-1),GG={kernelName:zm,backendName:"cpu",kernelFunc:HG};function qG(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{alpha:s}=a;hU([r],"leakyRelu");let i=gb.sizeFromShape(r.shape),o=n.data.get(r.dataId).values,l=gb.getTypedArrayFromDType("float32",i);for(let c=0;c<o.length;c++)l[c]=o[c]<0?s*o[c]:o[c];return n.makeTensorInfo(r.shape,"float32",l)}var KG={kernelName:og,backendName:"cpu",kernelFunc:qG},XG=vU((e,t)=>e<0?t*e:e);function YG(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t;hU([a,r],"prelu");let s=n.data.get(a.dataId).values,i=n.data.get(r.dataId).values,[o,l]=XG(a.shape,r.shape,s,i,"float32");return n.makeTensorInfo(l,"float32",o)}var QG={kernelName:Kg,backendName:"cpu",kernelFunc:YG},JG=VU(ty,e=>Math.max(0,e)),ZG={kernelName:ty,backendName:"cpu",kernelFunc:JG},$G=VU(oy,e=>Math.min(Math.max(0,e),6)),eq={kernelName:oy,backendName:"cpu",kernelFunc:$G};function tq(e,t,n,a,r){if("linear"===n)return SU({inputs:{x:t},backend:e});if("relu"===n)return JG({inputs:{x:t},backend:e});if("elu"===n)return HG({inputs:{x:t},backend:e});if("relu6"===n)return $G({inputs:{x:t},backend:e});if("prelu"===n)return YG({inputs:{x:t,alpha:a},backend:e});if("leakyrelu"===n)return qG({inputs:{x:t},backend:e,attrs:{alpha:r}});if("sigmoid"===n)return dG({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function nq(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{shape:s}=a,i=gb.sizeFromShape(r.shape),o=gb.inferFromImplicitShape(s,i),l=gb.sizeFromShape(o);gb.assert(i===l,()=>"The new shape (".concat(o,") has ").concat(l," elements and the old shape (").concat(r.shape,") has ").concat(i," elements. The new shape and old shape must have the same number of elements.")),n.incRef(r.dataId);let c=n.data.get(r.dataId);if(null!=c.complexTensorInfos){let e=c.complexTensorInfos.real,t=c.complexTensorInfos.imag;e.shape=o,t.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}var aq={kernelName:ny,backendName:"cpu",kernelFunc:nq};function rq(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:s}=t,{transposeA:i,transposeB:o}=a;hU([r,s],"matMul");let l=r.shape.length,c=s.shape.length,u=i?r.shape[l-2]:r.shape[l-1],d=o?s.shape[c-1]:s.shape[c-2],p=i?r.shape[l-1]:r.shape[l-2],h=o?s.shape[c-2]:s.shape[c-1],f=r.shape.slice(0,-2),m=s.shape.slice(0,-2),g=gb.sizeFromShape(f),y=gb.sizeFromShape(m),b=_k.assertAndGetBroadcastShape(r.shape.slice(0,-2),s.shape.slice(0,-2)).concat([p,h]);gb.assert(u===d,()=>"Error in matMul: inner shapes (".concat(u,") and (").concat(d,") of Tensors with shapes ").concat(r.shape," and ").concat(s.shape," and transposeA=").concat(i," and transposeB=").concat(o," must match."));let v=o?[y,h,d]:[y,d,h],x=nq({inputs:{x:r},backend:n,attrs:{shape:i?[g,u,p]:[g,p,u]}}),w=nq({inputs:{x:s},backend:n,attrs:{shape:v}}),k=i?x.shape[1]:x.shape[2],S=i?x.shape[2]:x.shape[1],N=o?w.shape[1]:w.shape[2],I=Math.max(g,y),C=n.data.get(x.dataId).values,T=n.data.get(w.dataId).values,E=gb.computeStrides(x.shape),_=gb.computeStrides(w.shape),[A,R,F]=i?[E[0],1,E[1]]:[E[0],E[1],1],[D,M,O]=o?[1,_[1],_[0]]:[_[1],1,_[0]],P=S*N,L=sw([I,S,N],x.dtype),z=L.values,j=n.blockSize;for(let B=0;B<I;B++){let e=B%g,t=B%y;for(let n=0;n<S;n+=j){let a=Math.min(n+j,S);for(let r=0;r<N;r+=j){let s=Math.min(r+j,N);for(let i=0;i<k;i+=j){let o=Math.min(i+j,k);for(let l=n;l<a;l++)for(let n=r;n<s;n++){let a=0;for(let r=i;r<o;r++){a+=C[e*A+l*R+r*F]*T[r*D+n*M+t*O]}z[B*P+(l*N+n)]+=a}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(b,L.dtype,L.values)}var sq={kernelName:am,backendName:"cpu",kernelFunc:rq};var iq={kernelName:eb,backendName:"cpu",kernelFunc:function(e){let t,n,a,{inputs:r,backend:s,attrs:i}=e,{a:o,b:l,bias:c,preluActivationWeights:u}=r,{transposeA:d,transposeB:p,activation:h,leakyreluAlpha:f}=i,m=[];t=rq({inputs:{a:o,b:l},attrs:{transposeA:d,transposeB:p},backend:s}),c&&(n=MU({inputs:{a:t,b:c},backend:s}),m.push(t),t=n),h&&(a=tq(s,t,h,u,f),m.push(t),t=a);for(let g of m)s.disposeIntermediateTensorInfo(g);return t}},oq=VU(Bf,e=>Math.acos(e)),lq={kernelName:Bf,backendName:"cpu",kernelFunc:oq},cq=VU(Wf,e=>Math.acosh(e)),uq={kernelName:Wf,backendName:"cpu",kernelFunc:cq};var dq={kernelName:Uf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,a=t;hU(t,"addN");let r=a.map(e=>n.data.get(e.dataId).values),s=sw(a[0].shape,a[0].dtype),i=s.values;for(let o=0;o<a.length;o++){let e=r[o];for(let t=0;t<i.length;t++)i[t]+=e[t]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}};var pq={kernelName:Hf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a;hU(r,"all");let o=gb.parseAxisParam(s,r.shape),l=o,c=WE.getAxesPermutation(l,r.shape.length),u=r;null!=c&&(u=HH({inputs:{x:r},backend:n,attrs:{perm:c}}),l=WE.getInnerMostAxes(l.length,r.shape.length)),WE.assertAxesAreInnerMostDims("all",l,u.shape.length);let[d,p]=WE.computeOutAndReduceShapes(u.shape,l),h=gb.sizeFromShape(p),f=gb.makeZerosTypedArray(gb.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let e=y*h,t=m[e];for(let n=0;n<h;++n){let a=m[e+n];t=t&&a}f[y]=t}null!=c&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(i){let e=nq({inputs:{x:g},backend:n,attrs:{shape:WE.expandShapeToKeepDim(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};var hq={kernelName:Gf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a;hU(r,"any");let o=gb.parseAxisParam(s,r.shape),l=o,c=WE.getAxesPermutation(l,r.shape.length),u=r;null!=c&&(u=HH({inputs:{x:r},backend:n,attrs:{perm:c}}),l=WE.getInnerMostAxes(l.length,r.shape.length)),WE.assertAxesAreInnerMostDims("any",l,u.shape.length);let[d,p]=WE.computeOutAndReduceShapes(u.shape,l),h=gb.sizeFromShape(p),f=gb.makeZerosTypedArray(gb.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let e=y*h,t=m[e];for(let n=0;n<h;++n){let a=m[e+n];t=t||a}f[y]=t}null!=c&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(i){let e=nq({inputs:{x:g},backend:n,attrs:{shape:WE.expandShapeToKeepDim(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};var fq={kernelName:qf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s}=a;hU(r,"argMax");let i=gb.parseAxisParam(s,r.shape),o=WE.getAxesPermutation(i,r.shape.length),l=r,c=[];null!=o&&(l=HH({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=WE.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],WE.assertAxesAreInnerMostDims("argMax",i,l.shape.length);let[u,d]=WE.computeOutAndReduceShapes(l.shape,i),p=gb.sizeFromShape(u),h=gb.makeZerosTypedArray(p,"int32"),f=gb.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let e=g*f,t=m[e],n=0;for(let a=0;a<f;++a){let r=m[e+a];r>t&&(t=r,n=a)}h[g]=n}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",h)}};var mq={kernelName:Kf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s}=a;hU(r,"argMin");let i=gb.parseAxisParam(s,r.shape),o=WE.getAxesPermutation(i,r.shape.length),l=r,c=[];null!=o&&(l=HH({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=WE.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],WE.assertAxesAreInnerMostDims("argMin",i,l.shape.length);let[u,d]=WE.computeOutAndReduceShapes(l.shape,i),p=gb.sizeFromShape(u),h=gb.makeZerosTypedArray(p,"int32"),f=gb.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let e=g*f,t=m[e],n=0;for(let a=0;a<f;++a){let r=m[e+a];r<t&&(t=r,n=a)}h[g]=n}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",h)}},gq=VU(Xf,e=>Math.asin(e)),yq={kernelName:Xf,backendName:"cpu",kernelFunc:gq},bq=VU(Yf,e=>Math.asinh(e)),vq={kernelName:Yf,backendName:"cpu",kernelFunc:bq},xq=VU(Qf,e=>Math.atan(e)),wq={kernelName:Qf,backendName:"cpu",kernelFunc:xq},kq=vU((e,t)=>Math.atan2(e,t)),Sq=AU(Zf,kq),Nq={kernelName:Zf,backendName:"cpu",kernelFunc:Sq},Iq=VU(Jf,e=>Math.atanh(e)),Cq={kernelName:Jf,backendName:"cpu",kernelFunc:Iq};function Tq(e,t,n,a,r,s){let i=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,h=r.padInfo.left,f="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=sw(r.outShape,n),g=m.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],b=r.outShape[2]*r.outShape[3],v=r.outShape[3];for(let x=0;x<r.batchSize;++x){let t=x*y,n=x*a[0];for(let m=0;m<r.inChannels;++m)for(let y=0;y<r.outHeight;++y){let x=y*i-p,w=Math.max(0,x),k=Math.min(r.inHeight,u+x),S=t+y*b;for(let t=0;t<r.outWidth;++t){let i=t*o-h,u=Math.max(0,i),p=Math.min(r.inWidth,d+i),y=f,b=0,x=0;for(let t=w;t<k;t+=l){let r=n+t*a[1];for(let t=u;t<p;t+=c){let n=e[r+t*a[2]+m];"max"===s&&n>y?y=n:"avg"===s&&(b+=n,x++)}if(isNaN(y))break}g[S+t*v+m]="avg"===s?b/x:y}}}return m}function Eq(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=sw(a.outShape,"int32"),o=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,u=a.dilationWidth,d=a.effectiveFilterHeight,p=a.effectiveFilterWidth,h=a.padInfo.top,f=a.padInfo.left,m=sw(t,n,e);for(let g=0;g<a.batchSize;++g)for(let e=0;e<a.inChannels;++e)for(let t=0;t<a.outHeight;++t){let n=t*o-h,y=n;for(;y<0;)y+=c;let b=Math.min(a.inHeight,d+n);for(let o=0;o<a.outWidth;++o){let d=o*l-f,h=d;for(;h<0;)h+=u;let v=Math.min(a.inWidth,p+d),x=Number.NEGATIVE_INFINITY,w=-1;for(let t=y;t<b;t+=c){let i=t-n;for(let n=h;n<v;n+=u){let o=n-d,l=m.get(g,t,n,e);l>x&&(x=l,w=r?s?((g*a.inHeight+t)*a.inWidth+n)*a.inChannels+e:(t*a.inWidth+n)*a.inChannels+e:i*p+o)}}i.set(w,g,t,o,e)}}return i}function _q(e,t,n,a,r,s){let i=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,p=r.effectiveFilterDepth,h=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,b="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=sw(r.outShape,n),x=v.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],N=r.outShape[4];for(let I=0;I<r.batchSize;++I){let t=I*w,n=I*a[0];for(let v=0;v<r.inChannels;++v)for(let w=0;w<r.outDepth;++w){let I=w*i-m,C=I;for(;C<0;)C+=c;let T=Math.min(r.inDepth,p+I),E=t+w*k;for(let t=0;t<r.outHeight;++t){let i=t*o-g,p=i;for(;p<0;)p+=u;let m=Math.min(r.inHeight,h+i),w=E+t*S;for(let t=0;t<r.outWidth;++t){let i=t*l-y,o=i;for(;o<0;)o+=d;let h=Math.min(r.inWidth,f+i),g=w+t*N,k=b,S=0,I=0;for(let t=C;t<T;t+=c){let r=n+t*a[1];for(let t=p;t<m;t+=u){let n=r+t*a[2];for(let t=o;t<h;t+=d){let r=e[n+t*a[3]+v];if("max"===s&&r>k?k=r:"avg"===s&&(S+=r,I++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}x[g+v]="avg"===s?S/Math.max(I,1):k}}}}return v}var Aq={kernelName:$f,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;hU(r,"avgPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=a;gb.assert(WE.eitherStridesOrDilationsAreOne(i,1),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(1,"'"));let c,u=WE.computePool2DInfo(r.shape,s,i,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&gb.arraysEqual(u.inShape,u.outShape))c=SU({inputs:{x:r},backend:n});else{let e=n.data.get(r.dataId).values,t=gb.computeStrides(r.shape),a=Tq(e,r.shape,r.dtype,t,u,"avg");c=n.makeTensorInfo(u.outShape,r.dtype,a.values)}return c}};var Rq={kernelName:tm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a;hU(r,"avgPool3d");let u=WE.computePool3DInfo(r.shape,s,i,1,o,l,c),d=_q(n.data.get(r.dataId).values,r.shape,r.dtype,gb.computeStrides(r.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};var Fq={kernelName:nm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=a;hU([r,s],"avgPool3DGrad");let u=WE.computePool3DInfo(s.shape,i,o,1,l,c),d=u.strideDepth,p=u.strideHeight,h=u.strideWidth,f=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,b=u.dilationHeight,v=u.dilationWidth,x=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,S=x-1-u.padInfo.front,N=k-1-u.padInfo.left,I=w-1-u.padInfo.top,C=sw(s.shape,"float32"),T=1/(f*m*g),E=n.bufferSync(r);for(let _=0;_<u.batchSize;++_)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let a=0;a<u.inWidth;++a){let r=t-S,s=n-I,i=a-N,o=0;for(let t=0;t<x;t+=y){let n=(r+t)/d;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=b){let a=(s+t)/p;if(!(a<0||a>=u.outHeight||Math.floor(a)!==a))for(let t=0;t<k;t+=v){let r=(i+t)/h;r<0||r>=u.outWidth||Math.floor(r)!==r||(o+=E.get(_,n,a,r,e))}}}C.set(o*T,_,t,n,a,e)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};var Dq={kernelName:em,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,i=s;hU([r,s],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=a,u=WE.computePool2DInfo(i.shape,o,l,1,c),d=u.strideHeight,p=u.strideWidth,h=u.filterHeight,f=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,b=u.effectiveFilterWidth,v=b-1-u.padInfo.left,x=y-1-u.padInfo.top,w=sw(i.shape,"float32"),k=1/(h*f),S=n.data.get(r.dataId).values,N=sw(r.shape,"float32",S);for(let I=0;I<u.batchSize;++I)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inHeight;++t)for(let n=0;n<u.inWidth;++n){let a=t-x,r=n-v,s=0;for(let t=0;t<y;t+=m){let n=(a+t)/d;if(!(n<0||n>=u.outHeight||Math.floor(n)!==n))for(let t=0;t<b;t+=g){let a=(r+t)/p;a<0||a>=u.outWidth||Math.floor(a)!==a||(s+=N.get(I,n,a,e))}}w.set(s*k,I,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var Mq={kernelName:Qm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,scale:s,offset:i,mean:o,variance:l}=t;gb.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),gb.assert(null==i||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),gb.assert(null==s||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),hU([r,o,l,s,i],"batchNorm");let{varianceEpsilon:c}=a;null==c&&(c=.001);let u=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,h=s?n.data.get(s.dataId).values:new Float32Array([1]),f=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=f.length,y=h.length,b=p.length,v=d.length,x=0,w=0,k=0,S=0;for(let N=0;N<u.length;++N)m[N]=f[x++]+(u[N]-d[w++])*h[k++]/Math.sqrt(p[S++]+c),x>=g&&(x=0),w>=v&&(w=0),k>=y&&(k=0),S>=b&&(S=0);return n.makeTensorInfo(r.shape,r.dtype,m)}};var Oq={kernelName:rm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:s,crops:i}=a;hU([r],"batchToSpaceND");let o=s.reduce((e,t)=>e*t),l=WE.getReshaped(r.shape,s,o),c=WE.getPermuted(l.length,s.length),u=WE.getReshapedPermuted(r.shape,s,o),d=WE.getSliceBeginCoords(i,s.length),p=WE.getSliceSize(u,i,s.length),h=nq({inputs:{x:r},backend:n,attrs:{shape:l}}),f=HH({inputs:{x:h},backend:n,attrs:{perm:c}}),m=nq({inputs:{x:f},backend:n,attrs:{shape:u}}),g=fG({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};var Pq={kernelName:sm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:s}=t,{size:i}=a,o=PU(n.data.get(r.dataId).values,n.data.get(s.dataId).values,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,o)}};var Lq={kernelName:lm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,s=n.data.get(a.dataId).values,i=n.data.get(r.dataId).values,o=WE.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},zq=VU(dm,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),jq={kernelName:dm,backendName:"cpu",kernelFunc:zq},Bq={kernelName:hm,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend,a=new Float32Array(gb.sizeFromShape(t.shape)),r=n.data.get(t.dataId),s=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,o=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<o.length;c++){let e=o[c],t=l[c];a[c]=Math.hypot(e,t)}return n.makeOutput(a,t.shape,"float32")}};function Wq(e){let{inputs:t,backend:n}=e,{input:a}=t,r=n.data.get(a.dataId).complexTensorInfos.imag,s=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,s)}var Vq={kernelName:ag,backendName:"cpu",kernelFunc:Wq};function Uq(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a,s=gb.parseAxisParam(r,t[0].shape)[0],i=t.map(e=>e.shape);WE.assertParamsConsistent(i,s);let o=WE.computeOutShape(t.map(e=>e.shape),s);if(0===gb.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>gb.sizeFromShape(e.shape)>0);if(1===l.length)return SU({inputs:{x:l[0]},backend:n});if("complex64"===l[0].dtype){let e=l.map(e=>IU({inputs:{input:e},backend:n})),t=l.map(e=>Wq({inputs:{input:e},backend:n})),a=Uq({inputs:e,backend:n,attrs:{axis:s}}),r=Uq({inputs:t,backend:n,attrs:{axis:s}}),i=xU({inputs:{real:a,imag:r},backend:n});return e.forEach(e=>n.disposeIntermediateTensorInfo(e)),t.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),i}let c=l.map(e=>{let t=[-1,gb.sizeFromShape(e.shape.slice(s))];return nq({inputs:{x:e},backend:n,attrs:{shape:t}})}),u=c.map(e=>({vals:n.data.get(e.dataId).values,shape:e.shape}));o=WE.computeOutShape(c.map(e=>e.shape),1);let d=1===c[0].shape[0],p=KU(u,o,t[0].dtype,d),h=WE.computeOutShape(l.map(e=>e.shape),s),f=n.makeTensorInfo(h,t[0].dtype,p);return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}var Hq={kernelName:fm,backendName:"cpu",kernelFunc:Uq};function Gq(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=a;hU([r,s],"conv2d");let d=WE.convertConv2DDataFormat(l),p=WE.computeConv2DInfo(r.shape,s.shape,i,c,o,u,!1,d),h=p.filterHeight,f=p.filterWidth,m=p.dilationHeight,g=p.dilationWidth,y=p.padInfo.left,b=p.padInfo.top,v="channelsLast"===p.dataFormat,x=new Xb(p.outShape,r.dtype),w=gb.computeStrides(r.shape),k=gb.computeStrides(s.shape),S=w[0],N=v?w[1]:w[2],I=v?w[2]:1,C=v?1:w[1],T=x.strides[0],E=v?x.strides[1]:x.strides[2],_=v?x.strides[2]:1,A=v?1:x.strides[1],R=n.data.get(r.dataId).values,F=n.data.get(s.dataId).values,D=x.values;for(let M=0;M<p.batchSize;++M){let e=M*S,t=M*T;for(let n=0;n<p.outHeight;++n){let a=t+n*E,r=n*p.strideHeight-b;for(let t=0;t<h;++t){let n=r+t*m;if(n<0||n>=p.inHeight)continue;let s=t*k[0],i=e+n*N;for(let e=0;e<p.outWidth;++e){let t=a+e*_,n=e*p.strideWidth-y;for(let e=0;e<f;++e){let a=n+e*g;if(a<0||a>=p.inWidth)continue;let r=i+a*I,o=s+e*k[1];for(let e=0;e<p.inChannels;++e){let n=R[r+e*C];for(let e=0;e<p.outChannels;++e)D[t+e*A]+=n*F[o+e];o+=p.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,D)}var qq={kernelName:mm,backendName:"cpu",kernelFunc:Gq};var Kq={kernelName:gm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:s}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=a;hU([r,s],"conv2dBackpropFilter");let d=WE.convertConv2DDataFormat(l),p=WE.computeConv2DInfo(r.shape,u,i,1,o,c,!1,d),{strideHeight:h,strideWidth:f,filterHeight:m,filterWidth:g}=p,y="channelsLast"===p.dataFormat,b=new Xb(p.filterShape,"float32"),v=p.padInfo.left,x=p.padInfo.top,w=n.data.get(r.dataId).values,k=n.data.get(s.dataId).values,S=new Xb(r.shape,r.dtype,w),N=new Xb(s.shape,s.dtype,k);for(let I=0;I<m;++I){let e=Math.max(0,Math.ceil((x-I)/h)),t=Math.min(p.outHeight,(p.inHeight+x-I)/h);for(let n=0;n<g;++n){let a=Math.max(0,Math.ceil((v-n)/f)),r=Math.min(p.outWidth,(p.inWidth+v-n)/f);for(let s=0;s<p.inChannels;++s)for(let i=0;i<p.outChannels;++i){let o=0;for(let l=0;l<p.batchSize;++l)for(let c=e;c<t;++c){let e=I+c*h-x;for(let t=a;t<r;++t){let a=n+t*f-v;o+=y?S.get(l,e,a,s)*N.get(l,c,t,i):S.get(l,s,e,a)*N.get(l,i,c,t)}}b.set(o,I,n,s,i)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var Xq={kernelName:ym,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:s}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=a;hU([r,s],"conv2dBackpropInput");let d=gb.computeStrides(s.shape),p=gb.computeStrides(r.shape),h=WE.convertConv2DDataFormat(c),f=WE.computeConv2DInfo(i,s.shape,o,1,l,u,!1,h),m=new Xb(f.inShape,"float32"),g=m.values,y=n.data.get(r.dataId).values,b=n.data.get(s.dataId).values,[v,x,w]=d,{batchSize:k,filterHeight:S,filterWidth:N,inChannels:I,inHeight:C,inWidth:T,outChannels:E,outHeight:_,outWidth:A,strideHeight:R,strideWidth:F}=f;h=f.dataFormat;let D=S-1-f.padInfo.top,M=N-1-f.padInfo.left,O="channelsLast"===h,P=m.strides[0],L=O?m.strides[1]:m.strides[2],z=O?m.strides[2]:1,j=O?1:m.strides[1],B=p[0],W=O?p[1]:p[2],V=O?p[2]:1,U=O?1:p[1];for(let H=0;H<k;++H)for(let e=0;e<I;++e)for(let t=0;t<C;++t){let n=t-D,a=Math.max(0,Math.ceil(n/R)),r=Math.min(_,(S+n)/R);for(let s=0;s<T;++s){let i=s-M,o=Math.max(0,Math.ceil(i/F)),l=Math.min(A,(N+i)/F),c=0;for(let t=a;t<r;++t){let a=t*R-n;for(let n=o;n<l;++n){let r=B*H+W*t+V*n,s=v*(S-1-a)+x*(N-1-(n*F-i))+w*e;for(let e=0;e<E;++e){c+=y[r+U*e]*b[s+e]}}}g[P*H+L*t+z*s+j*e]=c}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};var Yq={kernelName:bm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dilations:l}=a;hU([r,s],"conv3d");let c=WE.computeConv3DInfo(r.shape,s.shape,i,l,o),{filterDepth:u,filterHeight:d,filterWidth:p,dilationDepth:h,dilationHeight:f,dilationWidth:m,padInfo:g}=c,y=g.front,b=g.left,v=g.top,x=new Xb(c.outShape,r.dtype),w=n.data.get(r.dataId).values,k=n.data.get(s.dataId).values,S=x.values,N=gb.computeStrides(r.shape),I=gb.computeStrides(s.shape);for(let C=0;C<c.batchSize;++C){let e=C*N[0],t=C*x.strides[0];for(let n=0;n<c.outDepth;++n){let a=t+n*x.strides[1],r=n*c.strideDepth-y;for(let t=0;t<u;++t){let n=r+t*h;if(n<0||n>=c.inDepth)continue;let s=t*I[0],i=e+n*N[1];for(let e=0;e<c.outHeight;++e){let t=a+e*x.strides[2],n=e*c.strideHeight-v;for(let e=0;e<d;++e){let a=n+e*f;if(a<0||a>=c.inHeight)continue;let r=s+e*I[1],o=i+a*N[2];for(let e=0;e<c.outWidth;++e){let n=t+e*c.outChannels,a=e*c.strideWidth-b;for(let e=0;e<p;++e){let t=a+e*m;if(t<0||t>=c.inWidth)continue;let s=r+e*I[2],i=o+t*c.inChannels,l=s;for(let e=0;e<c.inChannels;++e){let t=w[i+e];for(let e=0;e<c.outChannels;++e)S[n+e]+=t*k[l+e];l+=c.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var Qq={kernelName:vm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:s}=t,{strides:i,pad:o,filterShape:l}=a;hU([r,s],"conv3dBackpropFilterV2");let c=gb.computeStrides(r.shape),u=gb.computeStrides(s.shape),d=WE.computeConv3DInfo(r.shape,l,i,1,o),p=d.strideDepth,h=d.strideHeight,f=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,b=new Xb(d.filterShape,"float32"),v=b.values,[x,w,k,S]=b.strides,N=n.data.get(s.dataId).values,[I,C,T,E]=u,_=n.data.get(r.dataId).values,[A,R,F,D]=c,M=d.padInfo.front,O=d.padInfo.left,P=d.padInfo.top;for(let L=0;L<m;++L){let e=Math.max(0,Math.ceil((M-L)/p)),t=Math.min(d.outDepth,(d.inDepth+M-L)/p),n=L*x;for(let a=0;a<g;++a){let r=Math.max(0,Math.ceil((P-a)/h)),s=Math.min(d.outHeight,(d.inHeight+P-a)/h),i=a*w+n;for(let n=0;n<y;++n){let o=Math.max(0,Math.ceil((O-n)/f)),l=Math.min(d.outWidth,(d.inWidth+O-n)/f),c=n*k+i;for(let i=0;i<d.inChannels;++i){let u=i*S+c;for(let c=0;c<d.outChannels;++c){let m=0;for(let u=0;u<d.batchSize;++u){let d=u*A,g=u*I;for(let u=e;u<t;++u){let e=(L+u*p-M)*R+d,t=u*C+g;for(let u=r;u<s;++u){let r=(a+u*h-P)*F+e,s=u*T+t;for(let e=o;e<l;++e){let t=e*E+s;m+=_[(n+e*f-O)*D+r+i]*N[t+c]}}}}v[u+c]=m}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var Jq={kernelName:xm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:s}=t,{pad:i,strides:o,inputShape:l}=a;hU([r],"conv3dBackpropInputV2");let c=gb.computeStrides(r.shape),u=gb.computeStrides(s.shape),d=WE.computeConv3DInfo(l,s.shape,o,1,i),p=new Xb(d.inShape,"float32"),h=p.values,[f,m,g,y]=p.strides,b=n.data.get(r.dataId).values,[v,x,w,k]=c,S=n.data.get(s.dataId).values,[N,I,C,T]=u,{batchSize:E,filterDepth:_,filterHeight:A,filterWidth:R,inChannels:F,inDepth:D,inHeight:M,inWidth:O,outChannels:P,outDepth:L,outHeight:z,outWidth:j,strideDepth:B,strideHeight:W,strideWidth:V}=d,U=_-1-d.padInfo.front,H=A-1-d.padInfo.top,G=R-1-d.padInfo.left;for(let q=0;q<E;++q)for(let e=0;e<F;++e)for(let t=0;t<D;++t){let n=t-U,a=Math.max(0,Math.ceil(n/B)),r=Math.min(L,(_+n)/B);for(let s=0;s<M;++s){let i=s-H,o=Math.max(0,Math.ceil(i/W)),l=Math.min(z,(A+i)/W);for(let c=0;c<O;++c){let u=c-G,d=Math.max(0,Math.ceil(u/V)),p=Math.min(j,(R+u)/V),E=0;for(let t=a;t<r;++t){let a=t*B-n;for(let n=o;n<l;++n){let r=n*W-i;for(let s=d;s<p;++s){let i=v*q+x*t+w*n+k*s,o=N*(_-1-a)+I*(A-1-r)+C*(R-1-(s*V-u))+T*e;for(let e=0;e<P;++e){E+=b[i+e]*S[o+e]}}}}h[f*q+m*t+g*s+y*c+e]=E}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}},Zq=VU(wm,e=>Math.cos(e)),$q={kernelName:wm,backendName:"cpu",kernelFunc:Zq},eK=VU(km,e=>Math.cosh(e)),tK={kernelName:km,backendName:"cpu",kernelFunc:eK};var nK={kernelName:Im,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r,boxes:s,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=a,[u,d,p,h]=r.shape,f=s.shape[0],[m,g]=o,y=sw([f,m,g,h],"float32"),b=n.data.get(s.dataId).values,v=n.data.get(i.dataId).values,x=n.data.get(r.dataId).values,w=gb.computeStrides(r.shape),k=gb.computeStrides(y.shape);for(let S=0;S<f;S++){let e=4*S,t=b[e],n=b[e+1],a=b[e+2],r=b[e+3],s=v[S];if(s>=u)continue;let i=m>1?(a-t)*(d-1)/(m-1):0,o=g>1?(r-n)*(p-1)/(g-1):0;for(let u=0;u<m;u++){let e=m>1?t*(d-1)+u*i:.5*(t+a)*(d-1);if(e<0||e>d-1)for(let t=0;t<g;t++)for(let e=0;e<h;e++){let n=e+t*k[2]+u*k[1]+S*k[0];y.values[n]=c}else if("bilinear"===l){let t=Math.floor(e),a=Math.ceil(e),i=e-t;for(let e=0;e<g;e++){let l=g>1?n*(p-1)+e*o:.5*(n+r)*(p-1);if(l<0||l>p-1){for(let t=0;t<h;t++){let n=t+e*k[2]+u*k[1]+S*k[0];y.values[n]=c}continue}let d=Math.floor(l),f=Math.ceil(l),m=l-d;for(let n=0;n<h;n++){let r=n+d*w[2]+t*w[1]+s*w[0],o=x[r];r=n+f*w[2]+t*w[1]+s*w[0];let l=x[r];r=n+d*w[2]+a*w[1]+s*w[0];let c=x[r];r=n+f*w[2]+a*w[1]+s*w[0];let p=o+(l-o)*m,h=c+(x[r]-c)*m;r=n+e*k[2]+u*k[1]+S*k[0],y.values[r]=p+(h-p)*i}}}else for(let t=0;t<g;++t){let a=g>1?n*(p-1)+t*o:.5*(n+r)*(p-1);if(a<0||a>p-1){for(let e=0;e<h;e++){let n=e+t*k[2]+u*k[1]+S*k[0];y.values[n]=c}continue}let i=Math.round(a),l=Math.round(e);for(let e=0;e<h;e++){let n=e+i*w[2]+l*w[1]+s*w[0],a=e+t*k[2]+u*k[1]+S*k[0];y.values[a]=x[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var aK={kernelName:Sm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,exclusive:i,reverse:o}=a;hU(r,"cumprod");let l=WE.getAxesPermutation([s],r.shape.length),c=r;null!=l&&(c=HH({inputs:{x:r},backend:n,attrs:{perm:l}}));let u=WE.getInnerMostAxes(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most axis=".concat(c.shape.length-1," but got axis=").concat(u));let d=lv(c.dtype,"int32"),p=gb.makeOnesTypedArray(gb.sizeFromShape(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<h.length;y+=f)for(let e=0;e<f;e++){let t=m(y,e);if(0===e)p[t]=i?1:h[t];else{let n=m(y,e-1);p[t]=i?h[n]*p[n]:h[t]*p[n]}}let g=n.makeTensorInfo(c.shape,d,p);if(null!=l){let e=HH({inputs:{x:g},backend:n,attrs:{perm:WE.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}};var rK={kernelName:Nm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,exclusive:i,reverse:o}=a;hU(r,"cumsum");let l=WE.getAxesPermutation([s],r.shape.length),c=r;null!=l&&(c=HH({inputs:{x:r},backend:n,attrs:{perm:l}}));let u=WE.getInnerMostAxes(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most axis=".concat(c.shape.length-1," but got axis=").concat(u));let d=lv(c.dtype,"int32"),p=gb.makeZerosTypedArray(gb.sizeFromShape(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<h.length;y+=f)for(let e=0;e<f;e++){let t=m(y,e);if(0===e)p[t]=i?0:h[t];else{let n=m(y,e-1);p[t]=i?h[n]+p[n]:h[t]+p[n]}}let g=n.makeTensorInfo(c.shape,d,p);if(null!=l){let e=HH({inputs:{x:g},backend:n,attrs:{perm:WE.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}};var sK={kernelName:Cm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:s}=t,{size:i,binaryOutput:o}=a;if(1===r.shape.length){let e=PU(n.data.get(r.dataId).values,n.data.get(s.dataId).values,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,e)}if(2===r.shape.length){let e=LU(n.bufferSync(r),n.bufferSync(s),i,o);return n.makeTensorInfo(e.shape,s.dtype,e.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank".concat(r.shape.length,"."))}};var iK={kernelName:Tm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockSize:s,dataFormat:i}=a;gb.assert("NHWC"===i,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(i));let o=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*s,p=c*s,h=u/(s*s),f=n.data.get(r.dataId).values,m=new Float32Array(o*d*p*h),g=0;for(let y=0;y<o;++y)for(let e=0;e<d;++e){let t=Math.floor(e/s),n=e%s;for(let e=0;e<p;++e){let a=Math.floor(e/s),r=(n*s+e%s)*h;for(let e=0;e<h;++e){let n=e+r+u*(a+c*(t+l*y));m[g++]=f[n]}}}return n.makeTensorInfo([o,d,p,h],r.dtype,m)}};function oK(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=a;hU([r,s],"depthwiseConv2DNative");let u=gb.computeStrides(r.shape),d=gb.computeStrides(s.shape),p=l;null==p&&(p=[1,1]),gb.assert(WE.eitherStridesOrDilationsAreOne(i,p),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(p,"'"));let h=WE.computeConv2DInfo(r.shape,s.shape,i,p,o,c,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=h,v=b.left,x=b.top,w=h.outChannels/h.inChannels,k=new Xb(h.outShape,r.dtype),S=n.data.get(r.dataId).values,N=n.data.get(s.dataId).values,I=k.values;for(let C=0;C<h.batchSize;++C){let e=C*u[0],t=C*k.strides[0];for(let n=0;n<h.outHeight;++n){let a=t+n*k.strides[1],r=n*h.strideHeight-x;for(let t=0;t<f;++t){let n=r+t*g;if(n<0||n>=h.inHeight)continue;let s=t*d[0],i=e+n*u[1];for(let e=0;e<h.outWidth;++e){let t=a+e*k.strides[2],n=e*h.strideWidth-v;for(let e=0;e<m;++e){let a=n+e*y;if(a<0||a>=h.inWidth)continue;let r=s+e*d[1],o=i+a*h.inChannels,l=t,c=r;for(let e=0;e<h.inChannels;++e){let t=S[o+e];for(let e=0;e<w;++e)I[l+e]+=t*N[c+e];l+=w,c+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}var lK={kernelName:Em,backendName:"cpu",kernelFunc:oK};var cK={kernelName:_m,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=a;hU([r,s],"depthwiseConv2dNativeBackpropFilter");let d=WE.computeConv2DInfo(r.shape,u,i,o,l,c,!0),{strideHeight:p,strideWidth:h,filterHeight:f,filterWidth:m}=d,g=new Xb(d.filterShape,"float32"),y=d.padInfo.left,b=d.padInfo.top,v=d.outChannels/d.inChannels,x=n.data.get(r.dataId).values,w=new Xb(r.shape,r.dtype,x),k=n.data.get(s.dataId).values,S=new Xb(s.shape,s.dtype,k);for(let N=0;N<f;++N){let e=Math.max(0,Math.ceil((b-N)/p)),t=Math.min(d.outHeight,(d.inHeight+b-N)/p);for(let n=0;n<m;++n){let a=Math.max(0,Math.ceil((y-n)/h)),r=Math.min(d.outWidth,(d.inWidth+y-n)/h);for(let s=0;s<d.outChannels;++s){let i=Math.trunc(s/v),o=s%v,l=0;for(let c=0;c<d.batchSize;++c)for(let o=e;o<t;++o){let e=N+o*p-b;for(let t=a;t<r;++t){let a=n+t*h-y;l+=w.get(c,e,a,i)*S.get(c,o,t,s)}}g.set(l,N,n,i,o)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};var uK={kernelName:Am,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=a;hU([r,s],"depthwiseConv2DNativeBackpropInput");let d=gb.computeStrides(r.shape),p=gb.computeStrides(s.shape),h=WE.computeConv2DInfo(u,s.shape,i,o,l,c,!0),f=new Xb(h.inShape,"float32"),m=f.values,[g,y,b]=f.strides,v=n.data.get(r.dataId).values,[x,w,k]=d,S=n.data.get(s.dataId).values,[N,I,C]=p,{batchSize:T,filterHeight:E,filterWidth:_,inChannels:A,inHeight:R,inWidth:F,outChannels:D,outHeight:M,outWidth:O,strideHeight:P,strideWidth:L}=h,z=E-1-h.padInfo.top,j=_-1-h.padInfo.left,B=D/A;for(let W=0;W<T;++W)for(let e=0;e<A;++e)for(let t=0;t<R;++t){let n=t-z,a=Math.max(0,Math.ceil(n/P)),r=Math.min(M,(E+n)/P);for(let s=0;s<F;++s){let i=s-j,o=Math.max(0,Math.ceil(i/L)),l=Math.min(O,(_+i)/L),c=0;for(let t=a;t<r;++t){let a=t*P-n;for(let n=o;n<l;++n){let r=x*W+w*t+k*n,s=N*(E-1-a)+I*(_-1-(n*L-i))+C*e;for(let t=0;t<B;++t){c+=v[r+(e*B+t)]*S[s+t]}}}m[g*W+y*t+b*s+e]=c}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};var dK={kernelName:Rm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=gb.sizeFromShape(a.shape),s=n.data.get(a.dataId).values,i=sw([r,r],a.dtype),o=i.values;for(let c=0;c<s.length;c++)o[c*r+c]=s[c];let l=[...a.shape,...a.shape];return n.makeTensorInfo(l,i.dtype,i.values)}},pK={kernelName:Fm,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dilations:l}=a,c=n,u=c.data.get(r.dataId).values,d=r.shape.length,p=c.data.get(s.dataId).values,h=s.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:y,outHeight:b,outWidth:v,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:S,filterWidth:N,dilationHeight:I,dilationWidth:C,outShape:T}=WE.computeDilation2DInfo(r.shape,s.shape,i,o,"NHWC",l),E=gb.sizeFromShape(T),_=T.length,A=gb.getArrayFromDType(r.dtype,E);for(let R=0;R<f;++R)for(let e=0;e<b;++e){let t=e*w-x.top;for(let n=0;n<v;++n){let a=n*k-x.left;for(let i=0;i<y;++i){let o=Number.MIN_SAFE_INTEGER;for(let e=0;e<S;++e){let n=t+e*I;if(n>=0&&n<m)for(let t=0;t<N;++t){let l=a+t*C;if(l>=0&&l<g){let a=gb.locToIndex([R,n,l,i],d,gb.computeStrides(r.shape)),c=gb.locToIndex([e,t,i],h,gb.computeStrides(s.shape)),f=u[a]+p[c];f>o&&(o=f)}}}A[gb.locToIndex([R,e,n,i],_,gb.computeStrides(T))]=o}}}return{dataId:c.write(gb.toTypedArray(A,r.dtype),T,r.dtype),shape:T,dtype:r.dtype}}},hK={kernelName:Mm,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s,dy:i}=t,{strides:o,pad:l,dilations:c}=a,u=n,d=gb.toNestedArray(r.shape,u.data.get(r.dataId).values),p=gb.toNestedArray(s.shape,u.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:N,dilationWidth:I,outShape:C}=WE.computeDilation2DInfo(r.shape,s.shape,o,l,"NHWC",c);gb.assert(i.rank===C.length,()=>"Error in ".concat(Mm,", dy must have the same rank as output ").concat(C.length,", but got ").concat(i.rank));let T=gb.toNestedArray(C,u.data.get(i.dataId).values),E=gb.makeZerosNestedTypedArray(s.shape,s.dtype);for(let _=0;_<h;++_)for(let e=0;e<y;++e){let t=e*x-v.top;for(let n=0;n<b;++n){let a=n*w-v.left;for(let r=0;r<g;++r){let s=Number.MIN_SAFE_INTEGER,i=0,o=0;for(let e=0;e<k;++e){let n=t+e*N;if(n>=0&&n<f)for(let t=0;t<S;++t){let l=a+t*I;if(l>=0&&l<m){let a=d[_][n][l][r]+p[e][t][r];a>s&&(s=a,i=e,o=t)}}}E[i][o][r]+=T[_][e][n][r]}}}return{dataId:u.write(gb.toTypedArray(E,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},fK={kernelName:Dm,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s,dy:i}=t,{strides:o,pad:l,dilations:c}=a,u=n,d=gb.toNestedArray(r.shape,u.data.get(r.dataId).values),p=gb.toNestedArray(s.shape,u.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:N,dilationWidth:I,outShape:C}=WE.computeDilation2DInfo(r.shape,s.shape,o,l,"NHWC",c);gb.assert(i.rank===C.length,()=>"Error in ".concat(Dm,", dy must have the same rank as output ").concat(C.length,", but got ").concat(i.rank));let T=gb.toNestedArray(C,u.data.get(i.dataId).values),E=gb.makeZerosNestedTypedArray(r.shape,r.dtype);for(let _=0;_<h;++_)for(let e=0;e<y;++e){let t=e*x-v.top;for(let n=0;n<b;++n){let a=n*w-v.left;for(let r=0;r<g;++r){let s=Number.MIN_SAFE_INTEGER,i=t<0?0:t,o=a<0?0:a;for(let e=0;e<k;++e){let n=t+e*N;if(n>=0&&n<f)for(let t=0;t<S;++t){let l=a+t*I;if(l>=0&&l<m){let a=d[_][n][l][r]+p[e][t][r];a>s&&(s=a,i=n,o=l)}}}E[_][i][o][r]+=T[_][e][n][r]}}}return{dataId:u.write(gb.toTypedArray(E,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};var mK={kernelName:Om,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r}=t,{canvas:s,options:i}=a,{contextOptions:o,imageOptions:l}=i||{},c=(null==l?void 0:l.alpha)||1,u=(null==o?void 0:o.contextType)||"2d";if("2d"!==u)throw new Error("Context type ".concat(o.contextType," is not supported by the CPU backend."));let d=s.getContext(u,(null==o?void 0:o.contextAttributes)||{});if(null==d)throw new Error("Could not get the context with ".concat(u," type."));let[p,h]=r.shape.slice(0,2),f=2===r.shape.length?1:r.shape[2],m=n.data.get(r.dataId).values,g="float32"===r.dtype?255:1,y=new Uint8ClampedArray(h*p*4);for(let v=0;v<p*h;++v){let e=[0,0,0,255*c];for(let n=0;n<f;n++){let t=m[v*f+n];if("float32"===r.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===r.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ".concat(t,"."));1===f?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}let t=4*v;y[t+0]=Math.round(e[0]),y[t+1]=Math.round(e[1]),y[t+2]=Math.round(e[2]),y[t+3]=Math.round(e[3])}s.width=h,s.height=p;let b=new ImageData(y,h,p);return d.putImageData(b,0,0),r}};function gK(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{axis:i,keepDims:o}=r;hU(s,"sum"),t="bool"===s.dtype?EU({inputs:{x:s},backend:a,attrs:{dtype:"int32"}}):SU({inputs:{x:s},backend:a});let l=t.shape.length,c=gb.parseAxisParam(i,t.shape),u=WE.getAxesPermutation(c,l),d=c,p=t;null!=u&&(p=HH({inputs:{x:t},backend:a,attrs:{perm:u}}),d=WE.getInnerMostAxes(d.length,l)),WE.assertAxesAreInnerMostDims("sum",d,p.shape.length);let[h,f]=WE.computeOutAndReduceShapes(p.shape,d),m=kU(a,h,WE.upcastType(p.dtype,"int32")),g=gb.sizeFromShape(f),y=a.data.get(m.dataId).values,b=a.data.get(p.dataId).values;for(let v=0;v<y.length;++v){let e=v*g,t=0;for(let n=0;n<g;++n)t+=b[e+n];y[v]=t}if(o){let e=m;m=nq({inputs:{x:m},backend:a,attrs:{shape:WE.expandShapeToKeepDim(m.shape,c)}}),a.disposeIntermediateTensorInfo(e)}return a.disposeIntermediateTensorInfo(t),null!=u&&a.disposeIntermediateTensorInfo(p),m}var yK={kernelName:Sy,backendName:"cpu",kernelFunc:gK};var bK={kernelName:Lm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{equation:r}=a,s=t,{allDims:i,summedDims:o,idDims:l}=WE.decodeEinsumEquation(r,s.length);WE.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=WE.getEinsumComputePath(o,l),d=u.length,p=null,h=i.length,f=[];for(let m=0;m<d;++m){for(let e of u[m]){let t,{permutationIndices:a,expandDims:r}=WE.getEinsumPermutation(h,l[e]);WE.isIdentityPermutation(a)?t=s[e]:(t=HH({inputs:{x:s[e]},backend:n,attrs:{perm:a}}),f.push(t));let i=t.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);gb.arraysEqual(t.shape,i)||(t=nq({inputs:{x:t},backend:n,attrs:{shape:i}}),f.push(t)),null===p?p=t:(p=PH({inputs:{a:t,b:p},backend:n}),f.push(p))}m<d-1&&(c[m]>=0&&(p=gK({inputs:{x:p},backend:n,attrs:{axis:c[m]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}};var vK={kernelName:jm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{dy:a,y:r}=t;hU([a,r],"eluGrad");let s=new Float32Array(gb.sizeFromShape(r.shape)),i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values;for(let l=0;l<i.length;++l){let e=i[l];s[l]=e>=0?o[l]:o[l]*(e+1)}return n.makeTensorInfo(r.shape,"float32",s)}},xK=WE.ERF_P,wK=WE.ERF_A1,kK=WE.ERF_A2,SK=WE.ERF_A3,NK=WE.ERF_A4,IK=WE.ERF_A5,CK=VU(Bm,e=>{let t=Math.sign(e),n=Math.abs(e),a=1/(1+xK*n);return t*(1-((((IK*a+NK)*a+SK)*a+kK)*a+wK)*a*Math.exp(-n*n))}),TK={kernelName:Bm,backendName:"cpu",kernelFunc:CK};function EK(e){let{inputs:t,backend:n,attrs:a}=e,{input:r}=t,{dim:s}=a,i=r.shape.length,o=r.shape.slice(),l=s;return s<0&&(gb.assert(-(i+1)<=s,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),l=i+s+1),o.splice(l,0,1),nq({inputs:{x:r},backend:n,attrs:{shape:o}})}var _K={kernelName:Um,backendName:"cpu",kernelFunc:EK},AK=vU((e,t)=>e/t),RK=AU(Pm,AK),FK={kernelName:Pm,backendName:"cpu",kernelFunc:RK};function DK(e,t,n){let a=e.shape,r=a[0],s=a[1],i=n.data.get(e.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[r,s],u=gb.sizeFromShape(c),d=gb.getTypedArrayFromDType("float32",u),p=gb.getTypedArrayFromDType("float32",u);for(let g=0;g<r;g++){let e=fG({inputs:{x:o},backend:n,attrs:{begin:[g,0],size:[1,s]}}),a=fG({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,s]}}),r=xU({inputs:{real:e,imag:a},backend:n}),{real:i,imag:c}=MK(r,t,n),u=WE.mergeRealAndImagArrays(i,c);for(let t=0;t<s;t++){let e=WE.getComplexWithIndex(u,t);d[g*s+t]=e.real,p[g*s+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r)}let h=n.makeTensorInfo(c,"float32",d),f=n.makeTensorInfo(c,"float32",p),m=xU({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}function MK(e,t,n){let a=gb.sizeFromShape(e.shape),r=n.data.get(e.dataId),s=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(function(e){return 0===(e&e-1)}(a)){let r=OK(s,i,a,t,n),o=[e.shape[0],e.shape[1]];if(t){let e=n.makeTensorInfo(o,"float32",r.real),t=n.makeTensorInfo(o,"float32",r.imag),s=n.makeTensorInfo([],"float32",gb.createScalarValue(a,"float32")),i=SU({inputs:{x:s},backend:n}),l=FK.kernelFunc({inputs:{a:e,b:s},backend:n}),c=FK.kernelFunc({inputs:{a:t,b:i},backend:n}),u=n.data.get(l.dataId).values,d=n.data.get(c.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),{real:u,imag:d}}return r}{let e=function(e,t,n){let a=new Float32Array(2*t);for(let r=0;r<t;r++){let s=0,i=0;for(let a=0;a<t;a++){let o=WE.exponent(r*a,t,n),l=WE.getComplexWithIndex(e,a);s+=l.real*o.real-l.imag*o.imag,i+=l.real*o.imag+l.imag*o.real}n&&(s/=t,i/=t),WE.assignToTypedArray(a,s,i,r)}return a}(WE.mergeRealAndImagArrays(s,i),a,t);return WE.splitRealAndImagArrays(e)}}function OK(e,t,n,a,r){if(1===n)return{real:e,imag:t};let s=WE.mergeRealAndImagArrays(e,t),i=n/2,o=WE.complexWithEvenIndex(s),l=o.real,c=o.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),p=r.makeTensorInfo(u,"float32",c),h=xU({inputs:{real:d,imag:p},backend:r}),f=WE.complexWithOddIndex(s),m=f.real,g=f.imag,y=[m.length],b=r.makeTensorInfo(y,"float32",m),v=r.makeTensorInfo(y,"float32",g),x=xU({inputs:{real:b,imag:v},backend:r}),w=OK(l,c,i,a,r),k=w.real,S=w.imag,N=[k.length],I=r.makeTensorInfo(N,"float32",k),C=r.makeTensorInfo(N,"float32",S),T=xU({inputs:{real:I,imag:C},backend:r}),E=OK(m,g,i,a,r),_=E.real,A=E.imag,R=[_.length],F=r.makeTensorInfo(R,"float32",_),D=r.makeTensorInfo(R,"float32",A),M=xU({inputs:{real:F,imag:D},backend:r}),O=WE.exponents(n,a),P=[O.real.length],L=r.makeTensorInfo(P,"float32",O.real),z=r.makeTensorInfo(P,"float32",O.imag),j=xU({inputs:{real:L,imag:z},backend:r}),B=PH({inputs:{a:j,b:M},backend:r}),W=MU({inputs:{a:T,b:B},backend:r}),V=PG({inputs:{a:T,b:B},backend:r}),U=IU({inputs:{input:W},backend:r}),H=IU({inputs:{input:V},backend:r}),G=Wq({inputs:{input:W},backend:r}),q=Wq({inputs:{input:V},backend:r}),K=Uq({inputs:[U,H],backend:r,attrs:{axis:0}}),X=Uq({inputs:[G,q],backend:r,attrs:{axis:0}}),Y=r.data.get(K.dataId).values,Q=r.data.get(X.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(F),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(j),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(V),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(H),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(K),r.disposeIntermediateTensorInfo(X),{real:Y,imag:Q}}var PK={kernelName:Gm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t,r=gb.sizeFromShape(a.shape),s=a.shape[a.shape.length-1],i=nq({inputs:{x:a},backend:n,attrs:{shape:[r/s,s]}}),o=DK(i,!1,n),l=nq({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}};function LK(e){let{backend:t,attrs:n}=e,{shape:a,value:r,dtype:s}=n,i=s||gb.inferDtype(r),o=gb.getArrayFromDType(i,gb.sizeFromShape(a));return function(e,t){e.fill(t)}(o,r),t.makeTensorInfo(a,i,o)}var zK={kernelName:qm,backendName:"cpu",kernelFunc:LK};var jK={kernelName:Km,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,s=a,i=gb.getTypedArrayFromDType(r.dtype,gb.sizeFromShape(r.shape)),[o,l,c,u]=r.shape,d=s.data.get(r.dataId).values;for(let p=0;p<o;p++){let e=p*c*l*u;for(let t=0;t<l;t++){let n=t*(c*u);for(let t=0;t<c;t++){let a=t*u;for(let r=0;r<u;r++){let s=Math.round(c-t-1),o=e+n+a+r,l=d[o];if(s>=0&&s<c){l=d[e+n+s*u+r]}i[o]=l}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};var BK={kernelName:tb,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=a,m=Gq({inputs:{x:r,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(i){let e=m;if("NCHW"===u&&1===i.shape.length&&1!==i.shape[0]){let e=nq({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=MU({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=MU({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(e)}if(h){let e=m;if("NCHW"===u&&"prelu"===h&&1===o.shape.length&&1!==o.shape[0]){let e=nq({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=tq(n,m,h,e,f),n.disposeIntermediateTensorInfo(e)}else m=tq(n,m,h,o,f);n.disposeIntermediateTensorInfo(e)}return m}};var WK={kernelName:nb,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=a,m=oK({inputs:{x:r,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(i){let e=m;m=MU({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(e)}if(h){let e=m;m=tq(n,m,h,o,f),n.disposeIntermediateTensorInfo(e)}return m}};var VK={kernelName:Zm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:a,indices:r}=t,s=gb.sizeFromShape(a.shape),i=r.shape,o=i[i.length-1],[l,c,u,d]=WE.prepareAndValidate(a,r);if(0===c)return n.makeTensorInfo(l,a.dtype,[]);let p=cH(n.data.get(r.dataId).values,n.bufferSync(a),a.dtype,c,o,u,d,a.shape,s);return n.makeTensorInfo(l,a.dtype,p.values)}};var UK={kernelName:Jm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,indices:s}=t,{axis:i,batchDims:o}=a;hU([r,s],"gatherV2");let l=gb.parseAxisParam(i,r.shape)[0],c=n.data.get(s.dataId).values,u=r.shape[l];for(let v=0;v<c.length;++v){let e=c[v];gb.assert(e<=u-1&&e>=0,()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(u-1,"]"))}let d=o;null==o&&(d=0);let p=gb.sizeFromShape(s.shape),h=WE.segment_util.collectGatherOpShapeInfo(r,s,l,d),f=nq({inputs:{x:r},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=nq({inputs:{x:s},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}}),g=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize],y=n.bufferSync(m),b=uH(n.bufferSync(f),y,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(h.outputShape,b.dtype,b.values)}};var HK={kernelName:ng,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t,r=gb.sizeFromShape(a.shape),s=a.shape[a.shape.length-1],i=nq({inputs:{x:a},backend:n,attrs:{shape:[r/s,s]}}),o=DK(i,!0,n),l=nq({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}},GK=VU(rg,e=>Number.isFinite(e)?1:0,"bool"),qK={kernelName:rg,backendName:"cpu",kernelFunc:GK},KK=VU(sg,e=>Math.abs(e)===1/0?1:0,"bool"),XK={kernelName:sg,backendName:"cpu",kernelFunc:KK},YK=VU(ig,e=>Number.isNaN(e)?1:0,"bool"),QK={kernelName:ig,backendName:"cpu",kernelFunc:YK};var JK={kernelName:ug,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,num:s}=n,i=SH(a,r,s);return t.makeTensorInfo([i.length],"float32",i)}},ZK=VU(pg,e=>Math.log1p(e)),$K={kernelName:pg,backendName:"cpu",kernelFunc:ZK},eX=vU((e,t)=>e&&t),tX=AU(hg,eX,null,"bool"),nX={kernelName:hg,backendName:"cpu",kernelFunc:tX},aX=VU(fg,e=>e?0:1,"bool"),rX={kernelName:fg,backendName:"cpu",kernelFunc:aX},sX=vU((e,t)=>e||t),iX=AU(mg,sX,null,"bool"),oX={kernelName:mg,backendName:"cpu",kernelFunc:iX};var lX={kernelName:vg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:s,bias:i,alpha:o,beta:l}=a;hU(r,"LRN");let c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,p=gb.sizeFromShape(r.shape),h=new Float32Array(p);function f(e){let t=e%c,n=e-t+Math.max(0,t-s),a=e-t+Math.min(t+s,u),r=0;for(;n<=a;n++){let e=d[n];r+=e*e}return r}for(let m=0;m<p;m++){let e=f(m),t=d[m]*Math.pow(i+o*e,-l);h[m]=t}return n.makeTensorInfo(r.shape,r.dtype,h)}};var cX={kernelName:xg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,y:s,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=a;hU(i,"LRNGrad");let d=gb.sizeFromShape(i.shape),p=i.shape[3],h=n.data.get(i.dataId).values,f=n.data.get(r.dataId).values,m=n.data.get(s.dataId).values,g=new Float32Array(d),y=d;for(let b=0;b<y;b++){let e=b%p,t=b-e+Math.max(0,e-o),n=b-e+Math.min(p,e+o+1),a=0;for(let r=t;r<n;r++)a+=Math.pow(f[r],2);a=c*a+l;for(let r=t;r<n;r++){let e=-2*c*u*f[r]*m[b]/a;b===r&&(e+=Math.pow(a,-u)),e*=h[b],g[r]+=e}}return n.makeTensorInfo(i.shape,r.dtype,g)}};function uX(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reductionIndices:s,keepDims:i}=a,o=n,l=r.shape,c=l.length,u=gb.parseAxisParam(s,l),d=u,p=WE.getAxesPermutation(d,c),h=o.data.get(r.dataId).values;if(null!=p){let e=new Array(c);for(let t=0;t<e.length;t++)e[t]=l[p[t]];h=UH(h,l,r.dtype,p,e),d=WE.getInnerMostAxes(d.length,c),l=e}hU(r,"max"),WE.assertAxesAreInnerMostDims("max",d,c);let[f,m]=WE.computeOutAndReduceShapes(l,d),g=TH(h,gb.sizeFromShape(m),f,r.dtype),y=o.write(g,f,r.dtype),b=f;return i&&(b=WE.expandShapeToKeepDim(f,u)),{dataId:y,shape:b,dtype:r.dtype}}var dX={kernelName:kg,backendName:"cpu",kernelFunc:uX};var pX={kernelName:Ng,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;hU(r,"maxPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=a;gb.assert(WE.eitherStridesOrDilationsAreOne(i,1),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(1,"'"));let c,u=WE.computePool2DInfo(r.shape,s,i,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&gb.arraysEqual(u.inShape,u.outShape))c=SU({inputs:{x:r},backend:n});else{let e=n.data.get(r.dataId).values,t=gb.computeStrides(r.shape),a=Tq(e,r.shape,r.dtype,t,u,"max");c=n.makeTensorInfo(u.outShape,r.dtype,a.values)}return c}};var hX={kernelName:Cg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a;hU(r,"maxPool3d");let u=WE.computePool3DInfo(r.shape,s,i,1,o,l,c),d=_q(n.data.get(r.dataId).values,r.shape,r.dtype,gb.computeStrides(r.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};var fX={kernelName:Tg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=a;hU([r,s],"maxPool3DGrad");let u=WE.computePool3DInfo(s.shape,i,o,1,l,c),d=function(e,t){let n=sw(t.outShape,"int32"),a=t.strideDepth,r=t.strideHeight,s=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){let b=y*a-p,v=b;for(;v<0;)v+=i;let x=Math.min(t.inDepth,c+b);for(let a=0;a<t.outHeight;++a){let c=a*r-h,p=c;for(;p<0;)p+=o;let w=Math.min(t.inHeight,u+c);for(let r=0;r<t.outWidth;++r){let h=r*s-f,k=h;for(;k<0;)k+=l;let S=Math.min(t.inWidth,d+h),N=Number.NEGATIVE_INFINITY,I=-1;for(let t=v;t<x;t+=i){let n=t-b;for(let a=p;a<w;a+=o){let r=a-c;for(let s=k;s<S;s+=l){let i=s-h,o=e.get(m,t,a,s,g);o>=N&&(N=o,I=n*u*d+r*u+i)}}}n.set(I,m,y,a,r,g)}}}return n}(n.bufferSync(s),u),p=u.strideDepth,h=u.strideHeight,f=u.strideWidth,m=u.dilationDepth,g=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,v=u.effectiveFilterHeight,x=u.effectiveFilterWidth,w=b-1-u.padInfo.front,k=x-1-u.padInfo.left,S=v-1-u.padInfo.top,N=sw(s.shape,"float32"),I=n.bufferSync(r);for(let C=0;C<u.batchSize;++C)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let a=0;a<u.inWidth;++a){let r=t-w,s=n-S,i=a-k,o=0;for(let t=0;t<b;t+=m){let n=(r+t)/p;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let a=0;a<v;a+=g){let r=(s+a)/h;if(!(r<0||r>=u.outHeight||Math.floor(r)!==r))for(let s=0;s<x;s+=y){let l=(i+s)/f;if(l<0||l>=u.outWidth||Math.floor(l)!==l)continue;let c=b*v*x-1-d.get(C,n,r,l,e)===t*v*x+a*x+s?1:0;0!==c&&(o+=I.get(C,n,r,l,e)*c)}}}N.set(o,C,t,n,a,e)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}};var mX={kernelName:Ig,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s,output:i}=t,o=s;hU([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=a,p=WE.computePool2DInfo(o.shape,l,c,1,u,d),h=n.data.get(o.dataId).values,f=sw(p.outShape,o.dtype,Eq(h,o.shape,o.dtype,p).values),m=p.strideHeight,g=p.strideWidth,y=p.dilationHeight,b=p.dilationWidth,v=p.effectiveFilterHeight,x=p.effectiveFilterWidth,w=x-1-p.padInfo.left,k=v-1-p.padInfo.top,S=sw(o.shape,"float32"),N=n.data.get(r.dataId).values,I=sw(r.shape,"float32",N);for(let C=0;C<p.batchSize;++C)for(let e=0;e<p.inChannels;++e)for(let t=0;t<p.inHeight;++t)for(let n=0;n<p.inWidth;++n){let a=t-k,r=n-w,s=0;for(let t=0;t<v;t+=y){let n=(a+t)/m;if(!(n<0||n>=p.outHeight||Math.floor(n)!==n))for(let a=0;a<x;a+=b){let i=(r+a)/g;if(i<0||i>=p.outWidth||Math.floor(i)!==i)continue;let o=v*x-1-f.get(C,n,i,e)===t*x+a?1:0;0!==o&&(s+=I.get(C,n,i,e)*o)}}S.set(s,C,t,n,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var gX={kernelName:Eg,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:l}=n,c=a;hU(r,"MaxPoolWithArgmax");let u=c.data.get(r.dataId).values,d=WE.computePool2DInfo(r.shape,s,i,[1,1],o),[p,h]=function(e,t,n,a,r){let s=Tq(e,0,n,gb.computeStrides(t),r,"max"),i=Eq(e,t,n,r,!0,a);return[s.values,i.values]}(u,r.shape,r.dtype,l,d),f=c.write(p,d.outShape,r.dtype),m=c.write(h,d.outShape,r.dtype);return[{dataId:f,shape:d.outShape,dtype:r.dtype},{dataId:m,shape:d.outShape,dtype:"int32"}]}};var yX={kernelName:_g,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a,o=gb.parseAxisParam(s,r.shape),l=WE.computeOutAndReduceShapes(r.shape,o)[1],c=gb.sizeFromShape(l),u=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));u.push(d);let p=EU({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});u.push(p);let h=RK({inputs:{a:p,b:d},backend:n});u.push(h);let f=gK({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:i}});return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}};var bX={kernelName:Ag,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a;hU(r,"min");let o=gb.parseAxisParam(s,r.shape),l=o,c=WE.getAxesPermutation(l,r.shape.length),u=r;null!=c&&(u=HH({inputs:{x:r},backend:n,attrs:{perm:c}}),l=WE.getInnerMostAxes(l.length,r.shape.length)),WE.assertAxesAreInnerMostDims("min",l,u.shape.length);let[d,p]=WE.computeOutAndReduceShapes(u.shape,l),h=gb.sizeFromShape(p),f=gb.makeZerosTypedArray(gb.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let e=y*h,t=m[e];for(let n=0;n<h;++n){let a=m[e+n];(Number.isNaN(a)||a<t)&&(t=a)}f[y]=t}null!=c&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(i){let e=nq({inputs:{x:g},backend:n,attrs:{shape:WE.expandShapeToKeepDim(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};var vX={kernelName:Fg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:s,mode:i}=a;hU(r,"mirrorPad");let o=s.map((e,t)=>e[0]+r.shape[t]+e[1]),l=s.map(e=>e[0]),c=s.map((e,t)=>e[0]+r.shape[t]),u="reflect"===i?0:1,d=n.data.get(r.dataId).values,p=r.shape.length,h=gb.computeStrides(r.shape),f=gb.sizeFromShape(o),m=o.length,g=gb.computeStrides(o),y=gb.getTypedArrayFromDType(r.dtype,f);for(let b=0;b<f;b++){let e=gb.indexToLoc(b,m,g);for(let n=0;n<m;n++)e[n]<l[n]?e[n]=2*l[n]-e[n]-u:e[n]>=c[n]&&(e[n]=2*(c[n]-1)-e[n]+u);e=e.map((e,t)=>e-l[t]);let t=gb.locToIndex(e,p,h);y[b]=d[t]}return{dataId:n.write(y,o,r.dtype),shape:o,dtype:r.dtype}}},xX=vU((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),wX=AU(Dg,xX),kX={kernelName:Dg,backendName:"cpu",kernelFunc:wX},SX=dh(Sh());function NX(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{dim:s}=a,i=r.shape.length,o=s;if(-1===o&&(o=i-1),o!==i-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(i," and dim was ").concat(o));let l=gb.parseAxisParam([o],r.shape),c=uX({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=WE.expandShapeToKeepDim(c.shape,l),d=nq({inputs:{x:c},backend:n,attrs:{shape:u}}),p=PG({inputs:{a:r,b:d},backend:n}),h=ZU({inputs:{x:p},backend:n}),f=gK({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),m=nq({inputs:{x:f},backend:n,attrs:{shape:u}}),g=RK({inputs:{a:h,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var IX={kernelName:Cy,backendName:"cpu",kernelFunc:NX};var CX={kernelName:Mg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:s,seed:i,normalized:o}=a;hU(r,"multinomial");let l=o?r:NX({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,p=[c,s],h=gb.makeZerosTypedArray(gb.sizeFromShape(p),"int32");for(let f=0;f<c;++f){let e=f*u,t=new Float32Array(u-1);t[0]=d[e];for(let r=1;r<t.length;++r)t[r]=t[r-1]+d[e+r];let n=SX.alea(i.toString()),a=f*s;for(let r=0;r<s;++r){let e=n();h[a+r]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){h[a+r]=n;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",h)}},TX=K_.nonMaxSuppressionV3Impl;var EX={kernelName:zg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=a;hU(r,"NonMaxSuppression");let c=n.data.get(r.dataId).values,u=n.data.get(s.dataId).values,{selectedIndices:d}=TX(c,u,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},_X=K_.nonMaxSuppressionV4Impl;var AX={kernelName:jg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=a;hU(r,"NonMaxSuppressionPadded");let u=n.data.get(r.dataId).values,d=n.data.get(s.dataId).values,{selectedIndices:p,validOutputs:h}=_X(u,d,i,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},RX=K_.nonMaxSuppressionV5Impl;var FX={kernelName:Bg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=a;hU(r,"NonMaxSuppressionWithScore");let u=n.data.get(r.dataId).values,d=n.data.get(s.dataId).values,p=i,h=o,f=l,m=c,{selectedIndices:g,selectedScores:y}=RX(u,d,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};var DX={kernelName:Vg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:s,depth:i,onValue:o,offValue:l}=a;hU(r,"oneHot");let c=gb.sizeFromShape(r.shape),u=new Float32Array(c*i);u.fill(l);let d=n.data.get(r.dataId).values;for(let p=0;p<c;++p)d[p]>=0&&d[p]<i&&(u[p*i+d[p]]=o);return n.makeTensorInfo([...r.shape,i],s,u)}};function MX(e){let{inputs:t,backend:n}=e,{x:a}=t;if("string"===a.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===a.dtype){let e=IU({inputs:{input:a},backend:n}),t=MX({inputs:{x:e},backend:n}),r=Wq({inputs:{input:a},backend:n}),s=MX({inputs:{x:r},backend:n}),i=xU({inputs:{real:t,imag:s},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),i}return LK({backend:n,attrs:{shape:a.shape,value:0,dtype:a.dtype}})}var OX={kernelName:Qy,backendName:"cpu",kernelFunc:MX};var PX={kernelName:Wg,backendName:"cpu",kernelFunc:function e(t){let{inputs:n,backend:a}=t,{x:r}=n;if("string"===r.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===r.dtype){let t=IU({inputs:{input:r},backend:a}),n=e({inputs:{x:t},backend:a}),s=Wq({inputs:{input:r},backend:a}),i=MX({inputs:{x:s},backend:a}),o=xU({inputs:{real:n,imag:i},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(s),a.disposeIntermediateTensorInfo(i),o}return LK({backend:a,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}};function LX(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return EK({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let s=t[0].shape,i=t[0].dtype;t.forEach(e=>{gb.assertShapesMatch(s,e.shape,"All tensors passed to stack must have matching shapes"),gb.assert(i===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=Uq({inputs:t.map(e=>{let t=EK({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}var zX={kernelName:Ug,backendName:"cpu",kernelFunc:LX};var jX={kernelName:Hg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:s,constantValue:i}=a;hU(r,"pad");let o=s.map((e,t)=>e[0]+r.shape[t]+e[1]),l=s.map(e=>e[0]),c=n.data.get(r.dataId).values,u=gb.sizeFromShape(r.shape),d=r.shape.length,p=gb.computeStrides(r.shape),h=gb.sizeFromShape(o),f=o.length,m=gb.computeStrides(o),g=gb.getTypedArrayFromDType(r.dtype,h);0!==i&&g.fill(i);for(let y=0;y<u;y++){let e=gb.indexToLoc(y,d,p).map((e,t)=>e+l[t]);g[gb.locToIndex(e,f,m)]=c[y]}return{dataId:n.write(g,o,r.dtype),shape:o,dtype:r.dtype}}},BX=vU((e,t)=>Math.pow(e,t)),WX=AU(qg,BX),VX={kernelName:qg,backendName:"cpu",kernelFunc:WX};var UX={kernelName:Yg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:r,paramsDenseValues:s,indices:i}=t,{outputRaggedRank:o}=a,l=r.map(e=>n.data.get(e.dataId).values),c=r.map(e=>e.shape),u=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,[p,h,f]=JH(l,c,u,s.shape,s.dtype,d,i.shape),m=p.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,s.dtype,h);return m.concat([g])}};var HX={kernelName:Qg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:a,limits:r,deltas:s}=t,i=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,[c,u]=$H(i,a.shape,a.dtype,o,r.shape,l,s.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],a.dtype,u)]}};var GX={kernelName:Jg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{shape:r,values:s,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,c=n.data.get(r.dataId).values,u=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,p=o.map(e=>n.data.get(e.dataId).values),h=o.map(e=>e.shape),[f,m]=rG(c,r.shape,u,s.shape,s.dtype,d,i.shape,p,h,l);return n.makeTensorInfo(f,s.dtype,m)}};var qX={kernelName:Zg,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,dtype:s,step:i}=n,o=sG(a,r,i,s);return t.makeTensorInfo([o.length],s,o)}},KX=VU(ey,e=>1/e),XX={kernelName:ey,backendName:"cpu",kernelFunc:KX};var YX={kernelName:sy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:s,halfPixelCenters:i,size:o}=a;hU(r,"resizeBilinear");let l=gb.computeStrides(r.shape),[c,u]=o,[d,p,h,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(gb.sizeFromShape([d,c,u,f])),y=[s&&c>1?p-1:p,s&&u>1?h-1:h],b=[s&&c>1?c-1:c,s&&u>1?u-1:u],v=0,x=y[0]/b[0],w=y[1]/b[1];for(let k=0;k<d;k++)for(let e=0;e<c;e++){let t;t=i?x*(e+.5)-.5:x*e;let n=Math.max(0,Math.floor(t)),a=t-n,r=Math.min(p-1,Math.ceil(t)),s=k*l[0]+n*l[1],o=k*l[0]+r*l[1];for(let e=0;e<u;e++){let t;t=i?w*(e+.5)-.5:w*e;let n=Math.max(0,Math.floor(t)),r=t-n,c=Math.min(h-1,Math.ceil(t)),u=s+n*l[2],d=o+n*l[2],p=s+c*l[2],y=o+c*l[2];for(let e=0;e<f;e++){let t=m[u+e],n=m[d+e],s=t+(m[p+e]-t)*r,i=s+(n+(m[y+e]-n)*r-s)*a;g[v++]=i}}}return n.makeTensorInfo([d,c,u,f],"float32",g)}};var QX={kernelName:iy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:s}=t,{alignCorners:i}=a;hU([s,r],"resizeBilinearGrad");let o=gb.computeStrides(r.shape),[l,c,u,d]=r.shape,[,p,h]=s.shape,f=new Float32Array(l*c*u*d),m=[i&&p>1?c-1:c,i&&h>1?u-1:u],g=[i&&p>1?p-1:p,i&&h>1?h-1:h],y=m[0]/g[0],b=m[1]/g[1],v=n.data.get(s.dataId).values,x=0;for(let w=0;w<l;w++){let e=w*o[0];for(let t=0;t<p;t++){let n=t*y,a=Math.floor(n),r=Math.min(Math.ceil(n),c-1),s=e+a*o[1],i=e+r*o[1],l=n-a,p=1-l;for(let e=0;e<h;e++){let t=e*b,n=Math.floor(t),a=Math.min(Math.ceil(t),u-1),r=t-n,c=1-r,h=s+n*o[2],m=s+a*o[2],g=i+n*o[2],y=i+a*o[2],w=p*c,k=p*r,S=l*c,N=l*r;for(let e=0;e<d;e++){let t=v[x++];f[h+e]+=t*w,f[m+e]+=t*k,f[g+e]+=t*S,f[y+e]+=t*N}}}}return n.makeTensorInfo([l,u,c,d],"float32",f)}};var JX={kernelName:ay,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:s,halfPixelCenters:i,size:o}=a;hU(r,"resizeNearestNeighbor");let l=gb.computeStrides(r.shape),[c,u]=o,[d,p,h,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(d*c*u*f),y=[s&&c>1?p-1:p,s&&u>1?h-1:h],b=[s&&c>1?c-1:c,s&&u>1?u-1:u],v=y[0]/b[0],x=y[1]/b[1],w=0;for(let k=0;k<d;k++){let e=k*l[0];for(let t=0;t<c;t++){let n=i?v*(t+.5):v*t,a=Math.min(p-1,s?Math.round(n):Math.floor(n));i&&(a=Math.max(0,a));let r=e+a*l[1];for(let e=0;e<u;e++){let t=i?x*(e+.5):x*e,n=Math.min(h-1,s?Math.round(t):Math.floor(t));i&&(n=Math.max(0,n));let a=r+n*l[2];for(let e=0;e<f;e++){let t=m[a+e];g[w++]=t}}}}return n.makeTensorInfo([d,c,u,f],r.dtype,g)}};var ZX={kernelName:ry,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:s}=t,{alignCorners:i}=a;hU([s,r],"resizeNearestNeighborGrad");let o=gb.computeStrides(r.shape),l=gb.computeStrides(s.shape),[c,u,d,p]=r.shape,[,h,f]=s.shape,m=new Float32Array(c*u*d*p),g=n.data.get(s.dataId).values,y=[i&&h>1?u-1:u,i&&f>1?d-1:d],b=[i&&h>1?h-1:h,i&&f>1?f-1:f],v=y[0]/b[0],x=y[1]/b[1],w=1/v,k=1/x,S=2*Math.ceil(w)+2,N=2*Math.ceil(k)+2;for(let I=0;I<c;I++){let e=I*o[0];for(let t=0;t<u;t++){let n=e+t*o[1],a=Math.floor(t*w),r=Math.floor(a-S/2);for(let s=0;s<d;s++){let a=n+s*o[2],c=Math.floor(s*k),y=Math.floor(c-N/2);for(let n=0;n<p;n++){let o=0;for(let a=0;a<S;a++){let c=a+r;if(c<0||c>=h)continue;let p=e+c*l[1],m=c*v;if(t===Math.min(u-1,i?Math.round(m):Math.floor(m)))for(let e=0;e<N;e++){let t=e+y;if(t<0||t>=f)continue;let a=p+t*l[2],r=t*x;s===Math.min(d-1,i?Math.round(r):Math.floor(r))&&(o+=g[a+n])}}m[a+n]=o}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}};var $X={kernelName:ly,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:s}=a;hU(r,"reverse");let i=r.shape.length,o=gb.parseAxisParam(s,r.shape);if(0===i)return SU({inputs:{x:r},backend:n});let l=new Xb(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){let e=l.indexToLoc(u),t=e.slice();o.forEach(e=>t[e]=r.shape[e]-1-t[e]),l.set(c.get(...t),...e)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},eY={kernelName:$y,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,{radians:s,fillValue:i,center:o}=n,l=a,c=gb.getTypedArrayFromDType(r.dtype,gb.sizeFromShape(r.shape)),[u,d,p,h]=r.shape,[f,m]=WE.getImageCenter(o,d,p),g=Math.sin(s),y=Math.cos(s),b=l.data.get(r.dataId).values;for(let v=0;v<u;v++){let e=v*p*d*h;for(let t=0;t<d;t++){let n=t*(p*h);for(let a=0;a<p;a++){let r=a*h;for(let s=0;s<h;s++){let o=[u,t,a,s],l=o[2],v=o[1],x=(l-f)*y-(v-m)*g,w=(l-f)*g+(v-m)*y;x=Math.round(x+f),w=Math.round(w+m);let k=i;if("number"!=typeof i&&(k=3===s?255:i[s]),x>=0&&x<p&&w>=0&&w<d){k=b[e+w*(p*h)+x*h+s]}c[e+n+r+s]=k}}}}return{dataId:l.write(c,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},tY=VU(cy,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),nY={kernelName:cy,backendName:"cpu",kernelFunc:tY};var aY={kernelName:dy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r,updates:s}=t,{shape:i}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=WE.calculateShapes(s,r,i),p=cG(n.bufferSync(r),n.bufferSync(s),i,d,c,l,o,u,0,!0);return n.makeTensorInfo(i,p.dtype,p.values)}};function rY(e,t){let n=0,a=e.length,r=0;for(;n<a;)r=Math.floor((n+a)/2),e[r]<t?n=r+1:a=r;return a}function sY(e,t){let n=0,a=e.length,r=0;for(;n<a;)r=Math.floor((n+a)/2),e[r]<=t?n=r+1:a=r;return a}var iY={kernelName:hy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:s}=t,{side:i}=a,o=function(e,t,n,a,r,s){let i=gb.getArrayFromDType("int32",n*r);for(let o=0;o<n;++o){let n=e.slice(o*a,(o+1)*a),l=o*r;for(let e=0;e<r;++e)i[l+e]="left"===s?rY(n,t[e+l]):sY(n,t[e+l])}return i}(n.data.get(r.dataId).values,n.data.get(s.dataId).values,r.shape[0],r.shape[1],s.shape[1],i);return n.makeTensorInfo(s.shape,"int32",o)}};var oY={kernelName:fy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:s}=t;hU([a,r,s],"select");let i=a.shape.length,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(s.dataId).values,u=lv(r.dtype,s.dtype),d=gb.makeZerosTypedArray(gb.sizeFromShape(r.shape),u),p=0,h=0===i||i>1||1===r.shape.length?1:gb.sizeFromShape(r.shape.slice(1));for(let f=0;f<o.length;f++)for(let e=0;e<h;e++)1===o[f]?d[p++]=l[f]:d[p++]=c[f];return n.makeTensorInfo(r.shape,u,d)}},lY=WE.SELU_SCALEALPHA,cY=WE.SELU_SCALE,uY=VU(my,e=>e>=0?cY*e:lY*(Math.exp(e)-1)),dY={kernelName:my,backendName:"cpu",kernelFunc:uY},pY=VU(vy,e=>e<0?-1:e>0?1:0),hY={kernelName:vy,backendName:"cpu",kernelFunc:pY},fY=VU(yy,e=>Math.sin(e)),mY={kernelName:yy,backendName:"cpu",kernelFunc:fY},gY=VU(by,e=>Math.sinh(e)),yY={kernelName:by,backendName:"cpu",kernelFunc:gY},bY=Math.log(1.1920928955078125e-7)+2,vY=VU(wy,e=>{let t,n=e>-bY,a=e<bY,r=Math.exp(e);return t=a?r:n?e:Math.log(1+r),t}),xY={kernelName:wy,backendName:"cpu",kernelFunc:vY};var wY={kernelName:Ny,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:s,paddings:i}=a;hU([r],"spaceToBatchND");let o=gb.sizeFromShape(s),l=[[0,0]];l.push(...i);for(let g=1+s.length;g<r.shape.length;++g)l.push([0,0]);let c=jX.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=WE.getReshaped(c.shape,s,o,!1),d=WE.getPermuted(u.length,s.length,!1),p=WE.getReshapedPermuted(c.shape,s,o,!1),h=nq({inputs:{x:c},backend:n,attrs:{shape:u}}),f=HH({inputs:{x:h},backend:n,attrs:{perm:d}}),m=nq({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}};var kY={kernelName:Ty,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:a,values:r,denseShape:s,defaultValue:i}=t;if(1!==s.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(s.shape));if(2!==a.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(a.shape));if(1!==r.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(r.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));let o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values[0],[d,p,h,f,m]=gG(o,a.shape,a.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(p,a.dtype,d),n.makeTensorInfo([p[0]],r.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}};var SY={kernelName:Ey,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:a,inputShape:r,newShape:s}=t;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(a.shape));if(1!==r.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(r.shape));if(1!==s.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(s.shape));let i=Array.from(n.data.get(r.dataId).values),o=n.data.get(a.dataId).values,l=Array.from(n.data.get(s.dataId).values),[c,u,d]=yG(o,a.shape,a.dtype,i,l);return[n.makeTensorInfo(u,a.dtype,c),n.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}};var NY={kernelName:_y,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:s}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(r.shape));if(1!==s.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(s.shape));if(r.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,[c,u]=bG(i,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(u,a.dtype,c)}};var IY={kernelName:Ay,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:s}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(r.shape));if(1!==s.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(s.shape));if(r.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,[c,u]=bG(i,a.shape,a.dtype,o,l);return n.makeTensorInfo(u,a.dtype,c)}};var CY={kernelName:Ry,backendName:"cpu",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{sparseIndices:s,sparseValues:i,defaultValue:o}=n,{outputShape:l}=r,{sliceRank:c,numUpdates:u,sliceSize:d,strides:p,outputSize:h}=WE.calculateShapes(i,s,l),f=!1,m=a.bufferSync(s);switch(i.dtype){case"bool":t=cG(m,a.bufferSync(i),l,h,d,u,c,p,!!a.data.get(o.dataId).values[0],f);break;case"float32":case"int32":t=cG(m,a.bufferSync(i),l,h,d,u,c,p,a.data.get(o.dataId).values[0],f);break;case"string":t=cG(m,a.bufferSync(i),l,h,d,u,c,p,gb.decodeString(a.data.get(o.dataId).values[0]),f);break;default:throw new Error("Unsupported type ".concat(i.dtype))}return a.makeTensorInfo(l,t.dtype,t.values)}};var TY={kernelName:Iy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{numOrSizeSplits:s,axis:i}=a,o=gb.parseAxisParam(i,r.shape)[0],l=WE.prepareSplitSize(r,s,o),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(e=>{let t=[...u];t[o]=e;let a=fG({inputs:{x:r},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,a})}},EY={kernelName:Dy,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e,{x:a}=t,r=n;hU(a,"square");let s=r.data.get(a.dataId).values,i=new Float32Array(s.length);for(let o=0;o<s.length;++o){let e=s[o];i[o]=e*e}return{dataId:r.write(i,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},_Y=VU(Jy,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),AY={kernelName:Jy,backendName:"cpu",kernelFunc:_Y};var RY={kernelName:Oy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:s,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=a;hU(r,"stridedSlice");let h,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:v,end:x,strides:w}=mE.sliceInfo(r.shape,s,i,o,l,c,u,d,p);if(g)h=nq({inputs:{x:r},backend:n,attrs:{shape:m}});else if(y||b){gb.assert(r.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(r.shape.length));let e=mE.computeOutShape(v,x,w),t=fG({inputs:{x:r},backend:n,attrs:{begin:v,size:e}});h=nq({inputs:{x:t},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(t)}else{let e=EG(f,n.bufferSync(r),w,v);h=n.makeTensorInfo(m,e.dtype,e.values)}return h}};var FY={kernelName:Py,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{separator:r,nGramWidths:s,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=a,{data:u,dataSplits:d}=t,p=n.data.get(u.dataId).values,h=n.data.get(d.dataId).values,[f,m]=AG(p,h,r,s,i,o,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};var DY={kernelName:Ly,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{skipEmpty:r}=a,{input:s,delimiter:i}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error("Input must be a vector, got shape: ".concat(s.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));let o=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,d]=FG(o,l,r),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};var MY={kernelName:zy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{numBuckets:r}=a,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");let i=DG(n.data.get(s.dataId).values,r);return n.makeTensorInfo(s.shape,"int32",i)}},OY=VU(By,e=>Math.tan(e)),PY={kernelName:By,backendName:"cpu",kernelFunc:OY},LY=VU(Wy,e=>Math.tanh(e));var zY={kernelName:py,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{tensor:a,indices:r,updates:s}=t,{sliceRank:i,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=WE.calculateShapes(s,r,a.shape),d=n.bufferSync(r),p=n.bufferSync(s),h=n.bufferSync(a),f=cG(d,p,a.shape,u,l,o,i,c,h,!1);return n.makeTensorInfo(a.shape,f.dtype,f.values)}};var jY={kernelName:Vy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reps:s}=a;hU(r,"tile");let i=zG(n.bufferSync(r),s);return n.makeTensorInfo(i.shape,i.dtype,i.values)}};var BY={kernelName:Uy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:s,sorted:i}=a;hU(r,"topk");let o=n.data.get(r.dataId).values,[l,c]=WG(o,r.shape,r.dtype,s,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};var WY={kernelName:Hy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{image:r,transforms:s}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=n,[u,d,p,h]=r.shape,[f,m]=null!=c?c:[d,p],g=[u,f,m,h],y=gb.computeStrides(r.shape),b=y[0],v=y[1],x=y[2],w=gb.computeStrides(g),k=w[0],S=w[1],N=w[2],I=gb.getTypedArrayFromDType(r.dtype,gb.sizeFromShape(g));I.fill(l);let C=a.data.get(r.dataId).values,T=a.data.get(s.dataId).values;for(let E=0;E<u;++E){let e=1===s.shape[0]?T:T.subarray(8*E,8*E+8);for(let t=0;t<f;++t)for(let n=0;n<m;++n)for(let a=0;a<h;++a){let r,s=e[6]*n+e[7]*t+1;if(0===s)continue;let c=(e[0]*n+e[1]*t+e[2])/s,u=(e[3]*n+e[4]*t+e[5])/s,h=VY(c,p,o),f=VY(u,d,o);switch(i){case"nearest":r=HY(C,d,p,b,v,x,E,f,h,a,l);break;case"bilinear":r=GY(C,d,p,b,v,x,E,f,h,a,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or 'bilinear', but got ".concat(i))}I[E*k+t*S+n*N+a]=r}return a.makeTensorInfo(g,r.dtype,I)}return{dataId:a.write(I,g,r.dtype),shape:r.shape,dtype:r.dtype}}};function VY(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{let e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return gb.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{let e=t-1;n-=t*Math.trunc(n/e)}return gb.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return gb.clamp(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function UY(e,t,n,a,r,s,i,o,l,c,u){return 0<=o&&o<t&&0<=l&&l<n?e[i*a+o*r+l*s+c]:u}function HY(e,t,n,a,r,s,i,o,l,c,u){return UY(e,t,n,a,r,s,i,Math.round(o),Math.round(l),c,u)}function GY(e,t,n,a,r,s,i,o,l,c,u){let d=Math.floor(o),p=Math.floor(l),h=d+1,f=p+1;return(h-o)*((f-l)*UY(e,t,n,a,r,s,i,d,p,c,u)+(l-p)*UY(e,t,n,a,r,s,i,d,f,c,u))+(o-d)*((f-l)*UY(e,t,n,a,r,s,i,h,p,c,u)+(l-p)*UY(e,t,n,a,r,s,i,h,f,c,u))}var qY={kernelName:qy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:s}=t;hU(s,"unique");let i=a.data.get(s.dataId).values,{outputValues:o,outputShape:l,indices:c}=VG(i,r,s.shape,s.dtype);return[a.makeTensorInfo(l,s.dtype,o),a.makeTensorInfo([c.length],"int32",c)]}};var KY={kernelName:Ky,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:s}=a;s<0&&(s+=r.shape.length);let i=r.shape.length,o=r.shape[s],l=new Array(i-1),c=0;for(let h=0;h<i;h++)h!==s&&(l[c++]=r.shape[h]);let u=new Array(i).fill(0),d=r.shape.slice();d[s]=1;let p=new Array(o);for(let h=0;h<p.length;h++){u[s]=h;let e=fG({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});p[h]=nq({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return p}};var XY={kernelName:Xy,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,segmentIds:s}=t,{numSegments:i}=a;hU(r,"unsortedSegmentSum");let o=[],l=[],c=r.shape.length-s.shape.length,u=s;for(let p=0;p<c;++p){let e=EK({inputs:{input:u},backend:n,attrs:{dim:p+1}});u=e,l.push(e)}for(let p=0;p<i;++p){let e=gb.createScalarValue(p,"int32"),t=n.makeTensorInfo([],"int32",e),a=YU({inputs:{a:t,b:u},backend:n}),s=EU({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),i=PH({inputs:{a:s,b:r},backend:n}),c=gK({inputs:{x:i},backend:n,attrs:{axis:0,keepDims:!1}});o.push(c),l.push(t),l.push(a),l.push(s),l.push(i),l.push(c)}let d=LX({inputs:o,backend:n,attrs:{axis:0}});return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),d}},YY=[iq,bU,lq,uq,OU,dq,pq,hq,fq,mq,yq,vq,wq,Nq,Cq,Aq,Rq,Fq,Dq,sq,Mq,Oq,Pq,BU,Lq,_U,qU,jq,wU,Bq,Hq,qq,Kq,Xq,Yq,Qq,Jq,$q,tK,nK,aK,rK,sK,iK,lK,cK,uK,dK,pK,hK,fK,mK,bK,GG,vK,QU,TK,$U,_K,nH,PK,zK,jK,sH,lH,BK,WK,VK,UK,hH,gH,NU,HK,Vq,qK,XK,QK,KG,vH,kH,JK,CH,$K,nX,rX,oX,lX,cX,dX,AH,pX,hX,fX,mX,gX,yX,bX,DH,vX,kX,CX,LH,jH,EX,AX,FX,VH,DX,PX,zX,jX,VX,QG,KH,UX,HX,GX,qX,CU,FK,XX,ZG,eq,aq,YX,QX,JX,ZX,$X,eY,nY,lG,aY,iY,oY,dY,pG,hY,mY,yY,mG,IX,xY,wY,kY,SY,NY,IY,CY,TY,wG,EY,NG,TG,AY,RY,FY,DY,MY,LG,yK,PY,{kernelName:Wy,backendName:"cpu",kernelFunc:LY},zY,jY,BY,WY,GH,qY,KY,XY,OX];for(let n of YY)ub(n);var QY={};uh(QY,{assertNotComplex:()=>sJ,bindCanvasToFramebuffer:()=>OQ,bindColorTextureToFramebuffer:()=>PQ,bindTextureToProgramUniformSampler:()=>MQ,bindTextureUnit:()=>AQ,bindVertexBufferToProgramAttribute:()=>_Q,callAndCheck:()=>lQ,canBeRepresented:()=>dQ,createFragmentShader:()=>mQ,createFramebuffer:()=>EQ,createProgram:()=>xQ,createStaticIndexBuffer:()=>NQ,createStaticVertexBuffer:()=>SQ,createTexture:()=>CQ,createVertexShader:()=>fQ,getBatchDim:()=>VQ,getExtensionOrThrow:()=>hQ,getFramebufferErrorMessage:()=>jQ,getMaxTexturesInShader:()=>JQ,getNumChannels:()=>IQ,getProgramUniformLocation:()=>DQ,getProgramUniformLocationOrThrow:()=>FQ,getRowsCols:()=>UQ,getShapeAs3D:()=>HQ,getTextureShapeFromLogicalShape:()=>GQ,getWebGLDisjointQueryTimerVersion:()=>ZQ,getWebGLErrorMessage:()=>pQ,getWebGLMaxTextureSize:()=>XQ,hasExtension:()=>$Q,isCapableOfRenderingToFloatTexture:()=>tJ,isDownloadFloatTextureEnabled:()=>nJ,isReshapeFree:()=>KQ,isWebGLFenceEnabled:()=>rJ,isWebGLVersionEnabled:()=>eJ,linkProgram:()=>wQ,logShaderSourceAndInfoLog:()=>vQ,resetMaxTextureSize:()=>YQ,resetMaxTexturesInShader:()=>QQ,unbindColorTextureFromFramebuffer:()=>LQ,unbindTextureUnit:()=>RQ,validateFramebuffer:()=>zQ,validateProgram:()=>kQ,validateTextureSize:()=>TQ});var JY,ZY,$Y,eQ={},tQ={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function nQ(e,t){eQ[e]=t}function aQ(e,t){if(!(e in eQ)||null!=t){let n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=null==t?function(e){if(!Mf().getBool("IS_SAFARI")&&"undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;return n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete eQ[e]},!1),Mf().getBool("SOFTWARE_WEBGL_ENABLED")&&(tQ.failIfMajorPerformanceCaveat=!1),1===e?n.getContext("webgl",tQ)||n.getContext("experimental-webgl",tQ):n.getContext("webgl2",tQ)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;eQ[e]=n}let n=eQ[e];return null==n||n.isContextLost()?(delete eQ[e],aQ(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),eQ[e])}function rQ(e,t){return[t,e]}function sQ(e){let t=gb.sizeFromShape(e),n=Math.ceil(t/4);return gb.sizeToSquarishShape(n)}function iQ(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function oQ(e,t){let n,a,r,s,i,o,l,c,u,d,p=e;return 2===Mf().getNumber("WEBGL_VERSION")?(n=p.R32F,a=p.R16F,r=p.RGBA16F,s=p.RGBA32F,i=p.RED,l=4,c=1,u=p.HALF_FLOAT,d=p.FLOAT,o=p.RGBA8):(n=e.RGBA,a=e.RGBA,r=e.RGBA,s=p.RGBA,i=e.RGBA,l=4,c=4,u=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT,o=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:s,textureFormatFloat:i,downloadTextureFormat:o,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:u,textureTypeFloat:d}}function lQ(e,t){let n=t();return Mf().getBool("DEBUG")&&function(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+pQ(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(JY||(JY={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(ZY||(ZY={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}($Y||($Y={}));var cQ=5.96e-8,uQ=65504;function dQ(e){return!!(Mf().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||cQ<Math.abs(e)&&Math.abs(e)<uQ)}function pQ(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}function hQ(e,t){return BQ(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function fQ(e,t){let n=BQ(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(lQ(e,()=>e.shaderSource(n,t)),lQ(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function mQ(e,t){let n=BQ(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(lQ(e,()=>e.shaderSource(n,t)),lQ(e,()=>e.compileShader(n)),Mf().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw vQ(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var gQ,yQ,bQ=/ERROR: [0-9]+:([0-9]+):/g;function vQ(e,t){let n=bQ.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);let a=+n[1],r=e.split("\n"),s=r.length.toString().length+2,i=r.map((e,t)=>gb.rightPad((t+1).toString(),s)+e),o=0;for(let d=0;d<i.length;d++)o=Math.max(i[d].length,o);let l=i.slice(0,a-1),c=i.slice(a-1,a),u=i.slice(a);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(gb.rightPad(c[0],o)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function xQ(e){return BQ(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function wQ(e,t){if(lQ(e,()=>e.linkProgram(t)),!Mf().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function kQ(e,t){if(lQ(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function SQ(e,t){let n=BQ(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return lQ(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),lQ(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function NQ(e,t){let n=BQ(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return lQ(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),lQ(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function IQ(){return 2===Mf().getNumber("WEBGL_VERSION")?1:4}function CQ(e){return BQ(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function TQ(e,t){let n=Mf().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let n="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(e>n||t>n){let a="[".concat(e,"x").concat(t,"]"),r="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+r+".")}}function EQ(e){return BQ(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function _Q(e,t,n,a,r,s,i){let o=e.getAttribLocation(t,n);return-1!==o&&(lQ(e,()=>e.bindBuffer(e.ARRAY_BUFFER,a)),lQ(e,()=>e.vertexAttribPointer(o,r,e.FLOAT,!1,s,i)),lQ(e,()=>e.enableVertexAttribArray(o)),!0)}function AQ(e,t,n){WQ(e,n),lQ(e,()=>e.activeTexture(e.TEXTURE0+n)),lQ(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function RQ(e,t){WQ(e,t),lQ(e,()=>e.activeTexture(e.TEXTURE0+t)),lQ(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function FQ(e,t,n){return BQ(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function DQ(e,t,n){return e.getUniformLocation(t,n)}function MQ(e,t,n,a){lQ(e,()=>AQ(e,t,a)),lQ(e,()=>e.uniform1i(n,a))}function OQ(e){lQ(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),lQ(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),lQ(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function PQ(e,t,n){lQ(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),lQ(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function LQ(e,t){lQ(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),lQ(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function zQ(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+jQ(e,t))}function jQ(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}function BQ(e,t,n){let a=lQ(e,()=>t());if(null==a)throw new Error(n);return a}function WQ(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=t+e.TEXTURE0;if(a<e.TEXTURE0||a>n){let e="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(e,"."))}}function VQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return gb.sizeFromShape(e.slice(0,e.length-t))}function UQ(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function HQ(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[VQ(e),...UQ(e)]),t}function GQ(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Mf().getNumber("WEBGL_MAX_TEXTURE_SIZE"),a=Mf().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");a===1/0&&Mf().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(a=n/2),t&&(n*=2,a*=2,1===(e=e.map((t,n)=>n>=e.length-2?gb.nearestLargerEven(e[n]):e[n])).length&&(e=[2,e[0]])),2!==e.length&&(e=gb.squeezeShape(e).newShape);let r=gb.sizeFromShape(e),s=null;e.length<=1&&r<=n?s=[1,r]:2===e.length&&e[0]<=n&&e[1]<=n?s=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);let i=null!=s&&Math.max(...s)>a&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(null==s||i)if(t){let t=VQ(e),n=2,a=2;e.length&&([n,a]=UQ(e)),r=t*(n/2)*(a/2),s=gb.sizeToSquarishShape(r).map(e=>2*e)}else s=gb.sizeToSquarishShape(r);return s}function qQ(e){return e%2===0}function KQ(e,t){if(e=e.slice(-2),t=t.slice(-2),gb.arraysEqual(e,t)||!e.length||!t.length||0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){let n=e[e.length-1],a=t[t.length-1];if(n===a||qQ(n)&&qQ(a)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&qQ(e[0])&&qQ(t[0])}function XQ(e){if(null==gQ){let t=aQ(e);gQ=t.getParameter(t.MAX_TEXTURE_SIZE)}return gQ}function YQ(){gQ=null}function QQ(){yQ=null}function JQ(e){if(null==yQ){let t=aQ(e);yQ=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,yQ)}function ZQ(e){if(0===e)return 0;let t,n=aQ(e);return t=$Q(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:$Q(n,"EXT_disjoint_timer_query")?1:0,t}function $Q(e,t){return null!=e.getExtension(t)}function eJ(e){try{if(null!=aQ(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function tJ(e){if(0===e)return!1;let t=aQ(e);if(1===e){if(!$Q(t,"OES_texture_float"))return!1}else if(!$Q(t,"EXT_color_buffer_float"))return!1;return aJ(t)}function nJ(e){if(0===e)return!1;let t=aQ(e);if(1!==e){if($Q(t,"EXT_color_buffer_float"))return aJ(t);let e="EXT_color_buffer_half_float";if($Q(t,e)){let n=t.getExtension(e);return function(e,t){let n=oQ(e,t),a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0);let s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(a),e.deleteFramebuffer(r),s}(t,n)}return!1}return!(!$Q(t,"OES_texture_float")||!$Q(t,"WEBGL_color_buffer_float"))&&aJ(t)}function aJ(e){let t=oQ(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let r=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),r}function rJ(e){return 2===e&&null!=aQ(e).fenceSync}function sJ(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&gb.assert("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the WebGL backend."))})}var iJ=Mf();function oJ(){let e,t,n,a,r,s,i,o,l,c;return 2===Mf().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",a="in",r="texture",s="outputColor",i="out vec4 outputColor;",o=Mf().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",a="varying",r="texture2D",s="gl_FragColor",i="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:r,output:s,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}function lJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=gb.computeStrides(t);return a.map((t,r)=>{let s="int ".concat(e[r]," = ").concat(n," / ").concat(t),i=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(t):"index -= ".concat(e[r]," * ").concat(t);return"".concat(s,"; ").concat(i,";")}).join("")}function cJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=gb.computeStrides(t);return a.map((t,r)=>{let s="int ".concat(e[r]," = ").concat(n," / outShapeStrides[").concat(r,"]"),i=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * outShapeStrides[").concat(r,"]"):"index -= ".concat(e[r]," * outShapeStrides[").concat(r,"]");return"".concat(s,"; ").concat(i,";")}).join("")}function uJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=function(e,t){let n=e.length,a=e.map(e=>"".concat(t,"[").concat(e,"]")),r=new Array(n-1);r[n-2]=a[n-1];for(let s=n-3;s>=0;--s)r[s]="(".concat(r[s+1]," * ").concat(a[s+1],")");return r}(e.map((e,t)=>t),t);return a.map((t,r)=>{let s="int ".concat(e[r]," = ").concat(n," / ").concat(a[r]),i=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(a[r]):"index -= ".concat(e[r]," * ").concat(a[r]);return"".concat(s,"; ").concat(i,";")}).join("")}function dJ(e){let t=gb.computeStrides(e).map(e=>e.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}iJ.registerFlag("HAS_WEBGL",()=>iJ.getNumber("WEBGL_VERSION")>0),iJ.registerFlag("WEBGL_VERSION",()=>eJ(2)?2:eJ(1)?1:0),iJ.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),iJ.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===iJ.get("WEBGL_VERSION")),iJ.registerFlag("WEBGL_CPU_FORWARD",()=>!0),iJ.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),iJ.registerFlag("WEBGL_PACK",()=>iJ.getBool("HAS_WEBGL")),iJ.registerFlag("WEBGL_PACK_NORMALIZATION",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_CLIP",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_REDUCE",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_LAZILY_UNPACK",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_CONV_IM2COL",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>iJ.getBool("WEBGL_PACK")),iJ.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>XQ(iJ.getNumber("WEBGL_VERSION"))),iJ.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>JQ(iJ.getNumber("WEBGL_VERSION"))),iJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=iJ.getNumber("WEBGL_VERSION");return 0===e?0:ZQ(e)}),iJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>iJ.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Nv.isMobile()),iJ.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>tJ(iJ.getNumber("WEBGL_VERSION"))),iJ.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!iJ.getBool("WEBGL_FORCE_F16_TEXTURES")&&iJ.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),iJ.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>nJ(iJ.getNumber("WEBGL_VERSION"))),iJ.registerFlag("WEBGL_FENCE_API_ENABLED",()=>rJ(iJ.getNumber("WEBGL_VERSION"))),iJ.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>iJ.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),iJ.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if("number"!=typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ".concat(e,"."))}),iJ.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Nv.isMobile()?1:-1,e=>{if("number"!=typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ".concat(e,"."))}),iJ.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),iJ.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),iJ.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),iJ.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),iJ.registerFlag("WEBGL_EXP_CONV",()=>!1),iJ.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>iJ.getBool("IS_TEST")),iJ.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),iJ.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),iJ.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),iJ.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);var pJ="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:hJ}=WE;function fJ(e,t,n){let a=[];if(e.forEach(e=>{let t=gb.sizeFromShape(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){let{uniformShape:t}=NJ(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:a.push("uniform int ".concat(e.name,"Shape;"));break;case 2:a.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:a.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:a.push("uniform ivec4 ".concat(e.name,"Shape;"))}a.push("uniform ivec2 ".concat(e.name,"TexShape;"))}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:a.push("uniform int outShape;");break;case 2:a.push("uniform ivec2 outShape;"),a.push("uniform int outShapeStrides;");break;case 3:a.push("uniform ivec3 outShape;"),a.push("uniform ivec2 outShapeStrides;");break;case 4:a.push("uniform ivec4 outShape;"),a.push("uniform ivec3 outShapeStrides;")}a.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(e=>{a.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))});let r,s,i=a.join("\n"),o=e.map(e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,r="";r+=n?gJ(e,a):mJ(e,a);let s=e.shapeInfo.logicalShape,i=t.logicalShape;return s.length<=i.length&&(r+=n?function(e,t){let n,a=e.name,r=a.charAt(0).toUpperCase()+a.slice(1),s="get"+r+"AtOutCoords",i=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,l=hJ(e.shapeInfo.logicalShape,t.logicalShape),c=SJ(o),u=o-i,d=["x","y","z","w","u","v"];n=0===i?"":o<2&&l.length>=1?"coords = 0;":l.map(e=>"coords.".concat(d[e+u]," = 0;")).join("\n");let p="";p=o<2&&i>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(d[t+u])).join(", ");let h="return outputValue;",f=1===gb.sizeFromShape(e.shapeInfo.logicalShape),m=1===gb.sizeFromShape(t.logicalShape);if(1!==i||f||m){if(f&&!m)h=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){let e=i-2,t=i-1;l.indexOf(e)>-1&&l.indexOf(t)>-1?h="return vec4(outputValue.x);":l.indexOf(e)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(t)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(s,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(r,"(").concat(p,");\n      ").concat(h,"\n    }\n  ")}(e,t):function(e,t){let n=e.name,a=n.charAt(0).toUpperCase()+n.slice(1),r="get"+a+"AtOutCoords",s=t.texShape,i=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&null==e.shapeInfo.flatOffset&&gb.arraysEqual(i,s))return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");let c,u=SJ(l),d=hJ(e.shapeInfo.logicalShape,t.logicalShape),p=l-o,h=["x","y","z","w","u","v"];c=0===o?"":l<2&&d.length>=1?"coords = 0;":d.map(e=>"coords.".concat(h[e+p]," = 0;")).join("\n");let f="";return f=l<2&&o>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(h[t+p])).join(", "),"\n    float ".concat(r,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(a,"(").concat(f,");\n    }\n  ")}(e,t)),r}(e,t,n.packedInputs,n.enableShapeUniforms)).join("\n"),l=t.texShape,c=oJ(),u=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),d=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(yJ,"\n    ").concat(bJ,"\n    ").concat(vJ,"\n  ")}(c);return t.isPacked?(r=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===a[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(a[1],".0);\n      }\n    "):1===a[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(a[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      return 2 * (resTexRC.x * ").concat(a[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(gb.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(a[0],", ").concat(a[1],"));\n      }\n    ");let r=Math.ceil(e[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),s=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n\n      int b = index / ").concat(s,";\n      index -= b * ").concat(s,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),s=r*Math.ceil(e[e.length-2]/2),i=s,o="",l="b, r, c";for(let c=2;c<e.length-1;c++)i*=e[e.length-c-1],o="\n      int b".concat(c," = index / ").concat(i,";\n      index -= b").concat(c," * ").concat(i,";\n    ")+o,l="b".concat(c,", ")+l;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(a[0],", ").concat(a[1],"));\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(s,";\n      index -= b * ").concat(s,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(l,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,l,n.enableShapeUniforms),s=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(r=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){return 1===t[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    "):1===t[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){return gb.arraysEqual(e,t)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    "):1===e[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===e[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(cJ(["r","c","d"],e),"\n    return ivec3(r, c, d);\n  }\n");let a=lJ(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(cJ(["r","c","d","d2"],e),"\n      return ivec4(r, c, d, d2);\n    }\n  ");let a=lJ(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){let n=lJ(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){let n=lJ(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,l,n.enableShapeUniforms),s=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(d+=xJ),[d,u,s,i,r,o,n.userCode].join("\n")}function mJ(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(a,"() {return ").concat(n,";}");let[r,s]=e.shapeInfo.texShape;if(1===r&&1===s)return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let i=wJ(n);if(t)return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");let[o,l]=e.shapeInfo.texShape;return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(l,", ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int index) {\n        ").concat(kJ(e),"\n      }\n    ");let r=e.shapeInfo.texShape,s=r[0],i=r[1];if(1===i&&1===s)return"\n      float ".concat(a,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let o=wJ(n);return 1===i?t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(s,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):1===s?t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):t?"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),s=e.shapeInfo.texShape;if(null!=s&&gb.arraysEqual(n,s)){if(t)return"\n      float ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");let e=s[0],n=s[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(e,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}let{newShape:i,keptDims:o}=gb.squeezeShape(n),l=i;if(l.length<n.length){let n=IJ(e,l),a=["row","col"];return"\n      ".concat(mJ(n,t),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(CJ(a,o),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(kJ(e),"\n      }\n    ");let c=s[0],u=s[1],d=wJ(a);return 1===u?t?"\n      float ".concat(r,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(a,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(a,"TexShape[0]));\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):1===c?t?"\n      float ".concat(r,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(a,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(a,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):t?"\n      float ".concat(r,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a,"Shape[1] + col + ").concat(d,";\n        vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", index);\n    return sampleTexture(").concat(a,", uv);\n  }\n")}(e,t);case 3:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[1]*n[2],i=n[2],{newShape:o,keptDims:l}=gb.squeezeShape(n),c=o;if(c.length<n.length){let n=IJ(e,c),a=["row","col","depth"];return"\n        ".concat(mJ(n,t),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(CJ(a,l),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(s,", ").concat(i,", 1)));\n        ").concat(kJ(e),"\n      }\n    ");let u=e.shapeInfo.texShape,d=u[0],p=u[1],h=e.shapeInfo.flatOffset;if(p===s&&null==h)return t?"\n      float ".concat(r,"(int row, int col, int depth) {\n        int stride1 = ").concat(a,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(p,".0, ").concat(d,".0);\n          return sampleTexture(").concat(a,", uv);\n        }\n      ");if(p===i&&null==h)return t?"\n      float ".concat(r,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(a,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,".0, ").concat(d,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ");let f=wJ(a);return t?"\n    float ".concat(r,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(a,"Shape[1] * ").concat(a,"Shape[2];\n      int stride1 = ").concat(a,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index);\n      return sampleTexture(").concat(a,", uv);\n    }\n    "):"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(s," + col * ").concat(i," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index);\n        return sampleTexture(").concat(a,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[3],i=n[2]*s,o=n[1]*i,{newShape:l,keptDims:c}=gb.squeezeShape(n);if(l.length<n.length){let n=IJ(e,l),a=["row","col","depth","depth2"];return"\n      ".concat(mJ(n,t),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(CJ(a,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(i,", ").concat(s,", 1)));\n        ").concat(kJ(e),"\n      }\n    ");let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1],f="int stride2 = ".concat(a,"Shape[3];"),m="int stride1 = ".concat(a,"Shape[2] * stride2;"),g="int stride0 = ".concat(a,"Shape[1] * stride1;");if(h===o&&null==u)return t?"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        ").concat(f,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(s,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");if(h===s&&null==u)return t?"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(a,"Shape[1] * ").concat(a,"Shape[2], ").concat(a,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");let y=wJ(a);return t?"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(f,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(i," +\n          depth * ").concat(s," + depth2;\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(h,", index + ").concat(y,");\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(e,t);case 5:return function(e){let t=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t[4],s=t[3]*r,i=t[2]*s,o=t[1]*i,{newShape:l,keptDims:c}=gb.squeezeShape(t);if(l.length<t.length){let t=IJ(e,l),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(mJ(t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(a,"(").concat(CJ(n,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(o,", ").concat(i,", ").concat(s,", ").concat(r,")) +\n          depth3;\n        ").concat(kJ(e),"\n      }\n    ");let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1];if(h===o&&null==u)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(s,", ").concat(r,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(h===r&&null==u)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(h,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");let f=wJ(n);return"\n    float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(i," + depth * ").concat(s," +\n          depth2 * ").concat(r," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(h,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){let t=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:s}=gb.squeezeShape(t);if(r.length<t.length){let t=IJ(e,r),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(mJ(t),"\n      float ").concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(a,"(").concat(CJ(n,s),");\n      }\n    ")}let i=t[5],o=t[4]*i,l=t[3]*o,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(c,", ").concat(l,", ").concat(o,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(i,", 1)));\n        ").concat(kJ(e),"\n      }\n    ");let d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],f=p[1];if(f===u&&null==d)return"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(c,", ").concat(l,", ").concat(o,", ").concat(i,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===i&&null==d)return"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");let m=wJ(n);return"\n    float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(c," + depth * ").concat(l," +\n          depth2 * ").concat(o," + depth3 * ").concat(i," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling is not yet supported"))}}function gJ(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=oJ();return"\n    vec4 ".concat(n,"() {\n      return ").concat(a.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e.shapeInfo.texShape,s=oJ();if(t)return"\n    vec4 ".concat(a,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(s.texture2D,"(").concat(n,", uv);\n    }\n  ");let i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return"\n    vec4 ".concat(a,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(s.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),s=e.shapeInfo.texShape,i=s[0],o=s[1],l=oJ();if(null!=s&&gb.arraysEqual(n,s))return t?"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    "):"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(r,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ");let c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),s=e.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(1===n[0]){let a=[1,2],s=IJ(e,n.slice(1)),i=["b","row","col"];return"\n        ".concat(gJ(s,t),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(CJ(i,a),");\n        }\n      ")}let o=oJ();if(t)return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(o.texture2D,"(").concat(a,", uv);\n    }\n  ");let l=i[0],c=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(c,", ").concat(d,", ").concat(u,", b, row, col);\n      return ").concat(o.texture2D,"(").concat(a,", uv);\n    }\n  ")}(e,t);default:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=oJ();if(t)return"\n    vec4 ".concat(a,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ");let s=e.shapeInfo.logicalShape,i=s.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],d=Math.ceil(s[i-1]/2),p=d*Math.ceil(s[i-2]/2),h="int b, int row, int col",f="b * ".concat(p," + (row / 2) * ").concat(d," + (col / 2)");for(let m=2;m<i-1;m++)h="int b".concat(m,", ")+h,p*=s[i-m-1],f="b".concat(m," * ").concat(p," + ")+f;return"\n    vec4 ".concat(a,"(").concat(h,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(c,");\n      return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var yJ="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",bJ="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",vJ="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",xJ="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function wJ(e){return"offset".concat(e)}function kJ(e){let t=e.name,n=gb.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function SJ(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function NJ(e,t,n){let{newShape:a,keptDims:r}=gb.squeezeShape(t),s=t.length,i=e&&3===s&&1===t[0],o=i?t.slice(1):a,l=!e&&s>1&&!gb.arraysEqual(t,n)&&a.length<s||i;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:r}}function IJ(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function CJ(e,t){return t.map(t=>e[t]).join(", ")}function TJ(e,t,n){let a,r,s,i=[],o=[],l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),1===Mf().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));let u=!1;for(let d of t.variableNames){let a={name:d,uniform:e.getUniformLocation(n,d,u),offset:e.getUniformLocation(n,"offset".concat(d),u)};t.enableShapeUniforms&&(a.shape=e.getUniformLocation(n,"".concat(d,"Shape"),u),a.texShape=e.getUniformLocation(n,"".concat(d,"TexShape"),u)),i.push(a)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",u),s=e.getUniformLocation(n,"outShapeStrides",u),r=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(let d of t.customUniforms)o.push(e.getUniformLocation(n,d.name,u));return{variablesLocations:i,customUniformLocations:o,infLoc:l,nanLoc:c,outShapeLocation:a,outShapeStridesLocation:s,outTexShapeLocation:r}}function EJ(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but was executed with ").concat(t.length," inputs"));e.forEach((e,n)=>{let a=e.logicalShape,r=t[n],s=r.shape;if(!gb.arraysEqual(a,s))throw Error("Binary was compiled with different shapes than the current args. Shapes ".concat(a," and ").concat(s," must match"));if(e.isUniform&&r.isUniform)return;let i=e.texShape,o=r.isUniform?null:r.texData.texShape;if(!gb.arraysEqual(i,o))throw Error("Binary was compiled with different texture shapes than the current args. Shape ".concat(i," and ").concat(o," must match"))})}function _J(e){return Mf().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var AJ=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=JY.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=oJ();this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?cJ(["r","c","d"],e):lJ(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},RJ=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=JY.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=oJ();this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?cJ(["r","c","d"],e):lJ(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},FJ=class{constructor(e){this.variableNames=["A"],this.outTexUsage=ZY.DOWNLOAD;let t=oJ();this.outputShape=e,this.userCode="\n      ".concat(pJ,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}},DJ=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ZY.DOWNLOAD;let t=oJ();this.outputShape=e,this.userCode="\n      ".concat(pJ,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}},MJ={R:0,G:1,B:2,A:3},OJ=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let a=oJ();this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)");let s="";for(let i=0;i<n.length;i++){let e=n[i];s+="\n          if(offset == ".concat(i,") {\n            result = values[").concat(MJ[e],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":dJ(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(s,"\n        }\n        ").concat(a.output," = vec4(").concat(r,", 0., 0., 0.);\n      }\n    ")}},PJ=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=oJ();this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length);let a="",r="result";t&&(r="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let t=0;t<=1;t++){let r=2*s+t;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(t," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(t,";\n          if (localCoords[1] + ").concat(s," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(s,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(r,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(r,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(r,"] = values[2];\n            } else {\n              result[").concat(r,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":dJ(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(n.output," = ").concat(r,";\n        }\n    ")}},LJ={};function zJ(e){let t=oJ();return fQ(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function jJ(e){return SQ(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function BJ(e){return NQ(e,new Uint16Array([0,1,2,2,1,3]))}function WJ(e,t,n,a,r,s){TQ(t,n);let i=CQ(e),o=e.TEXTURE_2D;return lQ(e,()=>e.bindTexture(o,i)),lQ(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),lQ(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),lQ(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),lQ(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===Mf().getNumber("WEBGL_VERSION")?lQ(e,()=>e.texImage2D(o,0,a,t,n,0,r,s,null)):lQ(e,()=>e.texStorage2D(o,1,a,t,n)),lQ(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:i,texShape:[n,t]}}function VJ(e){return e.internalFormatFloat}function UJ(e,t,n,a){let[r,s]=rQ(t,n);return WJ(e,r,s,VJ(a),a.textureFormatFloat,e.FLOAT)}function HJ(e){return e.internalFormatHalfFloat}function GJ(e,t,n,a){let[r,s]=rQ(t,n);return WJ(e,r,s,HJ(a),a.textureFormatFloat,a.textureTypeHalfFloat)}function qJ(e){return e.downloadTextureFormat}function KJ(e,t,n,a){let[r,s]=rQ(t,n);return WJ(e,r,s,qJ(a),e.RGBA,e.UNSIGNED_BYTE)}function XJ(e){return e.internalFormatPackedFloat}function YJ(e,t,n,a){let[r,s]=iQ(t,n);return WJ(e,r,s,XJ(a),e.RGBA,e.FLOAT)}function QJ(e){return e.internalFormatPackedHalfFloat}function JJ(e,t,n,a){let[r,s]=iQ(t,n);return WJ(e,r,s,QJ(a),e.RGBA,a.textureTypeHalfFloat)}function ZJ(e,t,n){return lQ(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),_Q(e,t,"clipSpacePos",n,3,20,0)&&_Q(e,t,"uv",n,2,20,12)}function $J(e,t,n,a,r,s){let i,o,l;lQ(e,()=>e.bindTexture(e.TEXTURE_2D,t)),r instanceof Uint8Array?(i=new Uint8Array(n*a*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(i=new Float32Array(n*a*4),o=e.FLOAT,l=s.internalFormatPackedFloat),i.set(r),2===Mf().getNumber("WEBGL_VERSION")?lQ(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,a,e.RGBA,o,i)):lQ(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,a,0,e.RGBA,o,i)),lQ(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function eZ(e,t,n){lQ(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?2===Mf().getNumber("WEBGL_VERSION")?lQ(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):lQ(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):2===Mf().getNumber("WEBGL_VERSION")?lQ(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):lQ(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),lQ(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function tZ(e,t,n,a){let r=e.createBuffer();lQ(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r));let s=16*t*n;return lQ(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ)),lQ(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),lQ(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),r}function nZ(e,t,n){let a=e,r=new Float32Array(n);return a.bindBuffer(a.PIXEL_PACK_BUFFER,t),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,r),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),r}function aZ(e,t,n,a){let[r,s]=rQ(t,n),i=new Uint8Array(function(e,t){return e*t}(t*n,4));return lQ(e,()=>e.readPixels(0,0,r,s,a.downloadTextureFormat,e.UNSIGNED_BYTE,i)),new Float32Array(i.buffer)}function rZ(e,t,n,a,r,s,i,o){let l=e,c=new Float32Array(function(e,t){let[n,a]=iQ(e,t);return n*a*4}(s,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function sZ(e,t,n){let a=new Float32Array(t*n*4);return lQ(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,a)),a}uh(LJ,{bindVertexProgramAttributeStreams:()=>ZJ,createBufferFromOutputTexture:()=>tZ,createFloat16MatrixTexture:()=>GJ,createFloat16PackedMatrixTexture:()=>JJ,createFloat32MatrixTexture:()=>UJ,createIndexBuffer:()=>BJ,createPackedMatrixTexture:()=>YJ,createUnsignedBytesMatrixTexture:()=>KJ,createVertexBuffer:()=>jJ,createVertexShader:()=>zJ,downloadByteEncodedFloatMatrixFromOutputTexture:()=>aZ,downloadFloat32MatrixFromBuffer:()=>nZ,downloadMatrixFromPackedOutputTexture:()=>sZ,downloadPackedMatrixFromBuffer:()=>rZ,getInternalFormatForFloat16MatrixTexture:()=>HJ,getInternalFormatForFloat16PackedMatrixTexture:()=>QJ,getInternalFormatForFloat32MatrixTexture:()=>VJ,getInternalFormatForPackedMatrixTexture:()=>XJ,getInternalFormatForUnsignedBytesMatrixTexture:()=>qJ,uploadDenseMatrixToTexture:()=>$J,uploadPixelDataToTexture:()=>eZ});var iZ=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=Mf().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,nQ(t,e)):this.gl=aQ(t),e=this.gl,2===Mf().getNumber("WEBGL_VERSION")){let t=e;this.createVertexArray=()=>lQ(t,()=>t.createVertexArray()),this.bindVertexArray=e=>lQ(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>lQ(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>lQ(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(null!=e){let t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>lQ(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>lQ(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>lQ(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>lQ(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===Mf().getNumber("WEBGL_VERSION")){let e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=hQ(this.gl,e),$Q(this.gl,t))this.textureHalfFloatExtension=hQ(this.gl,t);else if(Mf().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),$Q(this.gl,a))this.colorBufferHalfFloatExtension=hQ(this.gl,a);else if(Mf().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",$Q(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!$Q(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=jJ(this.gl),this.indexBuffer=BJ(this.gl),this.framebuffer=EQ(this.gl),this.textureConfig=oQ(this.gl,this.textureHalfFloatExtension)}get debug(){return Mf().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;lQ(e,()=>e.finish()),lQ(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),lQ(e,()=>e.deleteFramebuffer(this.framebuffer)),lQ(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),lQ(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),lQ(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),UJ(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),GJ(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),KJ(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),eZ(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,a){this.throwIfDisposed(),$J(this.gl,e,t,n,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),JJ(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),YJ(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(LQ(this.gl,this.framebuffer),this.outputTexture=null),lQ(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>aZ(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,a,r,s){return rZ(this.gl,e,0,0,0,r,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return nZ(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let a=tZ(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(Mf().getBool("WEBGL_FENCE_API_ENABLED")){let a=e,r=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let e=a.clientWaitSync(r,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=r}else Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>sZ(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;null==this.vertexShader&&(this.vertexShader=zJ(t));let n=xQ(t);lQ(t,()=>t.attachShader(n,this.vertexShader)),lQ(t,()=>t.attachShader(n,e)),wQ(t,n);let a=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&kQ(t,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;lQ(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),ZJ(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(lQ(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&kQ(this.gl,this.program),lQ(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?FQ(this.gl,e,t):DQ(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),lQ(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),MQ(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[a,r]=iQ(t,n);this.setOutputMatrixTextureDriver(e,a,r)}setOutputMatrixWriteRegion(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)}setOutputPackedMatrixWriteRegion(e,t,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&kQ(this.gl,this.program),zQ(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}lQ(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),lQ(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=hQ(this.gl,2===Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await gb.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){let t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{let t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){let t=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),a&&!this.disjoint}{let t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in Mf().platform&&(n=Mf().platform.setTimeoutCustom.bind(Mf().platform)),gb.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),PQ(this.gl,e,this.framebuffer),this.debug&&zQ(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(PQ(this.gl,this.outputTexture,this.framebuffer),this.debug&&zQ(this.gl)):LQ(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let a=this.gl;PQ(a,e,this.framebuffer),this.debug&&zQ(a),this.outputTexture=e,lQ(a,()=>a.viewport(0,0,t,n)),lQ(a,()=>a.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,a){this.throwIfDisposed(),lQ(this.gl,()=>this.gl.scissor(e,t,n,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}};var{addImpl:oZ,bincountImpl:lZ,bincountReduceImpl:cZ,bitwiseAndImpl:uZ,castImpl:dZ,ceilImpl:pZ,concatImpl:hZ,equalImpl:fZ,expImpl:mZ,expm1Impl:gZ,floorImpl:yZ,gatherNdImpl:bZ,gatherV2Impl:vZ,greaterImpl:xZ,greaterEqualImpl:wZ,lessImpl:kZ,lessEqualImpl:SZ,linSpaceImpl:NZ,logImpl:IZ,maxImpl:CZ,maximumImpl:TZ,minimumImpl:EZ,multiplyImpl:_Z,negImpl:AZ,notEqualImpl:RZ,prodImpl:FZ,raggedGatherImpl:DZ,raggedRangeImpl:MZ,raggedTensorToTensorImpl:OZ,rangeImpl:PZ,rsqrtImpl:LZ,scatterImpl:zZ,sigmoidImpl:jZ,simpleAbsImpl:BZ,sliceImpl:WZ,sparseFillEmptyRowsImpl:VZ,sparseReshapeImpl:UZ,sparseSegmentReductionImpl:HZ,sqrtImpl:GZ,staticRegexReplaceImpl:qZ,stridedSliceImpl:KZ,stringNGramsImpl:XZ,stringSplitImpl:YZ,stringToHashBucketFastImpl:QZ,subImpl:JZ,tileImpl:ZZ,topKImpl:$Z,transposeImpl:e$,uniqueImpl:t$}=gU;function n$(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>"".concat(e,".").concat(t))}function a$(e,t){return 1===t?[e]:n$(e,t)}var r$=class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=_J(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{let e=a$("rc",this.rank),t=SJ(this.rank),n=this.getOutOfBoundsCondition(e),a=this.getSetup(e),r=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(a,"\n\n            setOutput(vec4(").concat(r,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let a=0;a<=1;a++){let r="".concat(0===n?"r":"rp1",", ").concat(0===a?"c":"cp1");for(let t=2;t<this.rank;t++)r="".concat(e[e.length-1-t],",")+r;t.push(r)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";let t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],a=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(a,";\n    ")}getOutput(e){let t=this.getSourceCoordsArr(e);return 1===this.rank?"getA(rc), (rc + 1 >= ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]," ? 0. : getA(rc + 1)), 0, 0"):"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}},s$=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length);let n="";for(let a=0;a<4;a++){let e="thisRC = rc;";a%2===1&&(e+="thisRC.z += 1;"),a>1&&(e+="thisRC.y += 1;"),n+="\n        ".concat(e,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t?uJ(["r","c","d"],"inputShape"):lJ(["r","c","d"],e),"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":dJ(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}};var i$=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let a=l$(t,n),r=c$(e,a,n);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);let s,i=o$(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();let e=this.freeTextures[r].pop();return this.usedTextures[r].push(e),e}return a===$Y.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===$Y.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===$Y.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===$Y.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===$Y.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[r].push(s),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),s}releaseTexture(e,t,n,a){if(null==this.freeTextures)return;let r=l$(n,a),s=c$(t,r,a);s in this.freeTextures||(this.freeTextures[s]=[]);let i=o$(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,a),o=Mf().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[s].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;let l=this.usedTextures[s],c=l&&l.indexOf(e);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));let t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(let e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function o$(e,t,n,a,r){let s,i=function(e,t){switch(e){case $Y.PACKED_2X2_FLOAT32:return XJ(t);case $Y.PACKED_2X2_FLOAT16:return QJ(t);case $Y.UNPACKED_FLOAT32:return VJ(t);case $Y.UNPACKED_FLOAT16:return HJ(t);case $Y.PACKED_4X1_UNSIGNED_BYTE:return qJ(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,a);if(r){let[t,n]=iQ(e[0],e[1]);s=t*n}else{let[t,n]=rQ(e[0],e[1]);s=t*n}let o=function(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,i);return s*o}function l$(e,t){if(e===ZY.UPLOAD)return $Y.PACKED_2X2_FLOAT32;if(e===ZY.RENDER||null==e)return function(e){return Mf().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?$Y.PACKED_2X2_FLOAT32:$Y.UNPACKED_FLOAT32:e?$Y.PACKED_2X2_FLOAT16:$Y.UNPACKED_FLOAT16}(t);if(e===ZY.DOWNLOAD||e===ZY.PIXELS)return $Y.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function c$(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var u$=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}},d$="if (isnan(x)) return x;",p$="return abs(x);",h$=d$+"\n  return (x < 0.0) ? 0.0 : x;\n",f$=d$+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",m$="return x;",g$=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}},y$=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length);let t=e.length,n=a$("rc",t),a=SJ(t),r=function(e,t){if(1===e)return"rc";let n="";for(let a=0;a<e;a++)n+=t[a],a<e-1&&(n+=",");return n}(t,n),s=n.slice(-2),i=t<=1?"rc":"vec2(".concat(s.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(r,");\n\n        setOutput(getChannel(packedInput, ").concat(i,"));\n      }\n    ")}},b$=K_.whereImpl,v$={};var x$=Mf().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var w$=class e extends Mh{nextDataId(){return e.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Mf().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof iZ)t=e;else{let n=aQ(Mf().getNumber("WEBGL_VERSION"),e);t=new iZ(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let e=aQ(Mf().getNumber("WEBGL_VERSION"));t=new iZ(e),this.binaryCache=function(e){return e in v$||(v$[e]={}),v$[e]}(Mf().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new i$(this.gpgpu),this.numMBBeforeWarning=null==Mf().global.screen?1024:Mf().global.screen.height*Mf().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new Dh(this,qv())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,a,r,s){let i=this.makeTensorInfo(t,n),o=this.texData.get(i.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[a,r]},o.texShape=[a,r];let l=HQ(t),c=new OJ(l,!1,s),u=this.runWebGLProgram(c,[i],n,[[a,r]]);return u.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(i),u.dataId}write(e,t,n){if((Mf().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Mf().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let a={id:this.nextDataId()};return this.texData.set(a,{shape:t,dtype:n,values:e,usage:ZY.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,a,r){if(Mf().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===a)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:a,values:t,usage:ZY.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t=this.texData.get(e),{values:n,dtype:a,complexTensorInfos:r,slice:s,shape:i,isPacked:o}=t;if(null!=s){let t;t=o?new g$(i,m$):new u$(i,m$);let n=this.runWebGLProgram(t,[{dataId:e,shape:i,dtype:a}],a),r=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===a)return n;let l,c,u=null!=this.activeTimers;if(u&&(l=gb.now()),"complex64"===a){let e=this.readSync(r.real.dataId),t=this.readSync(r.imag.dataId);c=WE.mergeRealAndImagArrays(e,t)}else c=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=gb.now()-l),this.convertAndCacheOnCPU(e,c)}async read(e){if(this.pendingRead.has(e)){let t=this.pendingRead.get(e);return new Promise(e=>t.push(e))}let t=this.texData.get(e),{values:n,shape:a,slice:r,dtype:s,complexTensorInfos:i,isPacked:o}=t;if(null!=r){let t;t=o?new g$(a,m$):new u$(a,m$);let n=this.runWebGLProgram(t,[{dataId:e,shape:a,dtype:s}],s),r=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(e);if(Mf().getBool("DEBUG")&&!Mf().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Mf().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,c,u=null;if("complex64"!==s&&Mf().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);let t=this.texData.get(l.dataId);u=this.gpgpu.createBufferFromTexture(t.texture.texture,...sQ(a))}if(this.pendingRead.set(e,[]),"complex64"!==s&&await this.gpgpu.createAndWaitForFence(),"complex64"===s){let e=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]),t=e[0],n=e[1];c=WE.mergeRealAndImagArrays(t,n)}else if(null==u)c=this.getValuesFromTexture(e);else{let e=gb.sizeFromShape(a);c=this.gpgpu.downloadFloat32MatrixFromBuffer(u,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=u){let e=this.gpgpu.gl;lQ(e,()=>e.deleteBuffer(u))}let d=this.convertAndCacheOnCPU(e,c),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(e=>e(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&qv().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),{values:a,shape:r,slice:s,dtype:i,isPacked:o,texture:l}=n;if("complex64"===i)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=s){let n;n=o?new g$(r,m$):new u$(r,m$);let a=this.runWebGLProgram(n,[{dataId:e,shape:r,dtype:i}],i),s=this.readToGPU(a,t);return this.disposeIntermediateTensorInfo(a),s}if(null==l)throw null!=a?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let c=this.decode(e,t.customTexShape),u=qv().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:u},d.texture)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>gb.decodeString(e));return sw(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return sw(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){let n=e[t];if(!dQ(n))throw Mf().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value ".concat(n," cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'")):Error("The value ".concat(n," cannot be represented on this device."))}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:a}=this.texData.get(e),r=gb.sizeFromShape(t);if(Mf().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let n=this.decode(e),a=this.texData.get(n.dataId),s=this.gpgpu.downloadMatrixFromPackedTexture(a.texture.texture,...sQ(t)).subarray(0,r);return this.disposeIntermediateTensorInfo(n),s}let s=Mf().getBool("WEBGL_PACK")&&!0===a,i=s?HQ(t):t,o=s?new DJ(i):new FJ(i),l=this.runWebGLProgram(o,[{shape:i,dtype:n,dataId:e}],"float32"),c=this.texData.get(l.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(l),u}timerAvailable(){return Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let t=this.activeTimers,n=[],a=!1;null==this.programTimersStack?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,e();let r=gb.flatten(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),s=gb.flatten(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,a&&(this.programTimersStack=null);let i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let e=await Promise.all(r);i.kernelMs=gb.sum(e),i.getExtraProfileInfo=()=>e.map((e,t)=>({name:s[t],ms:e})).map(e=>"".concat(e.name,": ").concat(e.ms)).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:gb.now(),endMs:null}}endTimer(e){return Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=gb.now(),e)}async getQueryTime(e){if(Mf().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:a,usage:r,isPacked:s,slice:i}=this.texData.get(e),o=i&&i.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=t&&(this.numBytesInGPU-=this.computeBytes(a,n),this.textureManager.releaseTexture(t,a,r,s)));let c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x$;return Mf().getBool("WEBGL_CPU_FORWARD")&&e.every(e=>null==this.texData.get(e.dataId).texture&&gb.sizeFromShape(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){WE.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return b$(e.shape,t)}packedUnaryOp(e,t,n){let a=new g$(e.shape,t),r=this.compileAndRun(a,[e],n);return qv().makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){let t=BZ(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Mf().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,p$,e.dtype);let t=new u$(e.shape,p$),n=this.compileAndRun(t,[e]);return qv().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&gb.isString(n[0])){let r=n.map(e=>gb.encodeString(e));a=this.write(r,e,t)}else a=this.write(n,e,t);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:t}}makeOutput(e,t,n){return qv().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new y$(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new r$(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){let n=[VQ(e.shape),...UQ(e.shape)],a={dtype:e.dtype,shape:n,dataId:e.dataId},r=[VQ(t),...UQ(t)],s=new s$(r,n),i=[n],o=this.runWebGLProgram(s,[a],e.dtype,i,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}decode(e,t){let n=this.texData.get(e),{isPacked:a,shape:r,dtype:s}=n;if(null!=t){let e=gb.sizeFromShape(r),n=t[0]*t[1]*4;gb.assert(e<=n,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let i,o=HQ(r);i=a?new RJ(o):new AJ(o);let l=[null!=t?t:sQ(o)];return{dtype:s,shape:r,dataId:this.runWebGLProgram(i,[{shape:o,dtype:s,dataId:e}],s,l,!0,t).dataId}}runWebGLProgram(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0,i=this.makeTensorInfo(e.outputShape,n),o=this.texData.get(i.dataId);if(e.packedOutput&&(o.isPacked=!0),e.outPackingScheme===JY.DENSE){let t=null!=s?s:sQ(e.outputShape);o.texShape=t.map(e=>2*e)}if(null!=e.outTexUsage&&(o.usage=e.outTexUsage),0===gb.sizeFromShape(i.shape))return o.values=gb.getTypedArrayFromDType(i.dtype,0),i;let l=[],c=t.map(t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&gb.sizeFromShape(t.shape)<=Mf().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!KQ(n.shape,t.shape)){let e=t,a=t.shape;t.shape=n.shape,t=this.packedReshape(t,a),l.push(t),n=this.texData.get(t.dataId),e.shape=a}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(i.dataId);let u,d={shape:i.shape,texData:o,isUniform:!1},p=function(e,t,n){let a="";t.concat(n).forEach(t=>{let r=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){let s=t.texData.texShape,{useSqueezeShape:i,uniformShape:o,keptDims:l}=NJ(e.packedInputs,t.shape,s),c="",u="",d="";if(1===o.length&&e.packedInputs){let e=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];c="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==o.length||e.packedInputs){if(o.length>2&&!e.packedInputs){let e=gb.computeStrides(o);d="".concat(e[0]===s[1],"_").concat(e[e.length-1]===s[1])}}else u="".concat(o[0]>1,"_").concat(o[1]>1);let p=t.shape.length,h=2===o.length&&gb.arraysEqual(t.shape,s),f=1===gb.sizeFromShape(t.shape),m=WE.getBroadcastDims(t.shape,n.shape),g=!e.packedInputs&&p===n.shape.length&&gb.arraysEqual(s,n.texData.texShape),y=e.packedInputs||o.length>2?"":"".concat(s[0]>1,"_").concat(s[1]>1);a+="".concat(p,"_").concat(g,"_").concat(i?l:"","_").concat(o.length,"_").concat(f,"_").concat(m,"_").concat(h,"_").concat(c,"_").concat(u,"_").concat(d,"_").concat(y,"_").concat(r)}else{let e=t.isUniform?"uniform":t.texData.texShape;a+="".concat(t.shape,"_").concat(e,"_").concat(r)}});let r=e.userCode,s=e.constructor.name;return s+="_"+a+"_"+r+"".concat(Mf().getNumber("WEBGL_VERSION")),s}(e,c,d),h=this.getAndSaveBinary(p,()=>function(e,t,n,a){let r=n.map((e,n)=>{let a={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(a.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:a}}),s=r.map(e=>e.shapeInfo),i={logicalShape:a.shape,texShape:a.texData.texShape,isUniform:!1,isPacked:a.texData.isPacked,flatOffset:null},o=fJ(r,i,t),l=mQ(e.gl,o),c=e.createProgram(l);return Mf().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:s,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:s,outShapeInfo:i},TJ(e,t,c)))}(this.gpgpu,e,c,d)),f=null!=this.activeTimers;f&&(u=this.startTimer()),Mf().get("ENGINE_COMPILE_ONLY")||function(e,t,n,a,r){t.program.enableShapeUniforms||(EJ(t.inShapeInfos,n),EJ([t.outShapeInfo],[a]));let s=a.texData.texture,i=a.texData.texShape;a.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,i[0],i[1]):e.setOutputMatrixTexture(s.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===Mf().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let a=n[l],{uniform:r,offset:s,shape:i,texShape:o}=t.variablesLocations[l];if(i){let{uniformShape:n}=NJ(t.program.packedInputs,a.shape,a.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(i,new Int32Array(n));break;case 2:e.gl.uniform2iv(i,new Int32Array(n));break;case 3:e.gl.uniform3iv(i,new Int32Array(n));break;case 4:e.gl.uniform4iv(i,new Int32Array(n))}}if(o&&e.gl.uniform2i(o,a.texData.texShape[0],a.texData.texShape[1]),null!=r){if(a.isUniform){if(gb.sizeFromShape(a.shape)<2)e.gl.uniform1f(r,a.uniformValues[0]);else{let t=a.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(r,t)}continue}null!=a.texData.slice&&null!=s&&e.gl.uniform1i(s,a.texData.slice.flatOffset),e.setInputMatrixTexture(a.texData.texture.texture,r,l)}}let o=t.outShapeLocation;if(o)switch(a.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(a.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(a.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(a.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(a.shape))}if(t.outShapeStridesLocation){let n=gb.computeStrides(a.shape);switch(a.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,a.texData.texShape[0],a.texData.texShape[1]),t.program.customUniforms&&r)for(let l=0;l<t.program.customUniforms.length;++l){let n=t.program.customUniforms[l],a=t.customUniformLocations[l],s=r[l];if("float"===n.type)e.gl.uniform1fv(a,s);else if("vec2"===n.type)e.gl.uniform2fv(a,s);else if("vec3"===n.type)e.gl.uniform3fv(a,s);else if("vec4"===n.type)e.gl.uniform4fv(a,s);else if("int"===n.type)e.gl.uniform1iv(a,s);else if("ivec2"===n.type)e.gl.uniform2iv(a,s);else if("ivec3"===n.type)e.gl.uniform3iv(a,s);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(a,s)}}e.executeProgram()}(this.gpgpu,h,c,d,a),l.forEach(e=>this.disposeIntermediateTensorInfo(e)),f&&(u=this.endTimer(u),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(u)}));let m=Mf().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){let e=gb.now();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!Mf().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===r){let e=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),e}return i}compileAndRun(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,a,r)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Mf().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Yv(()=>{if(!Mf().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=Mf().getBool("DEBUG");Mf().set("DEBUG",!1);let t=this.abs($k(1e-8)).dataSync()[0];if(Mf().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){let t=this.texData.get(e),{shape:n,dtype:a,values:r,texture:s,usage:i,isPacked:o}=t;if(null!=s)return;let l,c=null!=this.activeTimers;c&&(l=gb.now());let u=t.texShape;if(null==u&&(u=GQ(n,o),t.texShape=u),null!=r){let e,s=HQ(n),i=u[1],d=u[0],p=r instanceof Uint8Array||r instanceof Uint8ClampedArray;(o||!p)&&([i,d]=iQ(u[0],u[1])),e=o?new PJ(s,p):new OJ(s,p);let h=p?[d,i]:u,f=this.makeTensorInfo(h,a),m=this.texData.get(f.dataId);m.usage=p?ZY.PIXELS:ZY.UPLOAD,m.texShape=h,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),i,d,r);let g=[[d,i]],y=this.runWebGLProgram(e,[f],a,g,!0),b=this.texData.get(y.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,Mf().get("ENGINE_COMPILE_ONLY")?this.disposeData(y.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(y.dataId)),this.disposeIntermediateTensorInfo(f),c&&(this.uploadWaitMs+=gb.now()-l)}else{let e=this.acquireTexture(u,i,a,o);t.texture=e}}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:a}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){let n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error("Unknown dtype ".concat(t))}(t,a)),n.values}acquireTexture(e,t,n,a){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){let e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, most likely due to a memory leak"))}return this.textureManager.acquireTexture(e,t,a)}computeBytes(e,t){return e[0]*e[1]*gb.bytesPerElement(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(let[,t]of Object.entries(this.binaryCache)){let n=new Promise(e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}});e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await jE(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS))throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)?(vQ(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:t,customUniformLocations:n,infLoc:a,nanLoc:r,outShapeLocation:s,outShapeStridesLocation:i,outTexShapeLocation:o}=TJ(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=a,e.nanLoc=r,e.outShapeLocation=s,e.outShapeStridesLocation=i,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";let{texture:a,height:r,width:s,channels:i}=e,o=qv().backend;if(!o.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let l=o.writeTexture(a,t,n,r,s,i);return qv().makeTensorFromDataId(l,t,n,o)}};w$.nextDataId=0;var k$="4.22.0";function S$(){Mf().set("WEBGL_FORCE_F16_TEXTURES",!0)}Nv.isBrowser()&&sx("webgl",()=>new w$,2);var N$={forceHalfFloat:S$},I$="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",C$=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=WE.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=_J(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}},T$="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",E$=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=WE.assertAndGetBroadcastShape(t,n);let r=this.outputShape.length;this.enableShapeUniforms=_J(r);let s="";if(a)if(0===r||1===gb.sizeFromShape(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(s="\n          ".concat(SJ(r)," coords = getOutputCoords();\n        "),1===r)this.enableShapeUniforms?s+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":s+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{let e=a$("coords",r);this.enableShapeUniforms?s+="\n            bool nextRowOutOfBounds =\n              (".concat(e[r-2]," + 1) >= outShape[").concat(r," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[r-1]," + 1) >= outShape[").concat(r," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):s+="\n            bool nextRowOutOfBounds =\n              (".concat(e[r-2]," + 1) >= ").concat(this.outputShape[r-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[r-1]," + 1) >= ").concat(this.outputShape[r-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(s,"\n\n        setOutput(result);\n      }\n    ")}};function _$(e){let{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}var A$={kernelName:tg,backendName:"webgl",kernelFunc:_$};function R$(e){let{inputs:t,backend:n}=e,{real:a,imag:r}=t,s=n.makeTensorInfo(a.shape,"complex64"),i=n.texData.get(s.dataId),o=_$({inputs:{x:a},backend:n}),l=_$({inputs:{x:r},backend:n});return i.complexTensorInfos={real:o,imag:l},s}var F$={kernelName:pm,backendName:"webgl",kernelFunc:R$},D$="return (a < 0.) ? b * a : a;",M$="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var O$={kernelName:og,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{alpha:s}=a,i=n.makeTensorInfo([],"float32",gb.createScalarValue(s,"float32")),o=Mf().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new E$(M$,r.shape,i.shape):new C$(D$,r.shape,i.shape),l=n.runWebGLProgram(o,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),l}},P$="return (a < 0.) ? b * a : a;",L$="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var z$={kernelName:Kg,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t,s=Mf().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new E$(L$,a.shape,r.shape):new C$(P$,a.shape,r.shape);return n.runWebGLProgram(s,[a,r],"float32")}},j$="if (isnan(x)) return x;";function B$(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:a,dtype:r}=e;return e=>{let s,{inputs:i,backend:o}=e,{x:l}=i,c=o,u=r||l.dtype;if(c.shouldExecuteOnCPU([l])&&null!=a){let e=c.texData.get(l.dataId),t=a(e.values,u);return c.makeTensorInfo(l.shape,u,t)}return s=Mf().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new g$(l.shape,n):new u$(l.shape,t),c.runWebGLProgram(s,[l],u)}}function W$(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:a=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}=e;return e=>{let{inputs:o,backend:l}=e,{a:c,b:u}=o,d=l;if(r&&"complex64"===c.dtype){let e=d.texData.get(c.dataId),n=d.texData.get(u.dataId),[a,r]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{let[n,a]=e,r={dataId:n.dataId,dtype:n.dtype,shape:c.shape},s={dataId:a.dataId,dtype:a.dtype,shape:u.shape},i=new C$(t,c.shape,u.shape);return d.runWebGLProgram(i,[r,s],lv(n.dtype,a.dtype))}),s=R$({inputs:{real:a,imag:r},backend:d});return d.disposeIntermediateTensorInfo(a),d.disposeIntermediateTensorInfo(r),s}let p,h=i||lv(c.dtype,u.dtype);if(("string"===c.dtype||"string"===u.dtype||d.shouldExecuteOnCPU([c,u]))&&null!=s){let e=d.texData.get(c.dataId).values,t=d.texData.get(u.dataId).values,n="string"===c.dtype?WE.fromUint8ToStringArray(e):e,a="string"===c.dtype?WE.fromUint8ToStringArray(t):t,[r,i]=s(c.shape,u.shape,n,a,h),o=d.makeTensorInfo(i,h);return d.texData.get(o.dataId).values=r,o}return p=Mf().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new E$(n,c.shape,u.shape,a):new C$(t,c.shape,u.shape),d.runWebGLProgram(p,[c,u],h)}}function V$(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":h$;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":f$;if("prelu"===e)return t?L$:P$;if("leakyrelu"===e)return t?M$:D$;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var U$=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=_J(this.outputShape.length);let c=a?e[1]:e[2],u=Math.ceil(c/2),d=a?"i * 2, rc.y":"rc.y, i * 2",p=r?"rc.z, i * 2":"i * 2, rc.z",h=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";i&&(m=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(i,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(i,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(i,"\n        }"),g="result = activation(result);");let y=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";e[0]<t[0]?b="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(v="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(v,";\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(p,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(h[0]," * ").concat(f[0],");\n          result += (").concat(h[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}},H$="return areal * breal - aimag * bimag;",G$="return areal * bimag + aimag * breal;",q$=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=WE.assertAndGetBroadcastShape(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}},K$="return a * b;";function X$(e){let t,{inputs:n,backend:a}=e,{a:r,b:s}=n,i=WE.upcastType(r.dtype,s.dtype);if("complex64"===r.dtype){let e=a.texData.get(r.dataId),t=a.texData.get(s.dataId),n=new q$(H$,r.shape,s.shape),i=new q$(G$,r.shape,s.shape),o=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:s.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:s.shape}],l=a.runWebGLProgram(n,o,"float32"),c=a.runWebGLProgram(i,o,"float32"),u=R$({inputs:{real:l,imag:c},backend:a});return a.disposeIntermediateTensorInfo(l),a.disposeIntermediateTensorInfo(c),u}if(a.shouldExecuteOnCPU([r,s])){let e=a.texData.get(r.dataId),t=a.texData.get(s.dataId),[n,o]=_Z(r.shape,s.shape,e.values,t.values,i),l=a.makeTensorInfo(o,i);return a.texData.get(l.dataId).values=n,l}return t=Mf().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new E$(K$,r.shape,s.shape):new C$(K$,r.shape,s.shape),a.runWebGLProgram(t,[r,s],i)}var Y$={kernelName:Og,backendName:"webgl",kernelFunc:X$};function Q$(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{shape:s}=a,i=n,o=gb.sizeFromShape(r.shape),l=gb.inferFromImplicitShape(s,o),c=gb.sizeFromShape(l);gb.assert(o===c,()=>"The new shape (".concat(l,") has ").concat(c," elements and the old shape (").concat(r.shape,") has ").concat(o," elements. The new shape and old shape must have the same number of elements."));let u=i.texData.get(r.dataId);return!u.isPacked||KQ(r.shape,l)||null!==u.texture&&KQ(u.shape,l)?(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype}):function(e,t,n){let a=[VQ(e.shape),...UQ(e.shape)],r={dtype:e.dtype,shape:a,dataId:e.dataId},s=[VQ(t),...UQ(t)],i=new s$(s,a),o=[a],l=n.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(r,l,i)}var J$={kernelName:ny,backendName:"webgl",kernelFunc:Q$},Z$=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:a,inSize:r,outSize:s}=e;this.outputShape=[a,s];let i=4*Math.floor(n/4),o=n%4,l="sumValue += dot(values, ones);";if(null!=t){let e=1/t;l="sumValue += dot(values * ".concat(gb.isInt(e)?e.toPrecision(2):e,", ones);")}let c="";r%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(i,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(i,";\n        if (").concat(1===o,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}},$$=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:a,inSize:r,outSize:s}=e;this.outputShape=[a,s];let i="0.0",o="";"prod"===t?i="1.0":"min"===t?(i="1.0 / 1e-20",o="min"):"max"===t&&(i="-1.0 / 1e-20",o="max");let l="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");let c=4*Math.floor(n/4),u=n%4,d="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(o,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(o,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),p="vec4";"all"===t?(i="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===t&&(i="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");let h="";r%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(i,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(i,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===u,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===u,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===u,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}};function e0(e,t,n,a){let r=function(e){let t=[];for(;0===t.length||1!==t[t.length-1].outSize;){let n=t.length?t[t.length-1].outSize:e[1],a=WE.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:a,outSize:Math.ceil(n/a)})}return t}(e.shape),s=e;for(let i=0;i<r.length;i++){let o,l,{inSize:c,windowSize:u,outSize:d}=r[i];o="mean"===n?0===i?new Z$({windowSize:u,inSize:c,batchSize:e.shape[0],outSize:d},c):new Z$({windowSize:u,inSize:c,batchSize:e.shape[0],outSize:d}):new $$({windowSize:u,inSize:c,batchSize:e.shape[0],outSize:d},n),l=s,s=a.runWebGLProgram(o,[s],t),l.dataId!==e.dataId&&a.disposeIntermediateTensorInfo(l)}return s}var t0=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let s=0;s<n.length;s++)n[s]=e[t[s]];this.outputShape=n,this.rank=n.length;let a=SJ(this.rank),r=function(e){let t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],a=new Array(t);for(let r=0;r<e.length;r++)a[e[r]]=n[r];return a.join()}(t);this.userCode="\n    void main() {\n      ".concat(a," resRC = getOutputCoords();\n      setOutput(getA(").concat(r,"));\n    }\n    ")}};var n0=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));let a=SJ(this.rank),r=n$("rc",this.rank),s=new Array(this.rank);for(let c=0;c<t.length;c++)s[t[c]]=r[c];let i="vec2(".concat(s.slice(-2).join(),")"),o="++".concat(r[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(s.join(),"), ").concat(i,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(o,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(r[this.rank-1],";\n      if(++").concat(r[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(o,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}};function a0(e,t,n){let a=Mf().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new n0(e.shape,t):new t0(e.shape,t);return n.runWebGLProgram(a,[e],e.dtype)}function r0(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a;return function(e,t,n,a){let r=t,s=e.shape.length,i=gb.parseAxisParam(r,e.shape),o=i,l=WE.getAxesPermutation(o,s),c=null!=l,u=e;c&&(u=a0(e,l,a),o=WE.getInnerMostAxes(o.length,s)),WE.assertAxesAreInnerMostDims("sum",o,s);let[d,p]=WE.computeOutAndReduceShapes(u.shape,o),h=d;n&&(h=WE.expandShapeToKeepDim(d,i));let f=gb.sizeFromShape(p),m=Q$({inputs:{x:u},attrs:{shape:[gb.sizeFromShape(e.shape)/f,f]},backend:a}),g=e0(m,cv(e.dtype),"sum",a),y=Q$({inputs:{x:g},attrs:{shape:h},backend:a});return a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(g),c&&a.disposeIntermediateTensorInfo(u),y}(r,s,i,n)}var s0={kernelName:Sy,backendName:"webgl",kernelFunc:r0};function i0(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{perm:i}=r,o=a,l=s.shape.length,c=new Array(l);for(let u=0;u<c.length;u++)c[u]=s.shape[i[u]];if(o.shouldExecuteOnCPU([s])){let e=o.texData.get(s.dataId).values,n=e$(e,s.shape,s.dtype,i,c);t=o.makeTensorInfo(c,s.dtype),o.texData.get(t.dataId).values=n}else t=a0(s,i,o);return t}var o0={kernelName:Gy,backendName:"webgl",kernelFunc:i0};function l0(e){let{a:t,b:n,transposeA:a,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:c=null}=e,u=t.shape.length,d=n.shape.length,p=a?t.shape[u-2]:t.shape[u-1],h=r?n.shape[d-1]:n.shape[d-2],f=a?t.shape[u-1]:t.shape[u-2],m=r?n.shape[d-2]:n.shape[d-1],g=t.shape.slice(0,-2),y=n.shape.slice(0,-2),b=gb.sizeFromShape(g),v=gb.sizeFromShape(y),x=_k.assertAndGetBroadcastShape(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);gb.assert(p===h,()=>"Error in matMul: inner shapes (".concat(p,") and (").concat(h,") of Tensors with shapes ").concat(t.shape," and ").concat(n.shape," and transposeA=").concat(a," and transposeB=").concat(r," must match."));let w,k=a?[b,p,f]:[b,f,p],S=r?[v,m,h]:[v,h,m],N=Q$({inputs:{x:t},backend:s,attrs:{shape:k}}),I=Q$({inputs:{x:n},backend:s,attrs:{shape:S}}),C=[N,I],T=Math.max(b,v),E=a?N.shape[1]:N.shape[2],_=null!=i,A=null!=o,R="leakyrelu"===c,F=null!=c?V$(c,!0):null;if((1===f||1===m)&&E>1e3&&!1===(_||A||R||null!=F)){let e=N,t=I;a&&(e=i0({inputs:{x:N},backend:s,attrs:{perm:[0,2,1]}}),C.push(e)),r&&(t=i0({inputs:{x:I},backend:s,attrs:{perm:[0,2,1]}}),C.push(t));let n=1===m,i=e;1!==m&&(i=Q$({inputs:{x:e},backend:s,attrs:{shape:[T,E,1]}}),C.push(i));let o=1===m?2:1,l=t;n&&(l=Q$({inputs:{x:t},backend:s,attrs:{shape:[T,1,E]}}),C.push(l));let c=X$({inputs:{a:i,b:l},backend:s});w=r0({inputs:{x:c},backend:s,attrs:{axis:o,keepDims:!0}}),C.push(c)}else{let e=lv(t.dtype,n.dtype),c=new U$(k,S,[T,f,m],a,r,_,F,A,R),u=[N,I];if(null!=i&&u.push(i),A&&u.push(o),R){let e=s.makeTensorInfo([],"float32",gb.createScalarValue(l,"float32"));u.push(e),C.push(e)}w=s.runWebGLProgram(c,u,e)}let D=Q$({inputs:{x:w},backend:s,attrs:{shape:x}});C.push(w);for(let M of C)s.disposeIntermediateTensorInfo(M);return D}var c0={kernelName:eb,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:s,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=a;return l0({a:r,b:s,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:o,leakyreluAlpha:d,activation:u})}},u0="return abs(x);";var d0={kernelName:jf,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{x:r}=n;if(a.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){let e=a.texData.get(r.dataId),t=BZ(e.values);return a.makeTensorInfo(r.shape,r.dtype,t)}return t=Mf().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new g$(r.shape,u0):new u$(r.shape,u0),a.runWebGLProgram(t,[r],r.dtype)}},p0=B$({opSnippet:d$+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),h0={kernelName:Bf,backendName:"webgl",kernelFunc:p0},f0=B$({opSnippet:d$+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),m0={kernelName:Wf,backendName:"webgl",kernelFunc:f0},g0="return a + b;",y0=W$({opSnippet:g0,packedOpSnippet:g0,supportsComplex:!0,cpuKernelImpl:oZ}),b0={kernelName:Vf,backendName:"webgl",kernelFunc:y0},v0=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));let n=[];this.variableNames.forEach(e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))});let a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}},x0=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));let n=[];this.variableNames.forEach(e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))});let a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}};var w0={kernelName:Uf,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a}=t,r=n;if(1===r.length)return _$({inputs:{x:r[0]},backend:a});if(r.length>Mf().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let t=Math.floor(r.length/2),n=e({inputs:r.slice(0,t),backend:a}),s=e({inputs:r.slice(t),backend:a});return e({inputs:[n,s],backend:a})}let s=r.map(e=>e.dtype).reduce((e,t)=>lv(e,t)),i=r.map(e=>e.shape),o=Mf().getBool("WEBGL_PACK")?new x0(r[0].shape,i):new v0(r[0].shape,i);return a.runWebGLProgram(o,r,s)}};var k0={kernelName:Hf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a,o=r.shape.length,l=gb.parseAxisParam(s,r.shape),c=l,u=WE.getAxesPermutation(c,o),d=r;null!=u&&(d=i0({inputs:{x:r},backend:n,attrs:{perm:u}}),c=WE.getInnerMostAxes(c.length,o)),WE.assertAxesAreInnerMostDims("all",c,o);let p,[h,f]=WE.computeOutAndReduceShapes(d.shape,c),m=Q$({inputs:{x:d},backend:n,attrs:{shape:[-1,gb.sizeFromShape(f)]}}),g=e0(m,m.dtype,"all",n);if(i){p=Q$({inputs:{x:g},backend:n,attrs:{shape:WE.expandShapeToKeepDim(h,l)}})}else p=Q$({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=u&&n.disposeIntermediateTensorInfo(d),p}};var S0={kernelName:Gf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a,o=r.shape.length,l=gb.parseAxisParam(s,r.shape),c=l,u=WE.getAxesPermutation(c,o),d=r;null!=u&&(d=i0({inputs:{x:r},backend:n,attrs:{perm:u}}),c=WE.getInnerMostAxes(c.length,o)),WE.assertAxesAreInnerMostDims("any",c,o);let p,[h,f]=WE.computeOutAndReduceShapes(d.shape,c),m=Q$({inputs:{x:d},backend:n,attrs:{shape:[-1,gb.sizeFromShape(f)]}}),g=e0(m,m.dtype,"any",n);if(i){p=Q$({inputs:{x:g},backend:n,attrs:{shape:WE.expandShapeToKeepDim(h,l)}})}else p=Q$({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=u&&n.disposeIntermediateTensorInfo(d),p}},N0=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:a,batchSize:r,outSize:s}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,s];let i="max"===t?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(o,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(i," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}},I0=class{constructor(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,gb.assert(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));let r=e[e.length-1],s=Math.ceil(r/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),a||this.variableNames.push("bestIndicesA");let i,o,l=this.outputShape,c=l.length,u=SJ(c),d=a$("coords",c);if(1===s){o=c+1;let e=SJ(o);i="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(d.join(),", 0);\n        ++").concat(d[c-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(d.join(),", 0);\n        ++").concat(d[c-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(d.join(),", 0);\n        --").concat(d[c-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(d.join(),", 0);\n        --").concat(d[c-2],";")}else o=c,i="\n        ".concat(u," sourceLocR = coords;\n        ++").concat(d[c-1],";\n        ").concat(u," sourceLocG = coords;\n        ++").concat(d[c-2],";\n        ").concat(u," sourceLocA = coords;\n        --").concat(d[c-1],";\n        ").concat(u," sourceLocB = coords;\n        --").concat(d[c-2],";");let p=["x","y","z","w","u","v"].slice(0,o),h="."+p[o-1],f=p.map(e=>"int "+e),m=a$("sourceLocR",o-1).concat("inIdx.r"),g=a$("sourceLocG",o-1).concat("inIdx.g"),y=a$("sourceLocB",o-1).concat("inIdx.b"),b=a$("sourceLocA",o-1).concat("inIdx.a"),v="max"===n?"greaterThan":"lessThan",x=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),")));"),w="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(b.join(),") : 0.)"),k=a?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(k,"\n      void main() {\n        ").concat(u," coords = getOutputCoords();\n        bool hasNextCol = ").concat(d[c-1]," < ").concat(l[c-1]-1,";\n        bool hasNextRow = ").concat(d[c-2]," < ").concat(l[c-2]-1,";\n        ").concat(i,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(h,", sourceLocG").concat(h,",\n          sourceLocB").concat(h,", sourceLocA").concat(h,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(x,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(v,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}};function C0(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=t.shape[0],s=t.shape[1];null!=a&&(r=a.shape[0],s=a.shape[1]);let i=WE.computeOptimalWindowSize(s),o={windowSize:i,inSize:s,batchSize:r,outSize:Math.ceil(s/i)},l=new N0(o,n,null==a),c=[t];null!=a&&c.push(a);let u=e.runWebGLProgram(l,c,"int32");if(1===u.shape[1])return u;let d=C0(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function T0(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=null!=a?a.shape:t.shape,s=r[r.length-1],i=WE.computeOptimalWindowSize(s),o=new I0(r,i,n,null==a),l=null==a?[t]:[t,a],c=e.runWebGLProgram(o,l,"int32");if(c.shape.length===t.shape.length){let a=T0(e,t,n,c);return e.disposeIntermediateTensorInfo(c),a}return c}function E0(e,t,n,a){let r=[n];if(WE.assertAxesAreInnerMostDims("arg"+a.charAt(0).toUpperCase()+a.slice(1),r,t.shape.length),!Mf().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let n=[],s=e.texData.get(t.dataId),i=t;null!==s&&s.isPacked&&(i=e.unpackTensor(t),n.push(i));let[o,l]=WE.computeOutAndReduceShapes(i.shape,r),c=gb.sizeFromShape(l),u=Q$({inputs:{x:i},backend:e,attrs:{shape:[-1,c]}});n.push(u);let d=C0(e,u,a);n.push(d);let p=Q$({inputs:{x:d},backend:e,attrs:{shape:o}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),p}return T0(e,t,a)}var _0={kernelName:qf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s}=a,i=gb.parseAxisParam(s,r.shape),o=WE.getAxesPermutation(i,r.shape.length),l=r,c=[];null!=o&&(l=i0({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=WE.getInnerMostAxes(i.length,l.shape.length)),WE.assertAxesAreInnerMostDims("argMax",[i[0]],l.shape.length);let u=E0(n,l,i[0],"max");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}};var A0={kernelName:Kf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s}=a,i=gb.parseAxisParam(s,r.shape),o=WE.getAxesPermutation(i,r.shape.length),l=r,c=[];null!=o&&(l=i0({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=WE.getInnerMostAxes(i.length,l.shape.length)),WE.assertAxesAreInnerMostDims("argMin",[i[0]],l.shape.length);let u=E0(n,l,i[0],"min");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}},R0=B$({opSnippet:d$+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),F0={kernelName:Xf,backendName:"webgl",kernelFunc:R0},D0=B$({opSnippet:d$+"return log(x + sqrt(x * x + 1.0));"}),M0={kernelName:Yf,backendName:"webgl",kernelFunc:D0},O0=B$({opSnippet:d$+"\n  return atan(x);\n"}),P0={kernelName:Qf,backendName:"webgl",kernelFunc:O0},L0=W$({opSnippet:I$+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+T$+"\n  return result;\n"}),z0={kernelName:Zf,backendName:"webgl",kernelFunc:L0},j0=B$({opSnippet:d$+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),B0={kernelName:Jf,backendName:"webgl",kernelFunc:j0},W0=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");let s=e.filterWidth,i=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;let f="avg"===t,m="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),y="0.0";if(f||(y="-1.0 / 1e-20"),n){let t=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n        const ivec2 pads = ivec2(").concat(p,", ").concat(h,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(t," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?r?m:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let b="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===t&&(b="avgValue / max(count, 1.0)");let v=4*Math.floor(s/4),x=s%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(p,", ").concat(h,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(v,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(v,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(b,");\n      }\n    ")}},V0=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");let s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,p=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;let b="avg"===t,v="0.0";if(b||(v="-1.0 / 1e-20"),n){let t=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(i,", ").concat(o,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(p,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(h,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(t," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?r?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(h," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===t&&(x="avgValue / max(count, 1.0)");let w=4*Math.floor(s/4),k=s%4,S="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(i,", ").concat(o,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(p,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}};var U0={kernelName:$f,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;sJ(r,"avgPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=a;gb.assert(WE.eitherStridesOrDilationsAreOne(i,1),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(1,"'"));let c=WE.computePool2DInfo(r.shape,s,i,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&gb.arraysEqual(c.inShape,c.outShape))return _$({inputs:{x:r},backend:n});let u=new W0(c,"avg",!1);return n.runWebGLProgram(u,[r],"float32")}};var H0={kernelName:tm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a,u=WE.computePool3DInfo(r.shape,s,i,[1,1,1],o,l,c),d=new V0(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}},G0=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=l-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n            wR += ").concat(s,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(i,") {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},q0=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=u-1-e.padInfo.front,f=d-1-e.padInfo.top,m=p-1-e.padInfo.left,g=1/(t*n*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(h,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(r,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(s,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var K0={kernelName:nm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,i=s,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=a,d=WE.computePool3DInfo(i.shape,o,l,[1,1,1],c,u),p=new q0(d);return n.runWebGLProgram(p,[r],i.dtype)}};var X0={kernelName:em,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,i=s;sJ([r,s],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=a,u=WE.computePool2DInfo(i.shape,o,l,1,c),d=new G0(u);return n.runWebGLProgram(d,[r],i.dtype)}};var Y0={kernelName:am,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:s}=t,{transposeA:i,transposeB:o}=a;return l0({a:r,b:s,transposeA:i,transposeB:o,backend:n})}},Q0=class{constructor(e,t,n,a,r,s){this.outputShape=[],this.variableNames=["x","mean","variance"],WE.assertAndGetBroadcastShape(e,t),WE.assertAndGetBroadcastShape(e,n);let i="0.0";null!=a&&(WE.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="1.0";null!=r&&(WE.assertAndGetBroadcastShape(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(i,";\n        float scale = ").concat(o,";\n        float inv = scale * inversesqrt(variance + float(").concat(s,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}},J0=class{constructor(e,t,n,a,r,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],WE.assertAndGetBroadcastShape(e,t),WE.assertAndGetBroadcastShape(e,n);let i="vec4(0.0)";null!=a&&(WE.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=r&&(WE.assertAndGetBroadcastShape(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(i,";\n        vec4 scale = ").concat(o,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(s,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}},Z0={kernelName:Qm,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,mean:s,variance:i,offset:o,scale:l}=t;gb.assert(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),gb.assert(null==o||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),gb.assert(null==l||s.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=a;null==c&&(c=.001);let u=[r,s,i],d=null;null!=o&&(d=o.shape,u.push(o));let p=null;null!=l&&(p=l.shape,u.push(l));let h=Mf().getBool("WEBGL_PACK_NORMALIZATION")?new J0(r.shape,s.shape,i.shape,d,p,c):new Q0(r.shape,s.shape,i.shape,d,p,c);return n.runWebGLProgram(h,u,u[0].dtype)}},$0=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=SJ(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return e1.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),r=e.map((e,t)=>"sourceLoc.".concat(e1[t]," = start[").concat(t,"] + coords.").concat(e1[t],";"));n="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(r.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(n,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")}},e1=["x","y","z","w","u","v"];var t1=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=SJ(this.rank),n=a$("coords",this.rank),a=a$("sourceLoc",this.rank),r=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),s="getChannel(getSource(".concat(a.join(),"), ").concat(r,")"),i="\n      result.x = ".concat(s,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(s,";\n        --").concat(a[this.rank-1],";\n      }\n    "),o=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(s,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(s,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((e,t)=>"start[".concat(t,"]")).join(),");"):e.map((e,t)=>"".concat(a[t]," = ").concat(n[t]," + start[").concat(t,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(i,"\n        ").concat(o,"\n        setOutput(result);\n      }\n    ")}};function n1(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:s,size:i}=a,[o,l]=mE.parseSliceParams(r,s,i);if(mE.assertParamsValid(r,o,l),0===gb.sizeFromShape(l))return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||"string"===r.dtype){let e=n.texData.get(r.dataId),t=WZ(e.values,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,t)}let{isPacked:c}=n.texData.get(r.dataId),u=mE.isSliceContinous(r.shape,o,l);if(c||!u){let e=Mf().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new t1(l):new $0(l),t=[o];return n.runWebGLProgram(e,[r],r.dtype,t)}return n.uploadToGPU(r.dataId),function(e,t,n,a){let r=a.texData.get(e.dataId),s=a.makeTensorInfo(n,e.dtype),i=a.texData.get(s.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=e.dtype;let o=mE.computeFlatOffset(t,gb.computeStrides(e.shape));r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};let l=a.dataRefCount.get(i.slice.origDataId)||1;return a.dataRefCount.set(i.slice.origDataId,l+1),s}(r,o,l,n)}var a1={kernelName:gy,backendName:"webgl",kernelFunc:n1},r1={kernelName:rm,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:s,crops:i}=a;gb.assert(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=s.reduce((e,t)=>e*t),l=WE.getReshaped(r.shape,s,o),c=WE.getPermuted(l.length,s.length),u=WE.getReshapedPermuted(r.shape,s,o),d=WE.getSliceBeginCoords(i,s.length),p=WE.getSliceSize(u,i,s.length),h=[],f=Q$({inputs:{x:r},backend:n,attrs:{shape:l}}),m=i0({inputs:{x:f},backend:n,attrs:{perm:c}}),g=Q$({inputs:{x:m},backend:n,attrs:{shape:u}}),y=n1({inputs:{x:g},backend:n,attrs:{begin:d,size:p}});return h.push(f),h.push(m),h.push(g),h.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}};var s1={kernelName:sm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:s}=t,{size:i}=a,o=n.readSync(r.dataId),l=n.readSync(s.dataId),c=lZ(o,l,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,c)}};var i1={kernelName:im,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{a:r,b:s}=n,i=Mf().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=Mf().getNumber("WEBGL_VERSION");if(a.shouldExecuteOnCPU([r,s])||1===o){let e=a.texData.get(r.dataId).values,t=a.texData.get(s.dataId).values,[n,i]=uZ(r.shape,s.shape,e,t,r.dtype),o=a.makeTensorInfo(i,r.dtype);return a.texData.get(o.dataId).values=n,o}return t=i?new E$("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,s.shape,!1):new C$("\n  return float(int(a.r) & int(b.r));\n",r.shape,s.shape),a.runWebGLProgram(t,[r,s],r.dtype)}};var o1={kernelName:lm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,s=n.readSync(a.dataId),i=n.readSync(r.dataId),o=WE.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},l1=W$({opSnippet:"return float(a != b);",cpuKernelImpl:RZ,dtype:"bool"}),c1={kernelName:Lg,backendName:"webgl",kernelFunc:l1};function u1(e){let{inputs:t,backend:n}=e,{input:a}=t;return _$({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.real},backend:n})}var d1={kernelName:$g,backendName:"webgl",kernelFunc:u1};var p1={kernelName:cm,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a,attrs:r}=t,{x:s}=n,{dtype:i}=r;if("complex64"===i){if("complex64"===s.dtype)return _$({inputs:{x:s},backend:a});let t=JS(s.shape),n=e({inputs:{x:s},backend:a,attrs:{dtype:"float32"}}),r=R$({inputs:{real:n,imag:t},backend:a});return t.dispose(),a.disposeIntermediateTensorInfo(n),r}if("complex64"===s.dtype){let t=u1({inputs:{input:s},backend:a}),n=e({inputs:{x:t},backend:a,attrs:{dtype:i}});return a.disposeIntermediateTensorInfo(t),n}if(!gb.hasEncodingLoss(s.dtype,i)){let e=_$({inputs:{x:s},backend:a});return{dataId:e.dataId,shape:e.shape,dtype:i}}if(a.shouldExecuteOnCPU([s])){let e=a.texData.get(s.dataId).values,[t,n,r]=dZ(e,s.shape,s.dtype,i);return a.makeTensorInfo(t,n,r)}if("int32"===i)return function(e,t){let n=new u$(e.shape,"return float(int(x));"),a=t.runWebGLProgram(n,[e],"int32");return{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}(s,a);if("bool"===i){let e=a.makeTensorInfo([],"bool",gb.getTypedArrayFromDType("bool",1)),t=l1({inputs:{a:s,b:e},backend:a});return a.disposeIntermediateTensorInfo(e),t}throw new Error("Error in Cast: failed to cast ".concat(s.dtype," to ").concat(i))}},h1="return ceil(x);",f1=B$({opSnippet:h1,packedOpSnippet:h1,cpuKernelImpl:pZ}),m1={kernelName:um,backendName:"webgl",kernelFunc:f1},g1=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}},y1=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}};var b1={kernelName:dm,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{clipValueMin:i,clipValueMax:o}=r;t=Mf().getBool("WEBGL_PACK_CLIP")?new y1(s.shape):new g1(s.shape);let l=[[i],[o]];return a.runWebGLProgram(t,[s],s.dtype,l)}},v1=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}};function x1(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var w1={kernelName:hm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=n.texData.get(a.dataId),s=new v1(a.shape),i=[x1(a,r.complexTensorInfos.real),x1(a,r.complexTensorInfos.imag)];return n.runWebGLProgram(s,i,i[0].dtype)}},k1=class{constructor(e){this.outputShape=[],this.outputShape=WE.computeOutShape(e,1),this.variableNames=e.map((e,t)=>"T".concat(t));let t=new Array(e.length-1);t[0]=e[0][1];for(let s=1;s<t.length;s++)t[s]=t[s-1]+e[s][1];let n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let s=1;s<t.length;s++){let e=t[s-1];n.push("else if (yC < ".concat(t[s],") setOutput(getT").concat(s,"(yR, yC-").concat(e,"));"))}let a=t.length,r=t[t.length-1];n.push("else setOutput(getT".concat(a,"(yR, yC-").concat(r,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}},S1=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=WE.computeOutShape(e,t);let n=this.outputShape,a=n.length,r=SJ(a),s=a$("coords",a),i=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((e,t)=>"T".concat(t));let o=new Array(e.length-1);o[0]=e[0][t];for(let f=1;f<o.length;f++)o[f]=o[f-1]+e[f][t];let l=i[t],c=i.slice(-2),u=i.join(),d="if (".concat(l," < ").concat(o[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(c.join(),"));\n        }");for(let f=1;f<o.length;f++){let e=o[f-1];d+="\n        if (".concat(l," < ").concat(o[f],"  && ").concat(l," >= ").concat(o[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(N1(i,l,e),"),\n            vec2(").concat(N1(c,l,e),"));\n        }")}let p=o.length,h=o[o.length-1];d+="\n        return getChannel(\n          getT".concat(p,"(").concat(N1(i,l,h),"),\n          vec2(").concat(N1(c,l,h),"));"),this.userCode="\n      float getValue(".concat(i.map(e=>"int "+e),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(r," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(s,"), 0., 0., 0.);\n\n        ").concat(s[a-1]," = ").concat(s[a-1]," + 1;\n        if (").concat(s[a-1]," < ").concat(n[a-1],") {\n          result.g = getValue(").concat(s,");\n        }\n\n        ").concat(s[a-2]," = ").concat(s[a-2]," + 1;\n        if (").concat(s[a-2]," < ").concat(n[a-2],") {\n          result.a = getValue(").concat(s,");\n        }\n\n        ").concat(s[a-1]," = ").concat(s[a-1]," - 1;\n        if (").concat(s[a-2]," < ").concat(n[a-2]," &&\n            ").concat(s[a-1]," < ").concat(n[a-1],") {\n          result.b = getValue(").concat(s,");\n        }\n        setOutput(result);\n      }\n    ")}};function N1(e,t,n){let a=e.indexOf(t);return e.map((e,t)=>t===a?"".concat(e," - ").concat(n):e).join()}function I1(e){let{inputs:t,backend:n}=e,{input:a}=t;return _$({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.imag},backend:n})}var C1={kernelName:ag,backendName:"webgl",kernelFunc:I1};function T1(e,t,n){let a=e[0].dtype;if("complex64"===a){let a=e.map(e=>u1({inputs:{input:e},backend:n})),r=e.map(e=>I1({inputs:{input:e},backend:n})),s=T1(a,t,n),i=T1(r,t,n),o=R$({inputs:{real:s,imag:i},backend:n});return a.forEach(e=>n.disposeIntermediateTensorInfo(e)),r.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),o}let r=n.shouldExecuteOnCPU(e);if("string"===a&&(r=!0),r){let r=e.map(e=>{let a=[-1,gb.sizeFromShape(e.shape.slice(t))];return Q$({inputs:{x:e},backend:n,attrs:{shape:a}})}),s=r.map(e=>({vals:n.readSync(e.dataId),shape:e.shape})),i=WE.computeOutShape(r.map(e=>e.shape),1),o=1===r[0].shape[0],l=hZ(s,i,a,o),c=WE.computeOutShape(e.map(e=>e.shape),t),u=n.makeTensorInfo(c,a,l);return r.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}let s=e.filter(e=>gb.sizeFromShape(e.shape)>0),i=Mf().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(1===s.length){let t=i?new u$(e[0].shape,m$):new g$(e[0].shape,m$);return n.runWebGLProgram(t,e,a)}let o=Mf().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>o){let e=[];for(let r=0;r<s.length;r+=o){let a=s.slice(r,r+o);e.push(T1(a,t,n))}let a=T1(e,t,n);for(let t of e)n.disposeIntermediateTensorInfo(t);return a}if(i){let e=new S1(s.map(e=>e.shape),t);return n.runWebGLProgram(e,s,a)}let{tensors2D:l,outShape:c}=function(e,t,n){let a=WE.computeOutShape(e.map(e=>e.shape),t);return{tensors2D:e.map(e=>Q$({inputs:{x:e},attrs:{shape:[-1,gb.sizeFromShape(e.shape.slice(t))]},backend:n})),outShape:a}}(s,t,n),u=new k1(l.map(e=>e.shape)),d=n.runWebGLProgram(u,l,a);l.forEach(e=>n.disposeIntermediateTensorInfo(e));let p=Q$({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),p}function E1(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a,s=gb.parseAxisParam(r,t[0].shape)[0],i=t.map(e=>e.shape);WE.assertParamsConsistent(i,s);let o=WE.computeOutShape(t.map(e=>e.shape),s);if(0===gb.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>gb.sizeFromShape(e.shape)>0);return 1===l.length?_$({inputs:{x:l[0]},backend:n}):T1(l,s,n)}var _1={kernelName:fm,backendName:"webgl",kernelFunc:E1},A1=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;let s=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,y=m?2:3,b=m?3:1,v="",x="";n&&(v=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");let w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(v,"\n\n      const ivec2 strides = ivec2(").concat(o,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(s,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(h,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(h,") *\n                    getW(wR, wC, ").concat(h,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(h,", xR, xC) *\n                    getW(wR, wC, ").concat(h,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(h,", d2),\n                getW(wR, wC, ").concat(h," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(h,"),\n                  getX(batch, xR, xC, ").concat(h," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(h,", xR, xC),\n                  getX(batch, ").concat(h," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(h,", d2),\n                getW(wR, wC, ").concat(h," + 1, d2),\n                getW(wR, wC, ").concat(h," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(h,"),\n                  getX(batch, xR, xC, ").concat(h," + 1),\n                  getX(batch, xR, xC, ").concat(h," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(h,", xR, xC),\n                  getX(batch, ").concat(h," + 1, xR, xC),\n                  getX(batch, ").concat(h," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}},R1=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,p=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(r,", ").concat(s,", ").concat(i,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(o,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(h,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(h,") *\n                  getW(wF, wR, wC, ").concat(h,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(h,"),\n                  getX(batch, xF, xR, xC, ").concat(h," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(h,", d2),\n                  getW(wF, wR, wC, ").concat(h," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(h,"),\n                  getX(batch, xF, xR, xC, ").concat(h," + 1),\n                  getX(batch, xF, xR, xC, ").concat(h," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(h,", d2),\n                  getW(wF, wR, wC, ").concat(h," + 1, d2),\n                  getW(wF, wR, wC, ").concat(h," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},F1=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=_J(this.outputShape.length);let s=e.padInfo.left,i=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,u=c,d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<c;m++)d+="\n           vec4 xTexelC".concat(2*m,";\n           int xTexelC").concat(2*m,"Ready;\n           vec4 xTexelC").concat(2*m+1,";\n           int xTexelC").concat(2*m+1,"Ready;\n           vec4 xC").concat(m,";");d+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<c;m++)d+="\n           xTexelC".concat(2*m," = vec4(0.0);\n           xTexelC").concat(2*m,"Ready = 0;\n           xTexelC").concat(2*m+1," = vec4(0.0);\n           xTexelC").concat(2*m+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(u+1)/2;m++){let t=2*m;if(d+="\n           xC = xCCorner + ".concat(t*o,";\n           "),1===i){if(t<c&&(s%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n               "),d+=1===o&&t>0?"\n                 xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                   } else {\n                     xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xC").concat(t," = xTexelC").concat(t,";\n                 "),t+1<c)){let e=s%2===0?gb.nearestLargerEven(o):o;o%2===0&&s%2===1||o%2!==0&&s%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                     xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(t+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(t+1,"Ready = 1;\n                   }\n                   "),d+=o>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                     } else {\n                      xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                     }\n                     "):"\n                     xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                     ")):d+=1===e?"\n                     xC".concat(t+1," = xTexelC").concat(t,";\n                     "):"\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                       xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(t+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(t+1,"Ready = 1;\n                     }\n\n                     xC").concat(t+1," = xTexelC").concat(t+1,";\n                     ")}}else t<c&&(s%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n               "),t+1<c&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(\n                   xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n               "),t+1<c&&(d+="\n                   xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                 "))));t<c&&(d+="\n             wTexel = getW(r, ".concat(t,", d1, d2);\n             dotProd += xC").concat(t,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(t,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),t+1<c&&(d+="\n               wTexel = getW(r, ".concat(t+1,", d1, d2);\n               dotProd += xC").concat(t+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(t+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let p="",h="";n&&(p=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):r?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),h="result = activation(result);");let f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(p,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(f,"\n         ").concat(h,"\n         setOutput(result);\n       }\n     ")}},D1=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=_J(this.outputShape.length);let{dataFormat:n}=t,a=oJ(),r="channelsLast"===n,s=r?1:2,i=r?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {"),l="";for(let c=0;c<=1;c++)for(let e=0;e<=1;e++)l+="\n          blockIndex = rc.z + ".concat(e,";\n          pos = rc.y + ").concat(c,";\n\n          ").concat(o,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(s,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(i,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(r,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(a.output," = result;\n      }\n    ")}};function M1(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function O1(e){let t,{x:n,filter:a,convInfo:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:c=null}=e,u=n.shape,d=s.texData.get(n.dataId),p=r.inChannels,h=u[0]*u[1]*u[2],f=r.outChannels,m="channelsLast"===r.dataFormat,g=!1,y=[];if(null!=o){let e=M1(o.shape,m);null!=e&&(o=Q$({inputs:{x:o},backend:s,attrs:{shape:e}}),y.push(o))}if(null!=i){let e=M1(i.shape,m);null!=e&&(i=Q$({inputs:{x:i},backend:s,attrs:{shape:e}}),y.push(i))}if((1!==h&&1!==f||!(p>1e3))&&d.isPacked&&m&&null!=d.texture&&u[2]%2!==0&&gb.arraysEqual(d.shape.slice(-3),u.slice(-3))){let e=u[0]*u[1]*(u[2]+1),p={dataId:n.dataId,shape:[1,e,r.inChannels],dtype:n.dtype},h=d.shape;d.shape=d.shape.slice(),d.shape[d.shape.length-2]++,gb.assert(KQ(d.shape,p.shape),()=>"packed reshape ".concat(d.shape," to ").concat(p.shape," isn't free"));let f=Q$({inputs:{x:a},backend:s,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(f);let m=l0({a:p,b:f,backend:s,transposeA:false,transposeB:g,bias:i,activation:c,preluActivationWeights:o,leakyreluAlpha:l}),b=s.texData.get(m.dataId);gb.assert(b.isPacked,()=>"batchMatMul result is expected to be packed"),d.shape=h,b.shape=r.outShape,t=_$({inputs:{x:m},backend:s}),t.shape=r.outShape,y.push(m)}else{let e=r.outHeight*r.outWidth,u=Q$({inputs:{x:n},backend:s,attrs:{shape:m?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),d=Q$({inputs:{x:a},backend:s,attrs:{shape:[1,r.inChannels,r.outChannels]}}),p=l0({a:m?u:d,b:m?d:u,transposeA:!m,transposeB:g,backend:s,bias:i,activation:c,preluActivationWeights:o,leakyreluAlpha:l});t=Q$({inputs:{x:p},backend:s,attrs:{shape:r.outShape}}),y.push(u),y.push(d),y.push(p)}for(let b of y)s.disposeIntermediateTensorInfo(b);return t}function P1(e){let{x:t,filter:n,convInfo:a,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}=e,{filterWidth:c,filterHeight:u,inChannels:d,outWidth:p,outHeight:h,dataFormat:f}=a,m="channelsLast"===f,g=c*u*d,y=h*p,b=[a.batchSize,g,y],v=[];if(null!=i){let e=M1(i.shape,m);null!=e&&(i=Q$({inputs:{x:i},backend:r,attrs:{shape:e}}),v.push(i))}if(null!=s){let e=M1(s.shape,m);null!=e&&(s=Q$({inputs:{x:s},backend:r,attrs:{shape:e}}),v.push(s))}let x=Q$({inputs:{x:n},backend:r,attrs:{shape:[1,g,gb.sizeFromShape(n.shape)/g]}});v.push(x);let w=new D1(b,a),k=[t.shape,[a.padInfo.top,a.padInfo.left],[a.strideHeight,a.strideWidth],[a.dilationHeight,a.dilationWidth],[a.inChannels],[a.filterWidth*a.inChannels],[a.outWidth]],S=r.runWebGLProgram(w,[t],"float32",k),N=Q$({inputs:{x:S},backend:r,attrs:{shape:b}});v.push(S),v.push(N);let I=null!=s,C=null!=i,T="leakyrelu"===l,E=l?V$(l,!0):null,_=new U$(m?N.shape:x.shape,m?x.shape:N.shape,m?[a.batchSize,y,a.outChannels]:[a.batchSize,a.outChannels,y],!0,!1,I,E,C,T),A=m?[N,x]:[x,N];if(s&&A.push(s),C&&A.push(i),T){let e=r.makeTensorInfo([],"float32",gb.createScalarValue(o,"float32"));A.push(e),v.push(e)}let R=r.runWebGLProgram(_,A,"float32"),F=Q$({inputs:{x:R},backend:r,attrs:{shape:a.outShape}});v.push(R);for(let D of v)r.disposeIntermediateTensorInfo(D);return F}var L1={kernelName:mm,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s,filter:i}=n,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:d}=r,p=WE.convertConv2DDataFormat(c),h=WE.computeConv2DInfo(s.shape,i.shape,o,u,l,d,!1,p);if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===p&&Mf().getBool("WEBGL_EXP_CONV")){let e=new F1(h),n=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];t=a.runWebGLProgram(e,[s,i],"float32",n)}else if(Mf().getBool("WEBGL_CONV_IM2COL"))t=P1({x:s,filter:i,convInfo:h,backend:a});else{let e=new A1(h);t=a.runWebGLProgram(e,[s,i],"float32")}else t=O1({x:s,filter:i,convInfo:h,backend:a});let f=Q$({inputs:{x:t},backend:a,attrs:{shape:h.outShape}});return a.disposeIntermediateTensorInfo(t),f}},z1=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,s="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(s?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},j1=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,s="channelsLast"===e.dataFormat,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=s?1:2,c=s?2:3,u=s?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(s,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},B1=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.padInfo.front,s=e.padInfo.top,i=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(r,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(s,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(i,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},W1=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(o,", ").concat(l,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(r,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(s,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var V1={kernelName:gm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:s}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=a,d=WE.convertConv2DDataFormat(l),p=WE.computeConv2DInfo(r.shape,u,i,1,o,c,!1,d),h=new z1(p);return n.runWebGLProgram(h,[r,s],"float32")}},U1=class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=_J(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,a=t-1-e.padInfo.top,r=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(r,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}};var H1={kernelName:ym,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:s}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=a,d=WE.convertConv2DDataFormat(c),p=WE.computeConv2DInfo(i,s.shape,o,1,l,u,!1,d);if(Mf().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){let e=[[p.strideHeight,p.strideWidth]],t=new U1(p);return n.runWebGLProgram(t,[r,s],"float32",e)}{let e=new j1(p);return n.runWebGLProgram(e,[r,s],"float32")}}};var G1={kernelName:bm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dilations:l}=a,c=WE.computeConv3DInfo(r.shape,s.shape,i,l,o),u=new R1(c);return n.runWebGLProgram(u,[r,s],"float32")}};var q1={kernelName:vm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:s}=t,{strides:i,pad:o,filterShape:l}=a,c=WE.computeConv3DInfo(r.shape,l,i,1,o),u=new B1(c);return n.runWebGLProgram(u,[r,s],"float32")}};var K1,X1={kernelName:xm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:s}=t,{pad:i,strides:o,inputShape:l}=a,c=WE.computeConv3DInfo(l,s.shape,o,1,i),u=new W1(c);return n.runWebGLProgram(u,[r,s],"float32")}},Y1=B$({opSnippet:j$+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(T$,"\n  return result;\n")}),Q1={kernelName:wm,backendName:"webgl",kernelFunc:Y1},J1=B$({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Z1={kernelName:km,backendName:"webgl",kernelFunc:J1},$1=class{constructor(e,t,n,a,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[s,i,o,l]=e,[c]=t,[u,d]=n;this.outputShape=[c,u,d,l];let p="bilinear"===a?1:0,[h,f]=["".concat(i-1,".0"),"".concat(o-1,".0")],[m,g,y]=u>1?["".concat((i-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(h," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(h)],[b,v,x]=d>1?["".concat((o-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(b,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(v,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(h," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(p," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}},e2={kernelName:Im,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{image:r,boxes:s,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=a,u=new $1(r.shape,s.shape,o,l,c);return n.runWebGLProgram(u,[r,s,i],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(K1||(K1={}));var t2=class{constructor(e,t,n,a){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let r=this.outputShape.length,s=this.op===K1.Prod?"1.0":"0.0",i=n?s:"getX(".concat(n2(r,"coords",this.op),")"),o=this.outputShape[this.outputShape.length-1],l="",c="";n?(l=a?"end != ".concat(o-1):"end != 0",c=a?"end + 1":"end - 1"):(l=a?"end + pow2 < ".concat(o):"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(SJ(r)," coords = getOutputCoords();\n        int end = ").concat(a2(r,"coords",this.op),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(c,";\n          ").concat(a2(r,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(n2(r,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}};function n2(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function a2(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function r2(e,t,n,a,r,s){let i=t.shape.length,o=WE.getAxesPermutation([a],i),l=t;null!=o&&(l=i0({inputs:{x:t},backend:n,attrs:{perm:o}}));let c=WE.getInnerMostAxes(1,i)[0];if(c!==i-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," but got axis=").concat(a));let u=l.shape[c],d=_$({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(u))-1;p++){let t=new t2(e,l.shape,!1,s),a=[[p]],r=d;d=n.runWebGLProgram(t,[d],d.dtype,a),n.disposeIntermediateTensorInfo(r)}if(r){let t=new t2(e,l.shape,r,s),a=d;d=n.runWebGLProgram(t,[d],d.dtype),n.disposeIntermediateTensorInfo(a)}if(null!=o){let e=i0({inputs:{x:d},backend:n,attrs:{perm:WE.getUndoAxesPermutation(o)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),e}return d}var s2={kernelName:Sm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,exclusive:i,reverse:o}=a;return r2(K1.Prod,r,n,s,i,o)}};var i2={kernelName:Nm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,exclusive:i,reverse:o}=a;return r2(K1.Sum,r,n,s,i,o)}};var o2={kernelName:Cm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:s}=t,{size:i,binaryOutput:o}=a;if(1===r.shape.length){let e=n.readSync(r.dataId),t=n.readSync(s.dataId),a=lZ(e,t,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,a)}if(2===r.shape.length){let e=n.bufferSync(r),t=n.bufferSync(s),a=cZ(e,t,i,o);return n.makeTensorInfo(a.shape,s.dtype,a.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank".concat(r.shape.length,"."))}},l2=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};var c2={kernelName:Tm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockSize:s,dataFormat:i}=a,o=r.shape[0],l=("NHWC"===i?r.shape[1]:r.shape[2])*s,c=("NHWC"===i?r.shape[2]:r.shape[3])*s,u=("NHWC"===i?r.shape[3]:r.shape[1])/(s*s),d=new l2("NHWC"===i?[o,l,c,u]:[o,u,l,c],s,i);return n.runWebGLProgram(d,[r],r.dtype)}},u2=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=_J(this.outputShape.length);let s=e.filterHeight,i=e.filterWidth,o=e.outChannels/e.inChannels,l="",c="";n&&(l=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);");let u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(s,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}},d2=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=_J(this.outputShape.length);let s=e.outChannels/e.inChannels,i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u,p="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<u;g++)p+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");p+="\n    for (int r = 0; r < ".concat(c,"; r++) {\n      ");for(let g=0;g<u;g++)p+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");p+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(d+1)/2;g++){let e=2*g;if(p+="\n          xC = xCCorner + ".concat(e*l,";\n          "),1===o){if(e<u&&(i%2===1?(p+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n              "),p+=1===l&&e>0?"\n                xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                  } else {\n                    xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                  }\n                  ")):p+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xC").concat(e," = xTexelC").concat(e,";\n                "),e+1<u)){let t=i%2===0?gb.nearestLargerEven(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(p+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                    xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(e+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(e+1,"Ready = 1;\n                  }\n                  "),p+=l>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                    } else {\n                     xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                    }\n                    "):"\n                    xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                    ")):p+=1===t?"\n                    xC".concat(e+1," = xTexelC").concat(e,";\n                    "):"\n                    xCOffset = xC + ".concat(t,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                      xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(e+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(e+1,"Ready = 1;\n                    }\n\n                    xC").concat(e+1," = xTexelC").concat(e+1,";\n                    ")}}else e<u&&(i%2===1?(p+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n              "),e+1<u&&(p+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                "))):(p+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(\n                  xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n              "),e+1<u&&(p+="\n                  xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                "))));e<u&&(p+="\n            wTexel = getW(r, ".concat(e,", d1, q);\n            dotProd += xC").concat(e," * vec4(wTexel.xz, wTexel.xz);\n          "),e+1<u&&(p+="\n              wTexel = getW(r, ".concat(e+1,", d1, q);\n              dotProd += xC").concat(e+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}p+="\n    }\n  ",p+="\n      }\n    ";let h="",f="";n&&(h=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),f="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(h,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(p,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}};var p2={kernelName:Em,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=a,u=l;null==u&&(u=[1,1]),gb.assert(WE.eitherStridesOrDilationsAreOne(i,u),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(u,"'"));let d,p=WE.computeConv2DInfo(r.shape,s.shape,i,u,o,c,!0);d=Mf().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?new d2(p):new u2(p);let h=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return n.runWebGLProgram(d,[r,s],"float32",h)}},h2=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(s," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},f2=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,s=t-1-e.padInfo.top,i=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(o,"; dm++) {\n              int d2 = d1 * ").concat(o," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var m2={kernelName:_m,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=a,d=WE.computeConv2DInfo(r.shape,u,i,o,l,c,!0),p=new h2(d);return n.runWebGLProgram(p,[r,s],"float32")}};var g2={kernelName:Am,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=a,d=WE.computeConv2DInfo(u,s.shape,i,o,l,c,!0),p=new f2(d);return n.runWebGLProgram(p,[r,s],"float32")}},y2=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}};var b2={kernelName:Rm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=[...a.shape,...a.shape],s=gb.sizeFromShape(a.shape),i=Q$({inputs:{x:a},backend:n,attrs:{shape:[s]}}),o=new y2(s),l=n.runWebGLProgram(o,[i],i.dtype),c=Q$({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}},v2=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:a,strideHeight:r,strideWidth:s,filterHeight:i,filterWidth:o,dilationHeight:l,dilationWidth:c}=e,{top:u,left:d}=a;this.userCode="\n      const ivec2 strides = ivec2(".concat(r,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(i,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(o,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}};var x2={kernelName:Fm,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s,filter:i}=n,{strides:o,pad:l,dilations:c}=r,u=WE.computeDilation2DInfo(s.shape,i.shape,o,l,"NHWC",c),d=new v2(u);t=a.runWebGLProgram(d,[s,i],"float32");let p=Q$({inputs:{x:t},backend:a,attrs:{shape:u.outShape}});return a.disposeIntermediateTensorInfo(t),p}};var w2={kernelName:Lm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{equation:r}=a,s=t,{allDims:i,summedDims:o,idDims:l}=WE.decodeEinsumEquation(r,s.length);WE.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=WE.getEinsumComputePath(o,l),d=u.length,p=null,h=i.length,f=[];for(let m=0;m<d;++m){for(let e of u[m]){let t,{permutationIndices:a,expandDims:r}=WE.getEinsumPermutation(h,l[e]);WE.isIdentityPermutation(a)?t=s[e]:(t=i0({inputs:{x:s[e]},backend:n,attrs:{perm:a}}),f.push(t));let i=t.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);gb.arraysEqual(t.shape,i)||(t=Q$({inputs:{x:t},backend:n,attrs:{shape:i}}),f.push(t)),null===p?p=t:(p=X$({inputs:{a:t,b:p},backend:n}),f.push(p))}m<d-1&&(c[m]>=0&&(p=r0({inputs:{x:p},backend:n,attrs:{axis:c[m]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}},k2=B$({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),S2={kernelName:zm,backendName:"webgl",kernelFunc:k2},N2={kernelName:jm,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{dy:a,y:r}=t,s=Mf().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new E$("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",a.shape,r.shape):new C$("return (b >= 0.0) ? a : a * (b + 1.0);",a.shape,r.shape);return n.runWebGLProgram(s,[a,r],a.dtype)}},I2=W$({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:fZ}),C2={kernelName:Wm,backendName:"webgl",kernelFunc:I2},T2=B$({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(WE.ERF_P,";\n  float a1 = ").concat(WE.ERF_A1,";\n  float a2 = ").concat(WE.ERF_A2,";\n  float a3 = ").concat(WE.ERF_A3,";\n  float a4 = ").concat(WE.ERF_A4,";\n  float a5 = ").concat(WE.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),E2={kernelName:Bm,backendName:"webgl",kernelFunc:T2},_2=B$({opSnippet:j$+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:mZ,dtype:"float32"}),A2={kernelName:Vm,backendName:"webgl",kernelFunc:_2};function R2(e){let{inputs:t,attrs:n,backend:a}=e,{dim:r}=n,{input:s}=t,i=s.shape.length,o=s.shape.slice(),l=r;return r<0&&(gb.assert(-(i+1)<=r,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),l=i+r+1),o.splice(l,0,1),Q$({inputs:{x:s},backend:a,attrs:{shape:o}})}var F2={kernelName:Um,backendName:"webgl",kernelFunc:R2},D2="return exp(x) - 1.0;",M2=B$({opSnippet:D2,packedOpSnippet:D2,cpuKernelImpl:gZ}),O2={kernelName:Hm,backendName:"webgl",kernelFunc:M2},P2=class{constructor(e,t,n){this.variableNames=["real","imag"];let a=t[1];this.outputShape=t;let r,s=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=n?"".concat(a,".0"):"1.0";if("real"===e)r="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));r="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(s,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(r,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}};function L2(e,t,n){let a=n.texData.get(e.dataId),r=gb.sizeFromShape(e.shape),s=e.shape[e.shape.length-1],i=Q$({inputs:{x:e},backend:n,attrs:{shape:[r/s,s]}}),o=i.shape,l=new P2("real",o,t),c=new P2("imag",o,t),u=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:o},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:o}],d=n.runWebGLProgram(l,u,"float32"),p=n.runWebGLProgram(c,u,"float32"),h=R$({inputs:{real:d,imag:p},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p);let f=Q$({inputs:{x:h},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(h),f}var z2={kernelName:Gm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t;return L2(a,!1,n)}},j2=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}};function B2(e){let{backend:t,attrs:n}=e,{shape:a,value:r}=n,{dtype:s}=n;if(s=s||gb.inferDtype(r),"string"===s){let e=gb.getArrayFromDType(s,gb.sizeFromShape(a));return e.fill(r),t.makeTensorInfo(a,s,e)}{let e=new j2(a,r),n=[[r]];return t.runWebGLProgram(e,[],s,n)}}var W2,V2={kernelName:qm,backendName:"webgl",kernelFunc:B2},U2=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}},H2={kernelName:Km,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{image:a}=t,r=n,s=new U2(a.shape);return r.runWebGLProgram(s,[a],a.dtype)}},G2="return floor(x);",q2=B$({opSnippet:G2,packedOpSnippet:G2,cpuKernelImpl:yZ}),K2={kernelName:Xm,backendName:"webgl",kernelFunc:q2},X2=W$({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Y2={kernelName:Ym,backendName:"webgl",kernelFunc:X2},Q2=class{constructor(e){this.variableNames=["A"];let t=oJ(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(a,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}},J2=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=oJ(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(a,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},Z2={kernelName:Zy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{pixels:r}=t,{numChannels:s}=a,i="undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement,[l,c]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,s];if(o||i){let e=Mf().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==W2||e!==$2)&&($2=e,W2=document.createElement("canvas").getContext("2d",{willReadFrequently:$2})),W2.canvas.width=l,W2.canvas.height=c,W2.drawImage(r,0,0,l,c),r=W2.canvas}let p=n.makeTensorInfo(u,"int32");n.texData.get(p.dataId).usage=ZY.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),r);let h=Mf().getBool("WEBGL_PACK")?new J2(d):new Q2(d),f=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),f}},$2=Mf().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var e3={kernelName:tb,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s,filter:i,bias:o,preluActivationWeights:l}=n,{strides:c,pad:u,dataFormat:d,dilations:p,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=r,g=WE.convertConv2DDataFormat(d),y=WE.computeConv2DInfo(s.shape,i.shape,c,p,u,h,!1,g),b=[],v=null!=o,x=null!=l,w="leakyrelu"===f,k=()=>{let e=[s,i],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){let t=Q$({inputs:{x:e},backend:a,attrs:{shape:[e.shape[0],1,1]}});return b.push(t),t}return e};if(v&&e.push(t(o,d)),x&&e.push(t(l,d)),w){let t=a.makeTensorInfo([],"float32",gb.createScalarValue(m,"float32"));e.push(t),b.push(t)}return e};if(1!==y.filterHeight||1!==y.filterWidth||1!==y.dilationHeight||1!==y.dilationWidth||1!==y.strideHeight||1!==y.strideWidth||"SAME"!==y.padInfo.type&&"VALID"!==y.padInfo.type)if(y.strideWidth<=2&&"channelsLast"===g&&Mf().getBool("WEBGL_EXP_CONV")){let e=f?V$(f,!0):null,n=new F1(y,v,e,x,w),r=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],s=k();t=a.runWebGLProgram(n,s,"float32",r)}else if(Mf().getBool("WEBGL_CONV_IM2COL"))t=P1({x:s,filter:i,convInfo:y,backend:a,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});else{let e=f?V$(f,!1):null,n=new A1(y,v,e,x,w),r=k();t=a.runWebGLProgram(n,r,"float32")}else t=O1({x:s,filter:i,convInfo:y,backend:a,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});let S=Q$({inputs:{x:t},backend:a,attrs:{shape:y.outShape}});return b.push(t),b.forEach(e=>a.disposeIntermediateTensorInfo(e)),S}};var t3={kernelName:nb,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:p,leakyreluAlpha:h}=a,f=[],m=u;null==m&&(m=[1,1]),gb.assert(WE.eitherStridesOrDilationsAreOne(l,m),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(l," and dilations '").concat(m,"'"));let g,y=WE.computeConv2DInfo(r.shape,s.shape,l,m,c,d,!0),b=Mf().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,v=p?V$(p,b):null,x=[r,s],w=null!=i,k=null!=o,S="leakyrelu"===p;if(w&&x.push(i),k&&x.push(o),S){let e=n.makeTensorInfo([],"float32",gb.createScalarValue(h,"float32"));x.push(e),f.push(e)}g=b?new d2(y,w,v,k,S):new u2(y,w,v,k,S);let N=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],I=n.runWebGLProgram(g,x,"float32",N);return f.forEach(e=>n.disposeIntermediateTensorInfo(e)),I}},n3=class{constructor(e,t,n,a){this.sliceDim=e,this.strides=t,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=n;let r=SJ(n.length),s="\n    int index;";for(let i=0;i<this.sliceDim;i++)s+="\n          index = round(getIndices(coords[0], ".concat(i,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[i],";\n          flattenIndex += index * ").concat(this.strides[i],";");this.userCode="\n         void main() {\n          ".concat(r," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(s,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}};var a3={kernelName:Zm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:a,indices:r}=t,s=r.shape,i=s[s.length-1],o=gb.sizeFromShape(a.shape),[l,c,u,d]=WE.prepareAndValidate(a,r),p=Q$({inputs:{x:r},backend:n,attrs:{shape:[c,i]}}),h=Q$({inputs:{x:a},backend:n,attrs:{shape:[gb.sizeFromShape(a.shape)/u,u]}});if(n.shouldExecuteOnCPU([a,r])||"string"===a.dtype){let e=n.readSync(r.dataId),t=n.bufferSync(a),s=bZ(e,t,a.dtype,c,i,u,d,a.shape,o);return n.makeTensorInfo(l,a.dtype,s.values)}let f=new n3(i,d,[c,u],a.shape),m=n.runWebGLProgram(f,[h,p],h.dtype),g=Q$({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}},r3=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=SJ(this.rank),a=function(e){let t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let a=0;a<e.length;a++)2===a?n.push("index"):n.push("".concat(t[a]));return n.join()}(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}};function s3(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,indices:s}=t,{axis:i,batchDims:o}=a,l=gb.parseAxisParam(i,r.shape)[0];if(Mf().get("DEBUG")){let e=n.readSync(s.dataId),t=r.shape[l];for(let n=0;n<e.length;++n){let a=e[n];gb.assert(a<=t-1&&a>=0,()=>"GatherV2: the index value ".concat(a," is not in [0, ").concat(t-1,"]"))}}let c=WE.segment_util.collectGatherOpShapeInfo(r,s,l,o),u=gb.sizeFromShape(s.shape),d=[],p=Q$({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),h=Q$({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(p),d.push(h);let f=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,s])||"string"===r.dtype){let e=n.bufferSync(h),t=n.bufferSync(p),a=vZ(t,e,f);return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(c.outputShape,a.dtype,a.values)}let m=new r3(p.shape,f),g=n.runWebGLProgram(m,[p,h],p.dtype);d.push(g);let y=Q$({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}var i3={kernelName:Jm,backendName:"webgl",kernelFunc:s3},o3=W$({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:xZ,dtype:"bool"}),l3={kernelName:$m,backendName:"webgl",kernelFunc:o3},c3=W$({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:wZ}),u3={kernelName:eg,backendName:"webgl",kernelFunc:c3};var d3={kernelName:ng,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t;return L2(a,!0,n)}},p3=B$({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),h3={kernelName:rg,backendName:"webgl",kernelFunc:p3},f3=B$({opSnippet:"return float(isinf(x));",dtype:"bool"}),m3={kernelName:sg,backendName:"webgl",kernelFunc:f3},g3=B$({opSnippet:"return float(isnan(x));",dtype:"bool"}),y3={kernelName:ig,backendName:"webgl",kernelFunc:g3},b3=W$({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:kZ,dtype:"bool"}),v3={kernelName:lg,backendName:"webgl",kernelFunc:b3},x3=W$({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:SZ,dtype:"bool"}),w3={kernelName:cg,backendName:"webgl",kernelFunc:x3};var k3={kernelName:ug,backendName:"webgl",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,num:s}=n,i=NZ(a,r,s);return t.makeTensorInfo([i.length],"float32",i)}},S3=B$({opSnippet:j$+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:IZ}),N3={kernelName:dg,backendName:"webgl",kernelFunc:S3},I3=B$({opSnippet:j$+"\n  return log(1.0 + x);\n"}),C3={kernelName:pg,backendName:"webgl",kernelFunc:I3},T3=W$({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),E3={kernelName:hg,backendName:"webgl",kernelFunc:T3},_3=B$({opSnippet:"return float(!(x >= 1.0));"}),A3={kernelName:fg,backendName:"webgl",kernelFunc:_3},R3=W$({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),F3={kernelName:mg,backendName:"webgl",kernelFunc:R3},D3=class{constructor(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[];let s=t,i=e[3]-1;this.outputShape=e;let o,l="float(".concat(n,") + float(").concat(a,") * sum");o=.5===r?"inversesqrt(".concat(l,")"):1===r?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(i,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")}},M3=class{constructor(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let s=t,i=e[3]-1;this.outputShape=e;let o,l="float(".concat(n,") + float(").concat(a,") * sum");o=.5===r?"inversesqrt(".concat(l,")"):1===r?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(i,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")}},O3={kernelName:vg,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:s,bias:i,alpha:o,beta:l}=a,c=Mf().getBool("WEBGL_PACK_NORMALIZATION")?new M3(r.shape,s,i,o,l):new D3(r.shape,s,i,o,l);return n.runWebGLProgram(c,[r],r.dtype)}},P3=class{constructor(e,t,n,a,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=r,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(r,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(r,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}},L3={kernelName:xg,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,y:s,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=a,d=new P3(r.shape,o,l,c,u);return n.runWebGLProgram(d,[r,s,i],r.dtype)}};function z3(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reductionIndices:s,keepDims:i}=a,o=r.shape.length,l=gb.parseAxisParam(s,r.shape),c=l,u=WE.getAxesPermutation(c,o),d=null!=u,p=n.shouldExecuteOnCPU([r]),h=r;if(d){if(p){let e=n.texData.get(h.dataId).values,t=new Array(o);for(let n=0;n<t.length;n++)t[n]=r.shape[u[n]];let a=e$(e,r.shape,r.dtype,u,t);h=n.makeTensorInfo(t,r.dtype),n.texData.get(h.dataId).values=a}else h=a0(r,u,n);c=WE.getInnerMostAxes(c.length,o)}WE.assertAxesAreInnerMostDims("max",c,o);let f,[m,g]=WE.computeOutAndReduceShapes(h.shape,c),y=m;if(i&&(y=WE.expandShapeToKeepDim(m,l)),p){let e=n.texData.get(h.dataId).values,t=CZ(e,gb.sizeFromShape(g),y,r.dtype);f=n.makeTensorInfo(y,r.dtype),n.texData.get(f.dataId).values=t}else f=function(e,t,n,a){let r=gb.sizeFromShape(t),s=Q$({inputs:{x:e},attrs:{shape:[gb.sizeFromShape(e.shape)/r,r]},backend:a}),i=e0(s,e.dtype,"max",a),o=Q$({inputs:{x:i},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(s),a.disposeIntermediateTensorInfo(i),o}(h,g,y,n);return d&&n.disposeIntermediateTensorInfo(h),f}var j3={kernelName:kg,backendName:"webgl",kernelFunc:z3},B3=W$({opSnippet:I$+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+T$+"\n  return result;\n",cpuKernelImpl:TZ}),W3={kernelName:Sg,backendName:"webgl",kernelFunc:B3};var V3={kernelName:Ng,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;sJ(r,"maxPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=a;gb.assert(WE.eitherStridesOrDilationsAreOne(i,1),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(1,"'"));let c=WE.computePool2DInfo(r.shape,s,i,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&gb.arraysEqual(c.inShape,c.outShape))return _$({inputs:{x:r},backend:n});let u=new W0(c,"max",!1);return n.runWebGLProgram(u,[r],r.dtype)}};var U3={kernelName:Cg,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,dataFormat:l,dimRoundingMode:c}=a,u=WE.computePool3DInfo(r.shape,s,i,[1,1,1],o,c,l),d=new V0(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}},H3=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,r=e.effectiveFilterHeight,s=e.effectiveFilterWidth,i=r-1-e.padInfo.top,o=s-1-e.padInfo.left,l=r*s-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(r,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(s," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},G3=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.dilationDepth,s=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=o-1-e.padInfo.front,d=l-1-e.padInfo.top,p=c-1-e.padInfo.left,h=o*l*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(d,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(o,";\n           wD += ").concat(r,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(s,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(i,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(h," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var q3={kernelName:Tg,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,i=s,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=a,d=WE.computePool3DInfo(i.shape,o,l,[1,1,1],c,u),p=new V0(d,"max",!0),h=n.runWebGLProgram(p,[i],i.dtype),f=new G3(d),m=n.runWebGLProgram(f,[r,h],i.dtype);return n.disposeIntermediateTensorInfo(h),m}};var K3={kernelName:Ig,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s,output:i}=t,o=s;sJ([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=a,p=WE.computePool2DInfo(o.shape,l,c,1,u,d),h=new W0(p,"max",!0),f=n.runWebGLProgram(h,[o],o.dtype),m=new H3(p),g=n.runWebGLProgram(m,[r,f],o.dtype);return n.disposeIntermediateTensorInfo(f),g}};var X3={kernelName:Eg,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:l}=n,c=a;gb.assert(4===r.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(r.shape.length,"."));let u=[1,1];gb.assert(WE.eitherStridesOrDilationsAreOne(i,u),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(u,"'"));let d=WE.computePool2DInfo(r.shape,s,i,u,o),[p,h]=function(e,t,n,a){let r=new W0(n,"max",!1),s=a.runWebGLProgram(r,[e],"float32");return r=new W0(n,"max",!0,!0,t),[s,a.runWebGLProgram(r,[e],"float32")]}(r,l,d,c);return[p,h]}};var Y3={kernelName:_g,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{keepDims:s,axis:i}=n,o=a,l=r.shape.length,c=gb.parseAxisParam(i,r.shape),u=c,d=WE.getAxesPermutation(u,l),p=null!=d,h=o.shouldExecuteOnCPU([r]),f=[],m=r;if(p){if(h){let e=o.texData.get(m.dataId).values,t=new Array(l);for(let a=0;a<t.length;a++)t[a]=r.shape[d[a]];let n=e$(e,r.shape,r.dtype,d,t);m=o.makeTensorInfo(t,r.dtype),o.texData.get(m.dataId).values=n}else m=a0(r,d,o);f.push(m),u=WE.getInnerMostAxes(u.length,l)}WE.assertAxesAreInnerMostDims("sum",u,l);let[g,y]=WE.computeOutAndReduceShapes(m.shape,u),b=g;s&&(b=WE.expandShapeToKeepDim(g,c));let v=function(e,t,n,a){let r=gb.sizeFromShape(t),s=Q$({inputs:{x:e},attrs:{shape:[gb.sizeFromShape(e.shape)/r,r]},backend:a}),i=e0(s,"float32","mean",a),o=Q$({inputs:{x:i},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(s),a.disposeIntermediateTensorInfo(i),o}(m,y,b,o);for(let x of f)o.disposeIntermediateTensorInfo(x);return v}};var Q3={kernelName:Ag,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,keepDims:i}=a,o=r.shape.length,l=gb.parseAxisParam(s,r.shape),c=l,u=WE.getAxesPermutation(c,o),d=r;null!=u&&(d=i0({inputs:{x:r},backend:n,attrs:{perm:u}}),c=WE.getInnerMostAxes(c.length,r.shape.length)),WE.assertAxesAreInnerMostDims("min",c,o);let p,[h,f]=WE.computeOutAndReduceShapes(d.shape,c),m=Q$({inputs:{x:d},backend:n,attrs:{shape:[-1,gb.sizeFromShape(f)]}}),g=e0(m,m.dtype,"min",n);if(i){p=Q$({inputs:{x:g},backend:n,attrs:{shape:WE.expandShapeToKeepDim(h,l)}})}else p=Q$({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=u&&n.disposeIntermediateTensorInfo(d),p}},J3=W$({opSnippet:I$+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+T$+"\n  return result;\n",cpuKernelImpl:EZ}),Z3={kernelName:Rg,backendName:"webgl",kernelFunc:J3},$3=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=SJ(a),s=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),l="reflect"===n?0:1;this.userCode=1!==a?"\n      ".concat(r," start = ").concat(r,"(").concat(s,");\n      ").concat(r," end = ").concat(r,"(").concat(i,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(r," coords = outC - start;\n        setOutput(getX(").concat(o,"));\n      }\n    "):"\n        int start = ".concat(s,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}},e4=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=SJ(a),s=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=a$("rc",a),l=a$("source",a),c="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),u=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),d="reflect"===n?0:1,p="";if(1===a){let e="\n        ".concat(r," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");p="\n        ".concat(r," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ")}else{let e="\n        ".concat(r," source = rc;\n        ").concat(r," lt = ").concat(r,"(lessThan(source, start));\n        ").concat(r," gte = ").concat(r,"(greaterThanEqual(source, end));\n        ").concat(r," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");p="\n        ".concat(r," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(o[a-2]," += 1;\n        if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          ").concat(o[a-1]," += 1;\n          if(").concat(c,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(s,");\n      const ").concat(r," end = ").concat(r,"(").concat(i,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}},t4={kernelName:Fg,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:s,mode:i}=a,o=Mf().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new e4(r.shape,s,i):new $3(r.shape,s,i);return n.runWebGLProgram(o,[r],r.dtype)}},n4=W$({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+T$+"\n  return result;\n"}),a4={kernelName:Dg,backendName:"webgl",kernelFunc:n4},r4=class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}},s4=W$({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),i4={kernelName:Pm,backendName:"webgl",kernelFunc:s4},o4="return a - b;",l4=W$({opSnippet:o4,packedOpSnippet:o4,supportsComplex:!0,cpuKernelImpl:JZ}),c4={kernelName:jy,backendName:"webgl",kernelFunc:l4};function u4(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{dim:s}=a,i=gb.parseAxisParam([s],r.shape),o=z3({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=WE.expandShapeToKeepDim(o.shape,i),c=Q$({inputs:{x:o},backend:n,attrs:{shape:l}}),u=l4({inputs:{a:r,b:c},backend:n}),d=_2({inputs:{x:u},backend:n}),p=r0({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),h=Q$({inputs:{x:p},backend:n,attrs:{shape:l}}),f=s4({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}var d4={kernelName:Cy,backendName:"webgl",kernelFunc:u4};var p4={kernelName:Mg,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:s,seed:i,normalized:o}=a,l=o?r:u4({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new r4(c,u,s),p=[[i]],h=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),h}},h4=d$+"\n  return -x;\n";var f4={kernelName:Pg,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{x:r}=n;if(a.shouldExecuteOnCPU([r])){let e=a.texData.get(r.dataId),[t,n]=AZ(e.values,r.shape,r.dtype);return a.makeTensorInfo(n,r.dtype,t)}return t=Mf().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new g$(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new u$(r.shape,h4),a.runWebGLProgram(t,[r],r.dtype)}},m4=K_.nonMaxSuppressionV3Impl;var g4={kernelName:zg,backendName:"webgl",kernelFunc:function(e){WE.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=a,c=n.readSync(r.dataId),u=n.readSync(s.dataId),{selectedIndices:d}=m4(c,u,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},y4=K_.nonMaxSuppressionV4Impl;var b4={kernelName:jg,backendName:"webgl",kernelFunc:function(e){WE.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=a,u=n.readSync(r.dataId),d=n.readSync(s.dataId),{selectedIndices:p,validOutputs:h}=y4(u,d,i,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},v4=K_.nonMaxSuppressionV5Impl;var x4={kernelName:Bg,backendName:"webgl",kernelFunc:function(e){WE.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=a,u=n.readSync(r.dataId),d=n.readSync(s.dataId),p=i,h=o,f=l,m=c,{selectedIndices:g,selectedScores:y}=v4(u,d,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},w4=class{constructor(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}},k4={kernelName:Vg,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:s,depth:i,onValue:o,offValue:l}=a,c=gb.sizeFromShape(r.shape),u=new w4(c,i,o,l),d=Q$({inputs:{x:r},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(u,[d],s);n.disposeIntermediateTensorInfo(d);let h=Q$({inputs:{x:p},backend:n,attrs:{shape:[...r.shape,i]}});return n.disposeIntermediateTensorInfo(p),h}};function S4(e){let{inputs:t,backend:n}=e,{x:a}=t;if("complex64"===a.dtype){let e=u1({inputs:{input:a},backend:n}),t=S4({inputs:{x:e},backend:n}),r=I1({inputs:{input:a},backend:n}),s=S4({inputs:{x:r},backend:n}),i=R$({inputs:{real:t,imag:s},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),i}return B2({attrs:{shape:a.shape,dtype:a.dtype,value:"string"===a.dtype?"":0},backend:n})}var N4={kernelName:Qy,backendName:"webgl",kernelFunc:S4};var I4={kernelName:Wg,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a}=t,{x:r}=n;if("string"===r.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===r.dtype){let t=u1({inputs:{input:r},backend:a}),n=e({inputs:{x:t},backend:a}),s=I1({inputs:{input:r},backend:a}),i=S4({inputs:{x:s},backend:a}),o=R$({inputs:{real:n,imag:i},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(s),a.disposeIntermediateTensorInfo(i),o}return B2({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:a})}};var C4={kernelName:Ug,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return R2({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let s=t[0].shape,i=t[0].dtype;t.forEach(e=>{gb.assertShapesMatch(s,e.shape,"All tensors passed to stack must have matching shapes"),gb.assert(i===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=E1({inputs:t.map(e=>{let t=R2({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}},T4=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=SJ(a),s=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(r," start = ").concat(r,"(").concat(s,");\n      ").concat(r," end = ").concat(r,"(").concat(i,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(r," coords = outC - start;\n          setOutput(getX(").concat(o,"));\n        }\n      }\n    "):"\n        int start = ".concat(s,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}},E4=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=SJ(a),s=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=a$("rc",a),l=a$("source",a),c="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),u=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),d=["".concat(r," rc = outputLoc;"),"".concat(o[a-1]," += 1;\n       if(").concat(c,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(o[a-2]," += 1;\n       if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(o[a-1]," += 1;\n         if(").concat(c,") {")],p=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let f=0,m=1===a?2:4;f<m;f++)h+="\n        ".concat(d[f],"\n        if (").concat(p,") {\n          result[").concat(f,"] = float(value);\n        } else {\n          ").concat(r," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ");h+=1===a?"} ":"}}",this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(s,");\n      const ").concat(r," end = ").concat(r,"(").concat(i,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")}},_4=e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:s,constantValue:i}=a;if(0===gb.sizeFromShape(r.shape)){return B2({backend:n,attrs:{shape:s.map((e,t)=>e[0]+r.shape[t]+e[1]),value:i,dtype:r.dtype}})}let o=Mf().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new E4(r.shape,s,i):new T4(r.shape,s,i),l=[[i]];return n.runWebGLProgram(o,[r],r.dtype,l)},A4={kernelName:Hg,backendName:"webgl",kernelFunc:_4},R4=W$({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+T$+"\n  return result;\n"}),F4={kernelName:qg,backendName:"webgl",kernelFunc:R4};var D4={kernelName:Xg,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{axis:i,keepDims:o}=r,l=s.shape.length,c=[],u=gb.parseAxisParam(i,s.shape),d=u,p=WE.getAxesPermutation(d,l),h=s;if(null!=p&&(h=i0({inputs:{x:s},backend:a,attrs:{perm:p}}),d=WE.getInnerMostAxes(d.length,l),c.push(h)),WE.assertAxesAreInnerMostDims("prod",d,l),a.shouldExecuteOnCPU([h])){let e=a.texData.get(h.dataId).values,{outVals:n,outShape:r,outDtype:s}=FZ(h.shape,h.dtype,e,d);t=a.makeTensorInfo(r,s,n)}else{let[e,n]=WE.computeOutAndReduceShapes(h.shape,d),r=gb.sizeFromShape(n),i=Q$({inputs:{x:h},backend:a,attrs:{shape:[-1,r]}}),o=e0(i,cv(s.dtype),"prod",a);t=Q$({inputs:{x:o},backend:a,attrs:{shape:e}}),c.push(i),c.push(o)}if(o){c.push(t);let e=WE.expandShapeToKeepDim(t.shape,u);t=Q$({inputs:{x:t},backend:a,attrs:{shape:e}})}return c.forEach(e=>a.disposeIntermediateTensorInfo(e)),t}};var M4={kernelName:Yg,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:r,paramsDenseValues:s,indices:i}=t,{outputRaggedRank:o}=a,l=r.map(e=>n.readSync(e.dataId)),c=r.map(e=>e.shape),u=n.readSync(s.dataId),d=n.readSync(i.dataId),[p,h,f]=DZ(l,c,u,s.shape,s.dtype,d,i.shape,o),m=p.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,s.dtype,h);return m.concat([g])}};var O4={kernelName:Qg,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:a,limits:r,deltas:s}=t,i=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(s.dataId),[c,u]=MZ(i,a.shape,a.dtype,o,r.shape,l,s.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],a.dtype,u)]}};var P4={kernelName:Jg,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{shape:r,values:s,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,c=n.readSync(r.dataId),u=n.readSync(s.dataId),d=n.readSync(i.dataId),p=o.map(e=>n.readSync(e.dataId)),h=o.map(e=>e.shape),[f,m]=OZ(c,r.shape,u,s.shape,s.dtype,d,i.shape,p,h,l);return n.makeTensorInfo(f,s.dtype,m)}},L4=e=>{let{backend:t,attrs:n}=e,{start:a,stop:r,step:s,dtype:i}=n,o=PZ(a,r,s,i);return t.makeTensorInfo([o.length],i,o)},z4={kernelName:Zg,backendName:"webgl",kernelFunc:L4},j4=B$({opSnippet:"return 1.0 / x;"}),B4={kernelName:ey,backendName:"webgl",kernelFunc:j4},W4=B$({opSnippet:d$+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),V4={kernelName:ty,backendName:"webgl",kernelFunc:W4},U4=B$({opSnippet:d$+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),H4={kernelName:oy,backendName:"webgl",kernelFunc:U4},G4=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c,u=[a&&t>1?i-1:i,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n];c=r?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(u[0]/d[0],",\n          ").concat(u[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(c,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}},q4=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c,u=[a&&t>1?i-1:i,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n];c=r?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(u[0]/d[0],",\n          ").concat(u[1]/d[1],",\n          ").concat(u[1]/d[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(c,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}};var K4={kernelName:sy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:s,halfPixelCenters:i,size:o}=a,[l,c]=o,u=Mf().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new q4(r.shape,l,c,s,i):new G4(r.shape,l,c,s,i);return n.runWebGLProgram(u,[r],"float32")}},X4=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,a,r]=t,[,s,i]=e,o=[n&&s>1?a-1:a,n&&i>1?r-1:r],l=[n&&s>1?s-1:s,n&&i>1?i-1:i],c=o[0]/l[0],u=o[1]/l[1],d=1/c,p=1/u,h=2*Math.ceil(d)+2,f=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(p,");\n\n        const int winHeight = int(").concat(h,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(a-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(r-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}};var Y4={kernelName:iy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:s}=t,{alignCorners:i}=a,o=new X4(s.shape,r.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}},Q4=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c,u=[a&&t>1?i-1:i,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n],p=a?"0.5":"0.0";c=r?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(u[0]/d[0],",\n          ").concat(u[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(c,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}},J4=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c,u=[a&&t>1?i-1:i,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n],p=a?"0.5":"0.0";c=r?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(u[0]/d[0],",\n          ").concat(u[1]/d[1],",\n          ").concat(u[1]/d[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(c,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}};var Z4={kernelName:ay,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:s,halfPixelCenters:i,size:o}=a,[l,c]=o,u=Mf().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new J4(r.shape,l,c,s,i):new Q4(r.shape,l,c,s,i);return n.runWebGLProgram(u,[r],r.dtype)}},$4=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,a,r]=t,[,s,i]=e,o=[n&&s>1?a-1:a,n&&i>1?r-1:r],l=[n&&s>1?s-1:s,n&&i>1?i-1:i],c=o[0]/l[0],u=o[1]/l[1],d=1/c,p=1/u,h=2*Math.ceil(d)+2,f=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(p,");\n\n        const int winHeight = int(").concat(h,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(o[0],") *\n                (float(dyR) / float(").concat(l[0],"));\n\n            float sourceFracCol =\n                float(").concat(o[1],") *\n                  (float(dyC) / float(").concat(l[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}};var e6={kernelName:ry,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:s}=t,{alignCorners:i}=a,o=new $4(s.shape,r.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}},t6=class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      "));let a=e.map((n,a)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(a)).join(","),r=SJ(n);this.userCode="\n      void main() {\n        ".concat(r," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}},n6=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;let a=a$("rc",n),r="".concat(a[n-1]," + 1 < ").concat(this.outputShape[n-1]),s="".concat(a[n-2]," + 1 < ").concat(this.outputShape[n-2]),i=SJ(n);var o;function l(n){let a=e.map((a,r)=>function(n,a){return-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - ").concat(a[n]," - 1"):"".concat(a[n])}(r,n)),r=a.join(","),s=a.slice(-2).join(",");return"getChannel(getX(".concat(r,"), vec2(").concat(s,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(r,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(i," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat((o=a.slice(),l(o)),";\n          if(").concat(r,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",l(e)}(a.slice()),";\n          }\n          if(").concat(s,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",l(e)}(a.slice()),";\n            if(").concat(r,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",l(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}};var a6={kernelName:ly,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:s}=a,i=r.shape.length,o=gb.parseAxisParam(s,r.shape);if(0===i)return _$({inputs:{x:r},backend:n});let l=Mf().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new n6(r.shape,o):new t6(r.shape,o);return n.runWebGLProgram(l,[r],r.dtype)}},r6=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],a=e[2];this.outputShape=e;let r="";r="number"==typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(r,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}},s6={kernelName:$y,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,{radians:s,fillValue:i,center:o}=n,l=a,c=new r6(r.shape,i),[u,d]=WE.getImageCenter(o,r.shape[1],r.shape[2]),p=[[u,d,Math.sin(s),Math.cos(s)]];return l.runWebGLProgram(c,[r],r.dtype,p)}},i6=B$({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),o6={kernelName:cy,backendName:"webgl",kernelFunc:i6},l6=B$({opSnippet:"return inversesqrt(x);",cpuKernelImpl:LZ}),c6={kernelName:uy,backendName:"webgl",kernelFunc:l6},u6=class{constructor(e,t,n,a,r,s){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;let o=SJ(r.length),l=SJ(s.length),c="";1===n?c="i":2===n&&(c="i, j");let u="getIndices(".concat(c,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");let p="getUpdates(".concat(d,")"),h="";i&&(h="coords[0], coords[1]");let f="getDefaultValue(".concat(h,")"),m=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(r,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(u,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(p,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(f,", sum, float(found)));\n        }\n      ")}},d6=class{constructor(e,t,n,a,r,s){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;let o=SJ(r.length),l=SJ(s.length),c="";1===n?c="i":2===n&&(c="i, j");let u="getIndices(".concat(c,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");let p="getUpdates(".concat(d,")"),h="";i&&(h="coords[0], coords[1]");let f="getDefaultValue(".concat(h,")"),m=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(r,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(u,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(p,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(f,", sum, found));\n        }\n      ")}};var p6={kernelName:dy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r,updates:s}=t,{shape:i}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=WE.calculateShapes(s,r,i),p=[d/c,c];if(0===d)return n.makeTensorInfo(i,r.dtype);let h,f=Q$({inputs:{x:r},backend:n,attrs:{shape:[l,o]}}),m=Q$({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));h=Mf().getBool("WEBGL_PACK")?new d6(l,o,f.shape.length,m.shape.length,u,p):new u6(l,o,f.shape.length,m.shape.length,u,p);let y=n.runWebGLProgram(h,[m,f,g],m.dtype),b=Q$({inputs:{x:y},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}},h6=class{constructor(e,t,n,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let r="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),s=2===Mf().getNumber("WEBGL_VERSION")?"while (left < right) {":r,i="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(s,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(i," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}};var f6={kernelName:hy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:s}=t,{side:i}=a,o=new h6(r.shape[0],r.shape[1],s.shape[1],i),l=[[r.shape[1]]];return n.runWebGLProgram(o,[r,s],"int32",l)}},m6=class{constructor(e,t,n){let a,r;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)r="resRC",a="resRC";else{let n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],i=[];for(let a=0;a<t.length;a++)i.push("".concat(n[a])),a<e&&s.push("".concat(n[a]));a=s.join(),r=i.join()}let s=SJ(n);this.userCode="\n      void main() {\n        ".concat(s," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(r,"));\n        } else {\n          setOutput(getB(").concat(r,"));\n        }\n      }\n    ")}};var g6={kernelName:fy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:s}=t,i=new m6(a.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[a,r,s],lv(r.dtype,s.dtype))}},y6=B$({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(WE.SELU_SCALEALPHA,";\n  float scale = ").concat(WE.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),b6={kernelName:my,backendName:"webgl",kernelFunc:y6},v6=B$({opSnippet:j$+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:jZ}),x6={kernelName:xy,backendName:"webgl",kernelFunc:v6},w6=B$({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),k6={kernelName:vy,backendName:"webgl",kernelFunc:w6},S6=B$({opSnippet:j$+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(T$,"\n  return result;\n")}),N6={kernelName:yy,backendName:"webgl",kernelFunc:S6},I6=B$({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),C6={kernelName:by,backendName:"webgl",kernelFunc:I6},T6=B$({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),E6={kernelName:wy,backendName:"webgl",kernelFunc:T6},_6={kernelName:Ny,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:s,paddings:i}=a;gb.assert(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=s.reduce((e,t)=>e*t),l=[[0,0]];l.push(...i);for(let y=1+s.length;y<r.shape.length;++y)l.push([0,0]);let c=[],u=_4({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=WE.getReshaped(u.shape,s,o,!1),p=WE.getPermuted(d.length,s.length,!1),h=WE.getReshapedPermuted(u.shape,s,o,!1),f=Q$({inputs:{x:u},backend:n,attrs:{shape:d}}),m=i0({inputs:{x:f},backend:n,attrs:{perm:p}}),g=Q$({inputs:{x:m},backend:n,attrs:{shape:h}});return c.push(u),c.push(f),c.push(m),c.forEach(e=>n.disposeIntermediateTensorInfo(e)),g}};var A6={kernelName:Ty,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:a,values:r,denseShape:s,defaultValue:i}=t;if(1!==s.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(s.shape));if(2!==a.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(a.shape));if(1!==r.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(r.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));let o=n.readSync(a.dataId),l=n.readSync(r.dataId),c=n.readSync(s.dataId),u=n.readSync(i.dataId)[0],[d,p,h,f,m]=VZ(o,a.shape,a.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(p,a.dtype,d),n.makeTensorInfo([p[0]],r.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}};var R6={kernelName:Ey,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:a,inputShape:r,newShape:s}=t;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(a.shape));if(1!==r.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(r.shape));if(1!==s.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(s.shape));let i=Array.from(n.readSync(r.dataId)),o=n.readSync(a.dataId),l=Array.from(n.readSync(s.dataId)),[c,u,d]=UZ(o,a.shape,a.dtype,i,l);return[n.makeTensorInfo(u,a.dtype,c),n.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}};var F6={kernelName:_y,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:s}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(r.shape));if(1!==s.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(s.shape));let i=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(s.dataId),[c,u]=HZ(i,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(u,a.dtype,c)}};var D6={kernelName:Ay,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:s}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(r.shape));if(1!==s.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(s.shape));let i=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(s.dataId),[c,u]=HZ(i,a.shape,a.dtype,o,l);return n.makeTensorInfo(u,a.dtype,c)}};var M6={kernelName:Ry,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sparseIndices:r,sparseValues:s,defaultValue:i}=t,{outputShape:o}=a,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=WE.calculateShapes(s,r,o),h=!1;if("string"===s.dtype){let e=n.bufferSync(r),t=n.bufferSync(s),a=gb.decodeString(n.readSync(i.dataId)[0]),f=zZ(e,t,o,p,u,c,l,d,a,h);return n.makeTensorInfo(o,f.dtype,f.values)}let f=new u6(c,l,r.shape.length,s.shape.length,d,[p,1],h),m=n.runWebGLProgram(f,[s,r,i],s.dtype),g=Q$({inputs:{x:m},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),g}};var O6={kernelName:Iy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{numOrSizeSplits:s,axis:i}=a,o=gb.parseAxisParam(i,r.shape)[0],l=WE.prepareSplitSize(r,s,o),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(e=>{let t=[...d];t[o]=e;let a=n1({inputs:{x:r},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,a})}},P6="return sqrt(x);",L6=B$({opSnippet:P6,packedOpSnippet:P6,cpuKernelImpl:GZ}),z6={kernelName:ky,backendName:"webgl",kernelFunc:L6},j6=B$({opSnippet:"return x * x;"}),B6={kernelName:Dy,backendName:"webgl",kernelFunc:j6},W6="return (a - b) * (a - b);",V6=W$({opSnippet:W6,packedOpSnippet:W6}),U6={kernelName:Fy,backendName:"webgl",kernelFunc:V6};var H6={kernelName:My,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");let s=n.readSync(r.dataId),i=WE.fromUint8ToStringArray(s),o=qZ(i,"string",a);return n.makeTensorInfo(r.shape,"string",o)}};var G6={kernelName:Jy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,s=d$+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),i=new u$(r.shape,s);return a.runWebGLProgram(i,[r],r.dtype)}},q6=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let a=n.length,r=SJ(n.length),s=SJ(n.length),i="";if(1===a)i="coords * strides + begin";else{let e=0;i=n.map((t,a)=>(e++,1===n.length?"coords * strides[".concat(a,"] + begin[").concat(a,"]"):"coords[".concat(e-1,"] * strides[").concat(a,"] + begin[").concat(a,"]"))).join(",")}this.userCode="\n      ".concat(r," begin = ").concat(r,"(").concat(e,");\n      ").concat(r," strides = ").concat(r,"(").concat(t,");\n\n      void main() {\n        ").concat(s," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}};var K6={kernelName:Oy,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{begin:i,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:d,newAxisMask:p,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:v,end:x,strides:w}=mE.sliceInfo(s.shape,i,o,l,c,u,d,p,h);if(g)t=Q$({inputs:{x:s},backend:a,attrs:{shape:m}});else if(y||b){gb.assert(s.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(s.shape.length));let e=mE.computeOutShape(v,x,w),n=n1({inputs:{x:s},backend:a,attrs:{begin:v,size:e}});t=Q$({inputs:{x:n},backend:a,attrs:{shape:m}}),a.disposeIntermediateTensorInfo(n)}else if(a.shouldExecuteOnCPU([s])){let e=a.readSync(s.dataId),n=sw(s.shape,s.dtype,e),r=KZ(f,n,w,v);t=a.makeTensorInfo(m,s.dtype,r.values)}else{let e=new q6(v,w,f);t=a.runWebGLProgram(e,[s],s.dtype)}let k=Q$({inputs:{x:t},backend:a,attrs:{shape:m}});return a.disposeIntermediateTensorInfo(t),k}};var X6={kernelName:Py,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{separator:r,nGramWidths:s,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=a,{data:u,dataSplits:d}=t,p=n.readSync(u.dataId),h=n.readSync(d.dataId),[f,m]=XZ(p,h,r,s,i,o,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};var Y6={kernelName:Ly,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{skipEmpty:r}=a,{input:s,delimiter:i}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error("Input must be a vector, got shape: ".concat(s.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));let o=n.readSync(s.dataId),l=n.readSync(i.dataId)[0],[c,u,d]=YZ(o,l,r),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};var Q6={kernelName:zy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{numBuckets:r}=a,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");let i=n.readSync(s.dataId),o=QZ(i,r);return n.makeTensorInfo(s.shape,"int32",o)}},J6=B$({opSnippet:"return tan(x);"}),Z6={kernelName:By,backendName:"webgl",kernelFunc:J6},$6=B$({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),e5={kernelName:Wy,backendName:"webgl",kernelFunc:$6};var t5={kernelName:py,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{tensor:r,indices:s,updates:i}=t,{}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=WE.calculateShapes(i,s,r.shape),p=[d/c,c];if(0===d)return n.makeTensorInfo(r.shape,s.dtype);let h=Q$({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),f=Q$({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=Q$({inputs:{x:r},backend:n,attrs:{shape:p}}),g=new u6(l,o,h.shape.length,f.shape.length,u,p,!1,!0),y=n.runWebGLProgram(g,[f,h,m],m.dtype),b=Q$({inputs:{x:y},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),b}},n5=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let s=0;s<n.length;s++)n[s]=e[s]*t[s];this.outputShape=n,this.rank=n.length;let a=SJ(this.rank),r=function(e){let t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],a=[];for(let r=0;r<e.length;r++)a.push("imod(".concat(n[r],", ").concat(e[r],")"));return a.join()}(e);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(r,"));\n      }\n    ")}};function a5(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reps:s}=a;if("string"===r.dtype||r.shape.length>5){let e=n.readSync(r.dataId),t="string"===r.dtype?e.map(e=>gb.decodeString(e)):e,a=sw(r.shape,r.dtype,t),i=ZZ(a,s);return n.makeTensorInfo(i.shape,i.dtype,i.values)}let i=new n5(r.shape,s);return n.runWebGLProgram(i,[r],r.dtype)}var r5={kernelName:Vy,backendName:"webgl",kernelFunc:a5},s5=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}},i5=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}};function o5(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function l5(e){let t=1;for(;t<e;)t*=2;return t}var c5={kernelName:Uy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:s,sorted:i}=a,o=Mf().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Mf().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<o||s>l){let e=n.readSync(r.dataId),[t,a]=$Z(e,c,r.dtype,s,i);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(a.shape,a.dtype,a.values)]}if(0===s)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===u)return[r,B2({attrs:{shape:c,dtype:"int32",value:0},backend:n})];let d=n.texData.get(r.dataId),p=null!==d&&d.isPacked,h=p?n.unpackTensor(r):r,f=gb.sizeFromShape(c)/u,m=Q$({inputs:{x:h},attrs:{shape:[f,u]},backend:n});p&&o5(n,h);let g=l5(s),y=l5(u),b=null,v=()=>null===b?[m,m]:[m,b],x=(e,t,a)=>{let r=v(),s=new s5(a),i=[[u],[null===b?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],o=b;b=n.runWebGLProgram(s,r,"int32",i),o5(n,o)};for(let I=1;I<g;I*=2){let e=2*I;for(let t=I;t>=1;t/=2)x(e,t,[f,y])}for(let I=y;I>g;I/=2){let e=v(),t=new i5([f,I/2]),a=[[u],[null===b?1:0],[g]],r=b;b=n.runWebGLProgram(t,e,"int32",a),o5(n,r);let s=g/2,i=2*s;for(let n=s;n>=1;n/=2)x(i,n,b.shape)}let w=b;b=n1({inputs:{x:b},backend:n,attrs:{begin:0,size:[f,s]}}),o5(n,w);let k=s3({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});o5(n,m);let S=c.slice(0,-1);S.push(s),w=b,b=Q$({inputs:{x:b},attrs:{shape:S},backend:n}),o5(n,w);let N=k;return k=Q$({inputs:{x:k},attrs:{shape:S},backend:n}),o5(n,N),[k,b]}},u5=class{constructor(e,t,n,a,r,s){this.variableNames=["Image","Transforms"],this.outputShape=s;let i,o="nearest"===n?1:2;switch(a){case"constant":default:i=1;break;case"reflect":i=2;break;case"wrap":i=3;break;case"nearest":i=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(i," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(i," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(i," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(r,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(r,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(o," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}};var d5={kernelName:Hy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r,transforms:s}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=a,[u,d,p,h]=r.shape,[f,m]=null!=c?c:[d,p],g=new u5(d,p,i,o,l,[u,f,m,h]);return n.runWebGLProgram(g,[r,s],"float32")}};var p5={kernelName:qy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:s}=t;sJ(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let i=a.readSync(s.dataId),{outputValues:o,outputShape:l,indices:c}=t$(i,r,s.shape,s.dtype);return[a.makeTensorInfo(l,s.dtype,o),a.makeTensorInfo([c.length],"int32",c)]}};var h5={kernelName:Ky,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:s}=a;s<0&&(s+=r.shape.length);let i=r,o=i.shape.length,l=r.shape[s],c=new Array(o-1),u=0;for(let m=0;m<o;m++)m!==s&&(c[u++]=i.shape[m]);let d=[],p=new Array(o).fill(0),h=i.shape.slice();h[s]=1;let f=new Array(l);for(let m=0;m<f.length;m++){p[s]=m;let e=n1({inputs:{x:i},backend:n,attrs:{begin:p,size:h}}),t=Q$({inputs:{x:e},backend:n,attrs:{shape:c}});f[m]=t,d.push(e)}return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}},f5=class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,a=e.batchSize,r=e.inSize,s=e.numSegments,i=s*Math.ceil(r/n);this.outputShape=[a,i];let o=4*Math.floor(n/4),l=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",u="";r%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      "));let d="";r%n>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(s,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(s,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}};var m5,g5,y5,b5={kernelName:Xy,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,segmentIds:s}=t,{numSegments:i}=a,o=r.shape.length,l=[],c=0,u=WE.getAxesPermutation([c],o),d=r;null!=u&&(d=i0({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=WE.getInnerMostAxes(1,o)[0]);let p=WE.segment_util.computeOutShape(d.shape,c,i),h=gb.sizeFromShape([d.shape[c]]),f=Q$({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(f);let m=cv(r.dtype),g=(e,t,a,r,s)=>{let i=e.shape[0],o=e.shape[1],c=WE.segment_util.segOpComputeOptimalWindowSize(o,s),u=new f5({windowSize:c,inSize:o,batchSize:i,numSegments:s},t),d=n.compileAndRun(u,[e,a],r);if(l.push(d),d.shape[1]===s)return d;let p=L4({backend:n,attrs:{start:0,stop:s,step:1,dtype:"float32"}}),h=a5({inputs:{x:p},backend:n,attrs:{reps:[o/c]}});return l.push(p),l.push(h),g(d,t,h,r,s)},y=Q$({inputs:{x:g(f,"unsortedSegmentSum",s,m,i)},backend:n,attrs:{shape:p}}),b=y;if(null!=u){l.push(y);let e=WE.getUndoAxesPermutation(u);b=i0({inputs:{x:b},backend:n,attrs:{perm:e}})}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),b}},v5=[c0,d0,h0,m0,b0,w0,k0,S0,_0,A0,F0,M0,P0,z0,B0,U0,H0,K0,X0,Y0,Z0,r1,s1,i1,o1,p1,m1,b1,F$,w1,_1,L1,V1,H1,G1,q1,X1,Q1,Z1,e2,s2,i2,o2,c2,p2,m2,g2,b2,x2,w2,S2,N2,C2,E2,A2,F2,O2,z2,V2,H2,K2,Y2,Z2,e3,t3,a3,i3,l3,u3,A$,d3,C1,h3,m3,y3,O$,v3,w3,k3,N3,C3,E3,A3,F3,O3,L3,j3,W3,V3,U3,q3,K3,X3,Y3,Q3,Z3,t4,a4,p4,Y$,f4,g4,b4,x4,c1,k4,I4,C4,A4,F4,z$,D4,M4,O4,P4,z4,d1,i4,B4,V4,H4,J$,K4,Y4,Z4,e6,a6,s6,o6,c6,p6,f6,g6,b6,x6,k6,N6,C6,a1,d4,E6,_6,A6,R6,F6,D6,M6,O6,z6,B6,U6,H6,G6,K6,X6,Y6,Q6,c4,s0,Z6,e5,t5,r5,c5,d5,o0,p5,h5,b5,N4];for(let n of v5)ub(n);!function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"}(m5||(m5={})),function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"}(g5||(g5={}));var x5={kernelName:eb,backendName:"wasm",setupFunc:function(e){y5=e.wasm.cwrap(eb,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:s,bias:i,preluActivationWeights:o}=t;if("float32"!==r.dtype||"float32"!==s.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=a,p=n.dataIdMap.get(r.dataId).id,h=n.dataIdMap.get(s.dataId).id,f=0;if(null!=i){let e=n.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error("_FusedMatMul only supports rank-1 bias but got rank ".concat(e.shape.length,"."));f=e.id}let m=null==o?0:n.dataIdMap.get(o.dataId).id,g=g5[u];if(null==g)throw new Error("".concat(u," activation not yet supported for FusedConv2D in the wasm backend."));let y=l?r.shape[2]:r.shape[1],b=c?s.shape[1]:s.shape[2],v=_k.assertAndGetBroadcastShape(r.shape.slice(0,-2),s.shape.slice(0,-2)),x=n.makeOutput([...v,y,b],r.dtype),w=n.dataIdMap.get(x.dataId).id,k=new Uint8Array(new Int32Array(r.shape).buffer),S=new Uint8Array(new Int32Array(s.shape).buffer);return y5(p,k,r.shape.length,h,S,s.shape.length,l,c,g,f,m,d||0,w),x}};function w5(e,t){let n;return{kernelName:e,backendName:"wasm",setupFunc:function(t){n=t.wasm.cwrap(e,null,["number","number","number"])},kernelFunc:function(e){let{backend:a,inputs:{x:r}}=e,s=a.dataIdMap.get(r.dataId).id,i=a.makeOutput(r.shape,t||r.dtype),o=a.dataIdMap.get(i.dataId).id;return 0===gb.sizeFromShape(i.shape)||n(s,m5[r.dtype],o),i}}}var k5=w5(jf),S5=w5(Bf),N5=w5(Wf);function I5(e,t,n){let a;return{kernelName:e,backendName:"wasm",setupFunc:function(t){a=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:r}=e,{a:s,b:i}=r,o=t.dataIdMap.get(s.dataId).id,l=t.dataIdMap.get(i.dataId).id,c=null!=n?n:s.dtype,u=WE.assertAndGetBroadcastShape(s.shape,i.shape),d=t.makeOutput(u,c);if(0===gb.sizeFromShape(u))return d;let p=new Uint8Array(new Int32Array(s.shape).buffer),h=new Uint8Array(new Int32Array(i.shape).buffer),f=t.dataIdMap.get(d.dataId).id;return a(o,p,s.shape.length,l,h,i.shape.length,m5[s.dtype],f),d}}}var C5,T5=I5(Vf);var E5={kernelName:Uf,backendName:"wasm",setupFunc:function(e){C5=e.wasm.cwrap(Uf,null,["array","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,a=n.makeOutput(t[0].shape,t[0].dtype);if(0===gb.sizeFromShape(a.shape))return a;let r=t.map(e=>n.dataIdMap.get(e.dataId).id),s=new Uint8Array(new Int32Array(r).buffer),i=n.dataIdMap.get(a.dataId).id;return C5(s,r.length,m5[a.dtype],i),a}};function _5(e){let{inputs:{x:t},backend:n}=e;if("string"===t.dtype)return zv(n.readSync(t.dataId),t.shape,t.dtype);let a=n.makeOutput(t.shape,t.dtype),r=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(a).set(r),a}var A5,R5={kernelName:tg,backendName:"wasm",kernelFunc:_5};function F5(e){let{inputs:t,backend:n,attrs:a}=e,[r,s]=function(e,t){let n=[],a=[];for(let r=0;r<e.length;++r)1!==e[r]&&n.push(e[r]),1!==e[t[r]]&&a.push(t[r]);for(let r=0;r<a.length;++r){let e=-1;for(let t=0;t<a.length;++t)a[t]>=r&&(-1===e||a[e]>a[t])&&(e=t);a[e]=r}return[n,a]}(t.x.shape,a.perm),i=!0;for(let f=0;f<s.length;f++)s[f]!==f&&(i=!1);let o=function(e,t){let n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];return n}(t.x.shape,a.perm),l={dataId:t.x.dataId,shape:r,dtype:t.x.dtype};if(i){let e=_5({inputs:t,backend:n});return e.shape=o,e}let c=n.makeOutput(o,l.dtype),u=n.dataIdMap.get(l.dataId).id,d=n.dataIdMap.get(c.dataId).id,p=new Uint8Array(new Int32Array(s).buffer),h=new Uint8Array(new Int32Array(l.shape).buffer);return A5(u,h,l.shape.length,m5[l.dtype],d,p,s.length),c}var D5,M5={kernelName:Gy,backendName:"wasm",kernelFunc:F5,setupFunc:function(e){A5=e.wasm.cwrap(Gy,null,["number","array","number","number","number","array","number"])}};function O5(e,t,n){let a=e.shape,r=e.shape.length,s=gb.parseAxisParam(t,a),i=s,o=WE.getAxesPermutation(i,r),l=null,c=!1;if(null!=o){let t=new Array(r);for(let e=0;e<t.length;e++)t[e]=a[o[e]];i=WE.getInnerMostAxes(i.length,r),l=F5({inputs:{x:e},attrs:{perm:o},backend:n});let s=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(l.dataId).id!==s&&(c=!0)}return{transposed:l,originalAxes:s,axes:i,inputWasTransposed:c}}var P5,L5={kernelName:Hf,backendName:"wasm",setupFunc:function(e){D5=e.wasm.cwrap(Hf,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:s}=a,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=O5(i,r,t);if(p){l=c,o=t.dataIdMap.get(c.dataId).id}let h=l.shape.length;WE.assertAxesAreInnerMostDims("all",u,h);let[f,m]=WE.computeOutAndReduceShapes(l.shape,u),g=gb.sizeFromShape(m),y=t.makeOutput(f,i.dtype);if(0!==gb.sizeFromShape(l.shape)){let e=t.dataIdMap.get(y.dataId).id;D5(o,g,e)}if(p&&t.disposeData(c.dataId),s){let e=WE.expandShapeToKeepDim(y.shape,d);y.shape=e}return y}};var z5={kernelName:Gf,backendName:"wasm",setupFunc:function(e){P5=e.wasm.cwrap(Gf,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:s}=a,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=O5(i,r,t);if(p){l=c,o=t.dataIdMap.get(c.dataId).id}let h=l.shape.length;WE.assertAxesAreInnerMostDims("any",u,h);let[f,m]=WE.computeOutAndReduceShapes(l.shape,u),g=gb.sizeFromShape(m),y=t.makeOutput(f,i.dtype);if(0!==gb.sizeFromShape(l.shape)){let e=t.dataIdMap.get(y.dataId).id;P5(o,g,e)}if(p&&t.disposeData(c.dataId),s){let e=WE.expandShapeToKeepDim(y.shape,d);y.shape=e}return y}};function j5(e){let t;return{kernelName:e,backendName:"wasm",setupFunc:function(n){t=n.wasm.cwrap(e,null,["number","number","number","number","number"])},kernelFunc:function(e){let{backend:n,inputs:a,attrs:r}=e,{axis:s}=r,{x:i}=a,o=n.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:d,inputWasTransposed:p}=O5(i,s,n);if(p){let e=n.dataIdMap.get(u.dataId).id;e!==o&&(c=u,l=e)}let h=c.shape.slice(0,-1),f=n.makeOutput(h,"int32"),m=n.dataIdMap.get(f.dataId).id,g=gb.sizeFromShape(f.shape),y=c.shape[d[0]];return t(l,m5[c.dtype],g,y,m),p&&n.disposeData(u.dataId),f}}}var B5,W5=j5(qf),V5=j5(Kf),U5=w5(Xf),H5=w5(Yf),G5=w5(Qf),q5=I5(Zf),K5=w5(Jf);var X5,Y5={kernelName:$f,backendName:"wasm",setupFunc:function(e){B5=e.wasm.cwrap($f,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,r=t.x,s=a.dataIdMap.get(r.dataId).id,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=n,u=WE.computePool2DInfo(r.shape,i,o,1,l,c),d=u.filterHeight,p=u.filterWidth,h=u.padInfo.top,f=u.padInfo.right,m=u.padInfo.bottom,g=u.padInfo.left,y=u.strideHeight,b=u.strideWidth,v=u.inChannels;if("channelsLast"!==u.dataFormat)throw new Error("wasm backend does not support dataFormat:'".concat(u.dataFormat,"'. Please use 'channelsLast'."));if(1!==u.dilationWidth||1!==u.dilationHeight)throw new Error("was backend only supports average pooling with dilation = [1, 1], got [".concat(u.dilationHeight,", ").concat(u.dilationWidth,"]."));let x=a.makeOutput(u.outShape,"float32"),w=a.dataIdMap.get(x.dataId).id;return B5(s,r.shape[0],r.shape[1],r.shape[2],d,p,h,f,m,g,y,b,v,w),x}};var Q5,J5={kernelName:tm,backendName:"wasm",setupFunc:function(e){X5=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a,u=WE.computePool3DInfo(r.shape,s,i,1,o,l,c),d=n.makeOutput(u.outShape,r.dtype);return X5(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}};var Z5,$5={kernelName:nm,backendName:"wasm",setupFunc:function(e){Q5=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=a,u=WE.computePool3DInfo(s.shape,i,o,1,l,c),d=n.makeOutput(s.shape,s.dtype);return Q5(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left,u.filterDepth,u.filterHeight,u.filterWidth),d}};var e8={kernelName:em,backendName:"wasm",setupFunc:function(e){Z5=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,{filterSize:i,strides:o,pad:l}=a,c=WE.computePool2DInfo(s.shape,i,o,1,l),u=n.makeOutput(s.shape,s.dtype);return Z5(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left,c.filterHeight,c.filterWidth),u}};function t8(e){let{inputs:t,attrs:n}=e,{x:a}=t,{shape:r}=n,s=gb.sizeFromShape(a.shape),i=gb.inferFromImplicitShape(r,s);return gb.assert(s===gb.sizeFromShape(i),()=>"new shape: ".concat(i,", old shape: ").concat(a.shape,". New shape and old shape must have the same number of elements.")),e.backend.incRef(a.dataId),{dataId:a.dataId,shape:i,dtype:a.dtype}}var n8,a8={kernelName:ny,backendName:"wasm",kernelFunc:t8};var r8={kernelName:am,backendName:"wasm",setupFunc:function(e){n8=e.wasm.cwrap(am,null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:s}=t,{transposeA:i,transposeB:o}=a;if("float32"!==r.dtype||"float32"!==s.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let l=r.shape.length,c=s.shape.length,u=i?r.shape[l-2]:r.shape[l-1],d=o?s.shape[c-1]:s.shape[c-2],p=i?r.shape[l-1]:r.shape[l-2],h=o?s.shape[c-2]:s.shape[c-1],f=r.shape.slice(0,-2),m=s.shape.slice(0,-2),g=gb.sizeFromShape(f),y=gb.sizeFromShape(m),b=_k.assertAndGetBroadcastShape(r.shape.slice(0,-2),s.shape.slice(0,-2)).concat([p,h]);gb.assert(u===d,()=>"Error in matMul: inner shapes (".concat(u,") and (").concat(d,") of Tensors with shapes ").concat(r.shape," and ").concat(s.shape," and transposeA=").concat(i," and transposeB=").concat(o," must match."));let v=o?[y,h,d]:[y,d,h],x=t8({inputs:{x:r},backend:n,attrs:{shape:i?[g,u,p]:[g,p,u]}}),w=t8({inputs:{x:s},backend:n,attrs:{shape:v}}),k=n.dataIdMap.get(x.dataId).id,S=n.dataIdMap.get(w.dataId).id,N=i?x.shape[2]:x.shape[1],I=o?w.shape[1]:w.shape[2],C=Math.max(g,y),T=n.makeOutput([C,N,I],x.dtype),E=n.dataIdMap.get(T.dataId).id,_=new Uint8Array(new Int32Array(x.shape).buffer),A=new Uint8Array(new Int32Array(w.shape).buffer);return n8(k,_,x.shape.length,S,A,w.shape.length,i,o,E),n.disposeData(x.dataId),n.disposeData(w.dataId),T.shape=b,T}};function s8(e){let{inputs:{x:t},attrs:{begin:n,size:a},backend:r}=e,[s,i]=mE.parseSliceParams(t,n,a),o=mE.isSliceContinous(t.shape,s,i),l=r.readSync(t.dataId),c=r.makeOutput(i,t.dtype),u=gb.computeStrides(t.shape),d=r.dataIdMap.get(c.dataId);if(o){let e=mE.computeFlatOffset(s,u);return"string"===t.dtype?d.stringBytes=l.slice(e,e+gb.sizeFromShape(i)):r.typedArrayFromHeap(c).set(l.subarray(e,e+gb.sizeFromShape(i))),c}if("string"===t.dtype){let e=hG(l,s,i,t.shape,t.dtype);return d.stringBytes=e,c}let p=r.typedArrayFromHeap(c),h=t.shape.length;if(2===h)!function(e,t,n,a,r){let s=0,i=a[0],o=a[1],l=i+r[0];for(let c=i;c<l;c++){let a=c*t+o;n.set(e.subarray(a,a+r[1]),s),s+=r[1]}}(l,u[0],p,s,i);else if(3===h)!function(e,t,n,a,r,s){let i=0,o=r[0],l=r[1],c=r[2],u=o+s[0],d=l+s[1];for(let p=o;p<u;p++)for(let r=l;r<d;r++){let o=p*t+r*n+c;a.set(e.subarray(o,o+s[2]),i),i+=s[2]}}(l,u[0],u[1],p,s,i);else if(4===h)!function(e,t,n,a,r,s,i){let o=0,l=s[0],c=s[1],u=s[2],d=l+i[0],p=c+i[1],h=u+i[2],f=s[3];for(let m=l;m<d;m++)for(let s=c;s<p;s++)for(let l=u;l<h;l++){let c=m*t+s*n+l*a+f;r.set(e.subarray(c,c+i[3]),o),o+=i[3]}}(l,u[0],u[1],u[2],p,s,i);else{let e=hG(l,s,i,t.shape,t.dtype);p.set(e)}return c}var i8={kernelName:gy,backendName:"wasm",kernelFunc:s8};var o8,l8={kernelName:rm,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:s,crops:i}=a,o=s.reduce((e,t)=>e*t),l=WE.getReshaped(r.shape,s,o),c=WE.getPermuted(l.length,s.length),u=WE.getReshapedPermuted(r.shape,s,o),d=WE.getSliceBeginCoords(i,s.length),p=WE.getSliceSize(u,i,s.length),h=t8({inputs:{x:r},backend:n,attrs:{shape:l}}),f=F5({inputs:{x:h},backend:n,attrs:{perm:c}}),m=t8({inputs:{x:f},backend:n,attrs:{shape:u}}),g=s8({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return n.disposeData(h.dataId),n.disposeData(f.dataId),n.disposeData(m.dataId),g}};var c8={kernelName:sm,backendName:"wasm",setupFunc:function(e){o8=e.wasm.cwrap(sm,null,["number","number","boolean","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r,weights:s}=n,{size:i}=a,o=0!==s.shape.reduce((e,t)=>e*t,1),l=1===r.shape.length?[i]:[r.shape[0],i],c=t.makeOutput(l,s.dtype);function u(e){return t.dataIdMap.get(e.dataId).id}return o8(u(r),i,o,u(s),m5[s.dtype],u(c)),c}},u8=I5(im);var d8={kernelName:lm,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,s=n.typedArrayFromHeap(a),i=n.typedArrayFromHeap(r),o=WE.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return n.makeOutput([o.length],"int32",void 0,new Int32Array(o))}};function p8(e){let{inputs:{x:t},attrs:{dtype:n},backend:a}=e,r=a.makeOutput(t.shape,n),s=a.typedArrayFromHeap(t);return a.typedArrayFromHeap(r).set(s),r}var h8,f8={kernelName:cm,backendName:"wasm",kernelFunc:p8},m8=w5(um);var g8={kernelName:dm,backendName:"wasm",setupFunc:function(e){h8=e.wasm.cwrap(dm,null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{clipValueMin:s,clipValueMax:i}=a,o=n.dataIdMap.get(r.dataId).id,l=n.makeOutput(r.shape,r.dtype),c=n.dataIdMap.get(l.dataId).id;return h8(o,s,i,c),l}};function y8(e){let{inputs:t,backend:n}=e,a=gb.parseAxisParam(e.attrs.axis,t[0].shape)[0],r=t.map(e=>e.shape);WE.assertParamsConsistent(r,a);let s=WE.computeOutShape(t.map(e=>e.shape),a),i=t.filter(e=>gb.sizeFromShape(e.shape)>0);if(1===i.length)return _5({inputs:{x:i[0]},backend:n});let o=n.makeOutput(s,t[0].dtype);if(0===gb.sizeFromShape(s))return o;if("string"===i[0].dtype){let e=i.map(e=>{let t=[-1,gb.sizeFromShape(e.shape.slice(a))];return t8({inputs:{x:e},backend:n,attrs:{shape:t}})}),r=e.map(e=>({vals:n.readSync(e.dataId),shape:e.shape}));s=WE.computeOutShape(e.map(e=>e.shape),1);let l=1===e[0].shape[0],c=KU(r,s,t[0].dtype,l),u=WE.computeOutShape(i.map(e=>e.shape),a);return o.shape=u,n.dataIdMap.get(o.dataId).stringBytes=WE.fromStringArrayToUint8(c),e.forEach(e=>n.disposeData(e.dataId)),o}let l=gb.sizeFromShape(i[0].shape.slice(0,a)),c=0,u=i.map(e=>{let t=gb.sizeFromShape(e.shape.slice(a));return c+=t,t}),d=i.map(e=>n.typedArrayFromHeap(e)),p=n.typedArrayFromHeap(o);for(let h=0;h<l;h++){let e=h*c;for(let t=0;t<d.length;t++){let n=u[t],a=h*n,r=d[t].subarray(a,a+n);p.set(r,e),e+=n}}return o}var b8,v8={kernelName:fm,backendName:"wasm",kernelFunc:y8};var x8,w8={kernelName:mm,backendName:"wasm",setupFunc:function(e){b8=e.wasm.cwrap(mm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:s}=t,i=a.dataIdMap.get(r.dataId).id,o=a.dataIdMap.get(s.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:d,dataFormat:p}=n,h=WE.convertConv2DDataFormat(p),f=WE.computeConv2DInfo(r.shape,s.shape,l,c,u,d,!1,h),m=f.filterHeight,g=f.filterWidth,y=f.padInfo.top,b=f.padInfo.right,v=f.padInfo.bottom,x=f.padInfo.left,w=f.dilationHeight,k=f.dilationWidth,S=f.strideHeight,N=f.strideWidth,I=f.inChannels,C=f.outChannels,T="SAME"===f.padInfo.type?1:0;if("channelsLast"!==f.dataFormat)throw new Error("wasm backend Conv2D does not support dataFormat:'".concat(f.dataFormat,"'. Please use 'channelsLast'."));let E=a.makeOutput(f.outShape,"float32"),_=a.dataIdMap.get(E.dataId).id;return b8(i,r.shape[0],r.shape[1],r.shape[2],o,m,g,y,b,v,x,T,w,k,S,N,I,C,_),E}};var k8,S8={kernelName:ym,backendName:"wasm",setupFunc:function(e){x8=e.wasm.cwrap(ym,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{dy:r,filter:s}=n,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,inputShape:u}=a,d=WE.convertConv2DDataFormat(l),p=WE.computeConv2DInfo(u,s.shape,i,1,o,c,!1,d),{batchSize:h,filterHeight:f,filterWidth:m,inChannels:g,inHeight:y,inWidth:b,outChannels:v,outHeight:x,outWidth:w,strideHeight:k,strideWidth:S}=p,N=f-1-p.padInfo.top,I=m-1-p.padInfo.left,C="channelsLast"===p.dataFormat,T=gb.computeStrides(p.inShape),E=gb.computeStrides(r.shape),[_,A,R]=gb.computeStrides(s.shape),F=T[0],D=C?T[1]:T[2],M=C?T[2]:1,O=C?1:T[1],P=E[0],L=C?E[1]:E[2],z=C?E[2]:1,j=C?1:E[1],B=t.makeOutput(p.inShape,"float32"),W=t.dataIdMap.get(B.dataId).id,V=t.dataIdMap.get(r.dataId).id,U=t.dataIdMap.get(s.dataId).id;return x8(V,U,h,f,m,y,b,g,x,w,v,k,S,N,I,_,A,R,F,D,M,O,P,L,z,j,W),B}};var N8,I8={kernelName:bm,backendName:"wasm",setupFunc:function(e){k8=e.wasm.cwrap(bm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dilations:l}=a;if("float32"!==r.dtype)throw new Error("Tensor x must have dtype float32, got ".concat(r.dtype));if("float32"!==s.dtype)throw new Error("Tensor filter must have dtype float32, got ".concat(s.dtype));let c=WE.computeConv3DInfo(r.shape,s.shape,i,l,o),u=n.makeOutput(c.outShape,r.dtype);return k8(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}};var C8,T8={kernelName:vm,backendName:"wasm",setupFunc:function(e){N8=e.wasm.cwrap(vm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:s}=t,{strides:i,pad:o,filterShape:l}=a;if("float32"!==r.dtype)throw new Error("Tensor dy must have dtype float32, got ".concat(r.dtype));if("float32"!==s.dtype)throw new Error("Tensor filter must have dtype float32, got ".concat(s.dtype));let c=WE.computeConv3DInfo(r.shape,l,i,1,o),u=n.makeOutput(c.filterShape,s.dtype);return N8(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}};var E8,_8,A8={kernelName:xm,backendName:"wasm",setupFunc:function(e){C8=e.wasm.cwrap(xm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:s}=t,{pad:i,strides:o,inputShape:l}=a;if("float32"!==r.dtype)throw new Error("Tensor dy must have dtype float32, got ".concat(r.dtype));if("float32"!==s.dtype)throw new Error("Tensor filter must have dtype float32, got ".concat(s.dtype));let c=WE.computeConv3DInfo(l,s.shape,o,1,i),u=n.makeOutput(c.inShape,r.dtype);return C8(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}},R8=w5(wm),F8=w5(km);!function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"}(E8||(E8={}));var D8,M8={kernelName:Im,backendName:"wasm",setupFunc:function(e){_8=e.wasm.cwrap(Im,null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{method:s,extrapolationValue:i,cropSize:o}=r,{image:l,boxes:c,boxInd:u}=a,d=c.shape[0],[p,h]=o,f=[d,p,h,l.shape[3]],m=n.dataIdMap.get(l.dataId);"float32"!==l.dtype&&(t=p8({backend:n,inputs:{x:l},attrs:{dtype:"float32"}}),m=n.dataIdMap.get(t.dataId));let g=m.id,y=n.dataIdMap.get(c.dataId).id,b=n.dataIdMap.get(u.dataId).id,v=n.makeOutput(f,"float32"),x=n.dataIdMap.get(v.dataId).id,w=new Uint8Array(new Int32Array(l.shape).buffer);return _8(g,y,b,d,w,p,h,E8[s],i,x),null!=t&&n.disposeData(t.dataId),v}};var O8,P8={kernelName:Sm,backendName:"wasm",setupFunc:function(e){D8=e.wasm.cwrap(Sm,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,exclusive:i,reverse:o}=a,l=r.shape.length;gb.assert("float32"===r.dtype||"int32"===r.dtype,()=>"cumprod does not support ".concat(r.dtype," tensors in the WASM backend"));let c=WE.getAxesPermutation([s],l),u=r;null!==c&&(u=F5({inputs:{x:r},attrs:{perm:c},backend:n}));let d=WE.getInnerMostAxes(1,l)[0];WE.assertAxesAreInnerMostDims("cumprod",[d],l);let p=n.makeOutput(u.shape,u.dtype),h=u.shape[d],f=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;D8(f,i?1:0,o?1:0,h,m,m5[r.dtype]);let g=p;if(null!==c){g=F5({inputs:{x:p},attrs:{perm:WE.getUndoAxesPermutation(c)},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return g}};var L8,z8={kernelName:Nm,backendName:"wasm",setupFunc:function(e){O8=e.wasm.cwrap(Nm,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:s,exclusive:i,reverse:o}=a,l=r.shape.length;gb.assert("float32"===r.dtype||"int32"===r.dtype,()=>"cumsum does not support ".concat(r.dtype," tensors in the WASM backend"));let c=WE.getAxesPermutation([s],l),u=r;null!==c&&(u=F5({inputs:{x:r},attrs:{perm:c},backend:n}));let d=WE.getInnerMostAxes(1,l)[0];WE.assertAxesAreInnerMostDims("cumsum",[d],l);let p=n.makeOutput(u.shape,u.dtype),h=u.shape[d],f=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;O8(f,i?1:0,o?1:0,h,m,m5[r.dtype]);let g=p;if(null!==c){g=F5({inputs:{x:p},attrs:{perm:WE.getUndoAxesPermutation(c)},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return g}};var j8,B8={kernelName:Cm,backendName:"wasm",setupFunc:function(e){L8=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r,weights:s}=n,{size:i,binaryOutput:o}=a,l=0!==s.shape.reduce((e,t)=>e*t,1),c=1===r.shape.length?[i]:[r.shape[0],i],u=t.makeOutput(c,s.dtype);function d(e){return t.dataIdMap.get(e.dataId).id}return L8(d(r),new Uint8Array(new Int32Array(r.shape).buffer),r.shape.length,i,l,d(s),m5[s.dtype],o,d(u)),u}};var W8,V8={kernelName:Tm,backendName:"wasm",setupFunc:function(e){j8=e.wasm.cwrap(Tm,null,["number","number","number","array","number","array","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r}=n,{blockSize:s,dataFormat:i}=a,o=r.shape[0],l=("NHWC"===i?r.shape[1]:r.shape[2])*s,c=("NHWC"===i?r.shape[2]:r.shape[3])*s,u=("NHWC"===i?r.shape[3]:r.shape[1])/(s*s),d="NHWC"===i?[o,l,c,u]:[o,u,l,c],p=t.makeOutput(d,"float32"),h=t.dataIdMap.get(r.dataId).id,f=new Uint8Array(new Int32Array(gb.computeStrides(r.shape)).buffer),m=new Uint8Array(new Int32Array(d).buffer),g=new Uint8Array(new Int32Array(gb.computeStrides(d)).buffer),y=t.dataIdMap.get(p.dataId).id;return j8(h,s,"NHWC"===i?1:0,f,r.shape.length-1,m,g,d.length,y),p}};var U8,H8={kernelName:Em,backendName:"wasm",setupFunc:function(e){W8=e.wasm.cwrap(Em,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:s}=t,i=a.dataIdMap.get(r.dataId).id,o=a.dataIdMap.get(s.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:d}=n,p=null==c?[1,1]:c,h=WE.computeConv2DInfo(r.shape,s.shape,l,p,u,d,!0),f=h.filterHeight,m=h.filterWidth,g=h.padInfo.top,y=h.padInfo.right,b=h.padInfo.bottom,v=h.padInfo.left,x=h.dilationHeight,w=h.dilationWidth,k=h.strideHeight,S=h.strideWidth,N=h.inChannels,I=h.outChannels,C="SAME"===h.padInfo.type?1:0;if("channelsLast"!==h.dataFormat)throw new Error("wasm backend DepthwiseConv2dNative does not support dataFormat:'".concat(h.dataFormat,"'. Please use 'channelsLast'."));let T=a.makeOutput(h.outShape,"float32"),E=a.dataIdMap.get(T.dataId).id;return W8(i,r.shape[0],r.shape[1],r.shape[2],o,f,m,g,y,b,v,C,x,w,k,S,N,I,E),T}};var G8,q8={kernelName:Rm,backendName:"wasm",setupFunc:function(e){U8=e.wasm.cwrap("Diag",null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=gb.sizeFromShape(a.shape),s=n.makeOutput([...a.shape,...a.shape],a.dtype);return U8(n.dataIdMap.get(a.dataId).id,m5[a.dtype],r,n.dataIdMap.get(s.dataId).id),s}};var K8,X8={kernelName:Fm,backendName:"wasm",setupFunc:function(e){G8=e.wasm.cwrap(Fm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s}=t,{strides:i,pad:o,dilations:l}=a;if(r.dtype!==s.dtype)throw new Error("Dilation2D error: x must have the same dtype as filter. Got ".concat(r.dtype," and ").concat(s.dtype));let c=WE.computeDilation2DInfo(r.shape,s.shape,i,o,"NHWC",l),u=n.makeOutput(c.outShape,r.dtype);return G8(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(u.dataId).id,m5[r.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),u}};var Y8,Q8={kernelName:Mm,backendName:"wasm",setupFunc:function(e){K8=e.wasm.cwrap(Mm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s,dy:i}=t,{strides:o,pad:l,dilations:c}=a;if(r.dtype!==s.dtype||r.dtype!==i.dtype)throw new Error("Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ".concat(r.dtype,", ").concat(s.dtype,", and ").concat(i.dtype));let u=WE.computeDilation2DInfo(r.shape,s.shape,o,l,"NHWC",c),d=n.makeOutput(s.shape,s.dtype);return K8(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,m5[r.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),d}};var J8,Z8={kernelName:Dm,backendName:"wasm",setupFunc:function(e){Y8=e.wasm.cwrap(Dm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:s,dy:i}=t,{strides:o,pad:l,dilations:c}=a;if(r.dtype!==s.dtype||r.dtype!==i.dtype)throw new Error("Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ".concat(r.dtype,", ").concat(s.dtype,", and ").concat(i.dtype));let u=WE.computeDilation2DInfo(r.shape,s.shape,o,l,"NHWC",c),d=n.makeOutput(r.shape,r.dtype);return Y8(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,m5[r.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),d}},$8=w5(zm);var e7={kernelName:jm,backendName:"wasm",setupFunc:function(e){J8=e.wasm.cwrap(jm,null,["number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{dy:a,y:r}=t,s=n.makeOutput(r.shape,"float32"),i=e=>n.dataIdMap.get(e.dataId).id;return J8(i(r),i(a),i(s)),s}},t7=I5(Wm,0,"bool"),n7=w5(Bm),a7=w5(Vm,"float32");function r7(e){let{inputs:t,attrs:n,backend:a}=e,{input:r}=t,{dim:s}=n,i=r.shape.length,o=r.shape.slice(),l=s;return s<0&&(gb.assert(-(i+1)<=s,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),l=i+s+1),o.splice(l,0,1),t8({inputs:{x:r},backend:a,attrs:{shape:o}})}var s7={kernelName:Um,backendName:"wasm",kernelFunc:r7},i7=w5(Hm,"float32");function o7(e){let{attrs:{shape:t,value:n},backend:a}=e,{attrs:{dtype:r}}=e;r=r||gb.inferDtype(n);let s=a.makeOutput(t,r);return a.typedArrayFromHeap(s).fill(n),s}var l7,c7={kernelName:qm,backendName:"wasm",kernelFunc:o7};var u7,d7={kernelName:Km,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{image:a}=t,r=n.makeOutput(a.shape,a.dtype),s=n.dataIdMap.get(a.dataId).id,i=n.dataIdMap.get(r.dataId).id,[o,l,c,u]=a.shape;return l7(s,o,l,c,u,i),r},setupFunc:function(e){l7=e.wasm.cwrap(Km,null,["number","number","number","number","number","number"])}},p7=w5(Xm),h7=I5(Ym);var f7,m7={kernelName:Qm,backendName:"wasm",setupFunc:function(e){u7=e.wasm.cwrap(Qm,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{varianceEpsilon:r}=a,{x:s,mean:i,variance:o,offset:l,scale:c}=n,u=t.dataIdMap.get(s.dataId).id,d=t.dataIdMap.get(i.dataId).id,p=t.dataIdMap.get(o.dataId).id,h=null!=l?t.dataIdMap.get(l.dataId).id:0,f=null!=c?t.dataIdMap.get(c.dataId).id:0,m=t.makeOutput(s.shape,s.dtype);if(0===gb.sizeFromShape(s.shape))return m;let g=t.dataIdMap.get(m.dataId).id;return u7(u,d,p,h,f,r,g),m}};var g7,y7={kernelName:tb,backendName:"wasm",setupFunc:function(e){f7=e.wasm.cwrap(tb,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=WE.computeConv2DInfo(r.shape,s.shape,l,u,c,p),g=g5[h];if(null==g)throw new Error("".concat(h," activation not yet supported for FusedConv2D in the wasm backend."));let y=a.dataIdMap.get(r.dataId).id,b=a.dataIdMap.get(s.dataId).id,v=m.outChannels,x=0;if(null!=i){let e=a.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error("FusedConv2D only supports rank-1 bias but got rank ".concat(e.shape.length,"."));if(e.shape[0]!==v)throw new Error("FusedConv2D bias shape (".concat(e.shape,") does not match the number of output channels (").concat(v,")"));x=e.id}let w=m.filterHeight,k=m.filterWidth,S=m.padInfo.top,N=m.padInfo.right,I=m.padInfo.bottom,C=m.padInfo.left,T=m.dilationHeight,E=m.dilationWidth,_=m.strideHeight,A=m.strideWidth,R=m.inChannels,F="SAME"===m.padInfo.type?1:0,D=m.batchSize,M=m.inHeight,O=m.inWidth;if("NHWC"!==d)throw new Error("wasm backend FusedConv2D does not support dataFormat:'".concat(d,"'. Please use 'NHWC'."));let P=a.makeOutput(m.outShape,"float32"),L=a.dataIdMap.get(P.dataId).id,z=null==o?0:a.dataIdMap.get(o.dataId).id;return f7(y,D,M,O,b,w,k,x,S,N,I,C,F,T,E,_,A,R,v,g,z,f||0,L),P}};var b7,v7={kernelName:nb,backendName:"wasm",setupFunc:function(e){g7=e.wasm.cwrap(nb,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=WE.computeConv2DInfo(r.shape,s.shape,l,u,c,p,!0),g=g5[h];if(null==g)throw new Error("".concat(h," activation not yet supported for FusedDepthwiseConv2D in the wasm backend."));let y=a.dataIdMap.get(r.dataId).id,b=a.dataIdMap.get(s.dataId).id,v=m.outChannels,x=0;if(null!=i){let e=a.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error("FusedDepthwiseConv2D only supports rank-1 bias but got rank ".concat(e.shape.length,"."));if(e.shape[0]!==v)throw new Error("FusedDepthwiseConv2D bias shape (".concat(e.shape,") does not match the number of output channels (").concat(v,")"));x=e.id}let w=m.filterHeight,k=m.filterWidth,S=m.padInfo.top,N=m.padInfo.right,I=m.padInfo.bottom,C=m.padInfo.left,T=m.dilationHeight,E=m.dilationWidth,_=m.strideHeight,A=m.strideWidth,R=m.inChannels,F="SAME"===m.padInfo.type?1:0,D=m.batchSize,M=m.inHeight,O=m.inWidth;if("NHWC"!==d)throw new Error("wasm backend FusedDepthwiseConv2D does not support dataFormat:'".concat(d,"'. Please use 'NHWC'."));let P=a.makeOutput(m.outShape,"float32"),L=a.dataIdMap.get(P.dataId).id,z=null==o?0:a.dataIdMap.get(o.dataId).id;return g7(y,D,M,O,b,w,k,x,S,N,I,C,F,T,E,_,A,R,v,g,z,f||0,L),P}};var x7,w7={kernelName:Zm,backendName:"wasm",setupFunc:function(e){b7=e.wasm.cwrap(Zm,null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(e){let{backend:t,inputs:n}=e,{params:a,indices:r}=n,[s,i,o,l]=hE.prepareAndValidate(a,r),c=t.makeOutput(s,a.dtype);if(0===i)return c;let u=r.shape,d=u[u.length-1],p=t.dataIdMap.get(a.dataId).id,h=t.dataIdMap.get(r.dataId).id,f=new Uint8Array(new Int32Array(l).buffer),m=t.dataIdMap.get(c.dataId).id;return b7(p,m5[a.dtype],h,i,d,o,f,m),c}};var k7,S7={kernelName:Jm,backendName:"wasm",setupFunc:function(e){x7=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r,indices:s}=n,{axis:i,batchDims:o}=a,l=gb.parseAxisParam(i,r.shape)[0],c=t.readSync(s.dataId),u=r.shape[l];for(let S=0;S<c.length;++S){let e=c[S];gb.assert(e<=u-1&&e>=0,()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(u-1,"]"))}let d=WE.segment_util.collectGatherOpShapeInfo(r,s,l,o),p=t8({inputs:{x:r},attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]},backend:t}),h=gb.sizeFromShape(s.shape),f=t8({inputs:{x:s},attrs:{shape:[d.batchSize,h/d.batchSize]},backend:t}),m=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],g=t.makeOutput(m,r.dtype);if(0===gb.sizeFromShape(r.shape))return g;let y=p.shape.length-1,b=t.dataIdMap.get(p.dataId).id,v=t.dataIdMap.get(f.dataId).id,x=t.dataIdMap.get(g.dataId).id,w=new Uint8Array(new Int32Array(gb.computeStrides(p.shape)).buffer),k=new Uint8Array(new Int32Array(gb.computeStrides(m)).buffer);return x7(b,m5[r.dtype],w,y,v,d.batchSize,k,x),t.disposeData(p.dataId),t.disposeData(f.dataId),g.shape=d.outputShape,g}},N7=I5($m,0,"bool"),I7=I5(eg,0,"bool"),C7=w5(rg,"bool"),T7=w5(sg,"bool"),E7=w5(ig,"bool");var _7,A7={kernelName:og,backendName:"wasm",setupFunc:function(e){k7=e.wasm.cwrap(og,null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:{x:t},attrs:{alpha:n},backend:a}=e,r=a.dataIdMap.get(t.dataId).id,s=a.makeOutput(t.shape,"float32");if(0!==gb.sizeFromShape(t.shape)){let e=a.dataIdMap.get(s.dataId).id;k7(r,m5[t.dtype],n,e)}return s}},R7=I5(lg,0,"bool"),F7=I5(cg,0,"bool");var D7,M7={kernelName:ug,backendName:"wasm",setupFunc:function(e){_7=e.wasm.cwrap(ug,null,["number","number","number","number"])},kernelFunc:function(e){let{attrs:t,backend:n}=e,{start:a,stop:r,num:s}=t,i=Math.floor(s),o=n.makeOutput([i],"float32");return _7(n.dataIdMap.get(o.dataId).id,a,r,i),o}},O7=w5(dg),P7=w5(pg),L7=I5(hg,0,"bool"),z7=w5(fg),j7=I5(mg,0,"bool"),B7=I5(gg,0,"bool");var W7,V7={kernelName:vg,backendName:"wasm",setupFunc:function(e){D7=e.wasm.cwrap(vg,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:s,bias:i,alpha:o,beta:l}=a;if("float32"!==r.dtype)throw new Error("LRN error: x must have dtype float32");let c=n.makeOutput(r.shape,r.dtype);return D7(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(c.dataId).id,r.shape[3],s,i,o,l),c}};var U7,H7={kernelName:xg,backendName:"wasm",setupFunc:function(e){W7=e.wasm.cwrap(xg,null,["number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,y:s,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=a;if("float32"!==r.dtype||"float32"!==s.dtype||"float32"!==i.dtype)throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let d=n.makeOutput(r.shape,r.dtype);return W7(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,i.shape[3],o,l,c,u),d}};var G7,q7={kernelName:kg,backendName:"wasm",setupFunc:function(e){U7=e.wasm.cwrap(kg,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{reductionIndices:r,keepDims:s}=a,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=O5(i,r,t);if(p){l=c,o=t.dataIdMap.get(c.dataId).id}let h=l.shape.length;WE.assertAxesAreInnerMostDims("max",u,h);let[f,m]=WE.computeOutAndReduceShapes(l.shape,u),g=gb.sizeFromShape(m),y=t.makeOutput(f,i.dtype);if(0!==gb.sizeFromShape(l.shape)){let e=t.dataIdMap.get(y.dataId).id;U7(o,m5[i.dtype],g,e)}if(p&&t.disposeData(c.dataId),s){let e=WE.expandShapeToKeepDim(y.shape,d);y.shape=e}return y}},K7=I5(Sg);var X7,Y7={kernelName:Ng,backendName:"wasm",setupFunc:function(e){G7=e.wasm.cwrap(Ng,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,r=t.x,s=a.dataIdMap.get(r.dataId).id;gb.assert("float32"===r.dtype,()=>"Error in MaxPool: only float32 input is supported. Got ".concat(r.dtype,"."));let{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=n,u=WE.computePool2DInfo(r.shape,i,o,1,l,c),d=u.filterHeight,p=u.filterWidth,h=u.padInfo.top,f=u.padInfo.right,m=u.padInfo.bottom,g=u.padInfo.left,y=u.dilationHeight,b=u.dilationWidth,v=u.strideHeight,x=u.strideWidth,w=u.inChannels,k=u.outChannels;if("channelsLast"!==u.dataFormat)throw new Error("wasm backend does not support dataFormat:'".concat(u.dataFormat,"'. Please use 'channelsLast'."));let S=a.makeOutput(u.outShape,"float32"),N=a.dataIdMap.get(S.dataId).id;return G7(s,r.shape[0],r.shape[1],r.shape[2],d,p,h,f,m,g,y,b,v,x,w,k,N),S}};var Q7,J7={kernelName:Cg,backendName:"wasm",setupFunc:function(e){X7=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a,u=WE.computePool3DInfo(r.shape,s,i,1,o,l,c),d=n.makeOutput(u.outShape,r.dtype);return X7(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}};var Z7,$7={kernelName:Tg,backendName:"wasm",setupFunc:function(e){Q7=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=a,u=WE.computePool3DInfo(s.shape,i,o,1,l,c),d=n.makeOutput(s.shape,s.dtype);return Q7(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}};var e9,t9={kernelName:Ig,backendName:"wasm",setupFunc:function(e){Z7=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=a,u=WE.computePool2DInfo(s.shape,i,o,1,l,c),d=n.makeOutput(s.shape,s.dtype);return Z7(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),d}};var n9,a9={kernelName:Eg,backendName:"wasm",setupFunc:function(e){e9=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:l}=a;gb.assert(4===r.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(r.shape.length,"."));let c=[1,1];gb.assert(WE.eitherStridesOrDilationsAreOne(i,c),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(c,"'"));let u=WE.computePool2DInfo(r.shape,s,i,[1,1],o),d=n.makeOutput(u.outShape,r.dtype),p=n.makeOutput(u.outShape,"int32");return e9(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,n.dataIdMap.get(p.dataId).id,m5[r.dtype],l,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),[d,p]}};var r9,s9={kernelName:_g,backendName:"wasm",setupFunc:function(e){n9=e.wasm.cwrap(_g,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:s}=a,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=O5(i,r,t),f=d;if(h){let e=t.dataIdMap.get(u.dataId).id;e!==o&&(c=u,l=e,f=WE.getInnerMostAxes(f.length,c.shape.length))}WE.assertAxesAreInnerMostDims("mean",f,c.shape.length);let[m,g]=WE.computeOutAndReduceShapes(c.shape,f),y=gb.sizeFromShape(g),b=c;"float32"!==c.dtype&&(b=p8({backend:t,inputs:{x:c},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(b.dataId).id);let v=t.makeOutput(m,"float32");if(0!==gb.sizeFromShape(c.shape)){let e=t.dataIdMap.get(v.dataId).id;n9(l,y,e)}if(h&&t.disposeData(u.dataId),s){let e=WE.expandShapeToKeepDim(v.shape,p);v.shape=e}return"float32"!==c.dtype&&t.disposeData(b.dataId),v}};var i9,o9,l9={kernelName:Ag,backendName:"wasm",setupFunc:function(e){r9=e.wasm.cwrap(Ag,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:s}=a,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=O5(i,r,t);if(h){let e=t.dataIdMap.get(u.dataId).id;e!==o&&(c=u,l=e)}let f=c.shape.length;WE.assertAxesAreInnerMostDims("min",d,f);let[m,g]=WE.computeOutAndReduceShapes(c.shape,d),y=gb.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(0!==gb.sizeFromShape(c.shape)){let e=t.dataIdMap.get(b.dataId).id;r9(l,m5[i.dtype],y,e)}if(h&&t.disposeData(u.dataId),s){let e=WE.expandShapeToKeepDim(b.shape,p);b.shape=e}return b}},c9=I5(Rg);!function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"}(i9||(i9={}));var u9,d9={kernelName:Fg,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n,attrs:{paddings:a,mode:r}}=e,s=a.map((e,n)=>e[0]+t.shape[n]+e[1]),i=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(s,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=a.map(e=>e[0]),d=a.map(e=>e[1]),p=new Uint8Array(new Int32Array(u).buffer),h=new Uint8Array(new Int32Array(d).buffer);return o9(i,c,t.shape.length,m5[t.dtype],p,h,i9[r],l),o},setupFunc:function(e){o9=e.wasm.cwrap(Fg,null,["number","array","number","number","array","array","number","number"])}};function p9(e){let{backend:t,inputs:{logits:n},attrs:{dim:a}}=e,r=t.dataIdMap.get(n.dataId).id,s=t.makeOutput(n.shape,n.dtype),i=t.dataIdMap.get(s.dataId).id,o=n.shape[a],l=gb.sizeFromShape(n.shape)/o;return 0===gb.sizeFromShape(s.shape)||u9(r,i,o,l),s}var h9,f9={kernelName:Cy,backendName:"wasm",setupFunc:function(e){u9=e.wasm.cwrap(Cy,null,["number","number","number","number"])},kernelFunc:p9};var m9,g9={kernelName:Mg,backendName:"wasm",setupFunc:function(e){h9=e.wasm.cwrap(Mg,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:s,seed:i,normalized:o}=a;if("float32"!==r.dtype)throw new Error("Tensor logits must have dtype float32, got ".concat(r.dtype));let l=o?r:p9({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),[c,u]=l.shape,d=n.makeOutput([c,s],"int32");return h9(n.dataIdMap.get(l.dataId).id,c,u,s,i,n.dataIdMap.get(d.dataId).id),o||n.disposeData(l.dataId),d}},y9=I5(Dg),b9=I5(Og),v9=w5(Pg);function x9(e,t){let n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),a=n[0],r=n[1],s=n[2],i=n[3];return e.wasm._free(t),{pSelectedIndices:a,selectedSize:r,pSelectedScores:s,pValidOutputs:i}}var w9,k9={kernelName:zg,backendName:"wasm",setupFunc:function(e){m9=e.wasm.cwrap(zg,"number",["number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:i}=a,{boxes:o,scores:l}=n,c=t.dataIdMap.get(o.dataId).id,u=t.dataIdMap.get(l.dataId).id,d=m9(c,u,s,r,i),{pSelectedIndices:p,selectedSize:h,pSelectedScores:f,pValidOutputs:m}=x9(t,d);return t.wasm._free(f),t.wasm._free(m),t.makeOutput([h],"int32",p)}};var S9,N9={kernelName:jg,backendName:"wasm",setupFunc:function(e){w9=e.wasm.cwrap(jg,"number",["number","number","number","number","number","bool"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:i,padToMaxOutputSize:o}=a,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=w9(u,d,s,r,i,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=x9(t,p);return t.wasm._free(m),[t.makeOutput([f],"int32",h),t.makeOutput([],"int32",g)]}};var I9,C9={kernelName:Bg,backendName:"wasm",setupFunc:function(e){S9=e.wasm.cwrap(Bg,"number",["number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:i,softNmsSigma:o}=a,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=S9(u,d,s,r,i,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=x9(t,p);return t.wasm._free(g),[t.makeOutput([f],"int32",h),t.makeOutput([f],"float32",m)]}},T9=I5(Lg,0,"bool");var E9={kernelName:Vg,backendName:"wasm",setupFunc:function(e){I9=e.wasm.cwrap(Vg,null,["number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:s,depth:i,onValue:o,offValue:l}=a,c=n.makeOutput([...r.shape,i],s),u=n.dataIdMap.get(c.dataId).id,d=n.dataIdMap.get(r.dataId).id;return I9(d,i,o,l,u),c}};var _9={kernelName:Wg,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(1),a}};var A9,R9={kernelName:Ug,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return r7({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let s=t[0].shape,i=t[0].dtype;t.forEach(e=>{gb.assertShapesMatch(s,e.shape,"All tensors passed to stack must have matching shapes"),gb.assert(i===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=y8({inputs:t.map(e=>{let t=r7({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeData(e.dataId)),l}};var F9,D9={kernelName:Hg,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n,attrs:{paddings:a,constantValue:r}}=e,s=a.map((e,n)=>e[0]+t.shape[n]+e[1]);if(0===gb.sizeFromShape(t.shape))return o7({backend:n,attrs:{shape:s,value:r,dtype:t.dtype}});let i=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(s,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=a.map(e=>e[0]),d=a.map(e=>e[1]),p=new Uint8Array(new Int32Array(u).buffer),h=new Uint8Array(new Int32Array(d).buffer);return A9(i,c,t.shape.length,m5[t.dtype],p,h,r,l),o},setupFunc:function(e){A9=e.wasm.cwrap(Hg,null,["number","array","number","number","array","array","number","number"])}},M9=I5(qg);var O9,P9={kernelName:Kg,backendName:"wasm",setupFunc:function(e){F9=e.wasm.cwrap(Kg,null,["number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t,s=n.dataIdMap.get(a.dataId).id,i=n.dataIdMap.get(r.dataId).id,o=s,l=a,c=l;"float32"!==l.dtype&&(c=p8({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),o=n.dataIdMap.get(c.dataId).id);let u=n.makeOutput(a.shape,"float32"),d=n.dataIdMap.get(u.dataId).id;return F9(o,i,d),"float32"!==l.dtype&&n.disposeData(c.dataId),u}};var L9,z9={kernelName:Xg,backendName:"wasm",setupFunc:function(e){O9=e.wasm.cwrap(Xg,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:s}=a,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=O5(i,r,t),f=d;if(h){let e=t.dataIdMap.get(u.dataId).id;e!==o&&(c=u,l=e,f=WE.getInnerMostAxes(f.length,c.shape.length))}WE.assertAxesAreInnerMostDims("prod",f,c.shape.length);let[m,g]=WE.computeOutAndReduceShapes(c.shape,f),y=gb.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(0!==gb.sizeFromShape(c.shape)){let e=t.dataIdMap.get(b.dataId).id;O9(l,y,m5[b.dtype],e)}if(h&&t.disposeData(u.dataId),s){let e=WE.expandShapeToKeepDim(b.shape,p);b.shape=e}return b}},j9={kernelName:Zg,backendName:"wasm",kernelFunc:e=>{let{backend:t,attrs:n}=e,{start:a,stop:r,step:s,dtype:i}=n,o=sG(a,r,s,i),l=t.makeOutput([o.length],i);return t.typedArrayFromHeap(l).set(o),l}},B9=I5(Pm),W9=w5(ey),V9=w5(ty),U9=w5(oy);var H9,G9={kernelName:sy,backendName:"wasm",setupFunc:function(e){L9=e.wasm.cwrap(sy,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{images:s}=a,{alignCorners:i,halfPixelCenters:o,size:l}=r,[c,u]=l,[d,p,h,f]=s.shape,m=[d,c,u,f],g=n.dataIdMap.get(s.dataId);"float32"!==g.dtype&&(t=p8({backend:n,inputs:{x:s},attrs:{dtype:"float32"}}),g=n.dataIdMap.get(t.dataId));let y=g.id,b=n.makeOutput(m,"float32");if(0===gb.sizeFromShape(s.shape))return b;let v=n.dataIdMap.get(b.dataId).id;return L9(y,d,p,h,f,c,u,i?1:0,o?1:0,v),null!=t&&n.disposeData(t.dataId),b}};var q9,K9={kernelName:iy,backendName:"wasm",setupFunc:function(e){H9=e.wasm.cwrap(iy,null,["number","number","number","array","array","boolean"])},kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{images:s,dy:i}=n,{alignCorners:o}=r,l=a.makeOutput(s.shape,"float32"),c=a.dataIdMap.get(s.dataId);return"float32"!==c.dtype&&(t=p8({backend:a,inputs:{x:s},attrs:{dtype:"float32"}}),c=a.dataIdMap.get(t.dataId)),H9(a.dataIdMap.get(s.dataId).id,a.dataIdMap.get(i.dataId).id,a.dataIdMap.get(l.dataId).id,new Uint8Array(new Int32Array(s.shape).buffer),new Uint8Array(new Int32Array(i.shape).buffer),o),null!=t&&a.disposeData(t.dataId),l}};var X9,Y9={kernelName:ay,backendName:"wasm",setupFunc:function(e){q9=e.wasm.cwrap(ay,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{images:r}=n,{alignCorners:s,halfPixelCenters:i,size:o}=a,[l,c]=o,[u,d,p,h]=r.shape,f=[u,l,c,h],m=t.makeOutput(f,"float32");if(0===gb.sizeFromShape(r.shape))return m;let g,y=t.dataIdMap.get(r.dataId);"float32"!==y.dtype&&(g=p8({backend:t,inputs:{x:r},attrs:{dtype:"float32"}}),y=t.dataIdMap.get(g.dataId));let b=y.id,v=t.dataIdMap.get(m.dataId).id;return q9(b,u,d,p,h,l,c,s?1:0,i?1:0,v),null!=g&&t.disposeData(g.dataId),m}};var Q9,J9={kernelName:ry,backendName:"wasm",setupFunc:function(e){X9=e.wasm.cwrap(ry,null,["number","number","number","array","array","boolean"])},kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{images:s,dy:i}=n,{alignCorners:o}=r,l=a.makeOutput(s.shape,"float32"),c=a.dataIdMap.get(s.dataId);return"float32"!==c.dtype&&(t=p8({backend:a,inputs:{x:s},attrs:{dtype:"float32"}}),c=a.dataIdMap.get(t.dataId)),X9(a.dataIdMap.get(s.dataId).id,a.dataIdMap.get(i.dataId).id,a.dataIdMap.get(l.dataId).id,new Uint8Array(new Int32Array(s.shape).buffer),new Uint8Array(new Int32Array(i.shape).buffer),o),null!=t&&a.disposeData(t.dataId),l}};var Z9,$9={kernelName:ly,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:s}=a,i=gb.parseAxisParam(s,r.shape);if(0===r.shape.length)return _5({inputs:{x:r},backend:n});let o=n.makeOutput(r.shape,r.dtype),l=n.dataIdMap.get(r.dataId).id,c=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(i).buffer),d=new Uint8Array(new Int32Array(r.shape).buffer);Q9(l,u,i.length,d,r.shape.length,c);let p=t8({inputs:{x:o},attrs:{shape:r.shape},backend:n});return n.disposeData(o.dataId),p},setupFunc:function(e){Q9=e.wasm.cwrap(ly,null,["number","array","number","array","number","number"])}};var eee,tee={kernelName:$y,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r}=t,{radians:s,fillValue:i,center:o}=a,l=n.makeOutput(r.shape,r.dtype),c=n.dataIdMap.get(r.dataId).id,u=n.dataIdMap.get(l.dataId).id,[d,p,h,f]=r.shape,[m,g]=WE.getImageCenter(o,p,h),y="number"==typeof i?[i,i,i,0===i?0:255]:[...i,255],b=new Uint8Array(new Int32Array(y).buffer);return Z9(c,d,p,h,f,s,m,g,b,y.length,u),l},setupFunc:function(e){Z9=e.wasm.cwrap($y,null,["number","number","number","number","number","number","number","number","array","number","number"])}},nee=w5(cy),aee=w5(uy);var ree,see={kernelName:dy,backendName:"wasm",setupFunc:function(e){eee=e.wasm.cwrap(dy,null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{indices:r,updates:s}=n,{shape:i}=a,o=t.makeOutput(i,s.dtype);if(0===gb.sizeFromShape(i))return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=DI.calculateShapes(s,r,i),h=t.dataIdMap.get(r.dataId).id,f=t.dataIdMap.get(s.dataId).id,m=new Uint8Array(new Int32Array(d).buffer),g=t.dataIdMap.get(o.dataId).id;return eee(h,f,m5[s.dtype],l,c,u,m,p,g),o}};var iee,oee={kernelName:hy,backendName:"wasm",setupFunc:function(e){ree=e.wasm.cwrap(hy,null,["number","number","number","number","number","number","bool","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:s}=t,{side:i}=a;if(r.dtype!==s.dtype)throw new Error("SearchSorted error: sorted_sequence must have the same dtype as values. Got ".concat(r.dtype," and ").concat(s.dtype));let o=n.makeOutput(s.shape,"int32");function l(e){return n.dataIdMap.get(e.dataId).id}return ree(l(r),l(s),r.shape[0],r.shape[1],s.shape[1],m5[r.dtype],"left"===i,l(o)),o}};var lee,cee={kernelName:fy,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:s}=t,i=n.dataIdMap.get(a.dataId).id,o=n.dataIdMap.get(r.dataId).id,l=n.dataIdMap.get(s.dataId).id,c=n.makeOutput(r.shape,r.dtype),u=n.dataIdMap.get(c.dataId).id,d=a.shape.length,p=r.shape.length,h=0===d||d>1||1===p?1:gb.sizeFromShape(r.shape.slice(1));return iee(i,o,l,h,u),c},setupFunc:function(e){iee=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}},uee=w5(my);var dee={kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(e){lee=e.wasm.cwrap(xy,null,["number","number"])},kernelFunc:function(e){let{backend:t,inputs:{x:n}}=e,a=t.dataIdMap.get(n.dataId).id,r=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(r.dataId).id;return 0===gb.sizeFromShape(r.shape)||lee(a,s),r}},pee=w5(vy),hee=w5(yy),fee=w5(by),mee=w5(wy);var gee,yee={kernelName:Ny,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:s,paddings:i}=a,o=gb.sizeFromShape(s),l=[[0,0]];l.push(...i);for(let g=1+s.length;g<r.shape.length;++g)l.push([0,0]);let c=D9.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=WE.getReshaped(c.shape,s,o,!1),d=WE.getPermuted(u.length,s.length,!1),p=WE.getReshapedPermuted(c.shape,s,o,!1),h=t8({inputs:{x:c},backend:n,attrs:{shape:u}}),f=F5({inputs:{x:h},backend:n,attrs:{perm:d}}),m=t8({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeData(c.dataId),n.disposeData(h.dataId),n.disposeData(f.dataId),m}};var bee,vee={kernelName:Ty,backendName:"wasm",setupFunc:function(e){gee=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a}=e,{indices:r,values:s,denseShape:i,defaultValue:o}=a,l=r.shape[0],c=r.shape[1],u=n.readSync(i.dataId)[0],d=[l+u,c],p=n.dataIdMap.get(r.dataId).id,h=n.dataIdMap.get(s.dataId).id,f=n.dataIdMap.get(o.dataId).id,m=n.makeOutput(d,r.dtype),g=n.dataIdMap.get(m.dataId).id,y=n.makeOutput(d.slice(0,1),s.dtype),b=n.dataIdMap.get(y.dataId).id,v=n.makeOutput([u],"bool"),x=n.dataIdMap.get(v.dataId).id,w=n.makeOutput([l],r.dtype),k=n.dataIdMap.get(w.dataId).id,S=n.makeOutput([4],"int32"),N=n.dataIdMap.get(S.dataId).id,I=gee(p,h,m5[s.dtype],l,u,c,f,g,b,x,k,N),C=n.readSync(S.dataId);switch(C[0]){case 1:t=WE.getSparseFillEmptyRowsIndicesDenseShapeMismatch(C[1]);break;case 2:t=WE.getSparseFillEmptyRowsNegativeIndexErrorMessage(C[1],C[2]);break;case 3:t=WE.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(C[1],C[2],C[3]);break;default:t=""}if(n.disposeData(S.dataId),t)throw n.disposeData(m.dataId),n.disposeData(y.dataId),n.disposeData(v.dataId),n.disposeData(w.dataId),new Error(t);let T=m,E=y;return I!==d[0]&&(T=s8({inputs:{x:m},attrs:{begin:0,size:[I,c]},backend:n}),E=s8({inputs:{x:y},attrs:{begin:0,size:I},backend:n}),n.disposeData(m.dataId),n.disposeData(y.dataId)),[T,E,v,w]}};var xee,wee={kernelName:Ey,backendName:"wasm",setupFunc:function(e){bee=e.wasm.cwrap(Ey,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n}=e,{inputIndices:a,inputShape:r,newShape:s}=n;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(a.shape));if(1!==r.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(r.shape));if(1!==s.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(s.shape));let i=t.dataIdMap.get(a.dataId).id,o=t.dataIdMap.get(r.dataId).id,l=t.dataIdMap.get(s.dataId).id,c=a.shape[0],u=gb.sizeFromShape(s.shape),d=t.makeOutput([c,u],a.dtype),p=t.dataIdMap.get(d.dataId).id,h=t.makeOutput([u],s.dtype),f=t.dataIdMap.get(h.dataId).id,m=t.makeOutput([3],"int32"),g=t.dataIdMap.get(m.dataId).id;bee(i,o,l,c,p,f,g);let y,b=t.readSync(m.dataId);switch(b[0]){case 0:y=WE.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(b[1],b[2]);break;case 1:y=WE.getSparseReshapeNegativeOutputDimErrorMessage(b[1],b[2]);break;case 2:y=WE.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let e=Array.from(t.readSync(r.dataId)),n=Array.from(t.readSync(h.dataId));y=WE.getSparseReshapeInputOutputMultipleErrorMessage(e,n);break}case 4:{let e=Array.from(t.readSync(r.dataId)),n=Array.from(t.readSync(h.dataId));y=WE.getSparseReshapeInputOutputMismatchErrorMessage(e,n);break}default:y=""}if(t.disposeData(m.dataId),y)throw t.disposeData(d.dataId),t.disposeData(h.dataId),new Error(y);return[d,h]}};function kee(e){xee=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function See(e,t){let{backend:n,inputs:a}=e,{data:r,indices:s,segmentIds:i}=a,o=s.shape[0],l=n.readSync(i.dataId,o-1,o)[0],c=o>0?l+1:0;if(c<0)throw new Error(WE.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let u=r.shape.slice();u[0]=c;let d=n.dataIdMap.get(r.dataId).id,p=n.dataIdMap.get(s.dataId).id,h=n.dataIdMap.get(i.dataId).id,f=n.makeOutput(u,r.dtype),m=n.dataIdMap.get(f.dataId).id,g=n.makeOutput([4],"int32"),y=n.dataIdMap.get(g.dataId).id;xee(d,m5[r.dtype],r.shape[0],p,h,m,y,t,0);let b,v=n.readSync(g.dataId);switch(v[0]){case 0:b=WE.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break;case 1:b=WE.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break;case 2:b=WE.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(v[1],v[2]);break;case 3:b=WE.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v[1],v[2],v[3]);break;default:b=""}if(n.disposeData(g.dataId),b)throw n.disposeData(f.dataId),new Error(b);return f}var Nee={kernelName:_y,backendName:"wasm",setupFunc:kee,kernelFunc:function(e){return See(e,!0)}};var Iee,Cee={kernelName:Ay,backendName:"wasm",setupFunc:kee,kernelFunc:function(e){return See(e,!1)}};var Tee={kernelName:Ry,backendName:"wasm",setupFunc:function(e){Iee=e.wasm.cwrap(Ry,null,["number","number","number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{sparseIndices:r,sparseValues:s,defaultValue:i}=n,{outputShape:o}=a,l=t.makeOutput(o,i.dtype);if(0===gb.sizeFromShape(o))return l;let{sliceRank:c,numUpdates:u,sliceSize:d,strides:p,outputSize:h}=WE.calculateShapes(s,r,o),f=t.dataIdMap.get(r.dataId).id,m=t.dataIdMap.get(s.dataId).id,g=t.dataIdMap.get(i.dataId).id,y=new Uint8Array(new Int32Array(p).buffer),b=t.dataIdMap.get(l.dataId).id;return Iee(f,m,s.shape.length,g,m5[i.dtype],c,u,d,y,h,b),l}};var Eee,_ee={kernelName:Iy,backendName:"wasm",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{numOrSizeSplits:s,axis:i}=n,o=gb.parseAxisParam(i,r.shape)[0],l=WE.prepareSplitSize(r,s,o),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(e=>{let t=[...u];t[o]=e;let n=s8({inputs:{x:r},attrs:{begin:c,size:t},backend:a});return c[o]+=e,n})}},Aee=w5(ky),Ree=w5(Dy),Fee=I5(Fy);var Dee,Mee={kernelName:Jy,backendName:"wasm",setupFunc:function(e){Eee=e.wasm.cwrap(Jy,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{alpha:r}=a,{x:s}=n,i=t.dataIdMap.get(s.dataId).id,o=t.makeOutput(s.shape,s.dtype),l=t.dataIdMap.get(o.dataId).id;return Eee(i,r,m5[s.dtype],l),o}};var Oee={kernelName:Oy,backendName:"wasm",setupFunc:function(e){Dee=e.wasm.cwrap(Oy,null,["number","array","number","array","array","array","array","array","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{x:s}=a,{begin:i,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:d,newAxisMask:p,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:v,end:x,strides:w}=mE.sliceInfo(s.shape,i,o,l,c,u,d,p,h);if(g)t=t8({inputs:{x:s},backend:n,attrs:{shape:m}});else if(y||b){gb.assert(s.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(s.shape.length));let e=mE.computeOutShape(v,x,w),a=s8({inputs:{x:s},backend:n,attrs:{begin:v,size:e}});t=t8({inputs:{x:a},backend:n,attrs:{shape:m}}),n.disposeData(a.dataId)}else{let e=n.makeOutput(f,"float32"),a=n.dataIdMap.get(s.dataId).id,r=new Uint8Array(new Int32Array(gb.computeStrides(s.shape)).buffer),i=new Uint8Array(new Int32Array(v).buffer),o=new Uint8Array(new Int32Array(x).buffer),l=new Uint8Array(new Int32Array(w).buffer),c=new Uint8Array(new Int32Array(f).buffer),u=new Uint8Array(new Int32Array(gb.computeStrides(f)).buffer),d=n.dataIdMap.get(e.dataId).id;Dee(a,r,s.shape.length,i,o,l,c,u,f.length,d),t=t8({inputs:{x:e},backend:n,attrs:{shape:m}}),n.disposeData(e.dataId)}return t}};var Pee={kernelName:Py,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{data:r,dataSplits:s}=n,{separator:i,nGramWidths:o,leftPad:l,rightPad:c,padWidth:u,preserveShortSequences:d}=a,p=t.readSync(r.dataId),h=t.readSync(s.dataId),[f,m]=AG(p,h,i,o,l,c,u,d),g=t.makeOutput([f.length],"string");t.dataIdMap.get(g.dataId).stringBytes=f;let y=t.makeOutput(s.shape,"int32");return t.typedArrayFromHeap(y).set(m),[g,y]}};var Lee={kernelName:Ly,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{input:r,delimiter:s}=n,{skipEmpty:i}=a,o=t.readSync(r.dataId),l=t.readSync(s.dataId),[c,u,d]=FG(o,l[0],i),p=u.length,h=t.makeOutput([p,2],"int32");t.typedArrayFromHeap(h).set(c);let f=t.makeOutput([p],"string");t.dataIdMap.get(f.dataId).stringBytes=u;let m=t.makeOutput([2],"int32");return t.typedArrayFromHeap(m).set(d),[h,f,m]}};var zee,jee={kernelName:zy,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{input:r}=n,{numBuckets:s}=a,i=DG(t.readSync(r.dataId),s),o=t.makeOutput(r.shape,"int32");return t.typedArrayFromHeap(o).set(i),o}},Bee=I5(jy);var Wee,Vee={kernelName:Sy,backendName:"wasm",setupFunc:function(e){zee=e.wasm.cwrap(Sy,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:s}=a,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=O5(i,r,t),f=d;if(h){let e=t.dataIdMap.get(u.dataId).id;e!==o&&(c=u,l=e,f=WE.getInnerMostAxes(f.length,c.shape.length))}WE.assertAxesAreInnerMostDims("sum",f,c.shape.length);let[m,g]=WE.computeOutAndReduceShapes(c.shape,f),y=gb.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(0!==gb.sizeFromShape(c.shape)){let e=t.dataIdMap.get(b.dataId).id;zee(l,y,m5[b.dtype],e)}if(h&&t.disposeData(u.dataId),s){let e=WE.expandShapeToKeepDim(b.shape,p);b.shape=e}return b}},Uee=w5(By),Hee=w5(Wy);var Gee,qee={kernelName:py,backendName:"wasm",setupFunc:function(e){Wee=e.wasm.cwrap(py,null,["number","number","number","number","number","number","array","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{tensor:r,indices:s,updates:i}=n,{}=a,o=t.makeOutput(r.shape,r.dtype);if(0===gb.sizeFromShape(r.shape))return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=DI.calculateShapes(i,s,r.shape),h=t.dataIdMap.get(s.dataId).id,f=t.dataIdMap.get(i.dataId).id,m=t.dataIdMap.get(r.dataId).id,g=new Uint8Array(new Int32Array(d).buffer),y=t.dataIdMap.get(o.dataId).id;return Wee(h,f,m5[i.dtype],l,c,u,g,p,y,m),o}};var Kee,Xee={kernelName:Vy,backendName:"wasm",setupFunc:function(e){Gee=e.wasm.cwrap(Vy,null,["number","array","number","array","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,s=n.dataIdMap.get(r.dataId).id,{reps:i}=a,o=new Array(r.shape.length);for(let p=0;p<o.length;p++)o[p]=r.shape[p]*i[p];let l=new Uint8Array(new Int32Array(r.shape).buffer),c=new Uint8Array(new Int32Array(o).buffer),u=n.makeOutput(o,r.dtype),d=n.dataIdMap.get(u.dataId).id;return Gee(s,l,r.shape.length,c,o.length,m5[u.dtype],d),u}};var Yee,Qee={kernelName:Uy,backendName:"wasm",setupFunc:function(e){Kee=e.wasm.cwrap(Uy,null,["number","array","number","number","number","bool","number","number"])},kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:s,sorted:i}=a,o=n.dataIdMap.get(r.dataId).id,l=new Uint8Array(new Int32Array(r.shape).buffer),c=r.shape.slice();c[c.length-1]=s;let u=n.makeOutput(c,r.dtype),d=n.dataIdMap.get(u.dataId).id,p=n.makeOutput(c,"int32"),h=n.dataIdMap.get(p.dataId).id;return Kee(o,l,r.shape.length,m5[r.dtype],s,i,d,h),[u,p]}};var Jee={kernelName:Hy,backendName:"wasm",setupFunc:function(e){Yee=e.wasm.cwrap(Hy,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{image:s,transforms:i}=a,{interpolation:o,fillMode:l,fillValue:c,outputShape:u}=r,[d,p,h,f]=s.shape,[m,g]=null!=u?u:[p,h],y=[d,m,g,f],b=new Uint8Array(new Int32Array(gb.computeStrides(s.shape)).buffer),v=new Uint8Array(new Int32Array(gb.computeStrides(y)).buffer),x=n.makeOutput(y,s.dtype),w=n.dataIdMap.get(x.dataId).id,k=n.dataIdMap.get(s.dataId).id,S=n.dataIdMap.get(i.dataId).id,N="nearest"===o?1:2;switch(l){case"constant":default:t=1;break;case"reflect":t=2;break;case"wrap":t=3;break;case"nearest":t=4}return Yee(k,S,i.shape[0]>1,d,m,g,f,h,p,b,s.shape.length-1,v,y.length-1,N,t,c,w),x}};var Zee={kernelName:qy,backendName:"wasm",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:s}=t,{outputValues:i,outputShape:o,indices:l}=VG(a.readSync(s.dataId),r,s.shape,s.dtype);return[a.makeOutput(o,s.dtype,void 0,i),a.makeOutput([l.length],"int32",void 0,l)]}};var $ee={kernelName:Ky,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:s}=a;s<0&&(s+=r.shape.length);let i=r.shape[s],o=r.shape.length,l=new Array(o-1),c=0;for(let h=0;h<o;h++)h!==s&&(l[c++]=r.shape[h]);let u=new Array(i),d=new Array(o).fill(0),p=r.shape.slice();p[s]=1;for(let h=0;h<u.length;h++)d[s]=h,u[h]=s8({inputs:{x:r},attrs:{begin:d,size:p},backend:n});return u.map(e=>{let{dataId:t,dtype:n}=e;return{dataId:t,dtype:n,shape:l}})}};var ete={kernelName:Qy,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(0),a}},tte=[x5,k5,S5,N5,T5,E5,L5,z5,W5,V5,U5,H5,G5,q5,K5,Y5,e8,J5,$5,r8,l8,c8,u8,d8,f8,m8,g8,v8,w8,S8,I8,T8,A8,R8,F8,M8,P8,z8,B8,V8,H8,q8,X8,Q8,Z8,$8,e7,t7,n7,a7,s7,i7,c7,d7,p7,h7,m7,y7,v7,w7,S7,N7,I7,R5,C7,T7,E7,A7,R7,F7,M7,P7,O7,L7,z7,j7,B7,V7,H7,q7,K7,Y7,J7,$7,t9,a9,s9,l9,c9,d9,g9,y9,b9,v9,k9,N9,C9,T9,E9,_9,R9,D9,M9,P9,z9,j9,B9,W9,V9,U9,a8,G9,K9,Y9,J9,$9,tee,nee,aee,see,oee,cee,uee,dee,pee,hee,fee,i8,f9,mee,yee,vee,wee,Nee,Cee,Tee,_ee,Aee,Ree,Fee,Mee,Oee,Pee,Lee,jee,Bee,Vee,Uee,Hee,qee,Xee,Qee,Jee,M5,Zee,$ee,ete];for(let n of tte)ub(n);var nte=Mf();nte.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch(tv){return!1}}),nte.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(nte.get("IS_NODE"))return!1;try{return(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(tv){return!1}});var ate=dh(Ah()),rte=dh(Rh()),ste=dh(Fh()),ite=ate.default||ate,ote=ste.default||ste,lte=class extends Mh{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(vte),xte=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new Dh(this,qv())}write(e,t,n){let a={id:this.dataIdNextNumber++};return this.move(a,e,t,n,1),a}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=gb.now();return e(),{kernelMs:gb.now()-t}}move(e,t,n,a,r){let s=this.dataIdNextNumber++;if("string"===a){let i=t;return void this.dataIdMap.set(e,{id:s,stringBytes:i,shape:n,dtype:a,memoryOffset:null,refCount:r})}let i=gb.sizeFromShape(n),o=i*gb.bytesPerElement(a),l=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:s,memoryOffset:l,shape:n,dtype:a,refCount:r}),this.wasm.tfjs.registerTensor(s,i,l),null!=t&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),l)}async read(e){return this.readSync(e)}readSync(e,t,n){let{memoryOffset:a,dtype:r,shape:s,stringBytes:i}=this.dataIdMap.get(e);if("string"===r)return null!=t&&0!==t||!(null==n||n>=i.length)?i.slice(t,n):i;t=t||0,n=n||gb.sizeFromShape(s);let o=gb.bytesPerElement(r);return function(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error("Unknown dtype ".concat(t))}}(this.wasm.HEAPU8.slice(a+t*o,a+n*o).buffer,r)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);null!=t&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n,a){let r;if(null==n)r=this.write(null!=a?a:null,e,t);else{let a=this.dataIdNextNumber++;r={id:a},this.dataIdMap.set(r,{id:a,memoryOffset:n,shape:e,dtype:t,refCount:1});let s=gb.sizeFromShape(e);this.wasm.tfjs.registerTensor(a,s,n)}return{dataId:r,shape:e,dtype:t}}typedArrayFromHeap(e){let{shape:t,dtype:n,dataId:a}=e,r=this.wasm.HEAPU8.buffer,{memoryOffset:s}=this.dataIdMap.get(a),i=gb.sizeFromShape(t);switch(n){case"float32":return new Float32Array(r,s,i);case"int32":return new Int32Array(r,s,i);case"bool":return new Uint8Array(r,s,i);default:throw new Error("Unknown dtype ".concat(n))}}};function cte(e,t,n){if(null!=pte)return pte;let a="tfjs-backend-wasm.wasm";return e&&t?a="tfjs-backend-wasm-threaded-simd.wasm":e&&(a="tfjs-backend-wasm-simd.wasm"),null!=fte&&null!=fte[a]?fte[a]:n+a}async function ute(){let[e,t]=await Promise.all([Mf().getAsync("WASM_HAS_SIMD_SUPPORT"),Mf().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,a)=>{let r={locateFile:(n,a)=>{if(n.endsWith(".worker.js")){let e=rte.wasmWorkerContents.replace(/\n/g,"\\n"),t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}return n.endsWith(".wasm")?cte(e,t,null!=hte?hte:a):a+n}};gte&&(r.instantiateWasm=function(e){return(t,n)=>(gb.fetch(e,{credentials:"same-origin"}).then(a=>{a.ok||t.env.a("failed to load wasm binary file at '".concat(e,"'")),a.arrayBuffer().then(e=>{WebAssembly.instantiate(e,t).then(e=>{n(e.instance,e.module)})})}),{})}(cte(e,t,null!=hte?hte:"")));let s,i=!1;r.onAbort=()=>{i||mte||(mte=!0,a({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))},t&&e&&null==pte?(r.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+ite.toString()],{type:"text/javascript"}),s=ite(r)):s=ote(r),s.then(e=>{i=!0,mte=!1;e.tfjs={init:e.cwrap("init",null,[]),initWithThreadsCount:e.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:e.cwrap("get_threads_count","number",[]),registerTensor:e.cwrap("register_tensor",null,["number","number","number"]),disposeData:e.cwrap("dispose_data",null,["number"]),dispose:e.cwrap("dispose",null,[])},n({wasm:e})}).catch(a)})}var dte=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],pte=null,hte=null,fte={},mte=!1,gte=!1;function yte(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Hv("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),mte)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");pte=e,gte=t}function bte(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(mte)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if("string"==typeof e)hte=e;else{fte=e;let t=dte.filter(e=>null==fte[e]);if(t.length>0)throw new Error("There were no entries found for the following binaries: ".concat(t.join(","),". Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found."))}gte=t}var vte=-1,xte=-1;function wte(e){vte=e}function kte(){if(-1===xte)throw new Error("WASM backend not initialized.");return xte}var Ste="4.22.0";sx("wasm",async()=>{let{wasm:e}=await ute();return new lte(e)},2);var Nte="4.22.0",Ite={tfjs:Nte,"tfjs-core":Nte,"tfjs-converter":"4.22.0","tfjs-backend-cpu":"4.22.0","tfjs-backend-webgl":"4.22.0","tfjs-backend-wasm":"4.22.0"};function Cte(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.beginPath(),t.slice(1).forEach((n,a)=>{let{x:r,y:s}=n,i=t[a];e.moveTo(i.x,i.y),e.lineTo(r,s)}),n){let n=t[t.length-1],a=t[0];if(!n||!a)return;e.moveTo(n.x,n.y),e.lineTo(a.x,a.y)}e.stroke()}nh({},{AnchorPosition:()=>pne,DrawBox:()=>gne,DrawBoxOptions:()=>mne,DrawFaceLandmarks:()=>aae,DrawFaceLandmarksOptions:()=>nae,DrawTextField:()=>fne,DrawTextFieldOptions:()=>hne,drawContour:()=>Cte,drawDetections:()=>yne,drawFaceExpressions:()=>$ne,drawFaceLandmarks:()=>rae});nh({},{computeReshapedDimensions:()=>Lte,getCenterPoint:()=>zte,isDimensions:()=>Pte,isEven:()=>Mte,isFloat:()=>Dte,isTensor:()=>Ete,isTensor1D:()=>_te,isTensor2D:()=>Ate,isTensor3D:()=>Rte,isTensor4D:()=>Fte,isValidNumber:()=>Bte,isValidProbablitiy:()=>Wte,range:()=>jte,round:()=>Ote});var Tte=class e{constructor(e,t){if(!Bte(e)||!Bte(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have ".concat(JSON.stringify({width:e,height:t})));this._width=e,this._height=t}get width(){return this._width}get height(){return this._height}reverse(){return new e(1/this.width,1/this.height)}};function Ete(e,t){return e instanceof Jb&&e.shape.length===t}function _te(e){return Ete(e,1)}function Ate(e){return Ete(e,2)}function Rte(e){return Ete(e,3)}function Fte(e){return Ete(e,4)}function Dte(e){return e%1!==0}function Mte(e){return e%2===0}function Ote(e){let t=10**(arguments.length>1&&void 0!==arguments[1]?arguments[1]:2);return Math.floor(e*t)/t}function Pte(e){return e&&e.width&&e.height}function Lte(e,t){let{width:n,height:a}=e,r=t/Math.max(a,n);return new Tte(Math.round(n*r),Math.round(a*r))}function zte(e){return e.reduce((e,t)=>e.add(t),new Vte(0,0)).div(new Vte(e.length,e.length))}function jte(e,t,n){return Array(e).fill(0).map((e,a)=>t+a*n)}function Bte(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||0===e}function Wte(e){return Bte(e)&&e>=0&&e<=1}var Vte=class e{constructor(e,t){this._x=e,this._y=t}get x(){return this._x}get y(){return this._y}add(t){return new e(this.x+t.x,this.y+t.y)}sub(t){return new e(this.x-t.x,this.y-t.y)}mul(t){return new e(this.x*t.x,this.y*t.y)}div(t){return new e(this.x/t.x,this.y/t.y)}abs(){return new e(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new e(Math.floor(this.x),Math.floor(this.y))}},Ute=class e{static isRect(e){return!!e&&[e.x,e.y,e.width,e.height].every(Bte)}static assertIsValidBox(t,n){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e.isRect(t))throw new Error("".concat(n," - invalid box: ").concat(JSON.stringify(t),", expected object with properties x, y, width, height"));if(!a&&(t.width<0||t.height<0))throw new Error("".concat(n," - width (").concat(t.width,") and height (").concat(t.height,") must be positive numbers"))}constructor(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t||{},r=[a.left,a.top,a.right,a.bottom].every(Bte),s=[a.x,a.y,a.width,a.height].every(Bte);if(!s&&!r)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have ".concat(JSON.stringify(a)));let[i,o,l,c]=s?[a.x,a.y,a.width,a.height]:[a.left,a.top,a.right-a.left,a.bottom-a.top];e.assertIsValidBox({x:i,y:o,width:l,height:c},"Box.constructor",n),this._x=i,this._y=o,this._width=l,this._height=c}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new Vte(this.left,this.top)}get topRight(){return new Vte(this.right,this.top)}get bottomLeft(){return new Vte(this.left,this.bottom)}get bottomRight(){return new Vte(this.right,this.bottom)}round(){let[t,n,a,r]=[this.x,this.y,this.width,this.height].map(e=>Math.round(e));return new e({x:t,y:n,width:a,height:r})}floor(){let[t,n,a,r]=[this.x,this.y,this.width,this.height].map(e=>Math.floor(e));return new e({x:t,y:n,width:a,height:r})}toSquare(){let{x:t,y:n,width:a,height:r}=this,s=Math.abs(a-r);return a<r&&(t-=s/2,a+=s),r<a&&(n-=s/2,r+=s),new e({x:t,y:n,width:a,height:r})}rescale(t){let n=Pte(t)?t.width:t,a=Pte(t)?t.height:t;return new e({x:this.x*n,y:this.y*a,width:this.width*n,height:this.height*a})}pad(t,n){let[a,r,s,i]=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new e({x:a,y:r,width:s,height:i})}clipAtImageBorders(t,n){let{x:a,y:r,right:s,bottom:i}=this,o=Math.max(a,0),l=Math.max(r,0),c=s-o,u=i-l,d=Math.min(c,t-o),p=Math.min(u,n-l);return new e({x:o,y:l,width:d,height:p}).floor()}shift(t,n){let{width:a,height:r}=this,s=this.x+t,i=this.y+n;return new e({x:s,y:i,width:a,height:r})}padAtBorders(e,t){let n=this.width+1,a=this.height+1,r=n,s=a,i=this.left,o=this.top,l=this.right,c=this.bottom;return l>t&&(r=-l+t+n,l=t),c>e&&(s=-c+e+a,c=e),i<1&&(s=2-i,i=1),o<1&&(s=2-o,o=1),{dy:1,edy:s,dx:1,edx:r,y:o,ey:c,x:i,ex:l,w:n,h:a}}calibrate(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()}},Hte=class extends Ute{constructor(e,t,n,a){super({left:e,top:t,right:n,bottom:a},arguments.length>4&&void 0!==arguments[4]&&arguments[4])}},Gte=class e{constructor(e,t,n,a,r){this._imageDims=new Tte(r.width,r.height),this._score=e,this._classScore=t,this._className=n,this._box=new Ute(a).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new Ute(this._box).rescale(this.imageDims.reverse())}forSize(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})}},qte=class e extends Gte{constructor(e,t,n){super(e,e,"",t,n)}forSize(t,n){let{score:a,relativeBox:r,imageDims:s}=super.forSize(t,n);return new e(a,r,s)}};function Kte(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?a/(e.area+t.area-a):a/Math.min(e.area,t.area)}function Xte(e,t){return Yv(()=>{let[n,a,r]=t,s=ok([...e.shape.slice(0,3),1],n,"float32"),i=ok([...e.shape.slice(0,3),1],a,"float32"),o=ok([...e.shape.slice(0,3),1],r,"float32"),l=Hw([s,i,o],3);return PS(e,l)})}function Yte(e){return 1/(1+Math.exp(-e))}var Qte,Jte=class extends Ute{constructor(e,t,n,a){super({x:e,y:t,width:n,height:a},arguments.length>4&&void 0!==arguments[4]&&arguments[4])}},Zte=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Vte(0,0),{width:a,height:r}=t;this._imgDims=new Tte(a,r),this._shift=n,this._positions=e.map(e=>e.mul(new Vte(a,r)).add(n))}get shift(){return new Vte(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map(e=>e.sub(this._shift).div(new Vte(this.imageWidth,this.imageHeight)))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Vte(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){let n=e instanceof qte?e.box.floor():new Ute(e);return this.shiftBy(n.x,n.y).align(null,t)}let{useDlibAlignment:n,minBoxPadding:a}=c({useDlibAlignment:!1,minBoxPadding:.2},t);return n?this.alignDlib():this.alignMinBbox(a)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,n,a]=e,r=e=>a.sub(e).magnitude(),s=(r(t)+r(n))/2,i=Math.floor(s/.45),o=zte(e),l=Math.floor(Math.max(0,o.x-.5*i)),c=Math.floor(Math.max(0,o.y-.43*i));return new Jte(l,c,Math.min(i,this.imageWidth+l),Math.min(i,this.imageHeight+c))}alignMinBbox(e){let t=function(e){let t=e.map(e=>e.x),n=e.map(e=>e.y),a=t.reduce((e,t)=>t<e?t:e,1/0),r=n.reduce((e,t)=>t<e?t:e,1/0),s=t.reduce((e,t)=>e<t?t:e,0),i=n.reduce((e,t)=>e<t?t:e,0);return new Hte(a,r,s,i)}(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},$te=class extends Zte{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(zte)}};function ene(e){return e.detection instanceof qte}function tne(e,t){return c(c({},e),{detection:t})}function nne(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function ane(){return"object"==typeof n.g&&"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node}function rne(e){let t="";if(!e&&ane())try{e=th("fs")}catch(n){t=n.toString()}return{readFile:e?t=>new Promise((n,a)=>{e.readFile(t,(e,t)=>e?a(e):n(t))}):()=>{throw new Error("readFile - failed to require fs in nodejs environment with error: ".concat(t))}}}function sne(){let e=n.g.Canvas||n.g.HTMLCanvasElement,t=n.g.Image||n.g.HTMLImageElement,a=n.g.Video||n.g.HTMLVideoElement,r=n.g.fetch,s=rne();return c({Canvas:e||class{},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:n.g.ImageData||class{},Video:n.g.HTMLVideoElement||class{},createCanvasElement:()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},createVideoElement:()=>{if(a)return new a;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},fetch:r},s)}function ine(){return"object"==typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLImageElement&&"undefined"!=typeof HTMLCanvasElement&&"undefined"!=typeof HTMLVideoElement&&"undefined"!=typeof ImageData&&"undefined"!=typeof CanvasRenderingContext2D}function one(e){Qte=e}function lne(){return ine()?one(nne()):ane()?one(sne()):null}var cne={getEnv:function(){if(!Qte)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Qte},setEnv:one,initialize:lne,createBrowserEnv:nne,createFileSystem:rne,createNodejsEnv:sne,monkeyPatch:function(e){if(Qte||lne(),!Qte)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=Qte.Canvas,Image:n=Qte.Image}=e;Qte.Canvas=t,Qte.Image=n,Qte.createCanvasElement=e.createCanvasElement||(()=>new t),Qte.createImageElement=e.createImageElement||(()=>new n),Qte.ImageData=e.ImageData||Qte.ImageData,Qte.Video=e.Video||Qte.Video,Qte.fetch=e.fetch||Qte.fetch,Qte.readFile=e.readFile||Qte.readFile},isBrowser:ine,isNodejs:ane};function une(e){return cne.isNodejs()||"string"!=typeof e?e:document.getElementById(e)}function dne(e){let{Canvas:t,CanvasRenderingContext2D:n}=cne.getEnv();if(e instanceof n)return e;let a=une(e);if(!(a instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let r=a.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("resolveContext2d - canvas 2d context is null");return r}lne();var pne=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e))(pne||{}),hne=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{anchorPosition:t,backgroundColor:n,fontColor:a,fontSize:r,fontStyle:s,padding:i}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=r||14,this.fontStyle=s||"Georgia",this.padding=i||4}},fne=class e{constructor(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.text="string"==typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new hne(a)}measureWidth(e){let{padding:t}=this.options;return this.text.map(t=>e.measureText(t).width).reduce((e,t)=>e<t?t:e,0)+2*t}measureHeight(){let{fontSize:e,padding:t}=this.options;return this.text.length*e+2*t}getUpperLeft(e,t){let{anchorPosition:n}=this.options,a="BOTTOM_RIGHT"===n||"TOP_RIGHT"===n,r="BOTTOM_LEFT"===n||"BOTTOM_RIGHT"===n,s=this.measureWidth(e),i=this.measureHeight(),o=a?this.anchor.x-s:this.anchor.x,l=r?this.anchor.y-i:this.anchor.y;if(t){let{width:e,height:n}=t;return{x:Math.max(Math.min(o,e-s),0),y:Math.max(Math.min(l,n-i),0)}}return{x:o,y:l}}draw(e){let t=une(e),n=dne(t),{backgroundColor:a,fontColor:r,fontSize:s,fontStyle:i,padding:o}=this.options;n.font="".concat(s,"px ").concat(i);let l=this.measureWidth(n),c=this.measureHeight();n.fillStyle=a;let u=this.getUpperLeft(n,t);n.fillRect(u.x,u.y,l,c),n.fillStyle=r,this.text.forEach((e,t)=>{let a=o+u.x,r=o+u.y+(t+1)*s;n.fillText(e,a,r)})}},mne=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{boxColor:t,lineWidth:n,label:a,drawLabelOptions:r}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=a;let s={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new hne(c(c({},s),r))}},gne=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.box=new Ute(e),this.options=new mne(t)}draw(e){let t=dne(e),{boxColor:n,lineWidth:a}=this.options,{x:r,y:s,width:i,height:o}=this.box;t.strokeStyle=n,t.lineWidth=a,t.strokeRect(r,s,i,o);let{label:l}=this.options;l&&new fne([l],{x:r-a/2,y:s},this.options.drawLabelOptions).draw(e)}};function yne(e,t){(Array.isArray(t)?t:[t]).forEach(t=>{let n=t instanceof qte?t.score:ene(t)?t.detection.score:void 0,a=t instanceof qte?t.box:ene(t)?t.detection.box:new Ute(t),r=n?"".concat(Ote(n)):void 0;new gne(a,{label:r}).draw(e)})}function bne(e){let{Image:t,Video:n}=cne.getEnv();return e instanceof t&&e.complete||e instanceof n&&e.readyState>=3}function vne(e){let{Image:t,Video:n}=cne.getEnv();return e instanceof t?new Tte(e.naturalWidth,e.naturalHeight):e instanceof n?new Tte(e.videoWidth,e.videoHeight):new Tte(e.width,e.height)}function xne(e){let{width:t,height:n}=e,{createCanvasElement:a}=cne.getEnv(),r=a();return r.width=t,r.height=n,r}function wne(e,t){let{ImageData:n}=cne.getEnv();if(!(e instanceof n)&&!bne(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:a,height:r}=t||vne(e),s=xne({width:a,height:r});return e instanceof n?dne(s).putImageData(e,0,0):dne(s).drawImage(e,0,0,a,r),s}function kne(e){let{Image:t,Canvas:n,Video:a}=cne.getEnv();return e instanceof t||e instanceof n||e instanceof a}var Sne=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ".concat(e));this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((e,t)=>{if(Rte(e))return this._imageTensors[t]=e,void(this._inputDimensions[t]=e.shape);if(Fte(e)){let n=e.shape[0];if(1!==n)throw new Error("NetInput - tf.Tensor4D with batchSize ".concat(n," passed, but not supported in input array"));return this._imageTensors[t]=e,void(this._inputDimensions[t]=e.shape.slice(1))}let n=e instanceof cne.getEnv().Canvas?e:wne(e);this._canvases[t]=n,this._inputDimensions[t]=[n.height,n.width,3]})}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return jte(this.batchSize,0,1).map((e,t)=>this.getReshapedInputDimensions(t))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return Lte({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)}toBatchTensor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._inputSize=e,Yv(()=>{let n=jte(this.batchSize,0,1).map(n=>{let a=this.getInput(n);if(a instanceof Jb){let n=Fte(a)?a:oS(a);return n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Yv(()=>{let[n,a]=e.shape.slice(1);if(n===a)return e;let r=Math.abs(n-a),s=Math.round(r*(t?.5:1)),i=n>a?2:1,o=t=>{let n=e.shape.slice();return n[i]=t,ok(n,0,"float32")},l=o(s),c=r-l.shape[i],u=[t&&c?o(c):null,e,l].filter(e=>!!e).map(e=>iw(e,"float32"));return Hw(u,i)})}(n,t),(n.shape[1]!==e||n.shape[2]!==e)&&(n=hT.resizeBilinear(n,[e,e],!1,!1)),n.as3D(e,e,3)}if(a instanceof cne.getEnv().Canvas)return aE.fromPixels(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{Image:a,Canvas:r}=cne.getEnv();if(!(e instanceof a||e instanceof r))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return xne({width:1,height:1});let s=vne(e),i=t/Math.max(s.height,s.width),o=i*s.width,l=i*s.height,c=xne({width:t,height:t}),u=e instanceof r?e:wne(e),d=Math.abs(o-l)/2,p=n&&o<l?d:0,h=n&&l<o?d:0;return u.width>0&&u.height>0&&dne(c).drawImage(u,p,h,o,l),c}(a,e,t));throw new Error("toBatchTensor - at batchIdx ".concat(n,", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ").concat(a))});return SI(n.map(e=>iw(e,"float32"))).as4D(this.batchSize,e,e,3)})}};async function Nne(e){if(e instanceof Sne)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let n=t=>Array.isArray(e)?" at input index ".concat(t,":"):"",a=t.map(une);return a.forEach((e,a)=>{if(!kne(e)&&!Rte(e)&&!Fte(e))throw"string"==typeof t[a]?new Error("toNetInput -".concat(n(a)," string passed, but could not resolve HTMLElement for element id ").concat(t[a])):new Error("toNetInput -".concat(n(a)," expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id"));if(Fte(e)){let t=e.shape[0];if(1!==t)throw new Error("toNetInput -".concat(n(a)," tf.Tensor4D with batchSize ").concat(t," passed, but not supported in input array"))}}),await Promise.all(a.map(e=>kne(e)&&function(e){return new Promise((t,n)=>{function a(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",a),n(e))}function r(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",a),t(e))}e instanceof cne.getEnv().Canvas||bne(e)?t(null):(e.addEventListener("load",r),e.addEventListener("error",a))})}(e))),new Sne(a,Array.isArray(e))}async function Ine(e,t){let{Canvas:n}=cne.getEnv(),a=e;if(!(e instanceof n)){let t=await Nne(e);if(t.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let r=t.getInput(0);a=r instanceof n?r:await async function(e,t){let n=t||cne.getEnv().createCanvasElement(),[a,r,s]=e.shape.slice(Fte(e)?1:0),i=Yv(()=>e.as3D(a,r,s).toInt());return await aE.toPixels(i,n),i.dispose(),n}(r)}let r=dne(a);return t.map(e=>e instanceof qte?e.forSize(a.width,a.height).box.floor():e).map(e=>e.clipAtImageBorders(a.width,a.height)).map(e=>{let{x:t,y:n,width:a,height:s}=e,i=xne({width:a,height:s});return a>0&&s>0&&dne(i).putImageData(r.getImageData(t,n,a,s),0,0),i})}async function Cne(e,t){if(!Rte(e)&&!Fte(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Fte(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return Yv(()=>{let[n,a,r]=e.shape.slice(Fte(e)?1:0);return t.map(e=>e instanceof qte?e.forSize(a,n).box:e).map(e=>e.clipAtImageBorders(a,n)).filter(e=>e.width>0&&e.height>0).map(t=>{let{x:s,y:i,width:o,height:l}=t;return hI(e.as3D(n,a,r),[i,s,0],[l,o,r])})})}async function Tne(e,t){let{fetch:n}=cne.getEnv(),a=await n(e,t);if(!(a.status<400))throw new Error("failed to fetch: (".concat(a.status,") ").concat(a.statusText,", from url: ").concat(a.url));return a}function Ene(e,t){let n="".concat(t,"-weights_manifest.json");if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/".concat(n)};let a=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",r=(e=e.replace(a,"")).split("/").filter(e=>e),s=e.endsWith(".json")?r[r.length-1]:n,i=a+(e.endsWith(".json")?r.slice(0,r.length-1):r).join("/");return i=e.startsWith("/")?"/".concat(i):i,{modelBaseUri:i,manifestUri:"/"===i?"/".concat(s):"".concat(i,"/").concat(s)}}async function _ne(e,t){let{manifestUri:n,modelBaseUri:a}=Ene(e,t),r=await async function(e){return(await Tne(e)).json()}(n);return MT.loadWeights(r,a)}var Ane=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:n}=this.traversePropertyPath(e);return t[n]}reassignParamFromPath(e,t){let{obj:n,objProp:a}=this.traversePropertyPath(e);n[a].dispose(),n[a]=t}getParamList(){return this._paramMappings.map(e=>{let{paramPath:t}=e;return{path:t,tensor:this.getParamFromPath(t)}})}getTrainableParams(){return this.getParamList().filter(e=>e.tensor instanceof $b)}getFrozenParams(){return this.getParamList().filter(e=>!(e.tensor instanceof $b))}variable(){this.getFrozenParams().forEach(e=>{let{path:t,tensor:n}=e;this.reassignParamFromPath(t,n.variable())})}freeze(){this.getTrainableParams().forEach(e=>{let{path:t,tensor:n}=e,a=zv(n.dataSync());n.dispose(),this.reassignParamFromPath(t,a)})}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.getParamList().forEach(t=>{if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path ".concat(t.path));t.tensor.dispose()}),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map(e=>{let{tensor:t}=e;return Array.from(t.dataSync())}).reduce((e,t)=>e.concat(t)))}async load(e){e instanceof Float32Array?this.extractWeights(e):await this.loadFromUri(e)}async loadFromUri(e){if(e&&"string"!=typeof e)throw new Error("".concat(this._name,".loadFromUri - expected model uri"));let t=await _ne(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&"string"!=typeof e)throw new Error("".concat(this._name,".loadFromDisk - expected model file path"));let{readFile:t}=cne.getEnv(),{manifestUri:n,modelBaseUri:a}=Ene(e,this.getDefaultModelName()),r=MT.weightsLoaderFactory(e=>Promise.all(e.map(e=>t(e).then(e=>"string"==typeof e?Buffer.from(e):e.buffer)))),s=JSON.parse((await t(n)).toString()),i=await r(s,a);this.loadFromWeightMap(i)}loadFromWeightMap(e){let{paramMappings:t,params:n}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=n}extractWeights(e){let{paramMappings:t,params:n}=this.extractParams(e);this._paramMappings=t,this._params=n}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce((t,n)=>{if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property ".concat(n,", for path ").concat(e));return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}},{nextObj:this.params}),{obj:n,objProp:a}=t;if(!n||!a||!(n[a]instanceof Jb))throw new Error("traversePropertyPath - parameter is not a tensor, for path ".concat(e));return{obj:n,objProp:a}}};function Rne(e,t,n){return Yv(()=>{let a=iI(e,t.depthwise_filter,t.pointwise_filter,n,"same");return a=cw(a,t.bias),a})}function Fne(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Yv(()=>{let a=QN(n?cw(hk(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Rne(e,t.conv0,[2,2])),r=Rne(a,t.conv1,[1,1]),s=Rne(QN(cw(a,r)),t.conv2,[1,1]);return QN(cw(a,cw(r,s)))})}function Dne(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Yv(()=>{let r=QN(n?cw(hk(e,t.conv0.filters,a?[2,2]:[1,1],"same"),t.conv0.bias):Rne(e,t.conv0,a?[2,2]:[1,1])),s=Rne(r,t.conv1,[1,1]),i=Rne(QN(cw(r,s)),t.conv2,[1,1]),o=Rne(QN(cw(r,cw(s,i))),t.conv3,[1,1]);return QN(cw(r,cw(s,cw(i,o))))})}function Mne(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"same",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Yv(()=>{let r=cw(hk(e,t.filters,[1,1],n),t.bias);return a?QN(r):r})}function One(e,t){Object.keys(e).forEach(n=>{t.some(e=>e.originalPath===n)||e[n].dispose()})}function Pne(e,t){return(n,a,r,s)=>{let i=AI(e(n*a*r*r),[r,r,n,a]),o=TI(e(a));return t.push({paramPath:"".concat(s,"/filters")},{paramPath:"".concat(s,"/bias")}),{filters:i,bias:o}}}function Lne(e,t){return(n,a,r)=>{let s=EI(e(n*a),[n,a]),i=TI(e(a));return t.push({paramPath:"".concat(r,"/weights")},{paramPath:"".concat(r,"/bias")}),{weights:s,bias:i}}}var zne=class{constructor(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}};function jne(e,t){return(n,a,r)=>{let s=AI(e(9*n),[3,3,n,1]),i=AI(e(n*a),[1,1,n,a]),o=TI(e(a));return t.push({paramPath:"".concat(r,"/depthwise_filter")},{paramPath:"".concat(r,"/pointwise_filter")},{paramPath:"".concat(r,"/bias")}),new zne(s,i,o)}}function Bne(e){return t=>{let n=e("".concat(t,"/depthwise_filter"),4),a=e("".concat(t,"/pointwise_filter"),4),r=e("".concat(t,"/bias"),1);return new zne(n,a,r)}}function Wne(e,t){return(n,a,r)=>{let s=e[n];if(!Ete(s,a))throw new Error("expected weightMap[".concat(n,"] to be a Tensor").concat(a,"D, instead have ").concat(s));return t.push({originalPath:n,paramPath:r||n}),s}}function Vne(e){let t=e;return{extractWeights:function(e){let n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function Une(e,t){let n=Pne(e,t),a=jne(e,t);function r(e,t,r){return{conv0:arguments.length>3&&void 0!==arguments[3]&&arguments[3]?n(e,t,3,"".concat(r,"/conv0")):a(e,t,"".concat(r,"/conv0")),conv1:a(t,t,"".concat(r,"/conv1")),conv2:a(t,t,"".concat(r,"/conv2"))}}return{extractDenseBlock3Params:r,extractDenseBlock4Params:function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{conv0:i,conv1:o,conv2:l}=r(e,t,n,s);return{conv0:i,conv1:o,conv2:l,conv3:a(t,t,"".concat(n,"/conv3"))}}}}function Hne(e){return t=>({filters:e("".concat(t,"/filters"),4),bias:e("".concat(t,"/bias"),1)})}function Gne(e,t){let n=Wne(e,t),a=Hne(n),r=Bne(n);return{extractDenseBlock3Params:function(e){return{conv0:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("".concat(e,"/conv0")):r("".concat(e,"/conv0")),conv1:r("".concat(e,"/conv1")),conv2:r("".concat(e,"/conv2"))}},extractDenseBlock4Params:function(e){return{conv0:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("".concat(e,"/conv0")):r("".concat(e,"/conv0")),conv1:r("".concat(e,"/conv1")),conv2:r("".concat(e,"/conv2")),conv3:r("".concat(e,"/conv3"))}}}}var qne=class extends Ane{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return Yv(()=>{let n=Dne(Xte(iw(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),t.dense0,!0);return n=Dne(n,t.dense1),n=Dne(n,t.dense2),n=Dne(n,t.dense3),n=Vw(n,[7,7],[2,2],"valid"),n})}async forward(e){return this.forwardInput(await Nne(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractDenseBlock4Params:n}=Gne(e,t),a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return One(e,t),{params:a,paramMappings:t}}(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=Vne(e),{extractDenseBlock4Params:r}=Une(n,t),s=r(3,32,"dense0",!0),i=r(32,64,"dense1"),o=r(64,128,"dense2"),l=r(128,256,"dense3");if(0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{paramMappings:t,params:{dense0:s,dense1:i,dense2:o,dense3:l}}}(e)}};function Kne(e,t){return Yv(()=>cw(Gw(e,t.weights),t.bias))}function Xne(e){let t={},n={};return Object.keys(e).forEach(a=>{(a.startsWith("fc")?n:t)[a]=e[a]}),{featureExtractorMap:t,classifierMap:n}}var Yne=class extends Ane{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error("".concat(this._name," - load model before inference"));return Yv(()=>{let n=e instanceof Sne?this.faceFeatureExtractor.forwardInput(e):e;return Kne(n.as2D(n.shape[0],-1),t.fc)})}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return function(e,t,n){let a=[],{extractWeights:r,getRemainingWeights:s}=Vne(e),i=Lne(r,a)(t,n,"fc");if(0!==s().length)throw new Error("weights remaing after extract: ".concat(s().length));return{paramMappings:a,params:{fc:i}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=Xne(e);return this.faceFeatureExtractor.loadFromWeightMap(t),function(e){let t=[],n=Wne(e,t),a={fc:(r="fc",{weights:n("".concat(r,"/weights"),2),bias:n("".concat(r,"/bias"),1)})};var r;return One(e,t),{params:a,paramMappings:t}}(n)}extractParams(e){let t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),a=n*t+n,r=e.slice(0,e.length-a),s=e.slice(e.length-a);return this.faceFeatureExtractor.extractWeights(r),this.extractClassifierParams(s)}},Qne=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Jne=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: ".concat(e.length));Qne.forEach((t,n)=>{this[t]=e[n]})}asSortedArray(){return Qne.map(e=>({expression:e,probability:this[e]})).sort((e,t)=>t.probability-e.probability)}};function Zne(e,t){return c(c({},e),{expressions:t})}function $ne(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,a=arguments.length>3?arguments[3]:void 0;(Array.isArray(t)?t:[t]).forEach(t=>{let r=t instanceof Jne?t:function(e){return e.expressions instanceof Jne}(t)?t.expressions:void 0;if(!r)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let s=r.asSortedArray().filter(e=>e.probability>n),i=ene(t)?t.detection.box.bottomLeft:a||new Vte(0,0);new fne(s.map(e=>"".concat(e.expression," (").concat(Ote(e.probability),")")),i).draw(e)})}function eae(e){return ene(e)&&e.landmarks instanceof Zte&&e.unshiftedLandmarks instanceof Zte&&e.alignedRect instanceof qte}function tae(e,t){let{box:n}=e.detection,a=t.shiftBy(n.x,n.y),r=a.align(),{imageDims:s}=e.detection,i=new qte(e.detection.score,r.rescale(s.reverse()),s),o=function(e){let t=e=>180*e/Math.PI,n=(e,t)=>Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2),a={roll:void 0,pitch:void 0,yaw:void 0};if(!e||!e.positions||68!==e.positions.length)return a;let r=e.positions;return a.roll=((e,n)=>{let a=Math.hypot(n.x-e.x,n.y-e.y),r=n.y-e.y,s=Math.asin(r/a),i=t(s);return Math.floor(90-i)*(n.x-e.x<0?-1:1)})(r[27],r[66]),a.pitch=((e,a,r)=>{let s=n(e,r),i=new Vte((e.x+r.x)/2,(e.y+r.y)/2),o=n(a,i),l=Math.atan(o/s);return Math.floor(t(l))*(i.y-a.y<0?-1:1)})(r[14],r[30],r[2]),a.yaw=(s=r[14],i=r[33],o=r[2],Math.floor(s.x-i.x)-Math.floor(i.x-o.x)),a;var s,i,o}(t);return c(c({},e),{landmarks:a,unshiftedLandmarks:t,alignedRect:i,angle:o})}var nae=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{drawLines:t=!0,drawPoints:n=!0,lineWidth:a,lineColor:r,pointSize:s,pointColor:i}=e;this.drawLines=t,this.drawPoints=n,this.lineWidth=a||1,this.pointSize=s||2,this.lineColor=r||"rgba(0, 255, 255, 1)",this.pointColor=i||"rgba(255, 0, 255, 1)"}},aae=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.faceLandmarks=e,this.options=new nae(t)}draw(e){let t=dne(e),{drawLines:n,drawPoints:a,lineWidth:r,lineColor:s,pointSize:i,pointColor:o}=this.options;if(n&&this.faceLandmarks instanceof $te&&(t.strokeStyle=s,t.lineWidth=r,Cte(t,this.faceLandmarks.getJawOutline()),Cte(t,this.faceLandmarks.getLeftEyeBrow()),Cte(t,this.faceLandmarks.getRightEyeBrow()),Cte(t,this.faceLandmarks.getNose()),Cte(t,this.faceLandmarks.getLeftEye(),!0),Cte(t,this.faceLandmarks.getRightEye(),!0),Cte(t,this.faceLandmarks.getMouth(),!0)),a){t.strokeStyle=o,t.fillStyle=o;let e=e=>{t.beginPath(),t.arc(e.x,e.y,i,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(e)}}};function rae(e,t){(Array.isArray(t)?t:[t]).forEach(t=>{let n=t instanceof Zte?t:eae(t)?t.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new aae(n).draw(e)})}function sae(e,t){let n=[],{extractWeights:a,getRemainingWeights:r}=Vne(e),{extractConvParams:s,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:l}=function(e,t){let n=Pne(e,t),a=jne(e,t);return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:function(e,t,r){return{separable_conv0:a(e,t,"".concat(r,"/separable_conv0")),separable_conv1:a(t,t,"".concat(r,"/separable_conv1")),expansion_conv:n(e,t,1,"".concat(r,"/expansion_conv"))}},extractMainBlockParams:function(e,t){return{separable_conv0:a(e,e,"".concat(t,"/separable_conv0")),separable_conv1:a(e,e,"".concat(t,"/separable_conv1")),separable_conv2:a(e,e,"".concat(t,"/separable_conv2"))}}}}(a,n),c={conv_in:s(3,32,3,"entry_flow/conv_in"),reduction_block_0:o(32,64,"entry_flow/reduction_block_0"),reduction_block_1:o(64,128,"entry_flow/reduction_block_1")},u={};jte(t,0,1).forEach(e=>{u["main_block_".concat(e)]=l(128,"middle_flow/main_block_".concat(e))});let d={reduction_block:o(128,256,"exit_flow/reduction_block"),separable_conv:i(256,512,"exit_flow/separable_conv")};if(0!==r().length)throw new Error("weights remaing after extract: ".concat(r().length));return{paramMappings:n,params:{entry_flow:c,middle_flow:u,exit_flow:d}}}function iae(e,t){let n=[],{extractConvParams:a,extractSeparableConvParams:r,extractReductionBlockParams:s,extractMainBlockParams:i}=function(e,t){let n=Wne(e,t),a=Hne(n),r=Bne(n);return{extractConvParams:a,extractSeparableConvParams:r,extractReductionBlockParams:function(e){return{separable_conv0:r("".concat(e,"/separable_conv0")),separable_conv1:r("".concat(e,"/separable_conv1")),expansion_conv:a("".concat(e,"/expansion_conv"))}},extractMainBlockParams:function(e){return{separable_conv0:r("".concat(e,"/separable_conv0")),separable_conv1:r("".concat(e,"/separable_conv1")),separable_conv2:r("".concat(e,"/separable_conv2"))}}}}(e,n),o={conv_in:a("entry_flow/conv_in"),reduction_block_0:s("entry_flow/reduction_block_0"),reduction_block_1:s("entry_flow/reduction_block_1")},l={};jte(t,0,1).forEach(e=>{l["main_block_".concat(e)]=i("middle_flow/main_block_".concat(e))});let c={reduction_block:s("exit_flow/reduction_block"),separable_conv:r("exit_flow/separable_conv")};return One(e,n),{params:{entry_flow:o,middle_flow:l,exit_flow:c},paramMappings:n}}function oae(e,t,n){return cw(hk(e,t.filters,n,"same"),t.bias)}function lae(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?QN(e):e;return n=Rne(n,t.separable_conv0,[1,1]),n=Rne(QN(n),t.separable_conv1,[1,1]),n=qS(n,[3,3],[2,2],"same"),n=cw(n,oae(e,t.expansion_conv,[2,2])),n}var cae=class extends Ane{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return Yv(()=>{let n=Xte(iw(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),a=QN(oae(n,t.entry_flow.conv_in,[2,2]));return a=lae(a,t.entry_flow.reduction_block_0,!1),a=lae(a,t.entry_flow.reduction_block_1),jte(this._numMainBlocks,0,1).forEach(e=>{a=function(e,t){let n=Rne(QN(e),t.separable_conv0,[1,1]);return n=Rne(QN(n),t.separable_conv1,[1,1]),n=Rne(QN(n),t.separable_conv2,[1,1]),n=cw(n,e),n}(a,t.middle_flow["main_block_".concat(e)])}),a=lae(a,t.exit_flow.reduction_block),a=QN(Rne(a,t.exit_flow.separable_conv,[1,1])),a})}async forward(e){return this.forwardInput(await Nne(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return iae(e,this._numMainBlocks)}extractParams(e){return sae(e,this._numMainBlocks)}};var uae,dae=((uae=dae||{}).FEMALE="female",uae.MALE="male",uae),pae=class extends Yne{postProcess(e,t,n){let a=n.map(e=>{let{width:n,height:a}=e,r=t/Math.max(a,n);return{width:n*r,height:a*r}}),r=a.length;return Yv(()=>{let n=(e,t)=>SI([ok([68],e,"float32"),ok([68],t,"float32")],1).as2D(1,136).as1D(),s=(e,t)=>{let{width:n,height:r}=a[e];return t(n,r)?Math.abs(n-r)/2:0};return e.mul(ok([r,136],t,"float32")).sub(SI(Array.from(Array(r),(e,t)=>n((e=>s(e,(e,t)=>e<t))(t),(e=>s(e,(e,t)=>t<e))(t))))).div(SI(Array.from(Array(r),(e,t)=>n(a[t].width,a[t].height))))})}forwardInput(e){return Yv(()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map(e=>{let[t,n]=e;return{height:t,width:n}}))})}async forward(e){return this.forwardInput(await Nne(e))}async detectLandmarks(e){let t=await Nne(e),n=Yv(()=>VI(this.forwardInput(t))),a=await Promise.all(n.map(async(e,n)=>{let a=Array.from(e.dataSync()),r=a.filter((e,t)=>Mte(t)),s=a.filter((e,t)=>!Mte(t));return new $te(Array(68).fill(0).map((e,t)=>new Vte(r[t],s[t])),{height:t.getInputHeight(n),width:t.getInputWidth(n)})}));return n.forEach(e=>e.dispose()),t.isBatchInput?a:a[0]}getClassifierChannelsOut(){return 136}},hae=class extends pae{constructor(){super("FaceLandmark68Net",arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qne)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}};var fae=class extends Ane{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Yv(()=>{let n=Fne(Xte(iw(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),t.dense0,!0);return n=Fne(n,t.dense1),n=Fne(n,t.dense2),n=Vw(n,[14,14],[2,2],"valid"),n})}async forward(e){return this.forwardInput(await Nne(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractDenseBlock3Params:n}=Gne(e,t),a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return One(e,t),{params:a,paramMappings:t}}(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=Vne(e),{extractDenseBlock3Params:r}=Une(n,t),s=r(3,32,"dense0",!0),i=r(32,64,"dense1"),o=r(64,128,"dense2");if(0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{paramMappings:t,params:{dense0:s,dense1:i,dense2:o}}}(e)}};function mae(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"same",{filters:s,bias:i}=t.conv,o=hk(e,s,n,r);return o=cw(o,i),o=function(e,t){return cw(pw(e,t.weights),t.biases)}(o,t.scale),a?QN(o):o}function gae(e,t){return mae(e,t,[1,1],!1)}function yae(e,t){return mae(e,t,[2,2],!0,"valid")}function bae(e,t){function n(n,a,r,s){let i=function(t,n,a){let r=e(t),s=r.length/(n*a*a);if(Dte(s))throw new Error("depth has to be an integer: ".concat(s,", weights.length: ").concat(r.length,", numFilters: ").concat(n,", filterSize: ").concat(a));return Yv(()=>XI(AI(r,[n,s,a,a]),[2,3,1,0]))}(n,a,r),o=TI(e(a));return t.push({paramPath:"".concat(s,"/filters")},{paramPath:"".concat(s,"/bias")}),{filters:i,bias:o}}function a(a,r,s,i){let o=n(a,r,s,"".concat(i,"/conv")),l=function(n,a){let r=TI(e(n)),s=TI(e(n));return t.push({paramPath:"".concat(a,"/weights")},{paramPath:"".concat(a,"/biases")}),{weights:r,biases:s}}(r,"".concat(i,"/scale"));return{conv:o,scale:l}}return{extractConvLayerParams:a,extractResidualLayerParams:function(e,t,n,r){return{conv1:a((arguments.length>4&&void 0!==arguments[4]&&arguments[4]?.5:1)*e,t,n,"".concat(r,"/conv1")),conv2:a(e,t,n,"".concat(r,"/conv2"))}}}}function vae(e,t){let n=Wne(e,t);function a(e){let t=n("".concat(e,"/conv/filters"),4),a=n("".concat(e,"/conv/bias"),1),r=function(e){return{weights:n("".concat(e,"/scale/weights"),1),biases:n("".concat(e,"/scale/biases"),1)}}(e);return{conv:{filters:t,bias:a},scale:r}}return{extractConvLayerParams:a,extractResidualLayerParams:function(e){return{conv1:a("".concat(e,"/conv1")),conv2:a("".concat(e,"/conv2"))}}}}function xae(e,t){let n=function(e,t){return mae(e,t,[1,1],!0)}(e,t.conv1);return n=gae(n,t.conv2),n=cw(n,e),n=QN(n),n}function wae(e,t){let n=yae(e,t.conv1);n=gae(n,t.conv2);let a=Vw(e,2,2,"valid"),r=JS(a.shape),s=a.shape[3]!==n.shape[3];if(a.shape[1]!==n.shape[1]||a.shape[2]!==n.shape[2]){let e=[...n.shape];e[1]=1;let t=JS(e);n=Hw([n,t],1);let a=[...n.shape];a[2]=1;let r=JS(a);n=Hw([n,r],2)}return a=s?Hw([a,r],3):a,n=cw(a,n),n=QN(n),n}var kae=class extends Ane{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return Yv(()=>{let n=yae(Xte(iw(e.toBatchTensor(150,!0),"float32"),[122.782,117.001,104.298]).div(255),t.conv32_down);n=qS(n,3,2,"valid"),n=xae(n,t.conv32_1),n=xae(n,t.conv32_2),n=xae(n,t.conv32_3),n=wae(n,t.conv64_down),n=xae(n,t.conv64_1),n=xae(n,t.conv64_2),n=xae(n,t.conv64_3),n=wae(n,t.conv128_down),n=xae(n,t.conv128_1),n=xae(n,t.conv128_2),n=wae(n,t.conv256_down),n=xae(n,t.conv256_1),n=xae(n,t.conv256_2),n=wae(n,t.conv256_down_out);let a=n.mean([1,2]);return Gw(a,t.fc)})}async forward(e){return this.forwardInput(await Nne(e))}async computeFaceDescriptor(e){var t;if(null!=(t=null==e?void 0:e.shape)&&t.some(e=>e<=0))return new Float32Array(128);let n=await Nne(e),a=Yv(()=>VI(this.forwardInput(n))),r=await Promise.all(a.map(e=>e.data()));return a.forEach(e=>e.dispose()),n.isBatchInput?r:r[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractConvLayerParams:n,extractResidualLayerParams:a}=vae(e,t),r=n("conv32_down"),s=a("conv32_1"),i=a("conv32_2"),o=a("conv32_3"),l=a("conv64_down"),c=a("conv64_1"),u=a("conv64_2"),d=a("conv64_3"),p=a("conv128_down"),h=a("conv128_1"),f=a("conv128_2"),m=a("conv256_down"),g=a("conv256_1"),y=a("conv256_2"),b=a("conv256_down_out"),{fc:v}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!Ate(v))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have ".concat(v));let x={conv32_down:r,conv32_1:s,conv32_2:i,conv32_3:o,conv64_down:l,conv64_1:c,conv64_2:u,conv64_3:d,conv128_down:p,conv128_1:h,conv128_2:f,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:v};return One(e,t),{params:x,paramMappings:t}}(e)}extractParams(e){return function(e){let{extractWeights:t,getRemainingWeights:n}=Vne(e),a=[],{extractConvLayerParams:r,extractResidualLayerParams:s}=bae(t,a),i=r(4704,32,7,"conv32_down"),o=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),c=s(9216,32,3,"conv32_3"),u=s(36864,64,3,"conv64_down",!0),d=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),h=s(36864,64,3,"conv64_3"),f=s(147456,128,3,"conv128_down",!0),m=s(147456,128,3,"conv128_1"),g=s(147456,128,3,"conv128_2"),y=s(589824,256,3,"conv256_down",!0),b=s(589824,256,3,"conv256_1"),v=s(589824,256,3,"conv256_2"),x=s(589824,256,3,"conv256_down_out"),w=Yv(()=>XI(EI(t(32768),[128,256]),[1,0]));if(a.push({paramPath:"fc"}),0!==n().length)throw new Error("weights remaing after extract: ".concat(n().length));return{params:{conv32_down:i,conv32_1:o,conv32_2:l,conv32_3:c,conv64_down:u,conv64_1:d,conv64_2:p,conv64_3:h,conv128_down:f,conv128_1:m,conv128_2:g,conv256_down:y,conv256_1:b,conv256_2:v,conv256_down_out:x,fc:w},paramMappings:a}}(e)}};function Sae(e,t){return c(c({},e),{descriptor:t})}function Nae(e,t){return c(c({},e),{age:t})}function Iae(e,t,n){return c(c({},e),{gender:t,genderProbability:n})}function Cae(e,t){function n(n,a,r,s,i){let o=AI(e(n*a*r*r),[r,r,n,a]),l=TI(e(a));return t.push({paramPath:"".concat(s,"/filters")},{paramPath:"".concat(s,"/").concat(i?"batch_norm_offset":"bias")}),{filters:o,bias:l}}function a(e,t,a,r){let{filters:s,bias:i}=n(e,t,a,r,!0);return{filters:s,batch_norm_offset:i}}function r(n,r,s){let i=function(n,a){let r=AI(e(9*n),[3,3,n,1]),s=TI(e(n)),i=TI(e(n)),o=TI(e(n)),l=TI(e(n));return t.push({paramPath:"".concat(a,"/filters")},{paramPath:"".concat(a,"/batch_norm_scale")},{paramPath:"".concat(a,"/batch_norm_offset")},{paramPath:"".concat(a,"/batch_norm_mean")},{paramPath:"".concat(a,"/batch_norm_variance")}),{filters:r,batch_norm_scale:s,batch_norm_offset:i,batch_norm_mean:o,batch_norm_variance:l}}(n,"".concat(s,"/depthwise_conv"));return{depthwise_conv:i,pointwise_conv:a(n,r,1,"".concat(s,"/pointwise_conv"))}}return{extractMobilenetV1Params:function(){return{conv_0:a(3,32,3,"mobilenetv1/conv_0"),conv_1:r(32,64,"mobilenetv1/conv_1"),conv_2:r(64,128,"mobilenetv1/conv_2"),conv_3:r(128,128,"mobilenetv1/conv_3"),conv_4:r(128,256,"mobilenetv1/conv_4"),conv_5:r(256,256,"mobilenetv1/conv_5"),conv_6:r(256,512,"mobilenetv1/conv_6"),conv_7:r(512,512,"mobilenetv1/conv_7"),conv_8:r(512,512,"mobilenetv1/conv_8"),conv_9:r(512,512,"mobilenetv1/conv_9"),conv_10:r(512,512,"mobilenetv1/conv_10"),conv_11:r(512,512,"mobilenetv1/conv_11"),conv_12:r(512,1024,"mobilenetv1/conv_12"),conv_13:r(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:a(1024,256,1,"prediction_layer/conv_0"),conv_1:a(256,512,3,"prediction_layer/conv_1"),conv_2:a(512,128,1,"prediction_layer/conv_2"),conv_3:a(128,256,3,"prediction_layer/conv_3"),conv_4:a(256,128,1,"prediction_layer/conv_4"),conv_5:a(128,256,3,"prediction_layer/conv_5"),conv_6:a(256,64,1,"prediction_layer/conv_6"),conv_7:a(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function Tae(e){let t=[],{extractMobilenetV1Params:n,extractPredictionLayerParams:a}=function(e,t){let n=Wne(e,t);function a(e,t,a){return{filters:n("".concat(e,"/Conv2d_").concat(t,"_pointwise/weights"),4,"".concat(a,"/filters")),batch_norm_offset:n("".concat(e,"/Conv2d_").concat(t,"_pointwise/convolution_bn_offset"),1,"".concat(a,"/batch_norm_offset"))}}function r(e){let t="mobilenetv1/conv_".concat(e),r="MobilenetV1/Conv2d_".concat(e,"_depthwise"),s="".concat(t,"/depthwise_conv"),i="".concat(t,"/pointwise_conv");return{depthwise_conv:{filters:n("".concat(r,"/depthwise_weights"),4,"".concat(s,"/filters")),batch_norm_scale:n("".concat(r,"/BatchNorm/gamma"),1,"".concat(s,"/batch_norm_scale")),batch_norm_offset:n("".concat(r,"/BatchNorm/beta"),1,"".concat(s,"/batch_norm_offset")),batch_norm_mean:n("".concat(r,"/BatchNorm/moving_mean"),1,"".concat(s,"/batch_norm_mean")),batch_norm_variance:n("".concat(r,"/BatchNorm/moving_variance"),1,"".concat(s,"/batch_norm_variance"))},pointwise_conv:a("MobilenetV1",e,i)}}function s(e,t){return{filters:n("".concat(e,"/weights"),4,"".concat(t,"/filters")),bias:n("".concat(e,"/biases"),1,"".concat(t,"/bias"))}}function i(e){return{box_encoding_predictor:s("Prediction/BoxPredictor_".concat(e,"/BoxEncodingPredictor"),"prediction_layer/box_predictor_".concat(e,"/box_encoding_predictor")),class_predictor:s("Prediction/BoxPredictor_".concat(e,"/ClassPredictor"),"prediction_layer/box_predictor_".concat(e,"/class_predictor"))}}return{extractMobilenetV1Params:function(){return{conv_0:a("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:r(1),conv_2:r(2),conv_3:r(3),conv_4:r(4),conv_5:r(5),conv_6:r(6),conv_7:r(7),conv_8:r(8),conv_9:r(9),conv_10:r(10),conv_11:r(11),conv_12:r(12),conv_13:r(13)}},extractPredictionLayerParams:function(){return{conv_0:a("Prediction",0,"prediction_layer/conv_0"),conv_1:a("Prediction",1,"prediction_layer/conv_1"),conv_2:a("Prediction",2,"prediction_layer/conv_2"),conv_3:a("Prediction",3,"prediction_layer/conv_3"),conv_4:a("Prediction",4,"prediction_layer/conv_4"),conv_5:a("Prediction",5,"prediction_layer/conv_5"),conv_6:a("Prediction",6,"prediction_layer/conv_6"),conv_7:a("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:i(0),box_predictor_1:i(1),box_predictor_2:i(2),box_predictor_3:i(3),box_predictor_4:i(4),box_predictor_5:i(5)}}}}(e,t),r=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Rte(r))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ".concat(r));let s={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:r}};return One(e,t),{params:s,paramMappings:t}}function Eae(e,t,n){return Yv(()=>{let a=hk(e,t.filters,n,"same");return a=cw(a,t.batch_norm_offset),lk(a,0,6)})}function _ae(e,t){return Yv(()=>{let n,a=Eae(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((e,t)=>{let r=t+1,s=function(e){return[2,4,6,12].some(t=>t===e)?[2,2]:[1,1]}(r);a=function(e,t,n){return Yv(()=>{let a=Ck(e,t.filters,n,"same");return a=Zw(a,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,.0010000000474974513),lk(a,0,6)})}(a,e.depthwise_conv,s),a=Eae(a,e.pointwise_conv,[1,1]),11===r&&(n=a)}),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:a,conv11:n}})}function Aae(e,t,n){let a=e.arraySync(),r=Math.min(a[t][0],a[t][2]),s=Math.min(a[t][1],a[t][3]),i=Math.max(a[t][0],a[t][2]),o=Math.max(a[t][1],a[t][3]),l=Math.min(a[n][0],a[n][2]),c=Math.min(a[n][1],a[n][3]),u=Math.max(a[n][0],a[n][2]),d=Math.max(a[n][1],a[n][3]),p=(i-r)*(o-s),h=(u-l)*(d-c);if(p<=0||h<=0)return 0;let f=Math.max(r,l),m=Math.max(s,c),g=Math.min(i,u),y=Math.min(o,d),b=Math.max(g-f,0)*Math.max(y-m,0);return b/(p+h-b)}function Rae(e,t){let{sizes:n,centers:a}=function(e){let t=VI(XI(e,[1,0])),n=[PS(t[2],t[0]),PS(t[3],t[1])];return{sizes:n,centers:[cw(t[0],dw(n[0],2)),cw(t[1],dw(n[1],2))]}}(e),r=VI(XI(t,[1,0])),s=dw(pw(iS(dw(r[2],5)),n[0]),2),i=cw(pw(dw(r[0],10),n[0]),a[0]),o=dw(pw(iS(dw(r[3],5)),n[1]),2),l=cw(pw(dw(r[1],10),n[1]),a[1]);return XI(SI([PS(i,s),PS(l,o),cw(i,s),cw(l,o)]),[1,0])}function Fae(e,t){return Yv(()=>{let n=e.shape[0];return{boxPredictionEncoding:Ww(Mne(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:Ww(Mne(e,t.class_predictor),[n,-1,3])}})}var Dae=class{constructor(){let{minConfidence:e,maxResults:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error("".concat(this._name," - expected minConfidence to be a number between 0 and 1"));if("number"!=typeof this._maxResults)throw new Error("".concat(this._name," - expected maxResults to be a number"))}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},Mae=class extends Ane{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return Yv(()=>{let n=iw(e.toBatchTensor(512,!1),"float32"),a=_ae(PS(dw(n,127.5),1),t.mobilenetv1),{boxPredictions:r,classPredictions:s}=function(e,t,n){return Yv(()=>{let a=Eae(e,n.conv_0,[1,1]),r=Eae(a,n.conv_1,[2,2]),s=Eae(r,n.conv_2,[1,1]),i=Eae(s,n.conv_3,[2,2]),o=Eae(i,n.conv_4,[1,1]),l=Eae(o,n.conv_5,[2,2]),c=Eae(l,n.conv_6,[1,1]),u=Eae(c,n.conv_7,[2,2]),d=Fae(t,n.box_predictor_0),p=Fae(e,n.box_predictor_1),h=Fae(r,n.box_predictor_2),f=Fae(i,n.box_predictor_3),m=Fae(l,n.box_predictor_4),g=Fae(u,n.box_predictor_5);return{boxPredictions:Hw([d.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,f.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:Hw([d.classPrediction,p.classPrediction,h.classPrediction,f.classPrediction,m.classPrediction,g.classPrediction],1)}})}(a.out,a.conv11,t.prediction_layer);return function(e,t,n){return Yv(()=>{let a=e.shape[0],r=Rae(Ww(cS(n.extra_dim,[a,1,1]),[-1,4]),Ww(e,[-1,4]));r=Ww(r,[a,r.shape[0]/a,4]);let s=qw(Kw(t,[0,0,1],[-1,-1,-1])),i=Kw(s,[0,0,0],[-1,-1,1]);return i=Ww(i,[a,i.shape[1]]),{boxes:VI(r),scores:VI(i)}})}(r,s,t.output_layer)})}async forward(e){return this.forwardInput(await Nne(e))}async locateFaces(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxResults:n,minConfidence:a}=new Dae(t),r=await Nne(e),{boxes:s,scores:i}=this.forwardInput(r),o=s[0],l=i[0];for(let y=1;y<s.length;y++)s[y].dispose(),i[y].dispose();let c=Array.from(l.dataSync()),u=function(e,t,n,a,r){let s=e.shape[0],i=Math.min(n,s),o=t.map((e,t)=>({score:e,boxIndex:t})).filter(e=>e.score>r).sort((e,t)=>t.score-e.score),l=e=>e<=a?1:0,c=[];return o.forEach(t=>{if(c.length>=i)return;let n=t.score;for(let a=c.length-1;a>=0;--a){let n=Aae(e,t.boxIndex,c[a]);if(0!==n&&(t.score*=l(n),t.score<=r))break}n===t.score&&c.push(t.boxIndex)}),c}(o,c,n,.5,a),d=r.getReshapedInputDimensions(0),p=r.inputSize,h=p/d.width,f=p/d.height,m=o.arraySync(),g=u.map(e=>{let[t,n]=[Math.max(0,m[e][0]),Math.min(1,m[e][2])].map(e=>e*f),[a,s]=[Math.max(0,m[e][1]),Math.min(1,m[e][3])].map(e=>e*h);return new qte(c[e],new Jte(a,t,s-a,n-t),{height:r.getInputHeight(0),width:r.getInputWidth(0)})});return o.dispose(),l.dispose(),g}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return Tae(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=Vne(e),{extractMobilenetV1Params:r,extractPredictionLayerParams:s}=Cae(n,t),i=r(),o=s(),l={extra_dim:_I(n(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{params:{mobilenetv1:i,prediction_layer:o,output_layer:l},paramMappings:t}}(e)}};var Oae=[new Vte(.738768,.874946),new Vte(2.42204,2.65704),new Vte(4.30971,7.04493),new Vte(10.246,4.59428),new Vte(12.6868,11.8741)],Pae=[new Vte(1.603231,2.094468),new Vte(6.041143,7.080126),new Vte(2.882459,3.518061),new Vte(4.266906,5.178857),new Vte(9.041765,10.66308)],Lae=[117.001,114.697,97.404],zae=e=>"number"==typeof e;function jae(e){return Yv(()=>{let t=pw(e,$k(.10000000149011612));return cw(QN(PS(e,t)),t)})}function Bae(e,t){return Yv(()=>{let n=uN(e,[[0,0],[1,1],[1,1],[0,0]]);return n=hk(n,t.conv.filters,[1,1],"valid"),n=PS(n,t.bn.sub),n=pw(n,t.bn.truediv),n=cw(n,t.conv.bias),jae(n)})}function Wae(e,t){return Yv(()=>{let n=uN(e,[[0,0],[1,1],[1,1],[0,0]]);return n=iI(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=cw(n,t.bias),jae(n)})}function Vae(e,t){let n=Pne(e,t);let a=jne(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(a,r,s){let i=n(a,r,3,"".concat(s,"/conv")),o=function(n,a){let r=TI(e(n)),s=TI(e(n));return t.push({paramPath:"".concat(a,"/sub")},{paramPath:"".concat(a,"/truediv")}),{sub:r,truediv:s}}(r,"".concat(s,"/bn"));return{conv:i,bn:o}},extractSeparableConvParams:a}}function Uae(e,t){let n=Wne(e,t);function a(e){return{filters:n("".concat(e,"/filters"),4),bias:n("".concat(e,"/bias"),1)}}return{extractConvParams:a,extractConvWithBatchNormParams:function(e){let t=a("".concat(e,"/conv")),r=function(e){return{sub:n("".concat(e,"/sub"),1),truediv:n("".concat(e,"/truediv"),1)}}("".concat(e,"/bn"));return{conv:t,bn:r}},extractSeparableConvParams:Bne(n)}}var Hae=class{constructor(){let{inputSize:e,scoreThreshold:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,"number"!=typeof this._inputSize||this._inputSize%32!==0)throw new Error("".concat(this._name," - expected inputSize to be a number divisible by 32"));if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error("".concat(this._name," - expected scoreThreshold to be a number between 0 and 1"))}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},Gae=class e extends Ane{constructor(e){super("TinyYolov2"),function(e){if(!e)throw new Error("invalid config: ".concat(e));if("boolean"!=typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: ".concat(e.withSeparableConvs));if(!zae(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: ".concat(e.iouThreshold));if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(e=>"string"==typeof e))throw new Error("config.classes has to be an array class names: string[], have: ".concat(JSON.stringify(e.classes)));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(e=>e||{}).every(e=>zae(e.x)&&zae(e.y)))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: ".concat(JSON.stringify(e.anchors)));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(zae)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: ".concat(JSON.stringify(e.meanRgb)))}(e),this._config=e}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(e,t){let n=Bae(e,t.conv0);return n=qS(n,[2,2],[2,2],"same"),n=Bae(n,t.conv1),n=qS(n,[2,2],[2,2],"same"),n=Bae(n,t.conv2),n=qS(n,[2,2],[2,2],"same"),n=Bae(n,t.conv3),n=qS(n,[2,2],[2,2],"same"),n=Bae(n,t.conv4),n=qS(n,[2,2],[2,2],"same"),n=Bae(n,t.conv5),n=qS(n,[2,2],[1,1],"same"),n=Bae(n,t.conv6),n=Bae(n,t.conv7),Mne(n,t.conv8,"valid",!1)}runMobilenet(e,t){let n=this.config.isFirstLayerConv2d?jae(Mne(e,t.conv0,"valid",!1)):Wae(e,t.conv0);return n=qS(n,[2,2],[2,2],"same"),n=Wae(n,t.conv1),n=qS(n,[2,2],[2,2],"same"),n=Wae(n,t.conv2),n=qS(n,[2,2],[2,2],"same"),n=Wae(n,t.conv3),n=qS(n,[2,2],[2,2],"same"),n=Wae(n,t.conv4),n=qS(n,[2,2],[2,2],"same"),n=Wae(n,t.conv5),n=qS(n,[2,2],[1,1],"same"),n=t.conv6?Wae(n,t.conv6):n,n=t.conv7?Wae(n,t.conv7):n,Mne(n,t.conv8,"valid",!1)}forwardInput(e,t){let{params:n}=this;if(!n)throw new Error("TinyYolov2 - load model before inference");return Yv(()=>{let a=iw(e.toBatchTensor(t,!1),"float32");return a=this.config.meanRgb?Xte(a,this.config.meanRgb):a,a=a.div(255),this.config.withSeparableConvs?this.runMobilenet(a,n):this.runTinyYolov2(a,n)})}async forward(e,t){return this.forwardInput(await Nne(e),t)}async detect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{inputSize:n,scoreThreshold:a}=new Hae(t),r=await Nne(e),s=await this.forwardInput(r,n),i=Yv(()=>VI(s)[0].expandDims()),o={width:r.getInputWidth(0),height:r.getInputHeight(0)},l=await this.extractBoxes(i,r.getReshapedInputDimensions(0),a);s.dispose(),i.dispose();let c=l.map(e=>e.box),u=l.map(e=>e.score),d=l.map(e=>e.classScore),p=l.map(e=>this.config.classes[e.label]);return function(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=t.map((e,t)=>({score:e,boxIndex:t})).sort((e,t)=>e.score-t.score).map(e=>e.boxIndex),s=[];for(;r.length>0;){let t=r.pop();s.push(t);let i=r,o=[];for(let n=0;n<i.length;n++){let r=i[n],s=e[t],l=e[r];o.push(Kte(s,l,a))}r=r.filter((e,t)=>o[t]<=n)}return s}(c.map(e=>e.rescale(n)),u,this.config.iouThreshold,!0).map(e=>new Gte(u[e],d[e],p[e],c[e],o))}getDefaultModelName(){return""}extractParamsFromWeightMap(e){return function(e,t){let n,a=[],{extractConvParams:r,extractConvWithBatchNormParams:s,extractSeparableConvParams:i}=Uae(e,a);if(t.withSeparableConvs){let e=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?r("conv0"):i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:e>7?i("conv6"):void 0,conv7:e>8?i("conv7"):void 0,conv8:r("conv8")}}else n={conv0:s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:s("conv6"),conv7:s("conv7"),conv8:r("conv8")};return One(e,a),{params:n,paramMappings:a}}(e,this.config)}extractParams(t){let n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(7!==a&&8!==a&&9!==a)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ".concat(a," filterSizes in config"));return function(e,t,n,a){let r,{extractWeights:s,getRemainingWeights:i}=Vne(e),o=[],{extractConvParams:l,extractConvWithBatchNormParams:c,extractSeparableConvParams:u}=Vae(s,o);if(t.withSeparableConvs){let[e,s,i,o,c,d,p,h,f]=a;r={conv0:t.isFirstLayerConv2d?l(e,s,3,"conv0"):u(e,s,"conv0"),conv1:u(s,i,"conv1"),conv2:u(i,o,"conv2"),conv3:u(o,c,"conv3"),conv4:u(c,d,"conv4"),conv5:u(d,p,"conv5"),conv6:h?u(p,h,"conv6"):void 0,conv7:f?u(h,f,"conv7"):void 0,conv8:l(f||h||p,5*n,1,"conv8")}}else{let[e,t,s,i,o,u,d,p,h]=a;r={conv0:c(e,t,"conv0"),conv1:c(t,s,"conv1"),conv2:c(s,i,"conv2"),conv3:c(i,o,"conv3"),conv4:c(o,u,"conv4"),conv5:c(u,d,"conv5"),conv6:c(d,p,"conv6"),conv7:c(p,h,"conv7"),conv8:l(h,5*n,1,"conv8")}}if(0!==i().length)throw new Error("weights remaing after extract: ".concat(i().length));return{params:r,paramMappings:o}}(t,this.config,this.boxEncodingSize,n)}async extractBoxes(e,t,n){let{width:a,height:r}=t,s=Math.max(a,r),i=s/a,o=s/r,l=e.shape[1],u=this.config.anchors.length,[d,p,h]=Yv(()=>{let t=e.reshape([l,l,u,this.boxEncodingSize]);return[t.slice([0,0,0,0],[l,l,u,4]),t.slice([0,0,0,4],[l,l,u,1]),this.withClassScores?mI(t.slice([0,0,0,5],[l,l,u,this.config.classes.length]),3):$k(0)]}),f=[],m=await p.array(),g=await d.array();for(let y=0;y<l;y++)for(let e=0;e<l;e++)for(let t=0;t<u;t++){let a=Yte(m[y][e][t][0]);if(!n||a>n){let n=(e+Yte(g[y][e][t][0]))/l*i,r=(y+Yte(g[y][e][t][1]))/l*o,s=Math.exp(g[y][e][t][2])*this.config.anchors[t].x/l*i,u=Math.exp(g[y][e][t][3])*this.config.anchors[t].y/l*o,d=n-s/2,p=r-u/2,m={row:y,col:e,anchor:t},{classScore:b,label:v}=this.withClassScores?await this.extractPredictedClass(h,m):{classScore:1,label:0};f.push(c({box:new Hte(d,p,d+s,p+u),score:a,classScore:a*b,label:v},m))}}return d.dispose(),p.dispose(),h.dispose(),f}async extractPredictedClass(e,t){let{row:n,col:a,anchor:r}=t,s=await e.array();return Array(this.config.classes.length).fill(0).map((e,t)=>s[n][a][r][t]).map((e,t)=>({classScore:e,label:t})).reduce((e,t)=>e.classScore>t.classScore?e:t)}};Gae.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var qae=Gae,Kae=class extends qae{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super(c({withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:Pae,meanRgb:Lae}:{anchors:Oae,withClassScores:!0}))}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(e=>new qte(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight}))}getDefaultModelName(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}};var Xae=class extends Hae{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},Yae=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function Qae(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>{let{alignedRect:t}=e;return t},s=e.map(e=>eae(e)?r(e):e.detection),i=a||(t instanceof Jb?await Cne(t,s):await Ine(t,s)),o=await n(i);return i.forEach(e=>e instanceof Jb&&e.dispose()),o}async function Jae(e,t,n,a,r){return Qae([e],t,async e=>n(e[0]),a,r)}var Zae=[new Vte(1.603231,2.094468),new Vte(6.041143,7.080126),new Vte(2.882459,3.518061),new Vte(4.266906,5.178857),new Vte(9.041765,10.66308)],$ae=[117.001,114.697,97.404],ere=class extends qae{constructor(){super({withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:Zae,meanRgb:$ae,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(e=>new qte(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight}))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},tre={ssdMobilenetv1:new Mae,tinyFaceDetector:new ere,tinyYolov2:new Kae,faceLandmark68Net:new hae,faceLandmark68TinyNet:new class extends pae{constructor(){super("FaceLandmark68TinyNet",arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fae)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}},faceRecognitionNet:new kae,faceExpressionNet:new class extends Yne{constructor(){super("FaceExpressionNet",arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qne)}forwardInput(e){return Yv(()=>mI(this.runNet(e)))}async forward(e){return this.forwardInput(await Nne(e))}async predictExpressions(e){let t=await Nne(e),n=await this.forwardInput(t),a=await Promise.all(VI(n).map(async e=>{let t=e.dataSync();return e.dispose(),t}));n.dispose();let r=a.map(e=>new Jne(e));return t.isBatchInput?r:r[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}},ageGenderNet:new class extends Ane{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new cae(2);super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error("".concat(this._name," - load model before inference"));return Yv(()=>{let n=e instanceof Sne?this.faceFeatureExtractor.forwardInput(e):e,a=Vw(n,[7,7],[2,2],"valid").as2D(n.shape[0],-1);return{age:Kne(a,t.fc.age).as1D(),gender:Kne(a,t.fc.gender)}})}forwardInput(e){return Yv(()=>{let{age:t,gender:n}=this.runNet(e);return{age:t,gender:mI(n)}})}async forward(e){return this.forwardInput(await Nne(e))}async predictAgeAndGender(e){let t=await Nne(e),n=await this.forwardInput(t),a=VI(n.age),r=VI(n.gender),s=a.map((e,t)=>({ageTensor:e,genderTensor:r[t]})),i=await Promise.all(s.map(async e=>{let{ageTensor:t,genderTensor:n}=e,a=t.dataSync()[0],r=n.dataSync()[0],s=r>.5,i=s?"male":"female",o=s?r:1-r;return t.dispose(),n.dispose(),{age:a,gender:i,genderProbability:o}}));return n.age.dispose(),n.gender.dispose(),t.isBatchInput?i:i[0]}getDefaultModelName(){return"age_gender_model"}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=Vne(e),r=Lne(n,t),s=r(512,1,"fc/age"),i=r(512,2,"fc/gender");if(0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{paramMappings:t,params:{fc:{age:s,gender:i}}}}(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=Xne(e);return this.faceFeatureExtractor.loadFromWeightMap(t),function(e){let t=[],n=Wne(e,t);function a(e){return{weights:n("".concat(e,"/weights"),2),bias:n("".concat(e,"/bias"),1)}}let r={fc:{age:a("fc/age"),gender:a("fc/gender")}};return One(e,t),{params:r,paramMappings:t}}(n)}extractParams(e){let t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)}}},nre=class extends Yae{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},are=class extends nre{async run(){let e=await this.parentTask,t=await Qae(e,this.input,async e=>Promise.all(e.map(e=>tre.faceExpressionNet.predictExpressions(e))),this.extractedFaces);return e.map((e,n)=>Zne(e,t[n]))}withAgeAndGender(){return new lre(this,this.input)}},rre=class extends nre{async run(){let e=await this.parentTask;if(e)return Zne(e,await Jae(e,this.input,e=>tre.faceExpressionNet.predictExpressions(e),this.extractedFaces))}withAgeAndGender(){return new cre(this,this.input)}},sre=class extends are{withAgeAndGender(){return new ure(this,this.input)}withFaceDescriptors(){return new hre(this,this.input)}},ire=class extends rre{withAgeAndGender(){return new dre(this,this.input)}withFaceDescriptor(){return new fre(this,this.input)}},ore=class extends Yae{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},lre=class extends ore{async run(){let e=await this.parentTask,t=await Qae(e,this.input,async e=>Promise.all(e.map(e=>tre.ageGenderNet.predictAgeAndGender(e))),this.extractedFaces);return e.map((e,n)=>{let{age:a,gender:r,genderProbability:s}=t[n];return Nae(Iae(e,r,s),a)})}withFaceExpressions(){return new are(this,this.input)}},cre=class extends ore{async run(){let e=await this.parentTask;if(!e)return;let{age:t,gender:n,genderProbability:a}=await Jae(e,this.input,e=>tre.ageGenderNet.predictAgeAndGender(e),this.extractedFaces);return Nae(Iae(e,n,a),t)}withFaceExpressions(){return new rre(this,this.input)}},ure=class extends lre{withFaceExpressions(){return new sre(this,this.input)}withFaceDescriptors(){return new hre(this,this.input)}},dre=class extends cre{withFaceExpressions(){return new ire(this,this.input)}withFaceDescriptor(){return new fre(this,this.input)}},pre=class extends Yae{constructor(e,t){super(),this.parentTask=e,this.input=t}},hre=class extends pre{async run(){let e=await this.parentTask;return(await Qae(e,this.input,e=>Promise.all(e.map(e=>tre.faceRecognitionNet.computeFaceDescriptor(e))),null,e=>e.landmarks.align(null,{useDlibAlignment:!0}))).map((t,n)=>Sae(e[n],t))}withFaceExpressions(){return new sre(this,this.input)}withAgeAndGender(){return new ure(this,this.input)}},fre=class extends pre{async run(){let e=await this.parentTask;if(e)return Sae(e,await Jae(e,this.input,e=>tre.faceRecognitionNet.computeFaceDescriptor(e),null,e=>e.landmarks.align(null,{useDlibAlignment:!0})))}withFaceExpressions(){return new ire(this,this.input)}withAgeAndGender(){return new dre(this,this.input)}},mre=class extends Yae{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=n}get landmarkNet(){return this.useTinyLandmarkNet?tre.faceLandmark68TinyNet:tre.faceLandmark68Net}},gre=class extends mre{async run(){let e=await this.parentTask,t=e.map(e=>e.detection),n=this.input instanceof Jb?await Cne(this.input,t):await Ine(this.input,t),a=await Promise.all(n.map(e=>this.landmarkNet.detectLandmarks(e)));return n.forEach(e=>e instanceof Jb&&e.dispose()),e.filter((e,t)=>a[t]).map((e,t)=>tae(e,a[t]))}withFaceExpressions(){return new sre(this,this.input)}withAgeAndGender(){return new ure(this,this.input)}withFaceDescriptors(){return new hre(this,this.input)}},yre=class extends mre{async run(){let e=await this.parentTask;if(!e)return;let{detection:t}=e,n=this.input instanceof Jb?await Cne(this.input,[t]):await Ine(this.input,[t]),a=await this.landmarkNet.detectLandmarks(n[0]);return n.forEach(e=>e instanceof Jb&&e.dispose()),tae(e,a)}withFaceExpressions(){return new ire(this,this.input)}withAgeAndGender(){return new dre(this,this.input)}withFaceDescriptor(){return new fre(this,this.input)}},bre=class extends Yae{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dae;super(),this.input=e,this.options=t}},vre=class extends bre{async run(){let e,{input:t,options:n}=this;if(n instanceof Xae)e=tre.tinyFaceDetector.locateFaces(t,n);else if(n instanceof Dae)e=tre.ssdMobilenetv1.locateFaces(t,n);else{if(!(n instanceof Hae))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");e=tre.tinyYolov2.locateFaces(t,n)}return e}runAndExtendWithFaceDetections(){return new Promise((e,t)=>{this.run().then(t=>e(t.map(e=>tne({},e)))).catch(e=>t(e))})}withFaceLandmarks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new gre(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new are(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new lre(this.runAndExtendWithFaceDetections(),this.input)}},xre=class extends bre{async run(){let e=await new vre(this.input,this.options),t=e[0];return e.forEach(e=>{e.score>t.score&&(t=e)}),t}runAndExtendWithFaceDetection(){return new Promise(async e=>{let t=await this.run();e(t?tne({},t):void 0)})}withFaceLandmarks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new yre(this.runAndExtendWithFaceDetection(),this.input,e)}withFaceExpressions(){return new rre(this.runAndExtendWithFaceDetection(),this.input)}withAgeAndGender(){return new cre(this.runAndExtendWithFaceDetection(),this.input)}};function wre(e,t){let{width:n,height:a}=new Tte(t.width,t.height);if(n<=0||a<=0)throw new Error("resizeResults - invalid dimensions: ".concat(JSON.stringify({width:n,height:a})));if(Array.isArray(e))return e.map(e=>wre(e,{width:n,height:a}));if(eae(e)){let t=e.detection.forSize(n,a),r=e.unshiftedLandmarks.forSize(t.box.width,t.box.height);return tae(tne(e,t),r)}return ene(e)?tne(e,e.detection.forSize(n,a)):e instanceof Zte||e instanceof qte?e.forSize(n,a):e}function kre(t){let{apiBase:n="/",MODEL_URL:a="/models",DISPLAY_WIDTH:r=320,DISPLAY_HEIGHT:s=240,REQUIRED_SAMPLES:i=5,onPassed:o=()=>{}}=t;const l=(0,e.useRef)(null),c=(0,e.useRef)(null),u=(0,e.useRef)(null),d=(0,e.useRef)(null),p=(0,e.useRef)(null),h=(0,e.useRef)(null),f=(0,e.useRef)(null),m=(0,e.useRef)([]),g=(0,e.useRef)([]),y=(0,e.useRef)([]),b=(0,e.useRef)(null),v=(0,e.useRef)(null),[x,w]=(0,e.useState)("Initializing models..."),[k,S]=(0,e.useState)(!1),[N,I]=(0,e.useState)(!1),[C,T]=(0,e.useState)(!1),[E,_]=(0,e.useState)("idle"),[A,R]=(0,e.useState)(0),[F,D]=(0,e.useState)({earThreshold:.2,smileThreshold:1.8,headXThreshold:.08}),M={CALIBRATION_TIME_MS:2200,HISTORY_MAX:120,BLINK_MIN_FRAMES:2,CHALLENGE_TIMEOUT:4500,CHALLENGES_ORDER:["left","right","smile"],MIN_EAR_ALLOWED:.09,MAX_EAR_ALLOWED:.48,SMILE_RATIO_MIN:1.2};(0,e.useEffect)(()=>{let e=!0;p.current=new Audio("/audio/success.mp3"),h.current=new Audio("/audio/wrong.mp3"),f.current=new Audio("/audio/instruction.mp3"),p.current.preload="auto",h.current.preload="auto",f.current.preload="auto";return(async()=>{try{if(w("\ud83d\udce6 Loading face-api.js models..."),await Promise.all([tre.ssdMobilenetv1.loadFromUri(a),tre.faceLandmark68Net.loadFromUri(a),tre.faceRecognitionNet.loadFromUri(a)]),!e)return;S(!0),w("Models loaded \u2014 initializing camera..."),await z()}catch(Tre){console.error("Model load failed",Tre),w("\u274c Failed loading models. Check /models accessibility.")}})(),()=>{e=!1,j()}},[]);const O=()=>{p.current&&(p.current.currentTime=0,p.current.play().catch(e=>console.log("Audio play failed:",e)))},P=()=>{h.current&&(h.current.currentTime=0,h.current.play().catch(e=>console.log("Audio play failed:",e)))},L=()=>{f.current&&(f.current.currentTime=0,f.current.play().catch(e=>console.log("Audio play failed:",e)))},z=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:640},height:{ideal:480}},audio:!1});d.current=e,l.current&&(l.current.srcObject=e,l.current.width=r,l.current.height=s,await l.current.play(),I(!0),w("\ud83c\udfa5 Camera ready \u2014 please position your face"),B())}catch(Tre){console.error("Camera failed",Tre),w("\u274c Camera access denied or unavailable.")}},j=()=>{u.current&&cancelAnimationFrame(u.current),d.current&&(d.current.getTracks().forEach(e=>e.stop()),d.current=null)},B=async()=>{if(!l.current||l.current.paused||l.current.ended)u.current=requestAnimationFrame(B);else{try{const e=new Dae({minConfidence:.5}),t=await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dae;return new xre(e,t)}(l.current,e).withFaceLandmarks(),n=c.current;if(n&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{width:a,height:r}=n?vne(t):t;e.width=a,e.height=r}(n,{width:r,height:s}),t){T(!0);const e=wre(t,{width:r,height:s}),n=e.landmarks.getLeftEye(),a=e.landmarks.getRightEye(),i=e.landmarks.getMouth(),o=e.landmarks.getNose(),l=U(n,a),c=Math.hypot(i[0].x-i[6].x,i[0].y-i[6].y),u=c/(Math.hypot(i[3].y-i[9].y,i[3].x-i[9].x)+1e-6),d=V(n),p=V(a),h={x:(d.x+p.x)/2,y:(d.y+p.y)/2},f=Math.abs(p.x-d.x)||1,b={x:(o[3].x-h.x)/f,y:(o[3].y-h.y)/Math.abs(p.y-d.y||1)};W(m,l,M.HISTORY_MAX),W(g,b,M.HISTORY_MAX),W(y,u,M.HISTORY_MAX),H(e,{ear:l,mouthRatio:u,noseRel:b})}else if(T(!1),n){n.getContext("2d").clearRect(0,0,n.width,n.height)}}catch(Tre){console.error("Detection loop error",Tre)}u.current=requestAnimationFrame(B)}},W=(e,t,n)=>{const a=e.current||[];a.push(t),a.length>n&&a.splice(0,a.length-n),e.current=a},V=e=>{const t=e.reduce((e,t)=>({x:e.x+t.x,y:e.y+t.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}},U=(e,t)=>{const n=e=>{const t=(e,t)=>Math.hypot(e.x-t.x,e.y-t.y);return(t(e[1],e[5])+t(e[2],e[4]))/(2*(t(e[0],e[3])||1))};return(n(e)+n(t))/2},H=(e,t)=>{const n=c.current;if(!n)return;const a=n.getContext("2d");a.clearRect(0,0,n.width,n.height);const r=e.detection.box;a.lineWidth=2,a.strokeStyle="rgba(0,200,120,0.9)",a.strokeRect(r.x,r.y,r.width,r.height),a.fillStyle="white",e.landmarks.positions.forEach(e=>{a.beginPath(),a.arc(e.x,e.y,1.2,0,2*Math.PI),a.fill()}),a.fillStyle="white",a.font="12px Arial";const s=t.ear,i=t.mouthRatio,o=t.noseRel.x;a.fillText("EAR: ".concat(s.toFixed(2)),8,14),a.fillText("earThr: ".concat(F.earThreshold.toFixed(2)),8,30),a.fillText("mouthR: ".concat(i.toFixed(2)),8,46),a.fillText("headX: ".concat(o.toFixed(2)),8,62),a.fillText("status: ".concat(E),8,78)},G=async()=>{if(!C)return w("\u2757 Face not detected \u2014 position your face"),P(),!1;_("calibrating"),w("\ud83d\udd27 Calibrating\u2026 Keep neutral face (no blink/smile) for a moment"),L();const e=Date.now();for(;Date.now()-e<M.CALIBRATION_TIME_MS;)await new Promise(e=>setTimeout(e,100));const t=[...m.current||[]].slice(-60).filter(e=>"number"===typeof e),n=[...y.current||[]].slice(-60).filter(e=>"number"===typeof e),a=q(t)||.32,r=q(n)||M.SMILE_RATIO_MIN,s=K(.72*a,M.MIN_EAR_ALLOWED,M.MAX_EAR_ALLOWED),i=Math.max(1.2,1.25*r);return b.current=a,v.current=r,D({earThreshold:s,smileThreshold:i,headXThreshold:.08}),w("\u2705 Calibrated (ear ".concat(a.toFixed(2),", mouth ").concat(r.toFixed(2),")")),_("idle"),O(),!0},q=e=>{if(!e||0===e.length)return null;const t=[...e].sort((e,t)=>e-t),n=Math.floor(t.length/2);return t.length%2===0?(t[n-1]+t[n])/2:t[n]},K=(e,t,n)=>Math.max(t,Math.min(n,e)),X=e=>({left:"Turn head slightly left",right:"Turn head slightly right",smile:"Smile"}[e]);return(0,jt.jsxs)("div",{style:{maxWidth:880,margin:12,fontFamily:"Inter, Arial, sans-serif"},children:[(0,jt.jsx)("h3",{children:"Adaptive Liveness Check"}),(0,jt.jsx)("p",{style:{color:"#444"},children:x}),(0,jt.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("div",{style:{position:"relative",width:r,height:s,borderRadius:12,background:"#000"},children:[(0,jt.jsx)("video",{ref:l,width:r,height:s,style:{position:"absolute",left:0,top:0,borderRadius:12},muted:!0,playsInline:!0}),(0,jt.jsx)("canvas",{ref:c,width:r,height:s,style:{position:"absolute",left:0,top:0,borderRadius:12,pointerEvents:"none"}})]}),(0,jt.jsxs)("div",{style:{marginTop:8,display:"flex",gap:8},children:[(0,jt.jsx)("button",{onClick:G,disabled:!N,style:Sre("#1976d2"),children:"Calibrate (2s)"}),(0,jt.jsx)("button",{onClick:async()=>{if(!C)return w("\u2757 Position your face first"),void P();if(!await G())return w("\u274c Calibration failed"),void P();_("running"),w("\u25b6\ufe0f Liveness check started"),R(0),L();const e={left:()=>{const e=g.current||[];if(e.length<6)return!1;return e.slice(-12).filter(e=>e.x<-F.headXThreshold).length>=3},right:()=>{const e=g.current||[];if(e.length<6)return!1;return e.slice(-12).filter(e=>e.x>F.headXThreshold).length>=3},smile:()=>{const e=y.current||[];if(e.length<6)return!1;const t=e.slice(-12).filter(e=>e>F.smileThreshold).length;return t>=4}},t=b.current<.18?["left","right","smile"]:M.CHALLENGES_ORDER;let n=!0;for(let a=0;a<t.length;a++){const r=t[a];w("\ud83d\udd0d Please: ".concat(X(r))),R(Math.round(a/t.length*100));const s=Date.now();let i=!1;for(;Date.now()-s<M.CHALLENGE_TIMEOUT;){if(e[r]()){i=!0;break}await new Promise(e=>setTimeout(e,120))}if(!i){w("\u274c Failed to ".concat(X(r))),_("failed"),n=!1,P();break}w("\u2705 ".concat(X(r)," detected")),O(),await new Promise(e=>setTimeout(e,450))}R(100),n?(w("\ud83c\udf89 Liveness check passed"),_("passed"),O(),o()):P()},disabled:!N,style:Sre("#4caf50"),children:"Start Liveness"}),(0,jt.jsx)("button",{onClick:()=>{m.current=[],g.current=[],y.current=[],b.current=null,v.current=null,w("Reset done"),_("idle"),L()},style:Sre("#f44336"),children:"Reset"})]}),(0,jt.jsxs)("div",{style:{marginTop:10},children:[(0,jt.jsxs)("div",{children:["Face detected: ",(0,jt.jsx)("strong",{children:C?"Yes":"No"})]}),(0,jt.jsxs)("div",{children:["Liveness step: ",(0,jt.jsx)("strong",{children:E})]}),(0,jt.jsxs)("div",{children:["Progress: ",(0,jt.jsxs)("strong",{children:[A,"%"]})]}),(0,jt.jsx)("div",{style:{marginTop:6},children:(0,jt.jsxs)("small",{children:["Thresholds (adaptive): ear ",F.earThreshold.toFixed(2),", smile ",F.smileThreshold.toFixed(2)]})})]})]}),(0,jt.jsxs)("div",{style:{flex:1},children:[(0,jt.jsx)("h4",{children:"Tips"}),(0,jt.jsxs)("ul",{children:[(0,jt.jsx)("li",{children:"Jaga jarak mata-kamera stabil saat kalibrasi (2 detik)."}),(0,jt.jsx)("li",{children:"Jika mata terlihat 'sipit' dan blink sulit terdeteksi, komponen otomatis memprioritaskan head-turn dan smile."}),(0,jt.jsx)("li",{children:"Bila liveness tetap gagal, coba lakukan gesture yang diminta (turn left/right atau senyum)."}),(0,jt.jsx)("li",{children:"Gunakan overlay debug untuk melihat EAR & headX realtime."})]}),(0,jt.jsx)("h4",{children:"Parameter (bisa di-tweak)"}),(0,jt.jsxs)("div",{children:["Calibration time: ",M.CALIBRATION_TIME_MS," ms"]}),(0,jt.jsxs)("div",{children:["Challenge timeout: ",M.CHALLENGE_TIMEOUT," ms"]})]})]})]})}const Sre=e=>({padding:"8px 12px",borderRadius:6,border:"none",background:e,color:"white",cursor:"pointer"}),Nre=e=>{let{children:t}=e;const{user:n}=Wt();return n?t:(0,jt.jsx)(Fe,{to:"/login"})};const Ire=function(){return(0,jt.jsx)("div",{className:"App",children:(0,jt.jsx)(Vt,{children:(0,jt.jsx)(ft,{children:(0,jt.jsxs)(Oe,{children:[(0,jt.jsx)(De,{path:"/login",element:(0,jt.jsx)(tr,{})}),(0,jt.jsx)(De,{path:"/*",element:(0,jt.jsx)(Nre,{children:(0,jt.jsx)(Zp,{children:(0,jt.jsxs)(Oe,{children:[(0,jt.jsx)(De,{path:"/",element:(0,jt.jsx)(Or,{})}),(0,jt.jsx)(De,{path:"/dashboard",element:(0,jt.jsx)(Or,{})}),(0,jt.jsx)(De,{path:"/register",element:(0,jt.jsx)(Od,{})}),(0,jt.jsx)(De,{path:"/search",element:(0,jt.jsx)(jd,{})}),(0,jt.jsx)(De,{path:"/document/:id",element:(0,jt.jsx)(Gd,{})}),(0,jt.jsx)(De,{path:"/borrowing",element:(0,jt.jsx)(Vp,{})}),(0,jt.jsx)(De,{path:"/monitoring",element:(0,jt.jsx)(Kp,{})}),(0,jt.jsx)(De,{path:"/face-recognition",element:(0,jt.jsx)(kre,{})})]})})})})]})})})})},Cre=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:a,getFCP:r,getLCP:s,getTTFB:i}=t;n(e),a(e),r(e),s(e),i(e)})};a.createRoot(document.getElementById("root")).render((0,jt.jsx)(e.StrictMode,{children:(0,jt.jsx)(Ire,{})})),Cre()})()})();
//# sourceMappingURL=main.598b3401.js.map